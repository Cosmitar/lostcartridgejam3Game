(this.webpackJsonplostcartridgejam3=this.webpackJsonplostcartridgejam3||[]).push([[0],{32:function(e){e.exports=JSON.parse('{"menu":{"main":{"loading_message":"LOADING... PLEASE WAIT","key_to_start":"PRESS ANY KEY TO START","option_new":"New Game","option_continue":"Continue","option_restart_level":"Restart level","option_back_to_menu":"Exit to menu","yes":"Yes","no":"No","on":"On","off":"Off","of":"OF","english":"English","spanish":"Spanish","heading_scrore":"level         gems    threats   shrooms   comp","score_gems":"gems","score_enemies":"threats","score_shrooms":"shrooms","score_comp":"complete","score_best":"best","score_op_next":"next","score_op_repeat":"repeat","score_op_exit":"exit","chamber":"chamber","ruins":"ruins","confirmNewGame":"START A NEW GAME AND LOST\\n\\nYOUR CURRENT PROGRESS?","toBeContinue":"CREDITS"},"dialog_options":{"close":"close","story":"story","next":"next","yes":"yes","no":"no"},"cookies":{"thirdparty":"Can\'t save progress. Please make sure you allow third party cookies in this page. This game uses IndexedDB to store your progress."}},"intro":{"story_page_1":{"line_1":"In the beginning: There was nothing,","line_2":"except for the goddess Tiamat"},"story_page_2":{"line_1":"she formed the world as she pleased","line_2":"Giving life to the sumarian people,","line_3":"creating them in her image"},"story_page_3":{"line_1":"The ancient land of Sumaria. An","line_2":"eternal paradise where immortal","line_3":"beings live in infinite harmony"},"dialog_1":{"tiamat_say_1":"My beloved: why do you call for me?","mary_say_1":"Our lord. A mysterious comet dashes across the sky. Our land has been ravaged by monstrous quakes, mysterious holes have been appearing, those who fall in never return. Please my lady, calm the earth.","tiamat_say_2":"The Catalyst Comet. It appears once every 2,533 years. I do not control its path. With it\'s coming, calamity strikes","mary_say_2":"We, your children, beseech thee. Guide us towards a resolution that might save our people.","tiamat_say_3":"Nothing you can do but accept your fate.","marduk_say_1":"Yes, We must accept our destiny.","mary_say_3":"But Lord, I\'m begging you, there must be something we can do for you to deliver us from evil.","tiamat_say_4":"hummm... Listen carefully, I will say it only once.","tiamat_say_5":"The Guardian ventures within the holes created in the earth, Discover the purpose of these mushrooms that now proliferate the land. Collect them and deliver them to me at the core of the planet.","tiamat_say_6":"Perhaps within these mysterious objects lies a solution to the terrors of The Catalyst Comet."},"dialog_2":{"marduk_say_1":"-Sigh- It is a man\'s duty I suppose.","mary_say_1":"Then I shall accompany you: There is safety in numbers.","marduk_say_2":"Nonsense. How would a frail priestess be of any benefit?","mary_say_2":"I am not frail. I am actually well versed in digging. The maintenance of the church keeps my mind and body active.","marduk_say_3":"I am a man, to endanger a woman\'s life by accepting her aid in such a perilous task would disgrace me.","mary_say_3":"But come to your senses. Let me help you. There are greater things at stake than your pride.","marduk_say_4":"I don\'t need your help."},"story_page_4":{"line_1":"A fissure opens up beneath Marduk","line_2":"and he falls into"},"story_page_5":{"line_1":"Mary rolls her eyes...","line_2":"and jumps in after his brother"}},"outro_ki":{"title":"NEXT STAGE: ABSU","toBrContinue":"TO BE CONTINUE...","discharge":"EVERLONG QUEST IS UNDER DEVELOPMENT.","whatsNext":"TWO MORE STAGES WILL COMPLETE THE GAME.","followUs":"TO BE IN CONTACT FOLLOW US ON TWITTER:","ourName":"LONG STORY SHORT GAMES","msgLine1":"IF YOU ENJOYED IT SO FAR, SHOW US SOME","msgLine2":"LOVE AND FEEDBACK. WE\'LL APPRECIATE IT.","msgLine3":"PRESS ENTER TO CONTINUE","credits":"CREDITS","creditsLine1":"GAME DESIGN, DEVEL AND PRODUCTION: @COSMITAR","creditsLine2":"STORY AND CREATIVE WRITTING: @QUEERJUNK","creditsLine3":"ORIGINAL MUSIC AND SFX: @E-7BJOHN","creditsLine4":"ORIGINAL TIAMAT ART: @LESS","creditsLine5":"AND SPACIAL THANKS TO YOU FOR PLAYING"},"stage_1":{"title":"STAGE 1: KI"},"levels":{"goal_dialog":{"dwarf_say_1":"REMEMBER, I NEED ${GOAL} DIAMONDS. YOU ONLY HAVE ${NUM}"}},"level_1":{"dialog_1":{"mary_say_1":"What a mysterious place. MARDUK CAN\'T BE FAR AWAY. I\'LL WALK AROUND A BIT AND SEE IF I CAN FIND HIM."},"dialog_2":{"mary_say_1":"THIS DECORATIONS ARE NOT NATURAL. A CIVILIZED CREATURE PUT IT HERE FOR A REASON."}},"level_2":{"dialog_1":{"mary_say_1":"MARDUUUUUK!!!! I can\'t see him. BUT I CAN SURE PUSH THOSE ROCKS OUT OF THE WAY AND KEEP LOOKING."},"dialog_2":{"mary_say_1":"What a beautiful gem, I will keep it."}},"level_3":{"dialog_1":{"mary_say_1":"THOSE CREEPY CRAWLIES LOOK DANGEROUS, BETTER IF I DON\'T TOUCH THEM. I\'LL SCARE THEM AWAY WITH A STONE."},"dialog_4":{"mary_say_1":"This thing is incredible!, I cut through earth like butter."},"discarded_dialog_3":{"mary_say_1":"Oops! hope I haven\'t bothered anybody."}},"level_4":{"dialog_1":{"mary_say_1":"WOW! THOSE QUAKES CAN BE DENGEROUS DOWN HERE"}},"level_5":{"dialog_1":{"mary_say_1":"HEY, WHO ARE YOU?","dwarf_say_1":"THAT\'S MY PICKAXE, GIVE IT BACK TO ME.","mary_say_2":"NO. I FOUND IT BACK THERE AND I NEED IT.","dwarf_say_2":"BUT IT\'S MINE... LOOK, I SHOULDN\'T EVEN BE TALKING TO YOUR KIND. I\'D BETTER GO.","mary_say_3":"WAIT! COME HERE FOR A SECOND."}},"level_6":{"dialog_1":{"mary_say_1":"YOU AGAIN! LOOK, I CAN\'T GIVE YOU YOUR PICKAXE BACK.","dwarf_say_1":"THERE ARE BIGGER ISSUES THAN THAT... THEY KNOW YOUR ARE DOWN HERE.","mary_say_2":"WHO KNOWS?","dwarf_say_2":"THEY, THEY HAVE SENT ANGELS TO BLOCK THE ENTRANCES TO THE KI CHAMBERS. YOU WON\'T BE ABLE TO ADVANCE.","mary_say_3":"I MUST FIND THE WAY, TELL ME HOW TO AVOID THEM.","dwarf_say_3":"YOU WON\'T MAKE IT ALONE, BUT I CAN HELP YOU, IN EXCHANGE FOR...","mary_say_4":"NOT THE PICKAXE. PERIOD.","dwarf_say_4":"...I LEND YOU MY PICKAXE AND I\'LL GET THE ANGELS OUT OF THE WAY IF YOU COLLECT ENOUGH JEWELS FOR ME.","dwarf_say_5":"GET ME 10 JEWELS IN THIS CHAMBER AND I WILL CLEAR THE WAY FOR YOU.","mary_say_5":"DEAL!"},"dialog_2":{"mary_say_1":"THE ANGEL BLOCKING MY PATH."},"dialog_3":{"mary_say_1":"WELL, I GOT YOUR JEWELS. BY THE WAY, DO YOU HAVE A NAME?","dwarf_say_1":"THEY CALL ME SHMERIDOCK","mary_say_2":"I WILL CALL YOU \'DOC\'... AND YOU CAN CALL ME...","dwarf_say_2":"MARY, I KNOW THAT. NOW, LET ME HONOUR MY WORD."},"dialog_4":{"dwarf_say_1":"REMEMBER, I NEED 10 DIAMONDS TO CLEAR THE WAY. YOU ONLY HAVE ${NUM}"}},"level_8":{"dialog_1":{"mary_say_1":"DOC, I\'M GLAD TO SEE YOU HERE. I WAS WONDERING IF YOU CAN GUIDE ME TO FIND MARDUK. CAN YOU?","dwarf_say_1":"I CAN, I JUST NEED SOME EXTRA ENERGY. GIVE ME ONE SHROOM AND I WILL UNLEASH MY POWER TO HELP YOU","mary_say_2":"I DON\'T KNOW DOC. THESE SHROOMS ARE FOR MARDUK TO FULFILL TIAMAT\'S COMMAND. LET ME THINK...","mary_say_3_yes":"HERE, TAKE IT AND HOPE YOU CAN FIND HIM.","mary_say_3_no":"NO, SHROOMS ARE NOT FOR YOU, THEY ARE FOR MARDUK, I JUST DON\'T KNOW HOW TO FIND HIM."},"dialog_1_option":{"yes":"YES, GIVE A SHROOM","no":"NO, KEEP THE SHROOM"},"dialog_1_no_shrooms":{"mary_say_1":"DOC, I\'M GLAD TO SEE YOU HERE. I WONDER IF YOU COULD GUIDE ME TO FIND MARDUK. CAN YOU?","dwarf_say_1":"I CAN, I JUST NEED SOME EXTRA ENERGY. IF YOU ONLY HAD A SHROOM, I WOULD UNLEASH MY POWER TO HELP YOU.","mary_say_2":"I\'M SURE I SAW SOME OF THEM IN PREVIOUS CHAMBERS, I\'LL BACK THERE AND GET ONE FOR YOU.","dwarf_say_2":"GO BACK TO CHAMBER ${NUM}, MUST BE A SHROOM THERE."},"dialog_1_repeat":{"dwarf_say_1":"SO, HAVE YOU CHANGED YOUR MIND?","mary_say_1":"MMM...","mary_say_2_yes":"HERE, TAKE IT AND HOPE YOU CAN FIND HIM","mary_say_2_no":"NO, SHROOMS ARE NOT FOR YOU, THEY ARE FOR MARDUK, I JUST DON\'T KNOW HOW TO FIND HIM."},"dialog_1_no_shrooms_repeat":{"dwarf_say_1":"SO, ARE YOU GOING TO GET THAT SHROOM?","mary_say_1":"YES, I WANT TO FIND MARDUK","dwarf_say_2":"GO BACK TO CHAMBER ${NUM}, MUST BE A SHROOM THERE"},"dialog_2":{"dwarf_say_1":"THERE YOU ARE... HELLO MARDUK","marduk_say_1":"WHAT ON EARTH IS THAT!? DON\'T EAT ME FOUL BEAST","dwarf_say_2":"THERE\'S NO NEED TO BE RUDE JUST BECAUSE I\'M DIFFERENT","marduk_say_2":"DON\'T PATRONIZE ME MONSTER AND REVEAL YOUR TRUE INTENTIONS","dwarf_say_3":"I\'M HERE TO HELP YOUR SISTER, SHE IS VERY WORRIED ABOUT YOU.","marduk_say_3":"THIS CAN\'T BE HAPPENING. HOW CAN I TRUST YOU? WHAT EVEN ARE YOU? WHERE DID YOU COME FROM?","dwarf_say_4":"I HAVE MANY NAMES. I HAVE BORN FROM DEEP WITHIN THE EARTH, CALLED TO LIFE BY THE FIRE ITSELF.","dwarf_say_5":"IF YOU ARE MORE OPEN, I CAN HELP YOUR SISTER AND YOU AS WELL.","marduk_say_4":"WHAT KIND OF FOUL NIGHTMARE IS THIS! I DON\'T MAKE DEALS WITH... YOUR KIND","dwarf_say_6":"BUT YOU WILL... IN TIME... THINGS CHANGE. PEOPLE GROW. EVEN YOU MARDUK. I THINK WE COULD BE GREAT FRIENDS. IN FACT. IT IS PROPHECY","dwarf_say_7":"I GOT WHAT I CAME FOR, NOW I CAN HELP MARY FIND YOU. FAREWELL MARDUK..."},"dialog_3":{"mary_say_1":"SO, HAVE YOU FOUND HIM? IS HE ALL RIGHT?","dwarf_say_1":"YES MARY, BUT DIDN\'T EXPECT SUCH A RUDE AND FOUL TEMPERED PERSON","mary_say_2":"-SIGHT- HE REALLY NEEDS TO LEARN WHEN TO SHUT HIS MOUTH. YOU HAVE BEEN VERY KIND DOC, CAN YOU TELL ME WHERE I CAN FIND MY BROTHER?","dwarf_say_2":"THAT\'S HOW IT SHOULD BE MARY, FOLLOW THE LION HEAD ENTRANCE, I\'LL WAIT FOR YOU IN THE NEXT CHAMBER. NOW I NEED TO REST A MOMENT..."}},"level_10":{"dialog_1":{"mary_say_1":"WHAT IS THIS PLACE, DOC?","dwarf_say_1":"THIS USED TO BE A STRONGHOLD, THE BULWARK OF A BEAUTIFUL DWARF CITY"},"dialog_2":{"mary_say_1":"USED TO BE? WHAT HAPPENED?..."},"dialog_3":{"dwarf_say_1":"GET ME ${NUM} DIAMONDS MARY, THAT WAY I CAN CLEAR THE PATH."}},"level_11":{"dialog_1":{"mary_say_1":"DOC, ARE YOU OK? I SEE YOU EMOTIONAL, IS THIS SOMEHOW SPECIAL FOR YOU?","dwarf_say_1":"THIS WAS MY VILLAGE ONCE. WE DWARVES THRIVED HERE FOR AGES BEFORE THE INFIGHTING OF THE MUSHROOM WAR TORE OUR HOMELAND APART","mary_say_2":"THE MUSHROOM WAR?","dwarf_say_2":"THE DAY OF THE GREAT QUAKES: MUSHROOMS STOPPED GROWING BENEATH THE SURFACE OF THE EARTH. WE WERE LEFT ONLY WITH WHAT WE HAD SAVED FROM THE PREVIOUS YEARS","dwarf_say_3":"WITH A LIMITED SUPPLY, IT WAS ONLY A MATTER OF TIME BEFORE VIOLENCE TAINTED OUR PEACEFUL LIFESTYLE.","mary_say_3":"OH! DOC, I REALLY SORRY.","dwarf_say_4":"NO TIME FOR REGRETS. GO AHEAD MARY AND BEWARE, MANY DANGEROUS ARTIFACTS STILL REMAIN AMONG THE RUINS, AS A REMINDER OF A TROUBLED TIME"},"dialog_2":{"mary_say_1":"WOW! THAT WAS DANGEROUS. I MUST BE CAREFUL WITH THOSE BARRELS, THEY CAN EVEN BREAK THE DEBRIS."},"dialog_3":{"dwarf_say_1":"I WAS JUST A BABY WHEN THEY TAKE ME AWAY TO PROTECT ME FROM THE FIRE AND THE HORROR. I HARDLY REMEMBER THESE PLACES.","mary_say_1":"DO NOT WORRY DOC, MAY TIAMAT GUIDE MY PATH, AND PROTECT ME FROM EVIL."},"dialog_4":{"dwarf_say_1":"GET ME ${NUM} DIAMONDS MARY, THAT WAY I CAN CLEAR THE PATH."}},"level_12_x":{"dialog_1":{"mary_say_1":"THERE YOU ARE MARDUK! I WAS WORRIED ABOUT YOU!","marduk_say_1":"THANK TIAMAT YOU\'RE HERE! I DON\'T FEEL WELL.","mary_say_2":" ARE YOU OKAY? HAVE YOU BEEN CRYING?","marduk_say_2":"MEN DON\'T CRY MARY... THOUGH I THINK I BROKE MY LEG FALLING FROM THE SURFACE.","mary_say_3":"CAN YOU WALK?","marduk_say_3":"I GUESS SO. WHAT ARE WE GOING TO DO?","mary_say_4":"JUST WAIT THERE FOR ME MARDUK, I\'M COMING TO HELP YOU. DON\'T BE AFRAID","marduk_say_4":"I CANT\'T BE AFRAID, I MUST GO ON.","mary_say_5":"JUST LISTEN TO ME THIS TIME, WAIT THERE, WE WILL SOLVE THIS OUT TOGETHER.","marduk_say_5":"FINE, I WON\'T BE FAR."},"dialog_2":{"mary_say_1":"DOC, I SAW MARDUK!, HE IS NEAR TO A WALL WITH THE WORD SHAMASH WRITTEN ON IT.","dwarf_say_1":"I KNOW THE WAY, FOLLOW ME."}},"maze_1":{"dialog_1":{"dwarf_say_1":"THIS PLACE IS A HUGH MESS, ONLY REMNANTS WERE LEFT STANDING, IS HARD TO KNOW WHERE TO GO. SOME EXTRA POWER MIGHT HELP US. DO YOU HAVE ONE OF YOUR SHROOMS FOR ME?","mary_say_1":"I DON\'T KNOW DOC, IS IT A GOOD IDEA KEEP SPENDING THE MUSHROOMS?","mary_say_2_yes":"HERE, TAKE IT AND HOPE YOU CAN FIND THE WAY OUT","mary_say_2_no":"NO, SHROOMS ARE NOT FOR YOU, THEY ARE FOR MARDUK, I\'M GOING TO MANGE MYSELF ON FIND THE WAY","mary_say_2_empty":"I\'M SURE I SAW SOME OF THEM IN PREVIOUS CHAMBERS, I\'LL GO BACK AND GET ONE FOR YOU","dwarf_say_2_empty":"GO BACK TO CHAMBER ${NUM}, MUST BE A SHROOM THERE"},"dialog_1_option":{"yes":"YES, GIVE A SHROOM","no":"NO, KEEP THE SHROOM"},"dialog_2":{"mary_say_1":"DOC!!! SLOW DOWN PLEASE, I CAN BARELY FOLLOW YOU","dwarf_say_1":"MY APOLOGIES, I THINK I GOT A LITTLE OVER ENTHUSIASTIC, HE HE."}},"level_16":{"dialog_1":{"mary_say_1":"MARDUUUK!... MARDUUUK!... THESE BOULDERS PILED UP ARE NOT MOVING ANYWHERE.","mary_say_2":"I CAN SEE HIM BREATHING FROM HERE. MAYBE HE IS UNCONSCIOUS.","mary_say_3":"WHERE IS DOC WHEN I NEED HIM? I MUST MOVE FAST, FIND DOC AND GET TO THAT SANCTUARY TO ASSIST MARDUK."},"dialog_2":{"mary_say_1":"DOC, I FOUND MARDUK!!! HE IS IN A SACTUARY NOT FAR FROM HERE.","dwarf_say_1":"OF COURSE, A SACTUARY IS WHERE I SAW HIM IN MY VISION. I KNOW WHERE IT IS.","mary_say_2":"GO AHEAD, I FOLLOW YOU.","dwarf_say_2_diamonds":"BUT BEFORE WE GO... I NEED TO GET RID OF THE ANGEL, GET ME ${NUM} DIAMONDS FOR THAT."},"dialog_2_repeat":{"mary_say_1":"TAKE YOUR DIAMONDS, NOW GO AHEAD, I FOLLOW YOU."},"dialog_2_repeat_no_diamonds":{"dwarf_say_1":"REMEMBER MARY, GET ME ${NUM} DIAMONDS THUS WE CAN CONTINUE."},"dialog_3":{"mary_say_1":"HERE DOC, HE WAS RIGHT HERE... I WONDER WHERE DID HE GO.","dwarf_say_1":"OR WHERE HE WAS TAKEN TO... EITHER WAY, THERE\'S ONLY ONE POSSIBLE DIRECTION... DOWN","dwarf_say_2":"FOLLOW ME MARY!"}},"level_17":{"dialog_1":{"mary_say_1":"DOC, CAN\'T SEE ANYTHING AHEAD. THIS PLACE IS LUGUBRIOUS.","dwarf_say_1":"I HAVE A GIFT FOR YOU, TAKE THE TORCH OF ASHELBROCK. SHALL SHED LIGHT ON YOUR DESTINY."},"dialog_2":{"mary_say_1":"ARE YOU COMING DOC?","dwarf_say_1":"CATCH YOU LATER, LET ME TAKE A LOOK AT THIS MARVELOUS FLAME..."}},"level_18":{"dialog_incident":{"mary_say_1":"OH GODDESS! THIS QUAKE WAS SO STRONG, IT MADE ME DROP THE TORCH AND IT WENT OUT."},"dialog_incident_recovery":{"mary_say_1":"THANKS TIAMAT! SOME LIGHT AGAIN. I REALLY HATE THE DARKNESS."}},"maze_2":{"dialog_1":{"mary_say_0":"ANOTHER MAZE OF DEBRIS...","dwarf_say_1":"THIS IS THE LAST CHAMBER IN DARKNESS. AFTER THIS ONE, THE LIGHT WILL SHINE AGAIN. SOME EXTRA POWER COULD BE REALLY HELPFUL HERE. DO YOU HAVE ONE OF YOUR SHROOMS TO ME?","mary_say_1":"I DON\'T KNOW DOC, IS IT A GOOD IDEA KEEP SPENDING THE MUSHROOMS?","mary_say_2_yes":"HERE, TAKE IT AND HOPE YOU CAN FIND THE WAY OUT","mary_say_2_no":"NO, SHROOMS ARE NOT FOR YOU, THEY ARE FOR MARDUK, I\'M GOING TO MANGE MYSELF ON FIND THE WAY","mary_say_2_empty":"I\'M SURE I SAW SOME OF THEM IN PREVIOUS CHAMBERS, I\'LL GO BACK AND GET ONE FOR YOU","dwarf_say_2_empty":"GO BACK TO CHAMBER ${NUM}, MUST BE A SHROOM THERE"},"dialog_1_option":{"yes":"YES, GIVE A SHROOM","no":"NO, KEEP THE SHROOM"},"dialog_2":{"mary_say_1":"DOC!!! SLOW DOWN PLEASE, I CAN BARELY FOLLOW YOU","dwarf_say_1":"MY APOLOGIES, I THINK I GOT A LITTLE OVER ENTHUSIASTIC, HE HE."}},"level_19":{"dialog_1":{"mary_say_1":"WHAT A BEAUTIFUL ART... IS IT TELLING A STORY?","dwarf_say_1":"IT IS A WRITTEN PROPHECY, ABOUT THE GUARDIAN OF THE MUSHROOMS AND THE HELPER. THEIR ARRIVAL TO KI AND THEIR JOURNEY TO THE CORE OF THE PLANET.","mary_say_2":"HOW COME YOU ARE SO WISE?","dwarf_say_2":"I AM NOT WISE, I BEGIN TO BELIEVE IN THE SCRIPTURES, THEY TELL THE TRUTH.","mary_say_3":"AND WHAT IT SAYS ABOUT THE HELPER? MIGHT TELL MY FUTURE AND COULD BE USEFUL TO KNOW.","dwarf_say_3":"IT SAYS THE GUARDIAN HAS THE FIRE IN HER HEAD AND THE KINDNESS IN HER HEART...","mary_say_4":"NONSENSES DOC, WE ALL KNOW FROM THE BIGINNING THAT MARDUK IS THE GUARDIAN AND I\'M THE HELPER. BESIDES, HOW CAN THEY KNOW ABOUT US IF WE HAVE NEVER BEEN UNDERGROUND?","dwarf_say_4":"YOU ARE BRAVE BUT NAIVE, MARY. I\'VE BEEN TOLD THESE STORIES ALL MY LIFE AS A FANTASY TALE, NOW, THEY ANTICIPATED EVERYTHING THAT HAPPENED SINCE I MET YOU. BUT MOST IMPORTANT, WHAT\'S ABOUT TO COME..."},"dialog_2":{"mary_say_1":"WHAT IS THAT TUMULT DOWN THERE?","dwarf_say_1":"IT\'S WHAT PREVENTS YOU TO ENTER THE ABSU CHAMBERS, IT\'S NAME IS ABUSHGIDIM, THE ROTTEN ROOTS OF IGNOBLE ACTS FROM THE UPPER WORLD, ENCRUSTED UNDER THE SURFACE.","dwarf_say_2":"BEAT IT AND YOU\'LL BE FREE TO WALK IN. AND REMEMBER, YOU ARE NOT ALONE ON THIS, I\'LL BRING YOU RESOURCES AS I FIND THEM.","dwarf_say_3":"STAY AWAY FROM THE GROWING ROOTS, HIT THEM TO DESTROY THEM AND AVOID THE FLYING CREATURES. GOOD LUCK AND MAY TIAMAT BLESS YOU."},"dialog_3":{"mary_say_1":"WE DID IT DOC!!!","dwarf_say_1":"YOU ARE UNSTOPPABLE MARY, YOUR CONSTANCY AND COURAGE ARE LEADING US THE RIGHT WAY.","dwarf_say_2":"WHAT FOLLOWS NEXT IS THIS ENTRANCE RIGHT BEFORE US. IT\'S THE GATE TO THE ABSU WORLD. IT\'S BEYOND ANY PLACE A DWARF HAVE EVER BEEN.","mary_say_2":"WE MUST TRAVEL THAT ROAD IF IT LEAD US TO MARDUK.","dwarf_say_3":"...A NEW WORLD FOR ME, BUT YOUR COMPANY GIVES ME HOPE... I\'M WITH YOU MARY"}}}')},33:function(e){e.exports=JSON.parse('{"menu":{"main":{"loading_message":"cargando... por favor espera","key_to_start":"PRESIONA UNA TECLA PARA COMENZAR","option_new":"Nuevo Juego","option_continue":"Continuar","option_restart_level":"Reiniciar nivel","option_back_to_menu":"SALIR AL MEN\xda","yes":"Si","no":"No","on":"Si","off":"No","of":"DE","english":"INGL\xc9S","spanish":"Espa\xf1ol","heading_scrore":"nivel        gemas     hostil    setas    comp","score_gems":"gemas","score_enemies":"hostil","score_shrooms":"setas","score_comp":"completo","score_best":"mejor","score_op_next":"siguiente","score_op_repeat":"repetir","score_op_exit":"salir","chamber":"RECINTO","ruins":"RUINAS","confirmNewGame":"\xbfREINICIAR EL JUEGO Y\\n\\nPERDER TU PROGRESO ACTUAL?","toBeContinue":"CREDITOS"},"dialog_options":{"close":"cerrar","story":"historia","next":"M\xc1S","yes":"si","no":"no"},"cookies":{"thirdparty":"No se puede guardar el progreso. Aseg\xfarate de habilitar cookies de terceros en esta p\xe1gina. Este juego usa IndexedDB para guardar tu progreso."}},"intro":{"story_page_1":{"line_1":"EN UN COMIENZO: NO HUBO NADA M\xc1S","line_2":"que la diosa Tiamat"},"story_page_2":{"line_1":"ella hizo el mundo a su antojo","line_2":"creando al pueblo sumerio","line_3":"a su imagen y semejanza"},"story_page_3":{"line_1":"La ancestral tierra de Sumeria,","line_2":"para\xedso eterno de seres inmortales","line_3":"viviendo en infinita armon\xeda"},"dialog_1":{"tiamat_say_1":"MIS AMADOS: \xbfPOR QU\xc9 ME HAN INVOCADO?","mary_say_1":"NUESTRA SE\xd1ORA. UN MISTERIOSO COMETA SURCA EL CIELO. MONSTRUOSOS TERREMOTOS DEVASTAN LA TIERRA, MISTERIOSOS HOYOS APARECEN, LOS QUE CAEN EN ELLOS JAM\xc1S REGRESAN. POR FAVOR MI SE\xd1ORA, CALMA LA TIERRA. DANOS PAZ.","tiamat_say_2":"EL COMETA CATALIZADOR. APARECE CADA 2,533 A\xd1OS. YO NO CONTROLO SU PASO. CON SU LLEGADA, TAMBI\xc9N LLEGAN CALAMIDADES","mary_say_2":"NOSOTROS, TUS HIJOS, TE SUPLICAMOS. GU\xcdANOS HACIA UNA SALIDA QUE PUEDA SALVAR A NUESTRA GENTE.","tiamat_say_3":"NADA PUEDEN HACER M\xc1S QUE ACEPTAR SU DESTINO.","marduk_say_1":"SI, ACEPTEMOS NUESTRO DESTINO.","mary_say_3":"PERO MI SE\xd1ORA, DEBE HABER ALGO QUE PODAMOS OFRECERLE PARA QUE USTED NOS LIBERE DEL MAL.","tiamat_say_4":"MMMM... PRESTEN MUCHA ATENCI\xd3N, S\xd3LO SER\xc1 DICHO UNA VEZ.","tiamat_say_5":"EL GUARDI\xc1N DEBE AVENTURARSE HACIA LOS AGUJEROS CREADOS EN LA TIERRA, DESCUBRIR EL PR\xd3SITO DE LOS HONGOS QUE AHORA PROLIFERAN LA SUPERFICIE. RECOLECTARLOS Y ENCONTRARME EN EL CENTRO DEL PLANETA.","tiamat_say_6":"QUIZ\xc1S EN ESTOS MISTERIOSOS OBJETOS YACE LA SOLUCI\xd3N AL TERROR DEL COMETA CATALIZADOR."},"dialog_2":{"marduk_say_1":"-UFF- ES LA OBLIGACI\xd3N DE UN HOMBRE SUPONGO.","mary_say_1":"ENTONCES TE HAR\xc9 COMPA\xd1\xcdA, M\xc1S ES MEJOR.","marduk_say_2":"TONTER\xcdAS. \xbfC\xd3MO PUEDE SER \xdaTIL UNA FR\xc1GIL SACERDOTISA COMO TU?","mary_say_2":"NO SOY FR\xc1GIL. DE HECHO, SOY MUY H\xc1BIL CAVANDO. CONSERVAR LA CAPILLA ME MANTIENE ACTIVA EN CUERPO Y MENTE.","marduk_say_3":"PERO YO SOY UN HOMBRE, PONER EN RIESGO LA VIDA DE UNA MUJER ACEPTANDO SU AYUDA, EN UNA TAREA TAN PELIGROSA, ME DESHONRAR\xcdA.","mary_say_3":"\xa1RECAPACITA!. D\xc9JAME AYUDARTE. HAY COSAS M\xc1S GRANDES EN JUEGO QUE TU ORGULLO.","marduk_say_4":"NO NECESITO TU AYUDA..."},"story_page_4":{"line_1":"UNA FISURA SE ABRE BAJO MARDUK","line_2":"Y \xc9L CAE DENTRO"},"story_page_5":{"line_1":"MARY VOLTEA SUS OJOS...","line_2":"Y SALTA TRAS SU HERMANO"}},"outro_ki":{"title":"PR\xd3XIMA ESCENA: ABSU","toBrContinue":"CONTINUAR\xc1...","discharge":"EVERLONG QUEST EST\xc1 EN DESARROLLO.","whatsNext":"OTRAS DOS ESCENAS COMPLETAR\xc1N EL JUEGO.","followUs":"POR M\xc1S INFO S\xcdGUENOS EN TWITTER:","ourName":"LONG STORY SHORT GAMES","msgLine1":"SI LO HAS DISFRUTADO, DEMU\xc9STRALO CON","msgLine2":"TUS COMENTARIOS. LO APRECIAREMOS MUCHO.","msgLine3":"PRESIONA ENTER PARA CONTINUAR","credits":"CR\xc9DITOS:","creditsLine1":"DISE\xd1O, DESARROLLO Y PRODUCCI\xd3N: @COSMITAR","creditsLine2":"HISTORIA Y REDACCI\xd3N CREATIVA: @QUEERJUNK","creditsLine3":"M\xdaSICA ORIGINAL Y SFX: @E-7BJOHN","creditsLine4":"ARTE ORIGINAL DE TIAMAT: @LESS","creditsLine5":"Y GRACIAS ESPECIALES A TI POR JUGAR"},"stage_1":{"title":"ESCENA 1: KI"},"levels":{"goal_dialog":{"dwarf_say_1":"RECUERDA, PRECISO ${GOAL} DIAMANTES Y TU TIENES ${NUM}"}},"level_1":{"dialog_1":{"mary_say_1":"\xa1VAYA! MISTERIOSO LUGAR. MARDUK NO PUEDE ESTAR MUY LEJOS. CAMINAR\xc9 UN POCO Y VER\xc9 SI LO ENCUENTRO."},"dialog_2":{"mary_say_1":"ESTAS DECORACIONES NO SON NATURALES. HAN SIDO UBICADAS AQU\xcd POR ALGUNA RAZ\xd3N."}},"level_2":{"dialog_1":{"mary_say_1":"MARDUUUUUK!!!! NO LO VEO. PERO SEGURO PUEDO EMPUJAR ESAS ROCAS Y SEGUIR BUSCANDO."},"dialog_2":{"mary_say_1":"QU\xc9 BELLA GEMA, ME LA QUEDAR\xc9."}},"level_3":{"dialog_1":{"mary_say_1":"ESOS ENGENDROS SE VEN PELIGROSOS, MEJOR SI NO LOS TOCO. LOS ESPANTAR\xc9 CON UNA PIEDRA."},"discarded_dialog_2":{"mary_say_1":"\xa1GUAU! ESO FUE PELIGROSO. TENDR\xc9 M\xc1S CUIDADO CON ESOS BARRILES."},"discarded_dialog_3":{"mary_say_1":"\xa1UPS! ESPERO NO HABER MOLESTADO A ALGUIEN CON ESO."},"dialog_4":{"mary_say_1":"\xa1Esta cosa es incre\xedble!, puedo cortar la tierra como una hogaza de pan."}},"level_4":{"dialog_1":{"mary_say_1":"\xa1GUAU! ESOS TERREMOTOS PUEDEN SER PELIGROSOS AQU\xcd ABAJO"}},"level_5":{"dialog_1":{"mary_say_1":"\xa1EY! \xbfQUI\xc9N ERES TU?.","dwarf_say_1":"ESE ES MI PICO, DEVU\xc9LVEMELO.","mary_say_2":"NO. LO ENCONTR\xc9 ALL\xc1 ATR\xc1S Y LO NECESITO","dwarf_say_2":"PERO ES MIO... MIRA, NI SIQUIERA DEBER\xcdA ESTAR HABLANDO CON LOS DE TU CLASE. MEJOR ME VOY.","mary_say_3":"\xa1ESPERA! VEN AQU\xcd UN MOMENTO."}},"level_6":{"dialog_1":{"mary_say_1":"\xa1TU DE NUEVO! MIRA, NO PUEDO DEVOLVERTE TU PICO.","dwarf_say_1":"HAY ASUNTOS M\xc1S SERIOS DE LOS QUE DEBO ADVERTIRTE... ELLOS SABEN QUE USTEDES EST\xc1N AQU\xcd ABAJO.","mary_say_2":"\xbfQUI\xc9NES LO SABEN?","dwarf_say_2":"ENVIARON \xc1NGELES A BLOQUEAR LAS ENTRADAS A LAS C\xc1MARAS DE KI. NO PRODR\xc1S AVANZAR.","mary_say_3":"DEBO ENCONTRAR LA FORMA, DIME C\xd3MO LOS EVITO.","dwarf_say_3":"SER\xc1 DIF\xcdCIL EN SOLEDAD, PERO YO PUEDO AYUDARTE A CAMBIO DE...","mary_say_4":"NO EL PICO. PUNTO FINAL.","dwarf_say_4":"...TE PRESTAR\xc9 EL PICO Y QUITAR\xc9 LOS \xc1NGELES DEL CAMINO SI ME RECOLECTAS SUFICIENTES JOYAS.","dwarf_say_5":"CONS\xcdGUEME 10 JOYAS EN ESTA C\xc1MARA Y DESPEJAR\xc9 LA SALIDA PARA TI.","mary_say_5":"\xa1HECHO!"},"dialog_2":{"mary_say_1":"EL \xc1NGEL BLOQUEANDO MI PASO."},"dialog_3":{"mary_say_1":"BIEN, TENGO TUS JOYAS. POR CIERTO, \xbfC\xd3MO TE LLAMAS?","dwarf_say_1":"ME LLAMAN SHMERIDOCK","mary_say_2":"TE LLAMAR\xc9 \'DOC\'... Y TU PUEDES DECIRME...","dwarf_say_2":"MARY, YA LO SE. AHORA, PERM\xcdTEME HONRAR MI PALABRA."},"dialog_4":{"dwarf_say_1":"REMEMBER, I NEED 10 DIAMONDS TO CLEAR THE WAY. YOU ONLY HAVE ${NUM}"}},"level_8":{"dialog_1":{"mary_say_1":"DOC, ME ALEGRA VERTE. ME PREGUNTO SI PODR\xcdAS GUIARME PARA ENCONTRAR A MARDUK. \xbfPUEDES?","dwarf_say_1":"CLARO QUE PUEDO, S\xd3LO NECESITO ALGO DE ENERG\xcdA EXTRA. ENTR\xc9GAME UN HONGO Y LIBERAR\xc9 MI POTENCIAL PARA AYUDARTE","mary_say_2":"NO LO SE DOC. ESTOS HONGOS SON PARA QUE MARDUK CUMPLA EL MANDATO DE TIAMAT. D\xc9JAME PENSARLO...","mary_say_3_yes":"BIEN, T\xd3MALO Y ESPERO QUE PUEDAS ENCONTRARLO","mary_say_3_no":"NO, LOS HONGOS NO SON PARA TI, SON PARA MARDUK, S\xd3LO DESCONOZCO C\xd3MO ENCONTRARLO"},"dialog_1_option":{"yes":"SI, ENTREGAR UNA SETA","no":"NO, CONSERVAR LAS SETAS"},"dialog_1_no_shrooms":{"mary_say_1":"DOC, ME ALEGRA VERTE. ME PREGUNTO SI PODR\xcdAS GUIARME PARA ENCONTRAR A MARDUK. PUEDES?","dwarf_say_1":"SI PUEDO, S\xd3LO NECESITO ALGO DE ENERG\xcdA EXTRA. SI TAN S\xd3LO TUVIERAS UN HONGO, PODR\xcdA LIBERAR MI POTENCIAL PARA AYUDARTE","mary_say_2":"CREO HABER VISTO ALGUNOS EN EL CAMINO, VOLVER\xc9 ALGUNASC C\xc1MARAS ATR\xc1S Y OBTENDR\xc9 UNO PARA TI","dwarf_say_2":"VUELVE A LA C\xc1MARA ${NUM}, DEBE HABER UN HONGO ALL\xcd"},"dialog_1_repeat":{"dwarf_say_1":"ENTOCES, \xbfHAS CAMBIADO DE IDEA?","mary_say_1":"MMM...","mary_say_2_yes":"BIEN, T\xd3MALO Y ESPERO QUE PUEDAS ENCONTRARLO","mary_say_2_no":"NO, LOS HONGOS NO SON PARA TI, SON PARA MARDUK, S\xd3LO DESCONOZCO C\xd3MO ENCONTRARLO"},"dialog_1_no_shrooms_repeat":{"dwarf_say_1":"ENTONCES, \xbfVAS A CONSEGUIR ESOS HONGOS?","mary_say_1":"CLARO, NECESITO ENCONTRAR A MARDUK","dwarf_say_2":"VUELVE A LA C\xc1MARA ${NUM}, DEBE HABER UN HONGO ALL\xcd"},"dialog_2":{"dwarf_say_1":"AQU\xcd EST\xc1S... HOLA MARDUK","marduk_say_1":"\xbf\xa1QUE DEMONIOS ES ESTO!? NO ME COMAS BESTIA ASQUEROSA","dwarf_say_2":"NO HAY NECESIDAD DE SER GROSERO PORQUE SEA DIFERENTE","marduk_say_2":"NO ME SERMONEES MONSTRUO Y REVELA TUS VERDADERAS INTENCIONES","dwarf_say_3":"HE VENIDO PARA AYUDAR A TU HERMANA A ENCONTRARTE, ELLA SE PREOCUPA POR TI","marduk_say_3":"ESTO NO PUEDE ESTAR PASANDO. \xbfC\xd3MO PUEDO CONFIAR EN TI? \xbfQU\xc9 ERES? \xbfDE DONDE VIENES?","dwarf_say_4":"TENGO MUCHOS NOMBRES. HE NACIDO DE LO PROFUNDO DE LA TIERRA, LLAMADO A LA VIDA POR EL FUEGO MISMO.","dwarf_say_5":"SI ERES UN POCO M\xc1S ABIERTO, PODR\xc9 AYUDAR A TU HERMANA Y TAMBI\xc9N A TI","marduk_say_4":"\xa1QU\xc9 CLASE DE PESADILLA ES ESTA! YO NO TRATO CON... LOS DE TU TIPO","dwarf_say_6":"PERO LO HAR\xc1S... CON EL TIEMPO... LAS COSAS CAMBIAN. LA GENTE CRECE. INCLUSO T\xda MARDUK. CREO QUE PODEMOS SER GRANDES AMIGOS. DE HECHO. ES LA PROFEC\xcdA","dwarf_say_7":"YA TENGO LO QUE VINE A BUSCAR, AHORA PUEDO AYUDAR A MARY A ENCONTRARTE. ADI\xd3S MARDUK..."},"dialog_3":{"mary_say_1":"\xbf\xa1ENTOCES!? \xbfLO HAS ENCONTRADO? \xbf\xc9L ESTA BIEN?","dwarf_say_1":"SI MARY, PERO NO ESPERABA UNA PERSONA TAN GROSERA Y DE POCO TEMPLE","mary_say_2":"-PFF- NECESITA APRENDER CU\xc1NDO CERRAR LA BOCA. HAS SIDO MUY AMABLE DOC, \xbfAHORA PUEDES DECIRME D\xd3NDE ENCONTRAR A MI HERMANO?","dwarf_say_2":"AS\xcd ES COMO DEBE SER MARY, SIGUE LA SALIDA CON FORMA DE CABEZA DE LE\xd3N, TE ESTAR\xc9 ESPERANDO EN LA PR\xd3XIMA C\xc1MARA. AHORA NECESITO DESCANSAR UN MOMENTO..."}},"level_10":{"dialog_1":{"mary_say_1":"\xbfQU\xc9 ES ESTE LUGAR, DOC?","dwarf_say_1":"ESTO SOL\xcdA SER UNA FORTALEZA, EL BASTI\xd3N DE UNA HERMOSA CIUDAD ENANA"},"dialog_2":{"mary_say_1":"\xbfSOL\xcdA SER? \xbfQU\xc9 SUCEDI\xd3?..."},"dialog_3":{"dwarf_say_1":"CONS\xcdGUEME ${NUM} DIAMANTES MARY, DE ESA FORMA DESPEJAR\xc9 EL CAMINO."}},"level_11":{"dialog_1":{"mary_say_1":"DOC \xbfTE ENCUENTRAS BIEN? TE VEO CONMOVIDO, \xbfACASO ESTO ES ESPECIAL PARA TI?","dwarf_say_1":"ESTA FUE MI VILLA ALGUNA VEZ. LOS ENANOS PROSPERAMOS AQU\xcd POR SIGLOS ANTES QUE LAS BATALLAS DE LA GUERRA DE LAS SETAS DESTRUYA NUESTROS HOGARES.","mary_say_2":"\xbfLA GUERRA DE LAS SETAS?","dwarf_say_2":"EL D\xcdA DEL GRAN SISMO: SETAS DEJARON DE CRECER BAJO LA SUPERFICIE. S\xd3LO NOS QUEDARON LAS RESERVAS DE A\xd1OS PREVIOS","dwarf_say_3":"CON SUMINISTROS LIMITADOS, S\xd3LO FUE CUESTI\xd3N DE TIEMPO ANTES QUE LA VIOLENCIA CONTAMIARA NUESTRA PAC\xcdFICA FORMA DE VIDA.","mary_say_3":"\xa1HO DOC!, DE VERDAD LO SIENTO.","dwarf_say_4":"NO ES TIEMPO DE LAMENTOS. SIGUE ADELANTE MARY PERO TEN CUIDADO, MUCHOS ARTEFACTOS PELIGROSOS A\xdaN YACEN ENTRE LAS RUINAS COMO RECUERDO DE UN TIEMPO TURBULENTO."},"dialog_2":{"mary_say_1":"\xa1VAYA! ESO FUE PELIGROSO. DEBO SER M\xc1S CUIDADOSA CON ESO BARRILES, ICLUSO PUEDEN DESTRUIR LOS ESCOMBROS."},"dialog_3":{"dwarf_say_1":"YO S\xd3LO ERA UN BEB\xc9 CUANDO ME ALEJARON PARA PROTEGERME DEL FUEGO Y EL HORROR. APENAS SI RECUERDO ESTOS LUGARES.","mary_say_1":"NO TE PREOCUPES DOC, TIAMAT ME GUIAR\xc1 Y PROTEJER\xc1 DE TODO MAL."},"dialog_4":{"dwarf_say_1":"CONS\xcdGUEME ${NUM} DIAMANTES MARY, DE ESA FORMA DESPEJAR\xc9 EL CAMINO."}},"maze_1":{"dialog_1":{"dwarf_say_1":"ESTE LUGAR EST\xc1 DESASTROSO, S\xd3LO RESTOS HAN QUEDADO EN PI\xc9, ES DURO SABER POR D\xd3NDE IR. ALGO DE ENERG\xcdA EXTRA PODR\xcdA AYUDAR. \xbfTIENES UNO DE ESOS HONGOS PARA M\xcd?","mary_say_1":"NO LO SE DOC \xbfES UNA BUENA IDEA CONTINUAR GASTANDO LOS HONGOS?","mary_say_2_yes":"AQU\xcd EST\xc1, TOMA UNO Y ESPERO PUEDAS ENCONTRAR EL CAMINO.","mary_say_2_no":"NO, LOS HONGOS NO SON PARA TI, SON PARA MARDUK, ME LAS ARREGLAR\xc9 PARA ENCONTRAR EL CAMINO POR MI CUENTA."},"dialog_1_option":{"yes":"SI, ENTREGAR UNA SETA","no":"NO, CONSERVAR LAS SETAS"},"dialog_2":{"mary_say_1":"\xa1\xa1\xa1DOC!!! DESPACIO POR FAVOR, APENAS SI PUEDO SEGUIRTE EL PASO.","dwarf_say_1":"MIS DISCULPAS, CREO QUE ME ENTUSIASM\xc9 UN POCO DE M\xc1S."}},"level_16":{"dialog_1":{"mary_say_1":"\xa1MARDUUUK!... \xa1MARDUUUK!... ESTAS ROCAS APILADAS NO SE MOVER\xc1N.","mary_say_2":"PUEDO VERLO RESPIRAR DESDE AQU\xcd. TAL VEZ EST\xc1 INCONCIENTE.","mary_say_3":"\xbfD\xd3NDE EST\xc1 DOC CUANDO LO NECESITO? DEBO MOVERME R\xc1PIDO, ENCONTRAR A DOC Y LLEGAR A ESE SANTUARIO PARA ASISTIR A MARDUK."},"dialog_2":{"mary_say_1":"\xa1DOC, ENCONTR\xc9 A MARDUK! EST\xc1 EN UN SANTUARIO NO LEJOS DE AQU\xcd.","dwarf_say_1":"POR SUPUESTO, UN SANTUARIO ES DONDE LO V\xcd. YA S\xc9 D\xd3NDE ES.","mary_say_2":"\xa1VAMOS!, TE SIGO.","dwarf_say_2_diamonds":"PERO ANTES DE PARTIR... NECESITO LIBRARME DEL \xc1NGEL, CONS\xcdGUEMME ${NUM} DIAMANTES PARA ESO."},"dialog_2_repeat":{"mary_say_1":"TOMA TUS DIAMANTES, AHORA \xa1VAMOS!, TE SIGO."},"dialog_2_repeat_no_diamonds":{"dwarf_say_1":"RECUERDA MARY, CONS\xcdGUEME ${NUM} DIAMANTES PARA PODER CONTINUAR."},"dialog_3":{"mary_say_1":"NO LO ENTIENDO DOC, \xc9L ESTABA JUSTO AQU\xcd... PERO YA NO EST\xc1, ME PREGUNTO A D\xd3NDE PUDE HABER IDO.","dwarf_say_1":"O A D\xd3NDE LO LLEVARON... DE CUALQUIER MANERA, HAY UNA SOLA DIRECCI\xd3N POSIBLE... HACIA ABAJO.","dwarf_say_2":"\xa1S\xcdGUEME MARY!"}},"level_17":{"dialog_1":{"mary_say_1":"DOC, NO PUEDO VER NADA HACIA ADELANTE. ESTE LUGAR ES L\xdaGUBRE","dwarf_say_1":"TENGO UN PRESENTE PARA TI, TEN LA ANTORCHA DE ASHELBROCK. ILUMINAR\xc1 TU DESTINO."},"dialog_2":{"mary_say_1":"\xbfVIENES DOC?","dwarf_say_1":"VOY EN SEGUIDA, D\xc9JAME APRECIAR ESTA MARAVILLOSA FLAMA..."}},"level_18":{"dialog_incident":{"mary_say_1":"\xa1OH MI DIOSA! ESE TERREMOTO FUE TAN POTENTE, ME HIZO SOLTAR LA ANTORCHA Y SE APAG\xd3."},"dialog_incident_recovery":{"mary_say_1":"\xa1ALABADA SEA TIAMAT! ALGO DE LUZ AL FIN. VERDADERAMENTE ODIO LA OSCURIDAD."}},"maze_2":{"dialog_1":{"mary_say_0":"OTRO LABERINTO DE ESCOMBROS...","dwarf_say_1":"ESTA ES LA \xdaLTIMA C\xc1MARA DE OSCURIDAD. LUEGO LA LUZ VOLVER\xc1 A ILUMINAR NUESTROS PASOS. ALGO DE ENERG\xcdA EXTRA PODR\xcdA AYUDAR. \xbfTIENES UNO DE ESOS HONGOS PARA M\xcd?","mary_say_1":"NO LO SE DOC \xbfES UNA BUENA IDEA CONTINUAR GASTANDO LOS HONGOS?","mary_say_2_yes":"AQU\xcd EST\xc1, TOMA UNO Y ESPERO PUEDAS ENCONTRAR EL CAMINO.","mary_say_2_no":"NO, LOS HONGOS NO SON PARA TI, SON PARA MARDUK, ME LAS ARREGLAR\xc9 PARA ENCONTRAR EL CAMINO POR MI CUENTA."},"dialog_1_option":{"yes":"SI, ENTREGAR UNA SETA","no":"NO, CONSERVAR LAS SETAS"},"dialog_2":{"mary_say_1":"\xa1\xa1\xa1DOC!!! DESPACIO POR FAVOR, APENAS SI PUEDO SEGUIRTE EL PASO.","dwarf_say_1":"MIS DISCULPAS, CREO QUE ME ENTUSIASM\xc9 UN POCO DE M\xc1S."}},"level_19":{"dialog_1":{"mary_say_1":"QUE HERMOSA OBRA DE ARTE... \xbfCUENTA UNA HISTORIA?","dwarf_say_1":"ES LA PROFEC\xcdA ESCRITA, HABLA DEL GUARDI\xc1N DE LAS SETAS Y SU AYUDANTE. SU ARRIBO A KI Y SU TRAVES\xcdA HACIA EL CENTRO DEL PLANETA.","mary_say_2":"\xbfC\xd3MO ES QUE SABES TANTO?","dwarf_say_2":"\xa1JA! NO SE TANTO, ES QUE COMIENZO A CREER EN LAS ESCRITURAS, ME HAN DICHO LA VERDAD.","mary_say_3":"Y \xbfQU\xc9 DICE ACERCA DEL AYUDANTE? PODR\xcdA PREDECIR MI FUTURO, EN CUYO CASO ME INTERESA SABER.","dwarf_say_3":"LO QUE DEBES SABER ES CUANDO DESCRIBE A LA GUARDIANA, CON EL FUEGO EN SU CABEZA Y LA BONDAD EN SU CORAZ\xd3N...","mary_say_4":"TONTER\xcdAS DOC, TODOS SABEMOS DESDE UN PRINCIPIO QUE MARDUK ES EL GUARDIAN Y YO LA AYUDANTE. ADEM\xc1S, \xbfCOMO PUEDEN SABER DE NOSOTROS SI NUNCA VINIMOS BAJO LA SUPERFICIE?","dwarf_say_4":"ERES VALIENTE PERO INGENUA. TODA MI VIDA ME HAN NARRADO ESTAS HISTORIAS COMO CUENTOS DE FANTAS\xcdA, AHORA ME HAN ANTICIPADO TODOS LOS SUCESOS DESDE QUE NOS CONOCIMOS. PERO A\xdaN M\xc1S IMPORTANTE, LO QUE EST\xc1 POR VENIR..."},"dialog_2":{"mary_say_1":"\xbfQU\xc9 ES ESE TUMULTO AH\xcd ABAJO?","dwarf_say_1":"ES LO QUE TE IMPIDE INGRESAR A ABSU, SU NOMBRE ES ABUSHGIDIM, LA RA\xcdZ PUTREFACTA DE LOS ACTOS IGNOBLES DEL MUNDO SUPERIOR, ENQUISTADO BAJO LA SUPERFICIE.","dwarf_say_2":"V\xc9NCELO Y SER\xc1S LIBRE DE SEGUIR TU CAMINO. Y RECUERDA, NO EST\xc1S SOLA EN ESTO, TE TRAER\xc9 RECURSOS MIENTRAS VAYA ENCONTRANDO.","dwarf_say_3":"AL\xc9JATE DE LAS RAICES EN CRECIMIENTO, GOLP\xc9ALAS PARA DESTRUIRLAS Y EVITA LAS CRIATURAS VOLADORAS. BUENA SUERTE Y QUE TIAMAT TE BENDIGA."},"dialog_3":{"mary_say_1":"LO LOGRAMOS DOC!!!","dwarf_say_1":"ERES IMPARABLE MARY, TU CONSTANCIA Y CORAJE NOS LLEVAN POR EL BUEN CAMINO.","dwarf_say_2":"LO QUE SIGUE ES ESTA ENTRADA FRENTE A NOSOTROS. ES LA PUERTA AL MUNDO DE ABSU. EST\xc1 M\xc1S ALL\xc1 DE CUALQUIER LUGAR AL QUE HAYA IDO UN ENANO.","mary_say_2":"DEBEMOS TRANSITARLO SI NOS LLEVA A MARDUK.","dwarf_say_3":"...UN NUEVO MUNDO PARA M\xcd, PERO EN TU COMPA\xd1\xcdA ENCUENTRO ESPERANZA... ESTOY CONTIGO MARY"}}}')},37:function(e){e.exports=JSON.parse('{"name":"lostcartridgejam3","version":"0.2.1","private":true,"homepage":"./","GHhomepage":"https://cosmitar.github.io/lostcartridgejam3Game","dependencies":{"@testing-library/jest-dom":"^5.11.4","@testing-library/react":"^11.1.0","@testing-library/user-event":"^12.1.10","dexie":"^3.2.2","easystarjs":"^0.4.4","generate-maze":"^1.1.0","gh-pages":"^3.2.3","i18n-js":"^3.9.2","lodash.memoize":"^4.1.2","lodash.template":"^4.5.0","phaser":"^3.55.2","phaser3-rex-plugins":"^1.1.72","react":"^17.0.2","react-dom":"^17.0.2","react-full-screen":"^1.1.1","react-scripts":"4.0.3","web-vitals":"^1.0.1"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","predeploy":"npm run build","deploy":"gh-pages -b master -r https://github.com/Cosmitar/lostcartridgejam3Game.git -d build"},"eslintConfig":{"extends":["react-app","react-app/jest"]},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},46:function(e,t,i){},56:function(e,t,i){"use strict";i.r(t);var a=i(13),s=i(9),n=i.n(s),o=i(30),r=i.n(o),l=(i(46),i(0)),c=i.n(l),h=i(7),u=i(8),d=i.n(u),p=i(14),y=i(12),m=i(10),f=Object(s.createContext)(),v=function(e){var t=e.game,i=e.scene,n=e.sceneProps,o=e.children,r=Object(s.useState)(),l=Object(a.a)(r,2),c=l[0],h=l[1];return Object(s.useEffect)((function(){h(!!t&&!!i)}),[t,i]),Object(m.jsx)(f.Provider,{value:{game:t,scene:i,sceneProps:n},children:c?o:null})},g=i(1),_=i(2),E=i(3),O=i(4),S=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a,s){var n;return Object(g.a)(this,i),(n=t.call(this,e)).onCreate=s,n.config=a,n}return Object(_.a)(i,[{key:"preload",value:function(){var e;(null===(e=this.config)||void 0===e?void 0:e.preload)&&this.config.preload.bind(this)()}},{key:"create",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(null===(e=this.config)||void 0===e?void 0:e.create)&&this.config.create.bind(this)(),this.onCreate(t)}}]),i}(d.a.Scene),T=Object(s.forwardRef)((function(e,t){var i=e.args,o=e.children,r=Object(s.useRef)(),l=t||r,c=Object(s.useState)(),h=Object(a.a)(c,2),u=h[0],f=h[1],g=Object(s.useState)(),_=Object(a.a)(g,2),E=_[0],O=_[1],T=Object(s.useState)({}),x=Object(a.a)(T,2),b=x[0],A=x[1];Object(s.useEffect)((function(){var e=n.a.Children.map(o,(function(e){return new S(e.props.name,e.props.args,(function(t){A(Object(y.a)({},e.props.name,t))}))}));i.scene=[].concat(Object(p.a)(i.scene||[]),Object(p.a)(e)),i.callbacks={postBoot:function(e){f(e),O(!0),e.scene.scenes.forEach((function(e){e.events.off(d.a.Scenes.Events.READY),e.events.once(d.a.Scenes.Events.READY,(function(){e.events.off(d.a.Scenes.Events.RENDER),e.events.once(d.a.Scenes.Events.RENDER,(function(){}))})),e.events.once(d.a.Scenes.Events.WAKE,(function(){})),e.events.once(d.a.Scenes.Events.UPDATE,(function(){})),e.events.once(d.a.Scenes.Events.TRANSITION_WAKE,(function(){})),e.events.once(d.a.Scenes.Events.TRANSITION_START,(function(){})),e.events.once(d.a.Scenes.Events.TRANSITION_OUT,(function(){})),e.events.once(d.a.Scenes.Events.TRANSITION_INIT,(function(){})),e.events.once(d.a.Scenes.Events.TRANSITION_COMPLETE,(function(){})),e.events.once(d.a.Scenes.Events.START,(function(){})),e.events.once(d.a.Scenes.Events.SLEEP,(function(){})),e.events.once(d.a.Scenes.Events.SHUTDOWN,(function(){})),e.events.once(d.a.Scenes.Events.RESUME,(function(){})),e.events.once(d.a.Scenes.Events.RENDER,(function(){})),e.events.once(d.a.Scenes.Events.READY,(function(){})),e.events.once(d.a.Scenes.Events.PRE_RENDER,(function(){})),e.events.once(d.a.Scenes.Events.PAUSE,(function(){})),e.events.on(d.a.Scenes.Events.CREATE,(function(){A((function(t){return Object(y.a)({},e.scene.key,t[e.scene.key])}))})),e.events.once(d.a.Scenes.Events.BOOT,(function(){}))}))}};var t=new d.a.Game(i);l.current=t}),[]);var k=n.a.Children.toArray(o).find((function(e){return e.props.name===Object.keys(b)[0]}));return E?Object(m.jsx)(v,{scene:u.scene.getScene(Object.keys(b)[0]),sceneProps:Object.values(b)[0],game:u,children:k}):null}));T.displayName="Canvas";var x,b,A=T,k=i(6),w=i(5),N=250,R=20,I=(window.devicePixelRatio,function(){return document.querySelector("canvas").width/20/R});I.toString=I;var D="CW",M="CCW",U="Enemy",C="Wall",L="Block",P="Womb",j="Torch",B="Player",H="Pillar",G="NPCharacter",F="Mushroom",W="Moveable",Y="Jewel",V="Interactive",K="Ground",X="GameObject",z="Fallable",Q="Explosion",J="Exit",q="Empty",Z="Destroyable",$="Deco",ee="Debris",te="Character",ie="Boulder",ae="Barrel",se="BaseObject",ne="00ff00",oe="000000",re="ffffff",le="00cc00",ce="999999",he="0000cc",ue="00ff00",de="009900",pe="000099",ye="0000ff",me="cc0000",fe="660000",ve="990000",ge="ff0000",_e={EMPTY:"000000",PLAYER:"ff00ff",GROUND:"663300",BOULDER:"999999",PILLAR:"545454",WALL:"0000ff",ENEMY:"ff0000",JEWEL:"ffff00",BARREL:"00ffff",EXPLOSION:"ffffff",INTERACTION:"00ff00",MUSHROOM:"9900ff",BRO:"22a5f6",DWARF:"f29900",EXIT:"00cc00",ART:"1d4ee1",ART2:"000099",HANGING_2:"d2fca8",HANGING_3:"7ea854",HANGING_4:"547e2a",HANGING_5:"2a5400",DEBRIS:"a82a2a",BLOCK:"dadaff",TORCH:"7e5400"},Ee={DOWN:"ArrowDown",UP:"ArrowUp",LEFT:"ArrowLeft",RIGHT:"ArrowRight"},Oe=(x={},Object(y.a)(x,ne,81),Object(y.a)(x,oe,0),Object(y.a)(x,re,71),Object(y.a)(x,le,82),Object(y.a)(x,ce,91),Object(y.a)(x,he,80),Object(y.a)(x,ue,72),Object(y.a)(x,de,92),Object(y.a)(x,pe,90),Object(y.a)(x,ye,70),Object(y.a)(x,me,85),Object(y.a)(x,fe,83),Object(y.a)(x,ve,84),Object(y.a)(x,ge,86),x),Se=(b={},Object(y.a)(b,_e.EMPTY,0),Object(y.a)(b,_e.WALL,3),Object(y.a)(b,_e.GROUND,2),Object(y.a)(b,_e.ART,0),Object(y.a)(b,_e.ART2,20),Object(y.a)(b,_e.EXIT+"_1",18),Object(y.a)(b,_e.EXIT+"_2",48),Object(y.a)(b,_e.EXIT+"_3",88),Object(y.a)(b,_e.DEBRIS,1),Object(y.a)(b,"WORLD_ART",60),Object(y.a)(b,"calculateGroundTileWithNeighbours",(function(e,t,i){var a=(i[e]||[])[t-1]===_e.GROUND?"W":"-",s=(i[e-1]||[])[t]===_e.GROUND?"N":"-",n=(i[e]||[])[t+1]===_e.GROUND?"E":"-",o=(i[e+1]||[])[t]===_e.GROUND?"S":"-";switch("".concat(s).concat(n).concat(o).concat(a)){case"----":default:return 2;case"NESW":return 51;case"N---":return 63;case"-E--":return 44;case"--S-":return 43;case"---W":return 46;case"NE--":return 60;case"-ES-":return 40;case"--SW":return 42;case"N--W":return 62;case"NES-":return 50;case"-ESW":return 41;case"N-SW":return 52;case"NE-W":return 61;case"N-S-":return 53;case"-E-W":return 45}})),Object(y.a)(b,"calculateWallTileWithNeighbours",(function(e,t,i){var a=(i[e]||[])[t-1]===_e.WALL||[_e.ART,_e.ART2].includes((i[e]||[])[t-1])||[_e.HANGING_2,_e.HANGING_3,_e.HANGING_4,_e.HANGING_5,_e.TORCH].includes((i[e]||[])[t-1])?"W":"-",s=(i[e-1]||[])[t]===_e.WALL||[_e.ART,_e.ART2].includes((i[e-1]||[])[t])||[_e.HANGING_2,_e.HANGING_3,_e.HANGING_4,_e.HANGING_5,_e.TORCH].includes((i[e-1]||[])[t])?"N":"-",n=(i[e]||[])[t+1]===_e.WALL||[_e.ART,_e.ART2].includes((i[e]||[])[t+1])||[_e.HANGING_2,_e.HANGING_3,_e.HANGING_4,_e.HANGING_5,_e.TORCH].includes((i[e]||[])[t+1])?"E":"-",o=(i[e+1]||[])[t]===_e.WALL||[_e.ART,_e.ART2].includes((i[e+1]||[])[t])||[_e.HANGING_2,_e.HANGING_3,_e.HANGING_4,_e.HANGING_5,_e.TORCH].includes((i[e+1]||[])[t])?"S":"-";switch("".concat(s).concat(n).concat(o).concat(a)){case"----":default:return 3;case"NESW":return 21;case"N---":return 33;case"-E--":return 14;case"--S-":return 13;case"---W":return 16;case"NE--":return 30;case"-ES-":return 10;case"--SW":return 12;case"N--W":return 32;case"NES-":return 20;case"-ESW":return 11;case"N-SW":return 22;case"NE-W":return 31;case"N-S-":return 23;case"-E-W":return 15}})),Object(y.a)(b,"calculateWallTileWithNeighboursDirtEarth",(function(e,t,i){var a=(i[e]||[])[t-1]===_e.WALL?"W":"-",s=(i[e-1]||[])[t]===_e.WALL?"N":"-",n=(i[e]||[])[t+1]===_e.WALL?"E":"-",o=(i[e+1]||[])[t]===_e.WALL?"S":"-";switch("".concat(s).concat(n).concat(o).concat(a)){case"----":default:return 2;case"NESW":return 51;case"N---":return 63;case"-E--":return 44;case"--S-":return 43;case"---W":return 46;case"NE--":return 60;case"-ES-":return 40;case"--SW":return 42;case"N--W":return 62;case"NES-":return 50;case"-ESW":return 41;case"N-SW":return 52;case"NE-W":return 61;case"N-S-":return 53;case"-E-W":return 45}})),b),Te=i(31),xe=i.n(Te),be=i(20),Ae=i.n(be),ke=i(32),we=i(33),Ne=function(e){switch(e){case"en":default:return ke;case"es":return we}},Re={en:function(){return Ne("en")},es:function(){return Ne("es")}},Ie=xe()((function(e,t){return Ae.a.t(e,t)}),(function(e,t){return t?e+JSON.stringify(t):e})),De=function(){var e=Object(h.a)(c.a.mark((function e(t){var i,a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"en",i=navigator.language.substring(0,2),Object.keys(Re).includes(i)||(i="en"),a=i,e.next=6,Re[a]();case 6:s=e.sent,Ae.a.translations=Object(y.a)({},a,s),Ae.a.locale=a,t(!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=function(){function e(){Object(g.a)(this,e),this.eventListeners=[],this.classes=[]}return Object(_.a)(e,[{key:"listClasses",value:function(){for(var e=this.__proto__,t=[];void 0!==e.constructor.className;)t.push(e.constructor.className),e=e.__proto__;return t}},{key:"isClass",value:function(e){0===this.classes.length&&(this.classes=this.listClasses());var t="string"===typeof e?e:e.className;return this.classes.includes(t)}},{key:"addEventListener",value:function(e,t){var i=this;return this.eventListeners.push([e,t]),function(){i.eventListeners=i.eventListeners.filter((function(e){return e[1]!==t}))}}},{key:"dispatchEvent",value:function(e,t){var i=this;this.eventListeners.filter((function(t){return t[0]===e})).forEach((function(e){return e(t,i)}))}}]),e}();Me.className=se;var Ue=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e){var a,s=e.id,n=e.isRigid,o=e.isBreakable,r=e.isFlat,l=e.isPickable,c=e.isCrushable,h=e.level;return Object(g.a)(this,i),(a=t.call(this)).id=s,a.isRigid=n,a.isBreakable=o,a.isFlat=r,a.isPickable=l,a.isCrushable=c,a.power=0,a.strength=0,a.force=0,a.weight=0,a.level=h,a.position=null,a.alien=null,a.isMoveable=!a.isRigid,a}return Object(_.a)(i,[{key:"setPosition",value:function(e){this.position=e}},{key:"canMove",value:function(){return this.isMoveable}},{key:"overrunBy",value:function(){}},{key:"runningOver",value:function(){}},{key:"canFallDown",value:function(){return!1}},{key:"canFallLeft",value:function(){return!1}},{key:"canFallRight",value:function(){return!1}},{key:"addedToScene",value:function(){}},{key:"hitBy",value:function(){}}]),i}(Me);Ue.className=X;var Ce=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!1,isFlat:!0,isPickable:!1,isCrushable:!0,level:a})).id=e,s.level=a,s.isEmpty=!0,s}return Object(_.a)(i,[{key:"setPosition",value:function(e){this.position=e}}]),i}(Ue);Ce.className=q;var Le=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!1,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).power=10,s.strength=10,s.extinguished=!1,s}return Object(_.a)(i,[{key:"setPosition",value:function(e){var t=this;Object(k.a)(Object(w.a)(i.prototype),"setPosition",this).call(this,e);var a=e.x,s=e.y,n=this.level.scene.children.getByName("layer_1");if(!n)return!1;var o=n.tilemap,r=this.level.scene.add.sprite(48,16).setOrigin(.125,.125).play("explosion_explode");r.setScale(n.scaleX),r.x=o.tileToWorldX(a),r.y=o.tileToWorldY(s),r.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){r.destroy(),t.extinguished=!0,(t.level.objects[s][a].isClass(q)||t.level.objects[s][a].isClass(Q))&&(t.level.objects[s][a]=new Ce(_e.EMPTY,t.level))})),this.alien=r,this.level.replaceByEmpty(this),this.level.onNextTick((function(e){}))}}]),i}(Ue);Le.className=Q;var Pe=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e){var a;return Object(g.a)(this,i),(a=t.call(this,e)).inactive=!1,a}return Object(_.a)(i,[{key:"overrunBy",value:function(e){e.power>this.strength&&(this.inactive=!0,this.level.onDestroyElement(this))}}]),i}(Ue);Pe.className=Z;var je=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.apply(this,arguments)}return Object(_.a)(i,[{key:"move",value:function(e){var t=e.x,a=e.y;Object(k.a)(Object(w.a)(i.prototype),"setPosition",this).call(this,{x:t,y:a})}}]),i}(Pe);je.className=W;var Be=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e){var a;return Object(g.a)(this,i),(a=t.call(this,e)).isFalling=0,a.freeze=!1,a}return Object(_.a)(i,[{key:"canFallDown",value:function(){var e={x:this.position.x,y:this.position.y+1},t=this.level.isDestinationInBounds(e.x,e.y)&&this.level.getObjectAt(e.x,e.y),i=this.level.isDestinationEmpty(e.x,e.y)||(null===t||void 0===t?void 0:t.isClass(Q)),a=t.isCrushable&&this.isFalling;return i||a}},{key:"canRollTo",value:function(e,t){var i={x:e,y:t},a=this.level.isDestinationInBounds(i.x,i.y),s=a&&this.level.getObjectAt(i.x,this.position.y),n=a&&this.level.objectIsEmpty(s),o=a&&this.level.getObjectAt(i.x,i.y),r=this.level.objectIsEmpty(o),l=a&&this.level.getObjectAt(this.position.x,this.position.y+1),c=!this.level.isDestinationEmpty(this.position.x,this.position.y+1)&&l.isFlat;return a&&r&&n&&!c&&l&&!l.isFalling}},{key:"canFallRight",value:function(){return!this.canFallDown()&&this.canRollTo(this.position.x+1,this.position.y+1)}},{key:"canFallLeft",value:function(){return!this.canFallDown()&&this.canRollTo(this.position.x-1,this.position.y+1)}}]),i}(je);Be.className=z;var He=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!1,isPickable:!1,isCrushable:!1,level:a})).strength=5,s}return Object(_.a)(i,[{key:"runningOver",value:function(e){e.classes.includes("Barrel")&&(this.inactive=!0)}},{key:"overrunBy",value:function(e){e&&!(null===e||void 0===e?void 0:e.isClass(Le))||(this.alien.visible=!1,this.alien.destroy(),this.inactive=!0)}}]),i}(Be);He.className=ie;var Ge=i(16),Fe=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!0,isPickable:!1,isCrushable:!0,level:a})).pushingDirection=null,s}return Object(_.a)(i,[{key:"animRun",value:function(){}},{key:"canMove",value:function(e,t){var i=this.level.getObjectAt(e,t),a=this.level.objectIsEmpty(i),s=(null===i||void 0===i?void 0:i.isBreakable)&&this.power>=i.strength&&!i.isClass(te),n=i.isClass&&i.isClass(te)&&"dwarf"!==i.name;return this.isBrakingGround=s&&i.isClass(K),!!(a||n||s||i.isPickable)&&i}},{key:"canMoveDir",value:function(e){switch(e){case Ee.UP:return this.canMoveUp();case Ee.DOWN:return this.canMoveDown();case Ee.LEFT:return this.canMoveLeft();case Ee.RIGHT:return this.canMoveRight();default:return!1}}},{key:"canMoveUp",value:function(){return this.canMove(this.position.x,this.position.y-1)}},{key:"canMoveDown",value:function(){return this.canMove(this.position.x,this.position.y+1)}},{key:"animPushRight",value:function(){}},{key:"animPushLeft",value:function(){}},{key:"canMoveLeft",value:function(){return this.canMove(this.position.x-1,this.position.y)}},{key:"canPushLeft",value:function(){var e=this.level.getObjectAt(this.position.x-1,this.position.y),t=this.level.isPositionClear(this.position.x-2,this.position.y),i=this.level.isPositionClear(this.position.x-1,this.position.y+1);return(null===e||void 0===e?void 0:e.isMoveable)&&t&&!i}},{key:"pushLeft",value:function(){var e=this.level.getObjectAt(this.position.x-1,this.position.y),t=this.canMoveLeft(),i=this.canPushLeft(),a=!1;return!t&&i&&(this.pushingDirection===Ee.LEFT?(this.animPushLeft(),a=!0,this.level.moveObject(e,{x:this.position.x-2,y:this.position.y}),this.level.jumpIntoParallelGravity(e),this.pushingDirection=null):(this.pushingDirection=Ee.LEFT,this.animPushLeft())),a}},{key:"canMoveRight",value:function(){return this.canMove(this.position.x+1,this.position.y)}},{key:"canPushRight",value:function(){var e=this.level.getObjectAt(this.position.x+1,this.position.y),t=this.level.isPositionClear(this.position.x+2,this.position.y),i=this.level.isPositionClear(this.position.x+1,this.position.y+1);return(null===e||void 0===e?void 0:e.isMoveable)&&t&&!i}},{key:"pushRight",value:function(){var e=this.level.getObjectAt(this.position.x+1,this.position.y),t=this.canMoveRight(),i=this.canPushRight(),a=!1;return!t&&i&&(this.pushingDirection===Ee.RIGHT?(this.animPushRight(),this.level.moveObject(e,{x:this.position.x+2,y:this.position.y}),this.level.jumpIntoParallelGravity(e),this.pushingDirection=null,a=!0):(this.pushingDirection=Ee.RIGHT,this.animPushRight())),a}},{key:"testProximity",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=this.position.y-t,s=this.position.y+t,n=this.position.x-t,o=this.position.x+t,r=!1,l=e.x>=n&&e.x<=o&&e.y>=a&&e.y<=s,c=e.x===this.position.x||e.y===this.position.y;return l&&(!i||i&&c)&&(r=!0),r}}]),i}(je);Fe.className=te;var We=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!0,isBreakable:!0,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).strength=9,s}return Object(_.a)(i,[{key:"overrunBy",value:function(e){var t=this;e&&e.isClass(Le)?this.level.scene.children.getByName("layer_1").tilemap.putTileAt(-1,this.position.x,this.position.y,!1,"layer_1"):(this.level.scene.children.getByName("layer_1").tilemap.putTileAt(-1,this.position.x,this.position.y,!1,"layer_1"),this.break_effect=this.level.scene.add.sprite(48,16).setOrigin(0,.25),this.break_effect.setScale(I),this.break_effect.depth=4,this.break_effect.x=li.tileToScreen(this.position.x),this.break_effect.y=li.tileToScreen(this.position.y),this.break_effect.play("ground_disolves"),this.break_effect.setFlipY(!0),this.break_effect.on(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){t.break_effect.destroy()})))}}]),i}(Ue);We.className=ee;var Ye=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).strength=5,s}return Object(_.a)(i,[{key:"runningOver",value:function(e){e.classes.includes("Barrel")&&(this.inactive=!0)}},{key:"overrunBy",value:function(e){e.constructor.className===Le.className&&(this.alien.visible=!1,this.alien.destroy())}}]),i}(Be);Ye.className=H;var Ve=new(i(34).a)("EverlongQuest"),Ke={bootUp:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ve.version(1).stores({items:"id,value"});case 3:return JSON.stringify({countDiamonds:0,collectedDiamonds:0,countEnemies:0,killedEnemies:0,countShrooms:0,collectedShrooms:0,comp:1,prevBest:0}),e.next=6,Ve.items.bulkPut([{id:"totalShroomsAmount",value:JSON.stringify(0)},{id:"tripDone",value:JSON.stringify(!1)}]);case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),alert(Ie("menu.cookies.thirdparty")),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),get:function(){var e=Object(h.a)(c.a.mark((function e(t){var i,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve.items.where({id:t});case 2:return i=e.sent,e.next=5,i.count();case 5:if(e.t0=e.sent,!(e.t0>0)){e.next=12;break}return e.next=9,i.first();case 9:e.t1=e.sent,e.next=13;break;case 12:e.t1=null;case 13:return a=e.t1,e.abrupt("return",null!==a?JSON.parse(a.value):null);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),set:function(){var e=Object(h.a)(c.a.mark((function e(t,i){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ve.items.where({id:t}).toArray();case 2:if(!(e.sent.length>0)){e.next=8;break}return e.next=6,Ve.items.where({id:t}).modify({value:JSON.stringify(i)});case 6:e.next=10;break;case 8:return e.next=10,Ve.items.put({id:t,value:JSON.stringify(i)});case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)})));return function(t,i){return e.apply(this,arguments)}}(),reset:function(){Ve.items.clear()},getLevels:function(){var e=Ve.items.where("id").startWith("level_").toArray();return console.log(e),e.map((function(e){return JSON.parse(e)}))}},Xe=function(){function e(t){Object(g.a)(this,e),this.config=t,this.moveables=[],this.parallelMovables=[],this.objects=[],this.interactiveElements={},this.decorationElements={},this.scene=null,this.player=null,this.playerTimeoutId=0,this.timeoutIds=[],this.focusObject=null,this.isPaused=!1,this.queuedActions=[],this.countDiamonds=0,this.collectedDiamonds=0,this.countEnemies=0,this.killedEnemies=0,this.countShrooms=0,this.collectedShrooms=0,this.totalShroomsAmount=0,this.prevBest=0,this.preventDisplayDiamondsGoalAmount=!1,this.unfinished=!0,this.tickId=0}return Object(_.a)(e,[{key:"onNextTick",value:function(e){this.queuedActions.push(e)}},{key:"runScheduledActions",value:function(){var e=this,t=this.queuedActions;this.queuedActions=[],t.forEach((function(t){return t(e)}))}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var i,a,s,n,o,r,l,u,p=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene=t,i=this.scene.children.getByName("layer_1"),a=i.tilemap,this.objects.length&&(this.objects=[]),this.break_effect=this.scene.add.sprite(48,16).setOrigin(0,.25),this.break_effect.setScale(i.scaleX),this.break_effect.depth=4,this.pick_effect=this.scene.add.sprite(48,16).setOrigin(0,.25),this.pick_effect.setScale(i.scaleX),this.pick_effect.depth=4,this.enemy_die_effect=this.scene.add.sprite(48,16).setOrigin(0,.25),this.enemy_die_effect.setScale(i.scaleX),this.enemy_die_effect.depth=4,e.next=15,Ke.get(this.constructor.key);case 15:return s=e.sent,n=s&&0!==s.collectedShrooms,o=(null===s||void 0===s?void 0:s.collectedShrooms)||0,r=0,this.objects=this.config.map((function(e,t){return e.map((function(e,s){var l;switch(e){case _e.WALL:(l=new $e(e,p)).setPosition({x:s,y:t});break;case _e.BLOCK:(l=new _i(e,p)).setPosition({x:s,y:t});break;case _e.TORCH:(l=new vi(e,p)).setPosition({x:s,y:t}),l.order=Object.values(p.decorationElements).filter((function(e){return e.isClass(vi)})).length,p.decorationElements["".concat(l.position.x,"-").concat(l.position.y)]=l;break;case _e.DEBRIS:(l=new We(e,p)).setPosition({x:s,y:t});break;case _e.GROUND:(l=new Je(e,p)).setPosition({x:s,y:t});break;case _e.BOULDER:l=p.createBoulderAt({x:s,y:t});break;case _e.PILLAR:var c=p.scene.add.sprite(48,16).setOrigin(.05,.2).play("pillar_idle");c.setScale(i.scaleX),c.x=a.tileToWorldX(s),c.y=a.tileToWorldY(t),(l=new Ye(e,p)).alien=c;break;case _e.JEWEL:var h=p.scene.add.sprite(48,16).setOrigin(.05,.2).play("diamond_idle");h.setScale(i.scaleX),h.x=a.tileToWorldX(s),h.y=a.tileToWorldY(t),p.countDiamonds++,(l=new ui(e,p)).order=p.countDiamonds,l.alien=h,l.move({x:s,y:t});break;case _e.MUSHROOM:if(n)p.collectedShrooms=o,l=new Ce(e,p);else{var u=p.scene.add.sprite(48,16).setOrigin(0,0).play("mushroom_idle");u.setScale(i.scaleX),u.x=a.tileToWorldX(s),u.y=a.tileToWorldY(t),(l=new fi(e,p)).alien=u}p.countShrooms++;break;case _e.BARREL:l=p.createBarrelAt({x:s,y:t});break;case _e.PLAYER:var y=p.scene.add.sprite(48,16).setOrigin(0,.25);y.setScale(i.scaleX),y.x=a.tileToWorldX(s),y.y=a.tileToWorldY(t)+5,y.name="brave",y.on(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){y.isMoving||y.inactive||y.play("brave_idle")})),(l=new di(e,p)).alien=y,l.animIdle(),p.player=l;break;case _e.BRO:var m=p.scene.add.sprite(48,16).setOrigin(0,.25);m.setScale(i.scaleX),m.x=a.tileToWorldX(s),m.y=a.tileToWorldY(t)+5,m.name="bro",m.on(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){!m.isMoving&&m.isFollowing&&m.play("bro_idle")})),(l=new hi(e,p,"bro")).alien=m,l.isFollowing=!0,l.animIdle(),p.follower=l;break;case _e.DWARF:var f=p.scene.add.sprite(48,16).setOrigin(0,.25);f.setScale(i.scaleX),f.x=a.tileToWorldX(s),f.y=a.tileToWorldY(t),f.name="dwarf",f.on(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){f.isMoving||f.play("dwarf_idle")})),(l=new hi(e,p,"dwarf")).alien=f,l.isLeading=!0,l.animIdle(),p.leader=l;break;case _e.ENEMY:l=p.createEnemyAt({x:s,y:t}),p.countEnemies++;break;case _e.EXIT:case _e.INTERACTION:var v=e===_e.EXIT?new yi(e,p):new pi(e,p);v.order=r++,p.interactiveElements["".concat(s,"-").concat(t)]=v,v.setPosition({x:s,y:t}),p.onAddElement(v),l=new Ce(e,p),v.isClass(yi)&&(p.exit=v);break;default:l=new Ce(e,p)}return l.setPosition({x:s,y:t}),p.objectIsEmpty(l)||l.isRigid||p.moveables.push(l),p.onAddElement(l),l.isClass(Ce)||l.addedToScene(),l}))})),this.focusObject=this.player.alien,this.unfinished=!s||s&&0===s.comp,console.log(this.unfinished),this.diamondsGoal>0&&(this.unfinished&&((l=this.scene.add.sprite(48,16).setOrigin(0,.25).play("exit_block")).setScale(i.scaleX),l.x=a.tileToWorldX(this.exit.position.x-2),l.y=a.tileToWorldY(this.exit.position.y),(u=new $e(_e.WALL,this)).setPosition({x:this.exit.position.x-2,y:this.exit.position.y}),u.alien=l,this.objects[this.exit.position.y][this.exit.position.x-2]=u,this.exit.block=u),this.preventDisplayDiamondsGoalAmount||setTimeout((function(){p.scene.events.emit("score:diamond_goal_set",p.diamondsGoal)}),1500)),this.onNextTick(Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.get(p.constructor.key);case 2:if(e.sent){e.next=5;break}return e.next=5,Ke.set(p.constructor.key,{countDiamonds:p.countDiamonds,collectedDiamonds:p.collectedDiamonds,countEnemies:p.countEnemies,killedEnemies:p.killedEnemies,countShrooms:p.countShrooms,collectedShrooms:p.collectedShrooms,comp:0,prevBest:p.prevBest});case 5:case"end":return e.stop()}}),e)})))),e.next=27,Ke.get("totalShroomsAmount");case 27:if(e.t0=e.sent,e.t0){e.next=30;break}e.t0=0;case 30:this.totalShroomsAmount=e.t0;case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"jumpIntoParallelGravity",value:function(e){var t=this.moveables.findIndex((function(t){return t===e}));this.moveables.splice(t,1),e.inParallelGravity=!0,this.parallelMovables.push(e)}},{key:"goBackToMainGravity",value:function(e){if(e.inactive)return!1;var t=this.parallelMovables.findIndex((function(t){return t===e}));if(-1===t)return!1;this.parallelMovables.splice(t,1),e.inParallelGravity=!1,this.moveables.push(e)}},{key:"explodeLoop",value:function(e){var t=this;e.forEach((function(e){var i=e.canFallDown(),a=t.objects[e.position.y+1][e.position.x];!i&&e.isFalling&&!a.isClass(Q)&&e.explode()}))}},{key:"gravityLoop",value:function(e){var t=this,i=e||this.moveables;this.isPaused||(e||this.runScheduledActions(),this.explodeLoop(i.filter((function(e){return e.isClass(ae)}))),i.sort((function(e,t){return e.position.y-t.position.y})).filter((function(e){return!e.freeze&&!e.exploded})).forEach((function(e){if(e.freeze)return!1;var i,a=e.canFallDown(),s=e.canFallLeft(),n=e.canFallRight();if(a&&(i={x:e.position.x,y:e.position.y+1}),!a&&s&&(i={x:e.position.x-1,y:e.position.y},e.isFalling&&i.y++),a||s||!n||(i={x:e.position.x+1,y:e.position.y},e.isFalling&&i.y++),i)t.moveObject(e,i),e.isFalling&&(s||n)&&e.isClass(ui)&&t.scene.events.emit("sounds:gem_hit"),e.isFalling&&(s||n)&&(e.isClass(He)||e.isClass(Ye))&&t.scene.events.emit("sounds:rock_hit_hard"),e.isFalling++;else{var o=t.getObjectAt(e.position.x,e.position.y+1);e.isFalling&&o&&o.hitBy(e),e.isFalling&&(e.isClass(He)||e.isClass(Ye))&&(o&&o.isClass(Je)?t.scene.events.emit("sounds:rock_hit_soft"):t.scene.events.emit("sounds:rock_hit_hard")),e.isFalling&&e.isClass(ui)&&t.scene.events.emit("sounds:gem_hit"),e.isFalling=0}!e.isFalling&&e.inParallelGravity&&t.goBackToMainGravity(e)})),e||this.enemiesLoop())}},{key:"enemiesLoop",value:function(){var e=this;if(!this.isPaused){var t,i,a,s,n,o,r,l=function(t,n,o,r,l){if(i=e.getObjectAt(n.x,n.y),(a=e.objectIsEmpty(i)||i&&i.isClass(di))&&i&&i.isClass(di)&&e.moveObject(t,n),a){if(!t.anchorPosition)return void(t.moveIntentDir=o);(t.position.x===t.anchorPosition.x||t.position.y===t.anchorPosition.y)&&(s=e.getObjectAt(l.x,l.y),e.objectIsEmpty(s)||s.isFalling||s.isClass(di)?t.moveIntentDir=r:t.anchorPosition=s.position),e.moveObject(t,n)}else t.anchorPosition=i.isFalling?null:i.position,t.moveIntentDir=o};this.moveables.filter((function(e){return e.isClass(ci)})).forEach((function(e){switch(e.moveIntentDir){case Ee.UP:t={x:e.position.x,y:e.position.y-1},n="CW"===e.scanDirection?Ee.RIGHT:Ee.LEFT,o="CW"===e.scanDirection?Ee.LEFT:Ee.RIGHT,r="CW"===e.scanDirection?{x:t.x-1,y:t.y}:{x:t.x+1,y:t.y},l(e,t,n,o,r);break;case Ee.RIGHT:t={x:e.position.x+1,y:e.position.y},n="CW"===e.scanDirection?Ee.DOWN:Ee.UP,o="CW"===e.scanDirection?Ee.UP:Ee.DOWN,r="CW"===e.scanDirection?{x:t.x,y:t.y-1}:{x:t.x,y:t.y+1},l(e,t,n,o,r);break;case Ee.DOWN:t={x:e.position.x,y:e.position.y+1},n="CW"===e.scanDirection?Ee.LEFT:Ee.RIGHT,o="CW"===e.scanDirection?Ee.RIGHT:Ee.LEFT,r="CW"===e.scanDirection?{x:t.x+1,y:t.y}:{x:t.x-1,y:t.y},l(e,t,n,o,r);break;case Ee.LEFT:t={x:e.position.x-1,y:e.position.y},n="CW"===e.scanDirection?Ee.UP:Ee.DOWN,o="CW"===e.scanDirection?Ee.DOWN:Ee.UP,r="CW"===e.scanDirection?{x:t.x,y:t.y+1}:{x:t.x,y:t.y-1},l(e,t,n,o,r)}e.loop()}))}}},{key:"playerLoop",value:function(){var e=this;if(!this.isPaused&&!this.player.inactive){clearTimeout(this.playerTimeoutId);var t=this.player,i=this.follower,a=this.leader,s={x:t.position.x,y:t.position.y};switch(t.moveIntentDir){case Ee.UP:t.canMoveUp()&&(s.y-=1);break;case Ee.DOWN:t.canMoveDown()&&(s.y+=1);break;case Ee.LEFT:(t.canMoveLeft()||t.canPushLeft()&&t.pushLeft())&&(s.x-=1);break;case Ee.RIGHT:(t.canMoveRight()||t.canPushRight()&&t.pushRight())&&(s.x+=1)}if((t.position.x!==s.x||t.position.y!==s.y)&&!t.isMoving){t.isMoving=!0,t.position.x<s.x&&t.animRunRight(),t.position.x>s.x&&t.animRunLeft(),this.scene.events.emit("player_moves",s);var n=t.position;this.moveObject(t,s),i&&i.isFollowing&&(i.moveIntentDir=i.position.y<n.y?Ee.DOWN:i.moveIntentDir,i.moveIntentDir=i.position.y>n.y?Ee.UP:i.moveIntentDir,i.position.x<n.x&&(i.moveIntentDir=Ee.RIGHT,i.animRunRight()),i.position.x>n.x&&(i.moveIntentDir=Ee.LEFT,i.animRunLeft()),this.moveObject(i,n),i.position.y<t.position.y?(i.alien.depth=0,t.alien.depth=2):(t.alien.depth=0,i.alien.depth=2))}this.playerTimeoutId=setTimeout((function(){if(!t.alien)return!1;t.isMoving=!1,t.animIdle();var s=e.interactiveElements["".concat(t.position.x,"-").concat(t.position.y)];s&&s.overrunBy(t),i&&t.alien.anims.currentAnim.key.includes("idle")&&i.isFollowing,(a||!(null===a||void 0===a?void 0:a.isCloseEnough(t.position))||(null===a||void 0===a?void 0:a.isCloseEnough(t.position))&&t.alien.anims.currentAnim.key.includes("idle")&&a.isLeading)&&(null===a||void 0===a||a.animIdle()),""!==t.moveIntentDir&&t.alien&&e.playerLoop()}),225)}}},{key:"moveObject",value:function(e,t){var i=this,a=this.scene.children.getByName("layer_1");if(!a)return!1;var s=a.tilemap,n={x:e.position.x,y:e.position.y},o=this.getObjectAt(t.x,t.y),r=[di.className,hi.className].includes(e.constructor.className)&&[di.className,hi.className].includes(o.constructor.className);if(this.objectIsEmpty(o)&&!o.isClass(pi)&&!o.isClass(yi)||r||(o.overrunBy(e),e.runningOver(o)),!e.inactive){var l;if(r||this.setObjectAt(n.x,n.y,new Ce(_e.EMPTY,this)),this.setObjectAt(t.x,t.y,e),e.move(t),e.isClass(Fe)&&e.alien&&(this.scene.tweens.add({targets:e.alien,x:{value:s.tileToWorldX(t.x),duration:e.isClass(ci)?N:225},y:{value:s.tileToWorldY(t.y)+(e.isClass(di)?5:0),duration:e.isClass(ci)?N:225}}),e.animRun()),e.isClass(hi)&&"dwarf"===e.name)if(this.leader.position.x===this.exit.position.x&&this.leader.position.y===this.exit.position.y)null===(l=this.leader.alien)||void 0===l||l.destroy(),this.leader.alien=null,this.replaceByEmpty(this.leader);if(e.isClass(Be)){if(this.scene.tweens.add({targets:e.alien,x:{value:s.tileToWorldX(t.x),duration:t.y!==n.y?125:N},y:{value:s.tileToWorldY(t.y),delay:t.x!==n.x?125:0,duration:t.x!==n.x?125:N},onComplete:function(){e.inParallelGravity&&i.gravityLoop([e])}}),t.x!==n.x&&e.isClass(He)&&(e.alien.play(t.x>n.x?"boulder_roll_right":"boulder_roll_left"),null!==this.player.pushingDirection)){var c=this.getObjectAt(n.x,n.y+1);this.scene.events.emit("sounds:rock_slide_".concat(c.isClass(Je)?"soft":"hard"))}e.isClass(mi)&&((t.x!==n.x&&this.isDestinationEmpty(t.x,n.y+1)||t.x!==n.x&&t.y!==n.y)&&setTimeout((function(){var i;return null===(i=e.alien)||void 0===i?void 0:i.play(t.x>n.x?"barrel_roll_right":"barrel_roll_left")}),125),t.x!==n.x&&this.scene.events.emit("sounds:rock_slide_soft")),e.isClass(Ye)&&((t.x!==n.x&&this.isDestinationEmpty(t.x,n.y+1)||t.x!==n.x&&t.y!==n.y)&&setTimeout((function(){var i;return null===(i=e.alien)||void 0===i?void 0:i.play(t.x>n.x?"pillar_roll_right":"pillar_roll_left")}),125),t.x!==n.x&&this.scene.events.emit("sounds:rock_slide_hard")),t.x!==n.x&&e.isClass(ui)&&(e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){e.alien.play("diamond_idle"),e.shine.play("diamond_shine")})),e.shine.stop(),e.alien.play(t.x>n.x?"diamond_roll_right":"diamond_roll_left"))}}}},{key:"pause",value:function(){this.isPaused=!0,this.player.moveIntentDir="",this.player.animIdle()}},{key:"resume",value:function(){this.isPaused=!1,this.gravityLoop(this.parallelMovables)}},{key:"destroy",value:function(){this.queuedActions=[]}},{key:"onCharacterDie",value:function(e){this.setObjectAt(e.position.x,e.position.y,new Ce(_e.EMPTY,this)),this.moveables=this.moveables.filter((function(t){return t!==e})),e.isClass(di)&&(e.moveIntentDir="",this.scene.levels.restart())}},{key:"onJewelPick",value:function(e){this.setObjectAt(e.position.x,e.position.y,new Ce(_e.EMPTY,this)),this.moveables=this.moveables.filter((function(t){return t!==e})),this.collectedDiamonds++,this.scene.events.emit("score:diamond_set",this.collectedDiamonds),this.diamondsGoal>0&&this.diamondsGoal<=this.collectedDiamonds&&(this.destroyBlock(),this.scene.events.emit("score:diamond_goal"),this.scene.events.emit("sounds:coin"))}},{key:"destroyBlock",value:function(){var e=Object.values(this.interactiveElements).find((function(e){return null===e||void 0===e?void 0:e.isClass(yi)}));(null===e||void 0===e?void 0:e.block)&&(this.onDestroyElement(e.block),e.block.alien.destroy())}},{key:"onMushroomPick",value:function(e){this.setObjectAt(e.position.x,e.position.y,new Ce(_e.EMPTY,this)),this.moveables=this.moveables.filter((function(t){return t!==e})),this.collectedShrooms=1}},{key:"onEnemyKill",value:function(e){this.killedEnemies++}},{key:"onDestroyElement",value:function(e){this.setObjectAt(e.position.x,e.position.y,new Ce(_e.EMPTY,this)),this.moveables=this.moveables.filter((function(t){return t!==e})),this.parallelMovables=this.parallelMovables.filter((function(t){return t!==e}))}},{key:"replaceByEmpty",value:function(e){var t=new Ce(_e.EMPTY,this);t.setPosition(e.position),this.getObjectAt(e.position.x,e.position.y)===e&&this.setObjectAt(e.position.x,e.position.y,t)}},{key:"onExplode",value:function(e){}},{key:"cleanLevel",value:function(){this.scene.events.off("player_moves"),this.scene.events.off("dialogue:hidden"),this.scene.events.off("dialogue:message_shown"),this.objects.forEach((function(e){return e.forEach((function(e){e.alien&&(e.alien.destroy(),e.alien=null)}))}))}},{key:"onComplete",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t,i,a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pause(),e.next=3,Ke.get(this.constructor.key);case 3:if((t=e.sent)&&(this.prevBest=null===t||void 0===t?void 0:t.comp),i=this.scene.rules.calcCompletion(this.countDiamonds,this.collectedDiamonds,this.countEnemies,this.killedEnemies,this.countShrooms,Math.max(this.collectedShrooms,0)),a={countDiamonds:this.countDiamonds,collectedDiamonds:this.collectedDiamonds,countEnemies:this.countEnemies,killedEnemies:this.killedEnemies,countShrooms:this.countShrooms,collectedShrooms:Math.max(this.collectedShrooms,0),comp:i,prevBest:this.prevBest},t&&!(t&&a.comp>=t.comp)){e.next=10;break}return e.next=10,Ke.set(this.constructor.key,a);case 10:return e.next=12,Ke.set("totalShroomsAmount",this.totalShroomsAmount+this.collectedShrooms);case 12:return e.next=14,Ke.get(this.constructor.key);case 14:return(s=e.sent).collectedShrooms=Math.max(0,this.collectedShrooms),e.next=18,Ke.set(this.constructor.key,s);case 18:this.scene.events.emit("levelcompleted",a);case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onInteractWith",value:function(e){e.ephemeral&&(this.interactiveElements["".concat(e.position.x,"-").concat(e.position.y)]=null)}},{key:"onAddElement",value:function(e){console.warn("implement element added ".concat(this.id))}},{key:"getConfigAt",value:function(e,t){return this.isDestinationInBounds(e,t)&&this.config[t][e]}},{key:"getCoords",value:function(e){for(var t=[],i=0;i<this.config.length;i++)for(var a=0;a<this.config[i].length;a++)this.config[i][a]===e&&t.push({x:a,y:i});return t}},{key:"getObjectAt",value:function(e,t){return this.isDestinationInBounds(e,t)&&this.objects[t][e]}},{key:"setObjectAt",value:function(e,t,i){this.objects[t][e]=i}},{key:"isPositionClear",value:function(e,t){return this.getObjectAt(e,t).isEmpty}},{key:"isDestinationInBounds",value:function(e,t){var i=e<this.config[0].length&&e>=0,a=t<this.config.length&&t>=0;return i&&a}},{key:"objectIsEmpty",value:function(e){return e&&e.isClass(q)}},{key:"isDestinationEmpty",value:function(e,t){return this.getObjectAt(e,t).isEmpty}},{key:"playEarthquake",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var i,a,s=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>1&&void 0!==s[1]?s[1]:3,e.next=3,this.shakeCamera(i);case 3:a=4===i?1:3===i?.75:2===i?.5:.25,this.destroyObjectsInRange(t,a);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroyObjectsInRange",value:function(e,t,i){for(var a=e.y1;a<e.y2;a++)for(var s=e.x1;s<=e.x2;s++){this.interactiveElements["".concat(s,"-").concat(a)]&&(this.interactiveElements["".concat(s,"-").concat(a)]=null);var n=this.getObjectAt(s,a),o=Math.random()<t,r=n.isClass(Je)||n.isClass(We),l=i&&i(n);(o&&n&&r||l)&&(n.overrunBy(),this.onDestroyElement(n))}}},{key:"shakeCamera",value:function(e){var t=this.scene.cameras.main;this.fx=this.scene.sound.add("earthquake");var i=.005*e;return t.shake(2500,i),this.fx.play(),new Promise((function(e){setTimeout(e,2500)}))}},{key:"updatePositionsOnScale",value:function(){var e,t=this.scene.children.getByName("layer_1").tilemap;this.moveables.forEach((function(e){e.alien&&e.alien.setPosition(t.tileToWorldX(e.position.x),t.tileToWorldY(e.position.y))}));var i=Object.values(this.interactiveElements).find((function(e){return null===e||void 0===e?void 0:e.isClass(yi)}));null===(e=i.block)||void 0===e||e.alien.setPosition(t.tileToWorldX(i.position.x-2),t.tileToWorldY(i.position.y)),Object.values(this.decorationElements).forEach((function(e){e.alien.x=li.tileToScreen(e.position.x),e.alien.y=li.tileToScreen(e.position.y)}))}},{key:"setTickTimeout",value:function(e,t){var i=t;!function t(a){0===i--?e(a):a.onNextTick((function(e){return t(e)}))}(this)}},{key:"awaitTicks",value:function(e){var t=this;return new Promise((function(i){return t.setTickTimeout(i,e)}))}},{key:"awaitTicksTime",value:function(e){return new Promise((function(t){setTimeout(t,N*e)}))}},{key:"teleportObject",value:function(){var e=Object(h.a)(c.a.mark((function e(t,i){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.alien.alpha=0,this.moveObject(t,i),t.setPosition(i),e.next=5,this.awaitTicks(3);case 5:t.alien.alpha=1;case 6:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"createBoulderAt",value:function(e){var t=this.scene.add.sprite(48,16).setOrigin(0,.25).play("boulder_idle");t.setScale(I()),t.x=li.tileToScreen(e.x),t.y=li.tileToScreen(e.y);var i=new He(_e.BOULDER,this);return i.alien=t,i}},{key:"createBarrelAt",value:function(e){var t=this.scene.add.sprite(48,16).setOrigin(.05,.2).play("barrel_idle");t.setScale(I()),t.x=li.tileToScreen(e.x),t.y=li.tileToScreen(e.y);var i=new mi(_e.BARREL,this);return i.alien=t,i}},{key:"createEnemyAt",value:function(e){var t=this.scene.add.sprite(48,16).setOrigin(.125,.125).play("bat_move");t.setScale(I()),t.x=li.tileToScreen(e.x),t.y=li.tileToScreen(e.y);var i=new ci(_e.ENEMY,this);return i.alien=t,i.setPosition(e),i}},{key:"destroyObjectsByKind",value:function(e){var t=this,i=new Le(_e.EXPLOSION,this);this.objects.forEach((function(a){return a.forEach((function(a){a.isClass(e)&&(a.overrunBy(i),t.onDestroyElement(a))}))}))}}]),e}(),ze=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!1,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).power=10,s.strength=10,s}return Object(_.a)(i,[{key:"setPosition",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"setPosition",this).call(this,e);var t=this.level.scene.add.sprite(li.tileToScreen(e.x),li.tileToScreen(e.y)).setOrigin(.125,.125).play("explosion_explode").setDepth(105);this.level.scene.events.emit("sounds:explosion"),t.setScale(I()),this.level.scene.plugins.get("rexTintRGB").add(t,16777215),t.tintGray=128,t.tintR=15,t.tintG=75,t.tintB=70,t.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){t.destroy()}))}}]),i}(Ue),Qe=i(11),Je=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!0,isBreakable:!0,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).strength=1,s}return Object(_.a)(i,[{key:"overrunBy",value:function(e){var t=this,i=this.level.scene.children.getByName("layer_1");if(!i)return!1;var a=i.tilemap;a.putTileAt(-1,this.position.x,this.position.y,!1,"layer_1"),this.level.scene.events.emit("sounds:clear_hit"),e||(this.break_effect=this.level.scene.add.sprite(48,16).setOrigin(0,.25),this.break_effect.setScale(I),this.break_effect.depth=4,this.break_effect.x=li.tileToScreen(this.position.x),this.break_effect.y=li.tileToScreen(this.position.y),this.break_effect.play("ground_disolves"),this.break_effect.setFlipY(!0),this.break_effect.on(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){t.break_effect.destroy()}))),setTimeout((function(){var e=t.level;[[0,-1],[1,0],[0,1],[-1,0]].forEach((function(i){var s=Array(3).fill(0).map((function(){return Array(3).fill(0)})),n=t.position.x+i[0],o=t.position.y+i[1],r=e.getObjectAt(n,o);if(r&&r.constructor.className===t.constructor.className){var l,c,h,u;s[0][1]=(null===(l=e.getObjectAt(n,o-1))||void 0===l?void 0:l.constructor.className)===t.constructor.className?_e.GROUND:0,s[1][0]=(null===(c=e.getObjectAt(n-1,o))||void 0===c?void 0:c.constructor.className)===t.constructor.className?_e.GROUND:0,s[2][1]=(null===(h=e.getObjectAt(n,o+1))||void 0===h?void 0:h.constructor.className)===t.constructor.className?_e.GROUND:0,s[1][2]=(null===(u=e.getObjectAt(n+1,o))||void 0===u?void 0:u.constructor.className)===t.constructor.className?_e.GROUND:0;var d=Se.calculateGroundTileWithNeighbours(1,1,s);a.putTileAt(d,n,o,!1,"layer_1")}}))}),31.25)}}]),i}(Pe);Je.className=K;var qe=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a,s){var n;return Object(g.a)(this,i),(n=t.call(this,{id:"root",isRigid:!0,isBreakable:!1,isFlat:!0,isPickable:!1,isCrushable:!1,level:e.level})).strength=18,n.color=s,n.alien=null,n.branchId=a,n.boss=e,n.isHorizontal=!0,n.elbowOrientation=!1,n.isHead=!0,n.lastAnimationKey="",n}return Object(_.a)(i,[{key:"setPosition",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"setPosition",this).call(this,e),this.orientation=this.boss.getChunkOrientation(this,this.branchId);var t=[Ee.RIGHT,Ee.LEFT].includes(this.orientation);this.isHorizontal=t,this.alien=this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(e.x)+li.tileToScreen(.5),li.tileToScreen(e.y)+li.tileToScreen(.5)),this.changeOrientation(this.orientation);var a=this.level.getObjectAt(e.x,e.y);a&&a.isClass(Je)&&(a.overrunBy(),this.level.onDestroyElement(a)),this.level.setObjectAt(e.x,e.y,this)}},{key:"changeOrientation",value:function(e){e===Ee.RIGHT&&(this.alien.setRotation(0),this.alien.setFlipX(!1)),e===Ee.LEFT&&(this.alien.setRotation(0),this.alien.setRotation(-Math.PI)),e===Ee.UP&&(this.alien.setRotation(-Math.PI/2),this.alien.setFlipX(!1)),e===Ee.DOWN&&this.alien.setRotation(-3*Math.PI/2)}},{key:"setElbowOrientation",value:function(e){e===Ee.UP+Ee.RIGHT&&(this.alien.setRotation(0),this.alien.setFlipX(!1)),e===Ee.RIGHT+Ee.DOWN&&(this.alien.setRotation(Math.PI/2),this.alien.setFlipX(!1)),e===Ee.DOWN+Ee.LEFT&&(this.alien.setRotation(Math.PI),this.alien.setFlipX(!1)),e===Ee.LEFT+Ee.UP&&(this.alien.setRotation(3*Math.PI/2),this.alien.setFlipX(!1)),e===Ee.UP+Ee.LEFT&&(this.alien.setRotation(0),this.alien.setFlipX(!0)),e===Ee.LEFT+Ee.DOWN&&(this.alien.setRotation(-Math.PI/2),this.alien.setFlipX(!0)),e===Ee.DOWN+Ee.RIGHT&&(this.alien.setRotation(-Math.PI),this.alien.setFlipX(!0)),e===Ee.RIGHT+Ee.UP&&(this.alien.setRotation(-3*Math.PI/2),this.alien.setFlipX(!0))}},{key:"getTurning",value:function(e){return[Ee.UP+Ee.RIGHT,Ee.RIGHT+Ee.DOWN,Ee.DOWN+Ee.LEFT,Ee.LEFT+Ee.UP].includes(e)?D:M}},{key:"animHeadEntrance",value:function(e){}},{key:"animHeadExit",value:function(e){}},{key:"animGrow",value:function(){var e=this;return new Promise((function(t){var i;if(e.elbowOrientation=e.boss.isElbow(e,e.branchId),i=e.isHorizontal?e.position.x%2===e.position.y%2?"Even":"Odd":e.position.x%2!==e.position.y%2?"Odd":"Even",e.boss.chunkIsHead(e,e.branchId)){i=e.position.x%2===e.position.y%2?"Odd":"Even";var a="chunkHead".concat(i,"_grow");e.alien.play(a),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,t),e.lastAnimationKey=a}else if(!1===e.elbowOrientation)if(e.lastAnimationKey.includes("Head")){var s="chunkHorizontal".concat(i,"_grow");e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){var i=s.replace("_grow","_idle");e.alien.play(i),e.lastAnimationKey=i,t()})),e.alien.play(s)}else t();else{var n;if(e.lastAnimationKey.includes("Head"))e.position.x%2!==e.position.y%2?e.getTurning(e.elbowOrientation)===D?(n="chunkCurveEven_grow",e.alien.play(n),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){e.setElbowOrientation(e.elbowOrientation),e.alien.play("chunkCurveOdd_idle"),t()})),e.lastAnimationKey=n):(n="chunkCurveOdd_grow",e.alien.setFlipY(!0),e.alien.play(n),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){e.alien.setFlipY(!1),e.setElbowOrientation(e.elbowOrientation),e.alien.play("chunkCurveEven_idle"),t()})),e.lastAnimationKey=n):e.getTurning(e.elbowOrientation)===D?(n="chunkCurveOdd_grow",e.alien.play(n),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){e.setElbowOrientation(e.elbowOrientation),e.alien.play("chunkCurveEven_idle"),t()})),e.lastAnimationKey=n):(n="chunkCurveEven_grow",e.alien.setFlipY(!0),e.alien.play(n),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){e.alien.setFlipY(!1),e.setElbowOrientation(e.elbowOrientation),e.alien.play("chunkCurveOdd_idle"),t()})),e.lastAnimationKey=n);else t()}}))}},{key:"animDetachment",value:function(){var e;null===(e=this.alien)||void 0===e||e.destroy()}},{key:"animReduction",value:function(){var e=this;return new Promise((function(t){var i,a;if(i=e.isHorizontal?e.position.x%2===e.position.y%2?"Even":"Odd":e.position.x%2!==e.position.y%2?"Odd":"Even",e.boss.chunkIsHead(e,e.branchId))i=e.position.x%2===e.position.y%2?"Odd":"Even",a="chunkHead".concat(i,"_shrink"),e.alien.play(a),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,t),e.lastAnimationKey=a;else if(e.boss.chunkIsNeck(e,e.branchId))if(e.elbowOrientation)e.position.x%2!==e.position.y%2?e.getTurning(e.elbowOrientation)===D?(e.changeOrientation(e.orientation),a="chunkCurveEven_shrink",e.alien.play(a),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){a="chunkHeadEven_idle",e.alien.play(a),e.lastAnimationKey=a,t()}))):(e.changeOrientation(e.orientation),a="chunkCurveOdd_shrink",e.alien.setFlipY(!0),e.alien.setFlipX(!1),e.alien.play(a),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){e.alien.setFlipY(!1),a="chunkHeadEven_idle",e.alien.play(a),e.lastAnimationKey=a,t()}))):e.getTurning(e.elbowOrientation)===D?(e.changeOrientation(e.orientation),a="chunkCurveOdd_shrink",e.alien.play(a),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){a="chunkHeadOdd_idle",e.alien.play(a),e.lastAnimationKey=a,t()}))):(a="chunkCurveEven_shrink",e.changeOrientation(e.orientation),e.alien.setFlipY(!0),e.alien.setFlipX(!1),e.alien.play(a),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){e.alien.setFlipY(!1),a="chunkHeadOdd_idle",e.alien.play(a),e.lastAnimationKey=a,t()})));else{var s="chunkHorizontal".concat(i,"_shrink");e.alien.play(s),e.alien.once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){var i=s.replace("_shrink","_idle").replace("Horizontal","Head");i=i.includes("Odd")?i.replace("Odd","Even"):i.replace("Even","Odd"),e.alien.play(i),e.lastAnimationKey=i,t()}))}else t()}))}},{key:"animDestroy",value:function(){var e=this;this.alien.setAlpha(.3),setTimeout((function(){return e.alien.destroy()}),N)}},{key:"hitBy",value:function(e){e.isClass(He)&&(console.log("hit by a rock"),this.boss.takeBranchDamage(this.branchId,1)),e.isClass(Le)&&(console.log("burnt"),this.boss.takeBranchDamage(this.branchId,5))}}]),i}(Ue);qe.className="BranchChunk";var Ze=qe,$e=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!0,isBreakable:!1,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).strength=20,s}return i}(Ue);$e.className=C;var et=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e){var a;return Object(g.a)(this,i),(a=t.call(this,"womb",e.level)).upperObject=null,a.object=null,a.boss=e,a}return Object(_.a)(i,[{key:"setPosition",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"setPosition",this).call(this,e),this.object=this.level.scene.add.rectangle(li.tileToScreen(e.x),li.tileToScreen(e.y),li.tileToScreen(1),li.tileToScreen(1),65280).setAlpha(0).setOrigin(0,0),this.level.setObjectAt(e.x,e.y,this)}}]),i}($e);et.className=P;var tt=et,it=i(17),at=i.n(it),st=function(){function e(t,i){Object(g.a)(this,e),this.level=t,this.position=i,this.body=null,this.leftBranch={id:"LEFT_BRANCH",chunks:[],originPos:{x:i.x-2,y:i.y-2},damageReceived:0,energy:50,maxEnergy:50,animating:!1},this.midBranch={id:"MID_BRANCH",chunks:[],originPos:{x:i.x,y:i.y-3},damageReceived:0,energy:50,maxEnergy:50,animating:!1},this.rightBranch={id:"RIGHT_BRANCH",chunks:[],originPos:{x:i.x+2,y:i.y-2},damageReceived:0,energy:50,maxEnergy:50,animating:!1},this.leftWomb=null,this.rightWomb=null,this.easystar=new at.a.js,this.alive=!0,this.drawEnemy(),this.subscribeToTicks()}return Object(_.a)(e,[{key:"subscribeToTicks",value:function(){var e=this;this.level.onNextTick((function(t){e.maintenance(),e.alive&&e.subscribeToTicks()}))}},{key:"drawEnemy",value:function(){this.body=[this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x+2)+li.tileToScreen(.5),li.tileToScreen(this.position.y-1)+li.tileToScreen(.5)).play("bossWombTop").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x+1)+li.tileToScreen(.5),li.tileToScreen(this.position.y)+li.tileToScreen(.5)).play("bossWombBottom1").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x+2)+li.tileToScreen(.5),li.tileToScreen(this.position.y)+li.tileToScreen(.5)).play("bossWombBottom2_idle").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x-2)+li.tileToScreen(.5),li.tileToScreen(this.position.y-1)+li.tileToScreen(.5)).setFlipX(!0).play("bossWombTop").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x-1)+li.tileToScreen(.5),li.tileToScreen(this.position.y)+li.tileToScreen(.5)).setFlipX(!0).play("bossWombBottom1").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x-2)+li.tileToScreen(.5),li.tileToScreen(this.position.y)+li.tileToScreen(.5)).setFlipX(!0).play("bossWombBottom2_idle").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x)+li.tileToScreen(.5),li.tileToScreen(this.position.y-2)+li.tileToScreen(.5)).play("bossCenterTop").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x)+li.tileToScreen(.5),li.tileToScreen(this.position.y-1)+li.tileToScreen(.5)).play("bossCenterMid").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x)+li.tileToScreen(.5),li.tileToScreen(this.position.y)+li.tileToScreen(.5)).play("bossCenterBottom").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x+1)+li.tileToScreen(.5),li.tileToScreen(this.position.y-2)+li.tileToScreen(.5)).play("bossSideTop").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x+1)+li.tileToScreen(.5),li.tileToScreen(this.position.y-1)+li.tileToScreen(.5)).play("bossSideMid").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x+1)+li.tileToScreen(.5),li.tileToScreen(this.position.y)+li.tileToScreen(.5)).play("bossSideBottom").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x+2)+li.tileToScreen(.5),li.tileToScreen(this.position.y-2)+li.tileToScreen(.5)).play("bossBorderTop").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x+2)+li.tileToScreen(.5),li.tileToScreen(this.position.y-1)+li.tileToScreen(.5)).play("bossBorderMid").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x+2)+li.tileToScreen(.5),li.tileToScreen(this.position.y)+li.tileToScreen(.5)).play("bossBorderBottom").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x-1)+li.tileToScreen(.5),li.tileToScreen(this.position.y-2)+li.tileToScreen(.5)).setFlipX(!0).play("bossSideTop").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x-1)+li.tileToScreen(.5),li.tileToScreen(this.position.y-1)+li.tileToScreen(.5)).setFlipX(!0).play("bossSideMid").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x-1)+li.tileToScreen(.5),li.tileToScreen(this.position.y)+li.tileToScreen(.5)).setFlipX(!0).play("bossSideBottom").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x-2)+li.tileToScreen(.5),li.tileToScreen(this.position.y-2)+li.tileToScreen(.5)).setFlipX(!0).play("bossBorderTop").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x-2)+li.tileToScreen(.5),li.tileToScreen(this.position.y-1)+li.tileToScreen(.5)).setFlipX(!0).play("bossBorderMid").setDepth(5.5),this.level.scene.add.sprite(0,0).setOrigin(.5,.5).setScale(I()).setPosition(li.tileToScreen(this.position.x-2)+li.tileToScreen(.5),li.tileToScreen(this.position.y)+li.tileToScreen(.5)).setFlipX(!0).play("bossBorderBottom").setDepth(5.5)];var e=new Ze(this,this.leftBranch.id,65280);e.setPosition(this.leftBranch.originPos),this.leftBranch.chunks.push(e),e.animGrow(),(e=new Ze(this,this.midBranch.id,34816)).setPosition(this.midBranch.originPos),this.midBranch.chunks.push(e),e.animGrow(),(e=new Ze(this,this.rightBranch.id,47872)).setPosition(this.rightBranch.originPos),this.rightBranch.chunks.push(e),e.animGrow();var t=new tt(this);t.setPosition(Object(Qe.a)(Object(Qe.a)({},this.position),{},{x:this.position.x-2})),this.leftWomb=t,(t=new tt(this)).setPosition(Object(Qe.a)(Object(Qe.a)({},this.position),{},{x:this.position.x+2})),this.rightWomb=t}},{key:"growBranches",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t,i,a,s,n,o,r,l,h,u,p,y,m,f,v,g;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.level.objects.map((function(e){return e.map((function(e){return e.isClass(K)||e.isClass(B)||e.isClass(q)?0:1}))})),this.easystar.setAcceptableTiles([0]),i=[],a=null,!(this.midBranch.energy>0)){e.next=13;break}return a=this.midBranch.chunks.slice(-1)[0],t[a.position.y][a.position.x]=0,this.easystar.setGrid(t),e.next=10,this.calcPathForBranch(this.midBranch);case 10:i=e.sent,t[a.position.y][a.position.x]=1,i.forEach((function(e){return t[e.y][e.x]=1}));case 13:if(s=[],!(this.leftBranch.energy>0)){e.next=23;break}return a=this.leftBranch.chunks.slice(-1)[0],t[a.position.y][a.position.x]=0,this.easystar.setGrid(t),e.next=20,this.calcPathForBranch(this.leftBranch);case 20:s=e.sent,t[a.position.y][a.position.x]=1,s.forEach((function(e){return t[e.y][e.x]=1}));case 23:if(n=[],!(this.rightBranch.energy>0)){e.next=31;break}return a=this.rightBranch.chunks.slice(-1)[0],t[a.position.y][a.position.x]=0,this.easystar.setGrid(t),e.next=30,this.calcPathForBranch(this.rightBranch);case 30:n=e.sent;case 31:return e.next=33,this.level.awaitTicksTime(2);case 33:return o=function(e){return e?{x:li.tileToScreen(e.x),y:li.tileToScreen(e.y)}:null},r=Number.MAX_SAFE_INTEGER,l=i.length>0?i.slice(-1)[0]:this.midBranch.chunks.length>0?{x:64+this.midBranch.chunks.slice(-1)[0].position.x,y:64+this.midBranch.chunks.slice(-1)[0].position.y}:{x:r,y:r},h=s.length>0?s.slice(-1)[0]:this.leftBranch.chunks.length>0?{x:64+this.leftBranch.chunks.slice(-1)[0].position.x,y:64+this.leftBranch.chunks.slice(-1)[0].position.y}:{x:r,y:r},u=n.length>0?n.slice(-1)[0]:this.rightBranch.chunks.length>0?{x:64+this.rightBranch.chunks.slice(-1)[0].position.x,y:64+this.rightBranch.chunks.slice(-1)[0].position.y}:{x:r,y:r},p=d.a.Math.Distance.BetweenPoints(o(l),this.level.player.alien),y=d.a.Math.Distance.BetweenPoints(o(h),this.level.player.alien),m=d.a.Math.Distance.BetweenPoints(o(u),this.level.player.alien),(f=Math.min(p,y,m))===p&&(v=l.x>64?{x:l.x-64,y:l.y-64}:l),f===y&&(v=h.x>64?{x:h.x-64,y:h.y-64}:h),f===m&&(v=u.x>64?{x:u.x-64,y:u.y-64}:u),e.next=47,this.level.scene.rules.panAndFollow({x:li.tileToScreen(v.x),y:li.tileToScreen(v.y),width:1,height:1});case 47:return g=function(e){return function(){return e.shift()}},(this.isSamePosition(i[i.length-1],this.level.player.position)||this.isSamePosition(s[s.length-1],this.level.player.position)||this.isSamePosition(n[n.length-1],this.level.player.position))&&this.level.playerKilledByBranch(),e.next=51,Promise.all([this.animateGrow(this.midBranch,g(i)),this.animateGrow(this.leftBranch,g(s)),this.animateGrow(this.rightBranch,g(n))]);case 51:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"animateGrow",value:function(){var e=Object(h.a)(c.a.mark((function e(t,i){var a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=i())||t.animating){e.next=9;break}return(s=new Ze(this,t.id,t.chunks[0].color)).setPosition(a),t.chunks.push(s),e.next=7,Promise.all(t.chunks.map((function(e){return e.animGrow()})));case 7:return e.next=9,this.animateGrow(t,i);case 9:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()},{key:"animateReduction",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.chunks.length>1)){e.next=11;break}return t.animating=!0,e.next=4,Promise.all(t.chunks.map((function(e){return e.animReduction()})));case 4:if(t.animating=!1,!(i=t.chunks.pop())){e.next=11;break}return i.animDetachment(),e.next=10,this.level.awaitTicksTime(.5);case 10:this.level.replaceByEmpty(i);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"calcPathForBranch",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var i,a,s,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.chunks.slice(-1)[0],a=i.position,s=this.level.player.position,e.next=5,this.calcPath(a,s);case 5:return n=e.sent,e.abrupt("return",n.slice(1,5));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"calcPath",value:function(e,t){var i=this;return new Promise((function(a){i.easystar.findPath(e.x,e.y,t.x,t.y,(function(e){a(e||[])})),i.easystar.calculate()}))}},{key:"birthBats",value:function(){this.createBatLeftDown(),this.createBatRightDown()}},{key:"createBatRightUp",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={x:this.rightWomb.position.x+1,y:this.rightWomb.position.y-1},!(i=this.createBatAt(t))){e.next=6;break}return e.next=5,this.level.awaitTicks(2);case 5:this.level.moveables.push(i);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createBatLeftUp",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={x:this.leftWomb.position.x-1,y:this.leftWomb.position.y-1},"CW",!(i=this.createBatAt(t,"CW"))){e.next=7;break}return e.next=6,this.level.awaitTicks(2);case 6:this.level.moveables.push(i);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createBatRightDown",value:function(){var e,t=this,i={x:this.rightWomb.position.x+1,y:this.rightWomb.position.y},a=this.createBatAt(i);a?(null===(e=a.alien)||void 0===e||e.setAlpha(0),this.body[2].play("bossWombBottom2_birth"),this.body[2].once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){var e;t.level.moveables.push(a),t.body[2].play("bossWombBottom2_idle"),null===(e=a.alien)||void 0===e||e.setAlpha(1)}))):(this.body[2].play("bossWombBottom2_blocked"),this.body[2].once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){t.body[2].play("bossWombBottom2_idle")})))}},{key:"createBatLeftDown",value:function(){var e,t=this,i={x:this.leftWomb.position.x-1,y:this.leftWomb.position.y},a=this.createBatAt(i,"CW");a?(null===(e=a.alien)||void 0===e||e.setAlpha(0),this.body[5].play("bossWombBottom2_birth"),this.body[5].once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){var e;t.level.moveables.push(a),t.body[5].play("bossWombBottom2_idle"),null===(e=a.alien)||void 0===e||e.setAlpha(1)}))):(this.body[5].play("bossWombBottom2_blocked"),this.body[5].once(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){t.body[5].play("bossWombBottom2_idle")})))}},{key:"createBatAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CCW",i=this.level.getObjectAt(e.x,e.y);if(i.isClass(q)){var a=this.level.createEnemyAt(e);return a.scanDirection=t,a}}},{key:"maintenance",value:function(){this.midBranch.damageReceived>0&&this.midBranch.energy>0&&!this.midBranch.animating&&(this.animateReduction(this.midBranch),this.midBranch.damageReceived--,this.midBranch.energy--,this.level.scene.events.emit("branch_takes_damage",{branchId:this.midBranch.id,newValue:this.midBranch.energy/this.midBranch.maxEnergy})),this.leftBranch.damageReceived>0&&this.leftBranch.energy>0&&!this.leftBranch.animating&&(this.animateReduction(this.leftBranch),this.leftBranch.damageReceived--,this.leftBranch.energy--,this.level.scene.events.emit("branch_takes_damage",{branchId:this.leftBranch.id,newValue:this.leftBranch.energy/this.leftBranch.maxEnergy})),this.rightBranch.damageReceived>0&&this.rightBranch.energy>0&&!this.rightBranch.animating&&(this.animateReduction(this.rightBranch),this.rightBranch.damageReceived--,this.rightBranch.energy--,this.level.scene.events.emit("branch_takes_damage",{branchId:this.rightBranch.id,newValue:this.rightBranch.energy/this.rightBranch.maxEnergy})),this.midBranch.energy<=0&&this.leftBranch.energy<=0&&this.rightBranch.energy<=0&&!this.defeated&&(this.defeated=!0,this.level.destroyObjectsByKind(U),this.level.playerWon())}},{key:"destroyBranch",value:function(e){var t=this;console.log("branch destroyed"),e.chunks.forEach((function(e){e.animDestroy(),t.level.replaceByEmpty(e)})),e.chunks=[]}},{key:"takeBranchDamage",value:function(e,t){var i=this.getBranchById(e);if(i.damageReceived+=t,i.damageReceived>=i.energy&&i.energy>0)i.energy=0,this.destroyBranch(i),this.level.scene.events.emit("branch_takes_damage",{branchId:e,newValue:0});else{var a=this.level.scene.add.group({classType:d.a.GameObjects.Sprite,defaultKey:null,defaultFrame:null,active:!0,maxSize:-1,runChildUpdate:!1,createCallback:null,removeCallback:null,createMultipleCallback:null});a.addMultiple(i.chunks.map((function(e){return e.alien})));var s=this.level.scene.plugins.get("rexFlash").add(a,{duration:75,repeat:3});s.flash(),s.once("complete",(function(){return a.clear()}))}}},{key:"getBranchById",value:function(e){return[this.leftBranch,this.midBranch,this.rightBranch].find((function(t){return t.id===e}))}},{key:"chunkIsHead",value:function(e,t){var i=this.getBranchById(t);return i.chunks[i.chunks.length-1]===e}},{key:"chunkIsNeck",value:function(e,t){var i=this.getBranchById(t);return i.chunks.length>1&&i.chunks[i.chunks.length-2]===e}},{key:"isSamePosition",value:function(e,t){return e&&t&&e.x===t.x&&e.y===t.y}},{key:"getChunkOrientation",value:function(e,t){var i=this.getBranchById(t),a=i.chunks.findIndex((function(t){return t===e}));if(0===a||0===i.chunks.length)return Ee.UP;var s=-1===a?i.chunks[i.chunks.length-1]:i.chunks[a-1];return s.position.x<e.position.x&&s.position.y===e.position.y?Ee.RIGHT:s.position.x>e.position.x&&s.position.y===e.position.y?Ee.LEFT:s.position.x===e.position.x&&s.position.y<e.position.y?Ee.DOWN:s.position.x===e.position.x&&s.position.y>e.position.y?Ee.UP:void 0}},{key:"isElbow",value:function(e,t){var i=this.getBranchById(t),a=i.chunks.findIndex((function(t){return t===e})),s=-1===a||a===i.chunks.length-1,n=0===a||0===i.chunks.length;if(s)return!1;var o=i.chunks[a+1],r=n?Object(Qe.a)(Object(Qe.a)({},e),{},{position:Object(Qe.a)(Object(Qe.a)({},e.position),{},{y:e.position.y+1})}):i.chunks[a-1];return r.position.x<o.position.x&&r.position.y>o.position.y?r.position.x<e.position.x?Ee.RIGHT+Ee.UP:Ee.UP+Ee.RIGHT:r.position.x<o.position.x&&r.position.y<o.position.y?r.position.x<e.position.x?Ee.RIGHT+Ee.DOWN:Ee.DOWN+Ee.RIGHT:r.position.x>o.position.x&&r.position.y<o.position.y?r.position.x>e.position.x?Ee.LEFT+Ee.DOWN:Ee.DOWN+Ee.LEFT:r.position.x>o.position.x&&r.position.y>o.position.y&&(r.position.x>e.position.x?Ee.LEFT+Ee.UP:Ee.UP+Ee.LEFT)}}]),e}(),nt=function(){function e(t){Object(g.a)(this,e),this.scene=t,this.object=null,this.flash=null}return Object(_.a)(e,[{key:"setValue",value:function(e){this.object.value=e,this.object.value>.85&&this.flash.flash()}},{key:"reset",value:function(){this.scene.tweens.add({targets:this.object,value:0,ease:"Linear",duration:500})}},{key:"draw",value:function(e){var t=e.x,i=void 0===t?0:t,a=e.y,s=void 0===a?0:a,n=e.radius,o=void 0===n?.5*I:n,r=e.barColor,l=void 0===r?6134649:r,c=e.trackColor,h=void 0===c?4745305:c,u=e.centerColor,p=void 0===u?4745305:u,y=e.thickness,m=void 0===y?.8:y,f=e.startAngle,v=void 0===f?d.a.Math.DegToRad(270):f;this.object=this.scene.add.rexCircularProgress({x:i,y:s,radius:o,barColor:l,trackColor:h,centerColor:p,thickness:m,startAngle:v,anticlockwise:!0,value:0,easeValue:{duration:0,ease:"Linear"},valuechangeCallback:function(e,t,i){}}),this.object.setScrollFactor(0),this.object.depth=100,this.object.name="circularProgress",this.flash=this.scene.plugins.get("rexFlash").add(this.object,{duration:N,repeat:2})}}]),e}(),ot=function(){function e(t){Object(g.a)(this,e),this.scene=t,this.branch1={progressBox:null,progressBar:null,value:0,x:0,y:0,barWidth:0,barHeight:0,flash:null},this.branch2={progressBox:null,progressBar:null,value:0,x:0,y:0,barWidth:0,barHeight:0,flash:null},this.branch3={progressBox:null,progressBar:null,value:0,x:0,y:0,barWidth:0,barHeight:0,flash:null}}return Object(_.a)(e,[{key:"draw",value:function(e){var t=e.x,i=e.y,a=li.tileToScreen(.3),s=li.tileToScreen(1),n=li.tileToScreen(.03),o=li.pixelToScreen(1);this.branch1.progressBox=this.scene.add.graphics(),this.branch1.progressBox.name="progressBox1",this.branch1.progressBox.depth=100,this.branch1.progressBox.setScrollFactor(0),this.branch1.progressBox.fillStyle(4745305,.8),this.branch1.progressBox.fillRect(t,i,a,s),this.branch1.progressBar=this.scene.add.graphics(),this.branch1.progressBar.name="progressBar1",this.branch1.progressBar.depth=101,this.branch1.progressBar.setScrollFactor(0),this.branch1.progressBar.fillStyle(6134649,1),this.branch1.barWidth=a-2*o,this.branch1.barHeight=s-2*o,this.branch1.x=t+o,this.branch1.y=i+o+this.branch1.barHeight,this.branch1.progressBar.fillRect(this.branch1.x,this.branch1.y,this.branch1.barWidth,-this.branch1.barHeight),this.branch1.flash=this.scene.plugins.get("rexFlash").add(this.branch1.progressBar,{duration:N,repeat:2}),this.branch2.progressBox=this.scene.add.graphics(),this.branch2.progressBox.name="progressBox2",this.branch2.progressBox.depth=100,this.branch2.progressBox.setScrollFactor(0),this.branch2.progressBox.fillStyle(4745305,.8),this.branch2.progressBox.fillRect(t+a+n,i,a,s),this.branch2.progressBar=this.scene.add.graphics(),this.branch2.progressBar.name="progressBar2",this.branch2.progressBar.depth=101,this.branch2.progressBar.setScrollFactor(0),this.branch2.progressBar.fillStyle(6134649,1),this.branch2.barWidth=a-2*o,this.branch2.barHeight=s-2*o,this.branch2.x=t+a+n+o,this.branch2.y=i+o+this.branch1.barHeight,this.branch2.progressBar.fillRect(this.branch2.x,this.branch2.y,this.branch2.barWidth,-this.branch2.barHeight),this.branch2.flash=this.scene.plugins.get("rexFlash").add(this.branch2.progressBar,{duration:N,repeat:2}),this.branch3.progressBox=this.scene.add.graphics(),this.branch3.progressBox.name="progressBox3",this.branch3.progressBox.depth=100,this.branch3.progressBox.setScrollFactor(0),this.branch3.progressBox.fillStyle(4745305,.8),this.branch3.progressBox.fillRect(t+2*a+2*n,i,a,s),this.branch3.progressBar=this.scene.add.graphics(),this.branch3.progressBar.name="progressBar3",this.branch3.progressBar.depth=101,this.branch3.progressBar.setScrollFactor(0),this.branch3.progressBar.fillStyle(6134649,1),this.branch3.barWidth=a-2*o,this.branch3.barHeight=s-2*o,this.branch3.x=t+2*a+2*n+o,this.branch3.y=i+o+this.branch1.barHeight,this.branch3.progressBar.fillRect(this.branch3.x,this.branch3.y,this.branch3.barWidth,-this.branch3.barHeight),this.branch3.flash=this.scene.plugins.get("rexFlash").add(this.branch3.progressBar,{duration:N,repeat:2}),this.scene.events.on("branch_takes_damage",this.reduceValue.bind(this))}},{key:"reduceValue",value:function(e){var t=e.branchId,i=e.newValue,a="LEFT_BRANCH"===t?this.branch1:"MID_BRANCH"===t?this.branch2:this.branch3;a.progressBar.clear(),a.progressBar.fillStyle(6134649,1),a.progressBar.fillRect(a.x,a.y,a.barWidth,-i*a.barHeight),console.log(a.flash),a.flash.timer&&a.flash.flash()}}]),e}(),rt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The prophecy",e.diamondsGoal=0,e.worldArtOriginPos={x:14,y:15},e.reloadSpots=[],e.batBirthSpots=[],e.stepsToBossGrowth=10,e.stepCount=0,e.artSpot=null,e.playerKilled=!1,e.ticksCountForBossLoop=50,e.ticksCount=50,e.flash=null,e.isRestart=!0,e.circularProgress=null,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:return t.ui.drawKiBossScores(),this.circularProgress=new nt(t),this.branchesEnergyBars=new ot(t),this.scene.children.getByName("score_left_img").setVisible(!1),this.scene.children.getByName("score_right_img").setVisible(!1),this.drawProfecy(),this.boss=new st(this,{x:Math.min(this.batBirthSpots[0].position.x,this.batBirthSpots[1].position.x)+Math.abs(this.batBirthSpots[0].position.x-this.batBirthSpots[1].position.x)/2,y:this.batBirthSpots[0].position.y}),this.battleMusic=this.scene.sound.add("escape_music",{loop:!0,valume:0}),this.scene.isRestart&&this.jumpToBattle(),this.prepareDwarfForProphecy(),e.next=14,this.awaitTicks(2);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"jumpToBattle",value:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.player.setPosition({x:this.artSpot.position.x,y:this.artSpot.position.y+3}),this.moveObject(this.player,this.player.position),this.focusObject=this.player.alien,this.leader.setPosition({x:this.artSpot.position.x+2,y:this.artSpot.position.y}),this.moveObject(this.leader,this.leader.position),this.leader.animIdle(),this.destroyObjectsInRange({x1:this.artSpot.position.x-1,x2:this.artSpot.position.x+2,y1:this.artSpot.position.y,y2:this.artSpot.position.y+2},1),e.next=9,this.awaitTicks(2);case 9:this.startBattle();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prepareDwarfForProphecy",value:function(){for(var e=this.artSpot.position.x+1-this.leader.position.x,t=1;t<=e;t++)this.leader.leadingPath.push({x:this.leader.position.x+t,y:this.leader.position.y})}},{key:"startBattle",value:function(){var e,t,i;this.pause(),this.circularProgress.draw({x:li.tileToScreen(19.15),y:li.tileToScreen(0),radius:li.tileToScreen(.5)}),this.branchesEnergyBars.draw({x:li.tileToScreen(1.5),y:li.tileToScreen(-.5)}),this.scene.children.getByName("score_left_img").setVisible(!0),this.scene.children.getByName("score_right_img").setVisible(!0),this.scene.tweens.add({targets:this.scene.rules.music,volume:0,ease:"Linear",duration:1e3}),null===(e=this.scene.rules)||void 0===e||null===(t=e.music)||void 0===t||t.stop(),null===(i=this.battleMusic)||void 0===i||i.play(),this.scene.tweens.add({targets:this.battleMusic,volume:1,ease:"Linear",duration:1e3}),this.bossLoop()}},{key:"growLeft",value:function(){var e=new Ze(this.boss,this.boss.rightBranch.id,65280),t=this.boss.rightBranch.chunks[this.boss.rightBranch.chunks.length-1];e.setPosition({x:t.position.x-1,y:t.position.y}),this.boss.rightBranch.chunks.push(e),this.boss.rightBranch.chunks.forEach((function(e){return e.animGrow()}))}},{key:"growRight",value:function(){var e=new Ze(this.boss,this.boss.rightBranch.id,65280),t=this.boss.rightBranch.chunks[this.boss.rightBranch.chunks.length-1];e.setPosition({x:t.position.x+1,y:t.position.y}),this.boss.rightBranch.chunks.push(e),this.boss.rightBranch.chunks.forEach((function(e){return e.animGrow()}))}},{key:"growUp",value:function(){var e=new Ze(this.boss,this.boss.rightBranch.id,65280),t=this.boss.rightBranch.chunks[this.boss.rightBranch.chunks.length-1];e.setPosition({x:t.position.x,y:t.position.y-1}),this.boss.rightBranch.chunks.push(e),this.boss.rightBranch.chunks.forEach((function(e){return e.animGrow()}))}},{key:"growDown",value:function(){var e=new Ze(this.boss,this.boss.rightBranch.id,65280),t=this.boss.rightBranch.chunks[this.boss.rightBranch.chunks.length-1];e.setPosition({x:t.position.x,y:t.position.y+1}),this.boss.rightBranch.chunks.push(e),this.boss.rightBranch.chunks.forEach((function(e){return e.animGrow()}))}},{key:"drawSmallRosette",value:function(e,t){var i=new Ze(this.boss,this.boss.rightBranch.id,65280);i.setPosition({x:e.x,y:e.y}),this.boss.rightBranch.chunks.push(i),(i=new Ze(this.boss,this.boss.rightBranch.id,65280)).setPosition({x:e.x-1,y:e.y}),this.boss.rightBranch.chunks.push(i),(i=new Ze(this.boss,this.boss.rightBranch.id,65280)).setPosition({x:e.x-1,y:e.y+1}),this.boss.rightBranch.chunks.push(i),(i=new Ze(this.boss,this.boss.rightBranch.id,65280)).setPosition({x:e.x-1,y:e.y+2}),this.boss.rightBranch.chunks.push(i),(i=new Ze(this.boss,this.boss.rightBranch.id,65280)).setPosition({x:e.x,y:e.y+2}),this.boss.rightBranch.chunks.push(i),(i=new Ze(this.boss,this.boss.rightBranch.id,65280)).setPosition({x:e.x+1,y:e.y+2}),this.boss.rightBranch.chunks.push(i),(i=new Ze(this.boss,this.boss.rightBranch.id,65280)).setPosition({x:e.x+1,y:e.y+1}),this.boss.rightBranch.chunks.push(i),(i=new Ze(this.boss,this.boss.rightBranch.id,65280)).setPosition({x:e.x+1,y:e.y}),this.boss.rightBranch.chunks.push(i)}},{key:"repost",value:function(){var e=this;this.reloadSpots.forEach((function(t){if(e.isDestinationEmpty(t.position.x,t.position.y)){var i=null;(i=Math.random()>.75?e.createBarrelAt(t.position):e.createBoulderAt(t.position)).setPosition(t.position),e.moveables.push(i),e.onAddElement(i),i.addedToScene(),e.objects[i.position.y][i.position.x]=i}}))}},{key:"playerKilledByBranch",value:function(){this.playerKilled=!0}},{key:"playerWon",value:function(){this.bossDefeated()}},{key:"drawProfecy",value:function(){for(var e=this.scene.children.getByName("layer_2"),t=0;t<=3;t++)for(var i=0;i<=3;i++)e.putTileAt(Se.WORLD_ART+i+10*t,this.worldArtOriginPos.x+i,this.worldArtOriginPos.y+t,!1,"layer_1")}},{key:"onKeyUp",value:function(e){"1"===e.key&&this.showDialog1(),"2"===e.key&&this.showDialog2(),"3"===e.key&&this.showDialog3(),"4"===e.key&&this.showDialog4(),"5"===e.key&&this.scene.events.emit("dialogue:updateCharacterName"),"9"===e.key&&this.destroyObjectsByKind(U),"7"===e.key&&this.boss.takeBranchDamage("RIGHT_BRANCH",1),"8"===e.key&&this.boss.takeBranchDamage("RIGHT_BRANCH",5),e.key===Ee.LEFT&&this.growLeft(),e.key===Ee.RIGHT&&this.growRight(),e.key===Ee.UP&&this.growUp(),e.key===Ee.DOWN&&this.growDown()}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",Object(h.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.awaitTicks(3);case 2:return t.next=4,e.playEarthquake({x1:e.player.position.x,x2:e.player.position.x,y1:e.player.position.y,y2:e.player.position.y},1);case 4:return e.destroyObjectsInRange({x1:e.player.position.x-1,x2:e.player.position.x+2,y1:e.player.position.y,y2:e.player.position.y+2},1),t.next=7,e.awaitTicks(5);case 7:e.showDialog2();case 8:case"end":return t.stop()}}),t)})))),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("level_19.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_19.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("level_19.dialog_1.mary_say_2")]},{who:"closeUp_Dwarf",text:[Ie("level_19.dialog_1.dwarf_say_2")]},{who:"closeUp_Mary",text:[Ie("level_19.dialog_1.mary_say_3")]},{who:"closeUp_Dwarf",text:[Ie("level_19.dialog_1.dwarf_say_3")]},{who:"closeUp_Mary",text:[Ie("level_19.dialog_1.mary_say_4")]},{who:"closeUp_Dwarf",text:[Ie("level_19.dialog_1.dwarf_say_4")]}]})}},{key:"showDialog2",value:function(){var e=this;this.scene.events.once("dialogue:hidden",Object(h.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.onNextTick((function(e){return e.startBattle()}));case 1:case"end":return t.stop()}}),t)})))),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("level_19.dialog_2.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_19.dialog_2.dwarf_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_19.dialog_2.dwarf_say_2")]},{who:"closeUp_Dwarf",text:[Ie("level_19.dialog_2.dwarf_say_3")]}]})}},{key:"moveDwarfToExit",value:function(){var e=this;this.dwarfRun&&(0!==this.leader.leadingPath.length?this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarfToExit()})):(this.dwarfRun=!1,this.replaceByEmpty(this.leader),this.leader=null,this.player.reconnect()))}},{key:"showDialog3",value:function(){var e=this;this.scene.events.once("dialogue:hidden",Object(h.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.dwarfRun=!0,e.leader.leadingPath=[{x:e.leader.position.x+1,y:e.leader.position.y},{x:e.leader.position.x+1,y:e.leader.position.y},{x:e.leader.position.x+2,y:e.leader.position.y},{x:e.leader.position.x+2,y:e.leader.position.y},{x:e.leader.position.x+3,y:e.leader.position.y},{x:e.leader.position.x+3,y:e.leader.position.y}],e.moveDwarfToExit();case 3:case"end":return t.stop()}}),t)})))),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Marduk"],conversation:[{who:"closeUp_Mary",text:[Ie("level_19.dialog_3.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_19.dialog_3.dwarf_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_19.dialog_3.dwarf_say_2")]},{who:"closeUp_Mary",text:[Ie("level_19.dialog_3.mary_say_2")]},{who:"closeUp_Dwarf",text:[Ie("level_19.dialog_3.dwarf_say_3")]}]})}},{key:"showDialog4",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Marduk","closeUp_Dwarf","closeUp_Tiamat"],participantNames:["Mary","Marduk","Doc","Tiamat"],conversation:[{who:"closeUp_Mary",text:[Ie("level_1.dialog_1.mary_say_1")],options:[]}]})}},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&this.onComplete(),99===e.order&&this.showDialog3(),0===e.order&&this.playTheProphecy()}},{key:"onAddElement",value:function(e){(e.isClass(di)&&(e.power=1,e.hasPickaxe=!0),e.isClass(vi)&&e.ignite(),e.isClass(pi)&&0===e.order&&(this.artSpot=e),e.isClass(pi)&&!e.isClass(yi)&&0!==e.order)&&(e.position.y<this.config.length/2?this.reloadSpots.push(e):this.batBirthSpots.push(e))}},{key:"bossLoop",value:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.boss.defeated){e.next=2;break}return e.abrupt("return",!0);case 2:if(this.onNextTick((function(e){return e.bossLoop()})),!(this.ticksCount<this.ticksCountForBossLoop)){e.next=9;break}return this.ticksCount++,this.circularProgress.setValue(this.ticksCount/this.ticksCountForBossLoop),e.abrupt("return",!1);case 9:this.ticksCount=0,this.circularProgress.reset();case 11:return this.player.disconnect(),this.pause(),e.next=15,this.scene.rules.panAndFollow({x:li.tileToScreen(this.boss.position.x),y:li.tileToScreen(this.boss.position.y),width:1,height:1});case 15:return e.next=17,this.boss.birthBats();case 17:return this.repost(),e.next=20,this.boss.growBranches();case 20:return e.next=22,this.scene.rules.panAndFollow(this.player.alien);case 22:this.playerKilled?(this.player.die(),setTimeout((function(){}),2e3)):(this.player.reconnect(),this.resume());case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bossDefeated",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t,i,a,s,n,o=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.scene.tweens.add({targets:this.battleMusic,volume:0,ease:"Linear",duration:1e3}),this.player.disconnect(),this.repositionDwarfToEndLevel(),e.next=5,this.scene.rules.panAndFollow({x:li.tileToScreen(this.boss.position.x),y:li.tileToScreen(this.boss.position.y),width:1,height:1});case 5:for(t=function(e){return Math.floor(Math.random()*e)*(Math.round(Math.random())?1:-1)},i=0;i<20;i++)this.setTickTimeout((function(){new ze("GREEN_EXPLOSION",o).setPosition({x:o.boss.position.x+t(3),y:o.boss.position.y-1+t(2)})}),i);return(a=this.scene.add.group({classType:d.a.GameObjects.Sprite,defaultKey:null,defaultFrame:null,active:!0,maxSize:-1,runChildUpdate:!1,createCallback:null,removeCallback:null,createMultipleCallback:null})).addMultiple(this.boss.body),e.next=11,this.awaitTicks(10);case 11:return(s=this.scene.plugins.get("rexFlash").add(a,{duration:125,repeat:20})).flash(),s.once("complete",(function(){a.clear(),o.boss.body.forEach((function(e){o.scene.add.sprite(e.x,e.y).setOrigin(0,.25).play("ground_disolves"),e.destroy()}))})),this.playEarthquake({x1:this.boss.position.x,x2:this.boss.position.x,y1:this.boss.position.y,y2:this.boss.position.y},1),e.next=17,this.awaitTicks(10);case 17:return n=function(e){return e.isClass(L)||e.isClass(P)||e.isClass(ie)},this.destroyObjectsInRange({x1:this.boss.position.x-4,x2:this.boss.position.x+4,y1:this.boss.position.y-6,y2:this.boss.position.y+2},1,n),e.next=21,this.awaitTicks(10);case 21:return this.scene.rules.music.play(),this.scene.tweens.add({targets:this.scene.rules.music,volume:1,ease:"Linear",duration:1e3}),e.next=25,this.scene.rules.panAndFollow(this.player.alien);case 25:this.player.reconnect();case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"repositionDwarfToEndLevel",value:function(){this.teleportObject(this.leader,{x:this.boss.position.x,y:this.boss.position.y+3}),this.leader.leadingPath=[{x:this.leader.position.x,y:this.leader.position.y+1},{x:this.leader.position.x,y:this.leader.position.y+2},{x:this.leader.position.x,y:this.leader.position.y+3},{x:this.leader.position.x,y:this.leader.position.y+4},{x:this.leader.position.x,y:this.leader.position.y+5},{x:this.leader.position.x,y:this.leader.position.y+6},{x:this.leader.position.x,y:this.leader.position.y+7},{x:this.leader.position.x,y:this.leader.position.y+8},{x:this.leader.position.x,y:this.leader.position.y+9},{x:this.leader.position.x,y:this.leader.position.y+10},{x:this.leader.position.x+1,y:this.leader.position.y+10},{x:this.leader.position.x+2,y:this.leader.position.y+10},{x:this.leader.position.x+3,y:this.leader.position.y+10},{x:this.leader.position.x+4,y:this.leader.position.y+10},{x:this.leader.position.x+5,y:this.leader.position.y+10},{x:this.leader.position.x+6,y:this.leader.position.y+10},{x:this.leader.position.x+7,y:this.leader.position.y+10},{x:this.leader.position.x+8,y:this.leader.position.y+10},{x:this.leader.position.x+9,y:this.leader.position.y+10},{x:this.leader.position.x+10,y:this.leader.position.y+10},{x:this.leader.position.x+11,y:this.leader.position.y+10},{x:this.leader.position.x+12,y:this.leader.position.y+10}];var e=new pi(_e.INTERACTION,this);e.order=99,this.interactiveElements["".concat(this.exit.position.x-4,"-").concat(this.exit.position.y)]=e,e.setPosition({x:this.exit.position.x-4,y:this.exit.position.y})}},{key:"destroy",value:function(){var e,t,a,s,n,o,r,l,c;Object(k.a)(Object(w.a)(i.prototype),"destroy",this).call(this),this.battleMusic.stop(),null===(e=this.branchesEnergyBars)||void 0===e||null===(t=e.branch1)||void 0===t||null===(a=t.progressBar)||void 0===a||a.destroy(),null===(s=this.branchesEnergyBars)||void 0===s||null===(n=s.branch2)||void 0===n||null===(o=n.progressBar)||void 0===o||o.destroy(),null===(r=this.branchesEnergyBars)||void 0===r||null===(l=r.branch3)||void 0===l||null===(c=l.progressBar)||void 0===c||c.destroy()}},{key:"playTheProphecy",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.player.disconnect(),this.onNextTick((function(){t.player.alien.play({key:"brave_run_up",startFrame:1},!0),t.player.alien.anims.currentAnim.pause(),t.leader.alien.play("dwarf_look_up")})),e.next=4,this.awaitTicks(8);case 4:this.leader.animIdle(),this.showDialog1();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onComplete",value:function(){this.scene.events.off("levelcompleted"),Object(k.a)(Object(w.a)(i.prototype),"onComplete",this).call(this),this.scene.navigateToScene("KiStageCompleted")}}]),i}(Xe);rt.key="level_ki_finale";var lt=rt,ct=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The wise move",e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a,s,n,o=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.unfinished&&t.events.once("levelstart",(function(){return o.showDialog1()})),(a=this.scene.add.image(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,"light_beam")).x=li.tileToScreen(14),a.y=li.tileToScreen(0),a.setOrigin(0,0),a.setScale(2*I),a.scaleX=2.4*I,a.setScrollFactor(1),a.depth=4.5,a.alpha=.5,s=t.add.particles("spark").setScale(I),(n=s.createEmitter()).setPosition({min:li.tileToPixels(17),max:li.tileToPixels(28)},{min:li.tileToPixels(0),max:li.tileToPixels(15)}),n.setQuantity(5),n.setFrequency(2e4),n.setAngle({min:0,max:360}),n.setSpeed(5),n.setGravityY(.1),n.setGravityX(0),n.setLifespan({min:1e4,max:5e4}),n.alpha.onChange(.5);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_2.dialog_1.mary_say_1")],options:[]}]})}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_2.dialog_2.mary_say_1")],options:[]}]})}},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&this.onComplete()}},{key:"onJewelPick",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onJewelPick",this).call(this,e),e.isClass(ui)&&1===this.collectedDiamonds&&this.unfinished&&this.showDialog2()}}]),i}(Xe);ct.key="level_2";var ht=ct,ut=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The tower",e.diamondsGoal=0,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a,s,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:(a=this.scene.add.image(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,"light_beam")).x=li.tileToScreen(20.5),a.y=li.tileToScreen(10),a.setOrigin(0,0),a.setScale(2*I),a.scaleX=I,a.setScrollFactor(1),a.depth=4.5,a.alpha=.5,s=t.add.particles("spark").setScale(I),(n=s.createEmitter()).setPosition({min:li.tileToPixels(21),max:li.tileToPixels(26)},{min:li.tileToPixels(9),max:li.tileToPixels(24)}),n.setQuantity(5),n.setFrequency(2e4),n.setAngle({min:0,max:360}),n.setSpeed(5),n.setGravityY(.1),n.setGravityX(0),n.setLifespan({min:1e4,max:5e4}),n.alpha.onChange(.5),(a=this.scene.add.image(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,"light_beam")).x=li.tileToScreen(12.5),a.y=li.tileToScreen(31),a.setOrigin(0,0),a.setScale(2*I),a.scaleX=2.25*I,a.setScrollFactor(1),a.depth=4.5,a.alpha=.5,s=t.add.particles("spark").setScale(I),(n=s.createEmitter()).setPosition({min:li.tileToPixels(15),max:li.tileToPixels(26)},{min:li.tileToPixels(29),max:li.tileToPixels(44)}),n.setQuantity(5),n.setFrequency(2e4),n.setAngle({min:0,max:360}),n.setSpeed(5),n.setGravityY(.1),n.setGravityX(0),n.setLifespan({min:1e4,max:5e4}),n.alpha.onChange(.5);case 42:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onInteractWith",value:function(e){var t=this;if(Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&this.onComplete(),e.isClass(pi)&&[1,2].includes(e.order)&&this.unfinished&&(this.showDialog1(),Object.keys(this.interactiveElements).forEach((function(e){var i=t.interactiveElements[e];i&&!i.isClass(yi)&&i.order<=2&&(t.interactiveElements[e]=null)}))),e.isClass(pi)&&3===e.order){var a=this.scene.children.getByName("layer_1").tilemap;this.player.power=1,this.player.hasPickaxe=!0,a.putTileAt(Se[_e.EMPTY],e.position.x,e.position.y,!1,"layer_1"),e.alien.destroy(),this.unfinished&&this.showDialog4()}}},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_3.dialog_1.mary_say_1")],options:[]}]})}},{key:"showDialog4",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_3.dialog_4.mary_say_1")]}]})}},{key:"onAddElement",value:function(e){if(e.isClass(pi)&&3===e.order){var t=this.scene.children.getByName("layer_1"),i=t.tilemap,a=this.scene.add.sprite(48,16).setOrigin(0,.25).play("pickaxe_idle");a.setScale(t.scaleX),a.x=i.tileToWorldX(e.position.x),a.y=i.tileToWorldY(e.position.y),e.alien=a}e.isClass(ci)&&1===this.enemiesCount&&(e.scanDirection="ACW")}}]),i}(Xe);ut.key="level_3";var dt=ut,pt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The round",e.enemiesCount=0,e.countDownAfterQuakeUntilMessage=null,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,t),![0,1,2,3,4,5,6,7].includes(t.order)){e.next=7;break}return this.player.disconnect(),e.next=5,this.playEarthquake({x1:t.position.x-9,x2:t.position.x+9,y1:t.position.y-6,y2:t.position.y+6},1);case 5:this.unfinished&&(this.countDownAfterQuakeUntilMessage=4,this.scene.events.addListener("player_moves",this.onPlayerMoves,this)),this.player.reconnect();case 7:t.isClass(yi)&&this.onComplete();case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onPlayerMoves",value:function(){null!==this.countDownAfterQuakeUntilMessage&&(this.countDownAfterQuakeUntilMessage--,0===this.countDownAfterQuakeUntilMessage&&(this.showDialog1(),this.scene.events.removeListener("player_moves",this.onPlayerMove)))}},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_4.dialog_1.mary_say_1")]}]})}},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0),e.isClass(ci)&&(this.enemiesCount++,this.enemiesCount%2===0&&(e.scanDirection="ACW"))}}]),i}(Xe);pt.key="level_4";var yt=pt,mt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The encounter",e.enemiesDeadCount=0,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.unfinished||(this.leader.alien.alpha=0,this.replaceByEmpty(this.leader));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){}},{key:"updateLight",value:function(){var e=this.scene.children.getByName("layer_1");if(!e)return!0;var t=e.tilemap,i=this.player.position;this.moveables.forEach((function(e){var t,a=d.a.Math.Distance.Snake(i.x,i.y,e.position.x,e.position.y);null===(t=e.alien)||void 0===t||t.setAlpha(1-.1*a)})),t.forEachTile((function(e){var t=d.a.Math.Distance.Snake(i.x,i.y,e.x,e.y);e.setAlpha(1-.1*t)}))}},{key:"onInteractWith",value:function(e){0===e.order&&this.onComplete()}},{key:"onAddElement",value:function(e){var t=this;e.isClass(di)&&(e.power=1,e.hasPickaxe=!0),e.isClass(hi)&&(e.leadingPath=[{x:8,y:36},{x:9,y:36},{x:10,y:36},{x:11,y:36},{x:11,y:37},{x:11,y:38},{x:11,y:39},{x:11,y:40},{x:12,y:40},{x:13,y:40},{x:14,y:40},{x:14,y:39},{x:14,y:38},{x:15,y:38},{x:16,y:38},{x:17,y:38},{x:18,y:38},{x:19,y:38},{x:20,y:38},{x:21,y:38},{x:22,y:38},{x:23,y:38},{x:24,y:38},{x:25,y:38},{x:26,y:38},{x:27,y:38},{x:28,y:38},{x:29,y:38},{x:30,y:38}],e.isCloseEnough=function(){return t.dwarfRun})}},{key:"onCharacterDie",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onCharacterDie",this).call(this,e),e.isClass(ci)&&(this.enemiesDeadCount++,1===this.enemiesDeadCount&&this.unfinished&&this.player.disconnect(),2===this.enemiesDeadCount&&this.unfinished&&this.encounter())}},{key:"encounter",value:function(){this.dwarfRun=!0,this.onNextTick(this.moveDwarf.bind(this))}},{key:"moveDwarf",value:function(){if(this.dwarfRun)if(this.leader.position.x<11)this.leader.onPlayerMoves(this.player.position),this.onNextTick(this.moveDwarf.bind(this));else{var e;if(!this.leader.alien.anims.currentAnim.key.includes("idle"))null===(e=this.leader)||void 0===e||e.animIdle();this.player.reconnect(),this.showDialog1()}}},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Dwarf","closeUp_Mary"],participantNames:["???","Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_5.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_5.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("level_5.dialog_1.mary_say_2")]},{who:"closeUp_Dwarf",text:[Ie("level_5.dialog_1.dwarf_say_2")]},{who:"closeUp_Mary",text:[Ie("level_5.dialog_1.mary_say_3")]}]})}}]),i}(Xe);mt.key="level_5";var ft=mt,vt=i(15),gt=i.n(vt),_t=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).goalCheckPoint=null,e}return Object(_.a)(i,[{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a,s,n,o,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.destroyBlock=function(){return null},this.unfinished?((a=new pi(_e.INTERACTION,this)).order=99,a.ephemeral=!1,s=this.exit.position.x-4,n=this.exit.position.y,this.interactiveElements["".concat(s,"-").concat(n)]=a,a.setPosition({x:s,y:n}),this.goalCheckPoint=a,console.log(this.goalCheckPoint)):(null===(o=this.follower)||void 0===o||null===(r=o.alien)||void 0===r||r.destroy(),this.follower=null,this.replaceByEmpty(this.leader),this.leader.alien.destroy(),this.leader=null);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e===this.goalCheckPoint&&this.unfinished&&(this.leader.position.x!==this.goalCheckPoint.position.x+1?this.showDialogAngel():this.collectedDiamonds<this.diamondsGoal?this.showDialogGoal():(this.moveToExit(),this.interactiveElements["".concat(e.position.x,"-").concat(e.position.y)]=null))}},{key:"showDialogAngel",value:function(){}},{key:"showDialogGoal",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[gt()(Ie("levels.goal_dialog.dwarf_say_1"))({GOAL:this.diamondsGoal,NUM:this.collectedDiamonds})]}]})}},{key:"moveToExit",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.player.disconnect(),this.dwarfRun=!0,this.leader.leadingPath=[{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y}],this.moveDwarfToExit(),this.scene.tweens.add({targets:this.exit.block.alien,x:li.tileToScreen(this.exit.position.x),duration:500,onComplete:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(k.a)(Object(w.a)(i.prototype),"destroyBlock",t).call(t),e.next=3,t.awaitTicks(8);case 3:t.player.reconnect();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"moveDwarfToExit",value:function(){var e=this;this.dwarfRun&&(0!==this.leader.leadingPath.length?this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarfToExit()})):(this.dwarfRun=!1,this.replaceByEmpty(this.leader),this.leader=null))}}]),i}(Xe),Et=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The deal",e.diamondsGoal=10,e.dwarfRun=!1,e.preventDisplayDiamondsGoalAmount=!0,e.diamondIdTriggerDwarfMove=4,e.exit=null,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a,s=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.unfinished&&(this.goalCheckPoint.ephemeral=!0,a=function e(t){if(t.x<4&&t.y>17){var i={x:s.exit.position.x-3,y:s.exit.position.y};s.teleportObject(s.leader,i),console.log("TELEPORT"),s.interactiveElements["".concat(s.goalCheckPoint.position.x,"-").concat(s.goalCheckPoint.position.y)]?s.goalCheckPoint.ephemeral=!1:(s.goalCheckPoint.ephemeral=!1,s.interactiveElements["".concat(s.goalCheckPoint.position.x,"-").concat(s.goalCheckPoint.position.y)]=s.goalCheckPoint)}else s.scene.events.once("player_moves",(function(t){return e(t)}))},this.scene.events.once("player_moves",(function(e){return a(e)})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&this.unfinished&&this.showDialog1(),e.isClass(yi)&&this.onComplete()}},{key:"onAddElement",value:function(e){var t=this;e.isClass(di)&&(e.power=1,e.hasPickaxe=!0),e.isClass(yi)&&(this.exit=e),e.isClass(hi)&&(e.leadingPath=[{x:10,y:9},{x:11,y:9},{x:12,y:9},{x:12,y:10},{x:12,y:10},{x:12,y:10},{x:13,y:11},{x:13,y:11},{x:13,y:11},{x:14,y:12},{x:15,y:12},{x:16,y:12},{x:17,y:12},{x:18,y:12},{x:18,y:11},{x:19,y:11},{x:20,y:11},{x:21,y:11},{x:22,y:11},{x:23,y:11},{x:24,y:11},{x:25,y:11},{x:26,y:11},{x:27,y:11},{x:28,y:11},{x:29,y:11},{x:30,y:11}],e.isCloseEnough=function(){return t.dwarfRun})}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Dwarf","closeUp_Mary"],participantNames:["???","Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_6.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_6.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("level_6.dialog_1.mary_say_2")]},{who:"closeUp_Dwarf",text:[Ie("level_6.dialog_1.dwarf_say_2")]},{who:"closeUp_Mary",text:[Ie("level_6.dialog_1.mary_say_3")]},{who:"closeUp_Dwarf",text:[Ie("level_6.dialog_1.dwarf_say_3")]},{who:"closeUp_Mary",text:[Ie("level_6.dialog_1.mary_say_4")]},{who:"closeUp_Dwarf",text:[Ie("level_6.dialog_1.dwarf_say_4")]},{who:"closeUp_Dwarf",text:[Ie("level_6.dialog_1.dwarf_say_5")]},{who:"closeUp_Mary",text:[Ie("level_6.dialog_1.mary_say_5")]}]}),this.scene.events.once("dialogue:hidden",(function(){e.player.disconnect(),e.dwarfRun=!0,e.moveDwarf()}))}},{key:"showDialogAngel",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_6.dialog_2.mary_say_1")]}]})}},{key:"moveToExit",value:function(){var e=this;this.scene.events.on("dialogue:message_shown",(function(t){2===t&&e.scene.events.emit("dialogue:updateCharacterName",{key:"closeUp_Dwarf",name:"Doc"})})),this.scene.events.once("dialogue:hidden",(function(){Object(k.a)(Object(w.a)(i.prototype),"moveToExit",e).call(e)})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","???"],conversation:[{who:"closeUp_Mary",text:[Ie("level_6.dialog_3.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_6.dialog_3.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("level_6.dialog_3.mary_say_2")]},{who:"closeUp_Dwarf",text:[Ie("level_6.dialog_3.dwarf_say_2")]}]})}},{key:"showDialogGoal",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","???"],conversation:[{who:"closeUp_Dwarf",text:[gt()(Ie("levels.goal_dialog.dwarf_say_1"))({GOAL:this.diamondsGoal,NUM:this.collectedDiamonds})]}]})}},{key:"moveDwarf",value:function(){var e=this;if(this.dwarfRun)if(this.leader.position.x<16)this.leader.onPlayerMoves(this.player.position),this.onNextTick((function(){e.leader.animIdle(),e.moveDwarf()}));else{this.leader.animIdle(),this.player.reconnect(),setTimeout((function(){return e.scene.events.emit("score:diamond_goal_set",e.diamondsGoal)}),1e3);var t=function(){e.leader.position.x>=30&&(e.dwarfRun=!1,e.scene.events.removeListener("player_moves",t))}.bind(this);this.scene.events.addListener("player_moves",t)}}},{key:"moveDwarfToExit",value:function(){var e=this;this.dwarfRun&&(this.leader.position.x<this.exit.position.x?this.onNextTick((function(){e.leader.onPlayerMoves(e.player.position),e.moveDwarfToExit()})):(this.leader.animIdle(),this.player.reconnect()))}}]),i}(_t);Et.key="level_6";var Ot=Et,St=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The dangerous chambers",e.diamondsGoal=12,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,t),t===this.goalCheckPoint||t.isClass(yi)){e.next=6;break}return this.player.disconnect(),e.next=5,this.playEarthquake({x1:t.position.x-3,x2:t.position.x+5,y1:t.position.y-10,y2:t.position.y},2);case 5:this.player.reconnect();case 6:t.isClass(yi)&&this.onComplete();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_t);St.key="level_7";var Tt=St,xt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The Sisyphean task",e.diamondsGoal=40,e.dwarf=null,e.broSprite=null,e.grayscalePipeline=null,e.tripMusic=null,e.firstVisit=!0,e.tookTheTrip=!1,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:return e.next=4,Ke.get("tripDone");case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=!1;case 7:this.tookTheTrip=e.t0,this.tookTheTrip?(this.replaceByEmpty(this.leader),this.leader.alien.destroy(),this.leader=null,Object.keys(this.interactiveElements).forEach((function(e){a.interactiveElements[e].isClass(yi)||(a.interactiveElements[e]=null)}))):(this.broSprite=this.scene.add.sprite(48,16).setOrigin(0,.25),this.broSprite.setScale(I),this.broSprite.play("bro_idle"),this.broSprite.x=this.dwarf.alien.x+li.tileToScreen(12),this.broSprite.y=this.dwarf.alien.y,this.grayscalePipeline=this.scene.renderer.pipelines.get("Gray"),this.player.alien.setPipeline(this.grayscalePipeline),this.tripMusic=this.scene.sound.add("swarf_chat_music",{loop:!0,valume:0}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onComplete",value:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.set("tripDone",this.tookTheTrip);case 2:Object(k.a)(Object(w.a)(i.prototype),"onComplete",this).call(this);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&(this.firstVisit?this.totalShroomsAmount>0?this.showDialog1():this.showDialog1NoShroom():this.showDialog1Revisit(),this.firstVisit=!1),e.isClass(yi)&&this.onComplete()}},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0),e.isClass(pi)&&(e.ephemeral=!1),e.isClass(hi)&&(e.isCloseEnough=function(){return!1},this.dwarf=e)}},{key:"showDialog1NoShroom",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("level_8.dialog_1_no_shrooms.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_1_no_shrooms.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("level_8.dialog_1_no_shrooms.mary_say_2")]},{who:"closeUp_Dwarf",text:[gt()(Ie("level_8.dialog_1_no_shrooms.dwarf_say_2"))({NUM:5})]}]})}},{key:"showDialog1Revisit",value:function(){var e=this;this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_1_repeat.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("level_8.dialog_1_repeat.mary_say_1")],options:{slot0:{label:Ie("level_8.dialog_1_option.yes"),slot:0,onSelect:function(){return e.scene.events.emit("dialogue:nextPage")}},slot1:{label:Ie("level_8.dialog_1_option.no"),slot:1,onSelect:function(){return e.scene.events.emit("dialogue:nextPage",1)}},slot2:null,slot3:null}},{who:"closeUp_Mary",text:[Ie("level_8.dialog_1_repeat.mary_say_2_yes")],options:{slot2:null,slot3:{label:Ie("menu.dialog_options.close"),slot:3,onSelect:function(){e.scene.events.emit("dialogue:hide"),e.scene.events.once("dialogue:hidden",(function(){e.playTheTrip(),e.scene.events.emit("score:mushroom_given"),e.collectedShrooms--,e.tookTheTrip=!0}))}}}},{who:"closeUp_Mary",text:[Ie("level_8.dialog_1_repeat.mary_say_2_no")]}]})}},{key:"showDialog1",value:function(){var e=this;this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("level_8.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("level_8.dialog_1.mary_say_2")],options:{slot0:{label:Ie("level_8.dialog_1_option.yes"),slot:0,onSelect:function(){return e.scene.events.emit("dialogue:nextPage")}},slot1:{label:Ie("level_8.dialog_1_option.no"),slot:1,onSelect:function(){return e.scene.events.emit("dialogue:nextPage",1)}},slot2:null,slot3:null}},{who:"closeUp_Mary",text:[Ie("level_8.dialog_1.mary_say_3_yes")],options:{slot2:null,slot3:{label:Ie("menu.dialog_options.close"),slot:3,onSelect:function(){e.scene.events.emit("dialogue:hide"),e.scene.events.once("dialogue:hidden",(function(){e.playTheTrip(),e.scene.events.emit("score:mushroom_given"),e.collectedShrooms--,e.tookTheTrip=!0}))}}}},{who:"closeUp_Mary",text:[Ie("level_8.dialog_1.mary_say_3_no")]}]})}},{key:"showDialog2",value:function(){var e=this;return new Promise((function(t){e.scene.events.emit("dialogue:show",{participants:["closeUp_Dwarf","closeUp_Marduk"],participantNames:["Doc","Marduk"],conversation:[{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_2.dwarf_say_1")]},{who:"closeUp_Marduk",text:[Ie("level_8.dialog_2.marduk_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_2.dwarf_say_2")]},{who:"closeUp_Marduk",text:[Ie("level_8.dialog_2.marduk_say_2")]},{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_2.dwarf_say_3")]},{who:"closeUp_Marduk",text:[Ie("level_8.dialog_2.marduk_say_3")]},{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_2.dwarf_say_4")]},{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_2.dwarf_say_5")]},{who:"closeUp_Marduk",text:[Ie("level_8.dialog_2.marduk_say_4")]},{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_2.dwarf_say_6")]},{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_2.dwarf_say_7")]}]}),e.scene.events.once("dialogue:hidden",(function(){setTimeout(t,500)}))}))}},{key:"showDialog3",value:function(){var e=this;return new Promise((function(t){e.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("level_8.dialog_3.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_3.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("level_8.dialog_3.mary_say_2")]},{who:"closeUp_Dwarf",text:[Ie("level_8.dialog_3.dwarf_say_2")]}]}),e.scene.events.once("dialogue:hidden",(function(){setTimeout(t,500)}))}))}},{key:"playTheTrip",value:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.player.disconnect(),e.next=3,this.animFadeOutLevel();case 3:return e.next=5,this.moveCamera();case 5:return this.animPlayerAndDwarf(),e.next=8,this.animBroEntrance();case 8:return e.next=10,this.showDialog2();case 10:return e.next=12,this.vanishBro();case 12:return e.next=14,this.animDwarfMoveCloseToPlayer();case 14:return e.next=16,this.showDialog3();case 16:return e.next=18,this.vanishDwarf();case 18:return e.next=20,this.animFadeInLevel();case 20:this.restoreRegularGamePlay();case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"restoreRegularGamePlay",value:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.interactiveElements["".concat(this.player.position.x,"-").concat(this.player.position.y)]=null,this.setObjectAt(this.dwarf.position.x,this.dwarf.position.y,new Ce(_e.EMPTY,this)),e.next=4,this.scene.rules.panAndFollow(this.player.alien);case 4:this.player.reconnect();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"vanishDwarf",value:function(){var e=this;return new Promise((function(t){e.scene.tweens.add({targets:e.player.alien,x:e.player.alien.x+li.tileToScreen(2),duration:3e3,ease:"Linear",onComplete:function(){}}),e.scene.tweens.add({targets:[e.dwarf.alien],duration:3e3,alpha:0,x:e.dwarf.alien.x+li.tileToScreen(2),onComplete:t}),e.scene.tweens.add({targets:e.scene.rules.music,volume:1,delay:1500,ease:"Linear",duration:1e3}),e.scene.tweens.add({targets:e.tripMusic,volume:0,ease:"Linear",duration:1e3,onComplete:function(){return e.tripMusic.stop()}})}))}},{key:"vanishBro",value:function(){var e=this;return new Promise((function(t){e.scene.tweens.add({targets:e.broSprite,duration:2e3,alpha:0,onComplete:t})}))}},{key:"animBroEntrance",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.scene.tweens.add({targets:t.broSprite,x:t.broSprite.x-li.tileToScreen(10),duration:2500,ease:"Linear",delay:2500,onComplete:function(){t.player.animIdle(),t.dwarf.animIdle(),t.dwarf.animRunRight(),e()}})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animDwarfMoveCloseToPlayer",value:function(){var e=this;return new Promise((function(t){e.dwarf.animRunLeft(),e.dwarf.animRun(),e.scene.tweens.add({targets:e.dwarf.alien,x:e.dwarf.alien.x-li.tileToScreen(1),duration:N,ease:"Linear",onComplete:function(){e.dwarf.animIdle(),e.dwarf.animRunRight(),e.scene.tweens.add({targets:e.grayscalePipeline,duration:1e3,gray:0,completeDelay:1e3,onComplete:t})}})}))}},{key:"animPlayerAndDwarf",value:function(){var e=this;this.dwarf.animRunRight(),this.dwarf.animRun(),this.scene.tweens.add({targets:this.player.alien,x:this.player.alien.x-li.tileToScreen(2),duration:500,ease:"Linear",onComplete:function(){e.player.animRun()}})}},{key:"moveCamera",value:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.scene.rules.panAndFollow({x:this.dwarf.alien.x+5,y:this.dwarf.alien.y,width:1,height:1}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"animFadeInLevel",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.scene.tweens.add({targets:{alpha:0},alpha:1,ease:"Linear",duration:2e3,onUpdate:function(e,i){t.setLevelAlpha(i.alpha)},onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animFadeOutLevel",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.scene.tweens.add({targets:t.grayscalePipeline,delay:1e3,duration:1e3,gray:1}),t.scene.tweens.add({targets:{alpha:1},alpha:0,ease:"Linear",duration:1e3,onUpdate:function(e,i){t.setLevelAlpha(i.alpha)},onComplete:e}),t.scene.tweens.add({targets:t.scene.rules.music,volume:0,ease:"Linear",duration:1e3}),t.tripMusic.volume=0,t.tripMusic.play(),t.scene.tweens.add({targets:t.tripMusic,volume:1,delay:500,ease:"Linear",duration:1e3})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setLevelAlpha",value:function(e){var t=this.scene.children.getByName("layer_1"),i=this.scene.children.getByName("layer_1z2"),a=this.scene.children.getByName("layer_2"),s=this.scene.children.getByName("layer_0"),n=this.scene.children.getByName("level_background_art");t.setAlpha(e),i.setAlpha(e),a.setAlpha(e),s.setAlpha(e),n.setAlpha(e/4),this.objects.forEach((function(t){return t.forEach((function(t){!t.alien||t.isClass(di)||t.isClass(hi)||t.alien.setAlpha(e)}))})),Object.values(this.decorationElements).forEach((function(t){return t.alien.setAlpha(e)}))}}]),i}(Xe);xt.key="level_8";var bt=xt,At=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The floodgates",e.diamondsGoal=10,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&this.onComplete()}},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_t);At.key="level_9";var kt=At,wt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).easystar=new at.a.js,e.name="The castle",e.diamondsGoal=10,e.exit=null,e.dwarf=null,e.dwarfRun=!1,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a,s=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.unfinished?(this.destroyBlock=function(){return!1},a=this.objects.map((function(e){return e.map((function(e){return e.isClass(hi)||e.isClass(Ce)?0:1}))})),this.easystar.setGrid(a),this.easystar.setAcceptableTiles([0]),this.easystar.findPath(this.leader.position.x,this.leader.position.y,this.exit.position.x-3,this.exit.position.y,(function(e){s.leader.leadingPath=e.slice(1)})),this.easystar.calculate()):(this.leader.alien.alpha=0,this.replaceByEmpty(this.leader));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&this.unfinished&&this.showDialog1(),1===e.order&&this.unfinished&&(this.diamondsGoal<=this.collectedDiamonds?this.clearPath():this.showDialog3()),e.isClass(yi)&&this.onComplete()}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.player.disconnect(),e.dwarfRun=!0,e.moveDwarf()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("level_10.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_10.dialog_1.dwarf_say_1")]}]})}},{key:"showDialog2",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.scene.events.off("player_moves"),e.player.reconnect()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_10.dialog_2.mary_say_1")]}]})}},{key:"showDialog3",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[gt()(Ie("level_10.dialog_3.dwarf_say_1"))({NUM:this.diamondsGoal})]}]})}},{key:"moveDwarf",value:function(){var e=this;this.dwarfRun?(this.leader.leadingPath.length||(this.dwarfRun=!1),this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarf()}))):this.leader.animIdle(),10===this.leader.leadingPath.length&&(this.leader.animIdle(),this.showDialog2())}},{key:"clearPath",value:function(){var e=this;this.scene.tweens.add({targets:this.exit.block.alien,x:li.tileToScreen(this.exit.position.x),duration:500,onComplete:function(){return e.exit.block.alien.destroy()}}),this.leader.leadingPath=[{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y}],this.player.disconnect(),this.dwarfRun=!0,this.moveDwarfToExit()}},{key:"moveDwarfToExit",value:function(){var e=this;this.dwarfRun&&(this.leader.position.x<this.exit.position.x?this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarfToExit()})):(this.onNextTick((function(){e.replaceByEmpty(e.leader)})),this.player.reconnect()))}},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0),e.isClass(yi)&&(this.exit=e),e.isClass(pi)&&1===e.order&&(e.ephemeral=!1,this.scene.events.once("score:diamond_goal",(function(){return e.ephemeral=!0})))}}]),i}(Xe);wt.key="level_10";var Nt=wt,Rt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).easystar=new at.a.js,e.name="The fallen city",e.diamondsGoal=14,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.unfinished&&(this.destroyBlock=function(){return!1}),t.events.once("barre:explode",(function(e){a.setTickTimeout((function(e){return e.showDialog2()}),5)}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onInteractWith",value:function(e){var t=this;if(Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&this.unfinished&&this.showDialog1(),1===e.order&&this.unfinished&&this.showDialog3(),2===e.order&&this.unfinished){var a={x:this.exit.position.x-3,y:this.exit.position.y};this.leader.alien.alpha=0,this.moveObject(this.leader,a),setTimeout((function(){t.leader.alien.alpha=1,t.scene.events.on("player_moves",(function(e){t.leader.testProximity(e,1,!0)&&(t.diamondsGoal<=t.collectedDiamonds?(t.clearPath(),t.scene.events.off("player_moves")):t.showDialog4())}))}),500)}e.isClass(yi)&&this.onComplete()}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){var t=e.objects.map((function(e){return e.map((function(e){return e.isClass(hi)||e.isClass(Ce)?0:1}))}));e.easystar.setGrid(t),e.easystar.setAcceptableTiles([0]),e.scene.events.off("player_moves"),e.player.disconnect(),e.easystar.enableDiagonals(),e.easystar.findPath(e.leader.position.x,e.leader.position.y,1,10,(function(t){e.leader.leadingPath=t.slice(1),e.easystar.findPath(1,10,7,18,(function(t){e.leader.leadingPath=[].concat(Object(p.a)(e.leader.leadingPath),Object(p.a)(t.slice(1))).reduce((function(e,t,i,a){if(a[i-1]){var s=a[i-1];o=s,(n=t).x!==o.x&&n.y!==o.y&&e.push(s)}var n,o;return e.push(t),e}),[]),e.dwarfRun=!0,e.moveDwarf(),e.setTickTimeout((function(e){return e.player.reconnect()}),4)})),e.easystar.calculate()})),e.easystar.calculate()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("level_11.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_11.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("level_11.dialog_1.mary_say_2")]},{who:"closeUp_Dwarf",text:[Ie("level_11.dialog_1.dwarf_say_2")]},{who:"closeUp_Dwarf",text:[Ie("level_11.dialog_1.dwarf_say_3")]},{who:"closeUp_Mary",text:[Ie("level_11.dialog_1.mary_say_3")]},{who:"closeUp_Dwarf",text:[Ie("level_11.dialog_1.dwarf_say_4")]}]})}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_11.dialog_2.mary_say_1")]}]})}},{key:"showDialog3",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[Ie("level_11.dialog_3.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("level_11.dialog_3.mary_say_1")]}]})}},{key:"showDialog4",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[gt()(Ie("level_11.dialog_4.dwarf_say_1"))({NUM:this.diamondsGoal})]}]})}},{key:"moveDwarf",value:function(){var e=this;this.dwarfRun?(this.leader.leadingPath.length||(this.dwarfRun=!1),this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarf()}))):this.leader.animIdle()}},{key:"clearPath",value:function(){var e=this;this.scene.tweens.add({targets:this.exit.block.alien,x:li.tileToScreen(this.exit.position.x),duration:500,onComplete:function(){return e.exit.block.alien.destroy()}}),this.leader.leadingPath=[{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y}],this.player.disconnect(),this.dwarfRun=!0,this.moveDwarfToExit()}},{key:"moveDwarfToExit",value:function(){var e=this;this.dwarfRun&&(this.leader.position.x<this.exit.position.x?this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarfToExit()})):(this.onNextTick((function(){e.replaceByEmpty(e.leader)})),this.player.reconnect()))}},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0),e.isClass(hi)&&(e.leadingPath=[]),e.isClass(yi)&&(this.exit=e)}}]),i}(Xe);Rt.key="level_11";var It=Rt,Dt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="Time trial",e.diamondsGoal=7,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&this.onComplete()}},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_t);Dt.key="level_12";var Mt=Dt,Ut=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="Risky business",e.diamondsGoal=9,e.interactiveCounts=0,e.quakeTriggerIndex=Math.trunc(100*Math.random())%4,e.playerOriginPosition=null,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.playerOriginPosition=Object(Qe.a)({},this.player.position);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onInteractWith",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,t),t.isClass(yi)&&this.onComplete(),!t.isClass(pi)){e.next=11;break}if(this.interactiveCounts!==this.quakeTriggerIndex){e.next=10;break}return this.player.disconnect(),17,11,e.next=9,this.playEarthquake({x1:this.playerOriginPosition.x-17-1,x2:this.playerOriginPosition.x-1,y1:t.position.y-11,y2:this.playerOriginPosition.y},3);case 9:this.player.reconnect();case 10:this.interactiveCounts++;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_t);Ut.key="level_13";var Ct=Ut,Lt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="Short fuse",e.diamondsGoal=10,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){var t=this;Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&this.onComplete(),e.isClass(yi)||(this.player.impersonateRockford=!0,this.player.hasPickaxe=!1,this.player.animIdle(),this.scene.events.on("player_moves",(function(i){i.x===e.position.x&&i.y===e.position.y||(t.player.impersonateRockford=!1,t.player.hasPickaxe=!0)})))}},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0),e.isClass(yi)||(e.ephemeral=!1)}}]),i}(_t);Lt.key="level_14";var Pt=Lt,jt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The catacomb",e.diamondsGoal=15,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&this.onComplete()}},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_t);jt.key="level_15";var Bt=jt,Ht=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The sanctuary",e.diamondsGoal=25,e.wasInSanctuary=!1,e.maryTalkedToDocAboutTheSactuary=!1,e.quakeTrigger=null,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a,s,n=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.scene.add.text(li.tileToScreen(this.follower.position.x-.3),li.tileToScreen(this.follower.position.y+2.5),"\ud808\udc2d\ud808\udf13",{fontFamily:"GameGirl",fill:"#503F35",align:"right"}).setScale(I),this.scene.add.text(li.tileToScreen(this.follower.position.x-.25),li.tileToScreen(this.follower.position.y+2.55),"\ud808\udc2d\ud808\udf13",{fontFamily:"GameGirl",fill:"#947E6C",align:"right"}).setScale(I),this.unfinished?(this.follower.isFollowing=!1,this.destroyBlock=function(){return!1},this.follower.animLayRight()):((a=function(e,t){var i=n.getObjectAt(e,t);i.overrunBy(),n.replaceByEmpty(i)})(this.quakeTrigger.position.x-1,this.quakeTrigger.position.y+1),a(this.quakeTrigger.position.x-2,this.quakeTrigger.position.y+1),a(this.quakeTrigger.position.x-3,this.quakeTrigger.position.y+1),(s=function(e,t){var i=n.getObjectAt(e,t);i.overrunBy(),n.replaceByEmpty(i)})(this.quakeTrigger.position.x+1,this.quakeTrigger.position.y-1),s(this.quakeTrigger.position.x+2,this.quakeTrigger.position.y-1),this.follower.alien.destroy(),this.follower=null,this.replaceByEmpty(this.leader),this.leader.alien.destroy(),this.leader=null,Object.keys(this.interactiveElements).forEach((function(e){n.interactiveElements[e].isClass(yi)||(n.interactiveElements[e]=null)})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onInteractWith",value:function(e){(Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&(this.unfinished?this.goToSanctuary():this.onComplete()),e.isClass(pi)&&0===e.order&&this.playTheSighting(e),e.isClass(pi)&&2===e.order)&&(this.collectedDiamonds>=this.diamondsGoal&&(this.interactiveElements["".concat(e.position.x,"-").concat(e.position.y)]=null),this.maryTalkedToDocAboutTheSactuary?this.showDialog2_repeat():this.showDialog2());e===this.sanctuaryEntrance&&this.wasInSanctuary&&this.onComplete()}},{key:"onAddElement",value:function(e){if(e.isClass(di)&&(e.power=1,e.hasPickaxe=!0),e.isClass(ci)&&(e.scanDirection="CCW"),e.isClass(pi)&&2===e.order&&(e.ephemeral=!1),e.isClass(pi)&&0===e.order&&(this.quakeTrigger=e),e.isClass(pi)&&1===e.order&&(e.ephemeral=!1,this.sanctuaryEntrance=e),e.isClass(yi)&&this.unfinished){var t=this.scene.children.getByName("layer_1z2");this.scene.children.getByName("layer_2").copy(e.position.x-2,e.position.y-2,5,5,this.sanctuaryEntrance.position.x-2,this.sanctuaryEntrance.position.y-2),t.copy(e.position.x-2,e.position.y-2,5,5,this.sanctuaryEntrance.position.x-2,this.sanctuaryEntrance.position.y-2)}}},{key:"playTheSighting",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.player.disconnect(),e.next=3,this.playEarthquake({x1:this.player.position.x-3,x2:this.player.position.x+3,y1:this.player.position.y-1,y2:this.player.position.y+2},4);case 3:return e.next=5,this.awaitTicks(10);case 5:return this.player.animPushRight(),e.next=8,this.awaitTicks(4);case 8:return this.player.animPushRight(),this.onNextTick((function(){return t.player.animPushRight()})),e.next=12,this.awaitTicks(4);case 12:return e.next=14,this.showDialog1();case 14:this.player.reconnect();case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showDialog1",value:function(){var e=this;return new Promise((function(t){e.scene.events.once("dialogue:hidden",t),e.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_16.dialog_1.mary_say_1")]},{who:"closeUp_Mary",text:[Ie("level_16.dialog_1.mary_say_2")]},{who:"closeUp_Mary",text:[Ie("level_16.dialog_1.mary_say_3")]}]})}))}},{key:"showDialog2",value:function(){var e=this;this.maryTalkedToDocAboutTheSactuary=!0;var t=this.collectedDiamonds>=this.diamondsGoal;this.scene.events.once("dialogue:hidden",(function(){t&&e.moveToExit()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("level_16.dialog_2.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_16.dialog_2.dwarf_say_1")],options:{slot2:{label:Ie("menu.dialog_options.next"),slot:2,onSelect:function(){e.collectedDiamonds<e.diamondsGoal?e.scene.events.emit("dialogue:nextPage"):e.scene.events.emit("dialogue:nextPage",1)}}}},{who:"closeUp_Dwarf",text:[gt()(Ie("level_16.dialog_2.dwarf_say_2_diamonds"))({NUM:this.diamondsGoal})],options:{slot2:null}},{who:"closeUp_Mary",text:[Ie("level_16.dialog_2.mary_say_2")]}]})}},{key:"showDialog2_repeat",value:function(){var e=this,t=this.collectedDiamonds>=this.diamondsGoal;this.scene.events.once("dialogue:hidden",(function(){t&&e.moveToExit()}));var i={who:"closeUp_Mary",text:[Ie("level_16.dialog_2_repeat.mary_say_1")]},a={who:"closeUp_Dwarf",text:[gt()(Ie("level_16.dialog_2_repeat_no_diamonds.dwarf_say_1"))({NUM:this.diamondsGoal})]};this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[t?i:a]})}},{key:"moveToExit",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dwarfRun=!0,this.leader.leadingPath=[{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y}],this.scene.tweens.add({targets:this.exit.block.alien,x:li.tileToScreen(this.exit.position.x),duration:500,onComplete:function(){t.exit.block.alien.destroy()}}),this.interactiveElements["".concat(this.exit.position.x,"-").concat(this.exit.position.y)]=null,this.exit.setPosition({x:this.exit.position.x+1,y:this.exit.position.y}),this.moveDwarf(),e.next=8,this.awaitTicks(this.leader.leadingPath.length);case 8:return e.next=10,this.teleportObject(this.leader,this.sanctuaryEntrance.position);case 10:this.exit.setPosition({x:this.exit.position.x-1,y:this.exit.position.y}),this.interactiveElements["".concat(this.exit.position.x,"-").concat(this.exit.position.y)]=this.exit;case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"moveDwarf",value:function(){var e=this;this.dwarfRun&&(this.leader.leadingPath.length?this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarf()})):(this.dwarfRun=!1,this.leader.animIdle()))}},{key:"movePlayer",value:function(){var e=this;this.playerRun&&this.onNextTick((function(){e.player.moveToNextPosition()?e.movePlayer():e.playerRun=!1}))}},{key:"goToSanctuary",value:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.player.disconnect(),this.focusElement={position:this.sanctuaryEntrance.position},e.next=4,this.awaitTicks(7);case 4:return this.follower.alien.alpha=0,e.next=7,this.teleportObject(this.player,this.sanctuaryEntrance.position);case 7:return this.player.mandatoryPath=[{x:this.sanctuaryEntrance.position.x-1,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-2,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-3,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-4,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-5,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-6,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-7,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-8,y:this.sanctuaryEntrance.position.y}],this.playerRun=!0,this.movePlayer(),e.next=12,this.awaitTicks(1);case 12:return this.leader.leadingPath=[{x:this.sanctuaryEntrance.position.x-1,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-2,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-3,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-4,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-5,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-6,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-7,y:this.sanctuaryEntrance.position.y}],this.dwarfRun=!0,this.moveDwarf(),e.next=17,this.awaitTicks(this.leader.leadingPath.length);case 17:return e.next=19,this.awaitTicks(3);case 19:this.showDialog3();case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"moveDocToFinalExit",value:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.leader.leadingPath=[{x:this.sanctuaryEntrance.position.x,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-1,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-2,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-3,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-4,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-5,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-6,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-7,y:this.sanctuaryEntrance.position.y}].reverse(),this.dwarfRun=!0,this.moveDwarf(),e.next=5,this.awaitTicks(this.leader.leadingPath.length+2);case 5:this.leader.alien.destroy(),this.leader.alien=null,this.replaceByEmpty(this.leader);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showDialog3",value:function(){var e=this;this.scene.events.once("dialogue:hidden",Object(h.a)(c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.wasInSanctuary=!0,t.next=3,e.moveDocToFinalExit();case 3:e.player.reconnect();case 4:case"end":return t.stop()}}),t)})))),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("level_16.dialog_3.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_16.dialog_3.dwarf_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_16.dialog_3.dwarf_say_2")]}]})}}]),i}(Xe);Ht.key="level_16";var Gt=Ht,Ft=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.apply(this,arguments)}return Object(_.a)(i,[{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:t.lights.enable().setAmbientColor(0),t.children.getByName("layer_0").setPipeline("Light2D"),t.children.getByName("layer_1").setPipeline("Light2D"),t.children.getByName("layer_2").setPipeline("Light2D"),t.children.getByName("layer_1z2").setPipeline("Light2D"),this.moveables.forEach((function(e){var t,i;return!e.isClass(di)&&(null===(t=e.alien)||void 0===t?void 0:t.active)&&(null===(i=e.alien)||void 0===i?void 0:i.setPipeline("Light2D"))})),Object.values(this.decorationElements).forEach((function(e){var t;return null===(t=e.alien)||void 0===t?void 0:t.setPipeline("Light2D")})),this.scene.events.on("player_moves",(function(e){a.updateLight(e)})),this.unfinished&&(this.staticlight=t.lights.addLight(li.tileToScreen(this.exit.position.x),li.tileToScreen(this.exit.position.y),1e3).setColor(15124680).setIntensity(1.5),t.time.addEvent({delay:100,callback:function(){!this.exit.block.alien.active&&this.staticlight.intensity>0&&this.staticlight.setIntensity(this.staticlight.intensity-.5),d.a.Geom.Ellipse.Random(this.exit.block.alien,this.staticlight)},callbackScope:this,repeat:-1}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onAddElement",value:function(e){if(Object(k.a)(Object(w.a)(i.prototype),"onAddElement",this).call(this,e),e.isClass(yi)){var t=this.scene.children.getByName("layer_2"),a=t.tilemap;this.exitEye=this.scene.add.sprite(48,16,"spark").setOrigin(.5,.5),this.exitEye.setTintFill(13784064),this.exitEye.setScale(2*t.scaleX,4*t.scaleX),this.exitEye.x=a.tileToWorldX(e.position.x-.5),this.exitEye.y=a.tileToWorldY(e.position.y-.4),this.exitEye.depth=100,this.exitEye.alpha=0}}},{key:"updateLight",value:function(e){var t,i,a;if(!this.exit||!this.player.torch)return!1;if(e.x===this.exit.position.x-3&&e.y===this.exit.position.y)null===(i=this.player.light)||void 0===i||i.setRadius(500),null===(a=this.player.light)||void 0===a||a.setIntensity(1.3),this.eyeAnimation&&(this.exitEye.alpha=0,this.eyeAnimation.remove());else if(e.x===this.exit.position.x-2&&e.y===this.exit.position.y){var s,n;null===(s=this.player.light)||void 0===s||s.setRadius(250),null===(n=this.player.light)||void 0===n||n.setIntensity(.8),this.eyeAnimation&&this.eyeAnimation.remove(),this.exitEye.alpha=.1,this.eyeAnimation=this.scene.tweens.add({targets:this.exitEye,alpha:.2,duration:100,yoyo:!0,repeat:-1})}else if(e.x===this.exit.position.x-1&&e.y===this.exit.position.y){var o,r;null===(o=this.player.light)||void 0===o||o.setIntensity(.3),null===(r=this.player.light)||void 0===r||r.setRadius(125),this.eyeAnimation&&this.eyeAnimation.remove(),this.exitEye.alpha=.3,this.eyeAnimation=this.scene.tweens.add({targets:this.exitEye,alpha:.5,duration:100,yoyo:!0,repeat:-1})}else if(e.x===this.exit.position.x&&e.y===this.exit.position.y){var l;null===(l=this.player.light)||void 0===l||l.setIntensity(.1)}else if(1.5!==(null===(t=this.player.light)||void 0===t?void 0:t.intensity)){var c,h;null===(c=this.player.light)||void 0===c||c.setIntensity(1.5),null===(h=this.player.light)||void 0===h||h.setRadius(1e3)}}}]),i}(_t),Wt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="Into the dark",e.diamondsGoal=10,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.unfinished&&this.scene.events.once("player_moves",(function(e){a.detectDocTeleporting(e)}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"detectDocTeleporting",value:function(e){var t=this;e.y>45&&this.leader.position.y<10?this.teleportObject(this.leader,{x:this.exit.position.x-3,y:this.exit.position.y}):this.scene.events.once("player_moves",(function(e){t.detectDocTeleporting(e)}))}},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&this.onComplete(),e.isClass(pi)&&0===e.order&&this.unfinished&&this.showDialog1(),e.isClass(pi)&&1===e.order&&this.unfinished&&(this.collectedDiamonds<this.diamondsGoal?this.showDialogGoal():(this.moveToExit(),this.interactiveElements["".concat(e.position.x,"-").concat(e.position.y)]=null))}},{key:"onAddElement",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onAddElement",this).call(this,e),e.isClass(di)&&(e.power=1,e.hasPickaxe=!0,e.alien.alpha=.5,this.onNextTick((function(t){t.unfinished||e.ligthTorch()}))),e.isClass(vi)&&0===e.order&&e.ignite(),e.isClass(pi)&&1===e.order&&(e.ephemeral=!1)}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.player.ligthTorch(),e.setTickTimeout((function(){e.showDialog2()}),10)})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Dwarf","closeUp_Mary"],participantNames:["Doc","Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_17.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_17.dialog_1.dwarf_say_1")]}]})}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Dwarf","closeUp_Mary"],participantNames:["Doc","Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_17.dialog_2.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("level_17.dialog_2.dwarf_say_1")]}]})}}]),i}(Ft);Wt.key="level_17";var Yt=Wt,Vt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The blind side",e.diamondsGoal=10,e.quakePlayed=!1,e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&this.onComplete(),e.isClass(pi)&&0===e.order&&this.playDropTorchIncident(e)}},{key:"playDropTorchIncident",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.player.disconnect(),e.next=3,this.playEarthquake({x1:t.position.x-3,x2:t.position.x,y1:t.position.y-3,y2:t.position.y},4);case 3:return e.next=5,this.awaitTicks(2);case 5:this.unfinished&&this.displayIncidentDialog(),this.player.alien.setPipeline("Light2D"),this.player.setOffTorch(),this.scene.children.getByName("layer_0").resetPipeline("Light2D");case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"displayIncidentDialog",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.player.reconnect()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_18.dialog_incident.mary_say_1")]}]})}},{key:"displayIncidentRecoveryDialog",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_18.dialog_incident_recovery.mary_say_1")]}]})}},{key:"recoveryFromDropTorch",value:function(){this.player.ligthTorch(),this.player.alien.resetPipeline("Light2D"),this.scene.children.getByName("layer_0").setPipeline("Light2D"),this.unfinished&&this.displayIncidentRecoveryDialog()}},{key:"onAddElement",value:function(e){var t=this;Object(k.a)(Object(w.a)(i.prototype),"onAddElement",this).call(this,e),e.isClass(di)&&(e.power=1,e.hasPickaxe=!0,e.ligthTorch()),e.isClass(vi)&&4===e.order&&(e.ignite(),e.proximityTrigger=function(){t.player.torch||t.recoveryFromDropTorch()})}}]),i}(Ft);Vt.key="level_18";var Kt=Vt,Xt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The Maze",e.easystar=new at.a.js,e.solvingPath=[],e.isMaze=!0,e.exitEye=null,e.dwarfRun=!1,e.buyLeadingWithShrooms=!1,e}return Object(_.a)(i,[{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a,s,n,o=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:t.lights.enable().setAmbientColor(0),a=this.objects.map((function(e){return e.map((function(e){return e.isClass(hi)||e.isClass(Ce)?0:1}))})),this.easystar.setGrid(a),this.easystar.setAcceptableTiles([0]),this.easystar.findPath(this.leader.position.x,this.leader.position.y,this.exit.position.x,this.exit.position.y,(function(e){null===e?o.shouldRestart=!0:(o.solvingPath=e.slice(1),o.leader.personalSpace=10)})),this.easystar.calculate(),t.events.once("levelstart",(function(){if(o.shouldRestart)t.levels.restart();else if(o.unfinished){o.totalShroomsAmount>0?o.showDialog1():o.showDialog1_no_shrooms();t.events.once("player_moves",(function e(){if(o.leader.leadingPath.length<o.solvingPath.length/3){o.leader.personalSpace=2;var i=o.solvingPath.at(-o.leader.leadingPath.length-4),a=new pi(_e.INTERACTION,o);a.order=9;var s=i.x,n=i.y;o.interactiveElements["".concat(s,"-").concat(n)]=a,a.setPosition({x:s,y:n})}else t.events.once("player_moves",e)}))}})),this.unfinished||(s=this.scene.children.getByName("layer_1"),(n=new We(_e.DEBRIS,this)).setPosition({x:this.leader.position.x-1,y:this.leader.position.y}),s.copy(0,4,1,1,2,5),this.setObjectAt(this.leader.position.x+1,this.leader.position.y,n),this.replaceByEmpty(this.leader),this.leader.alien.destroy(),this.leader.alien=null);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&this.onComplete(),9===e.order&&this.buyLeadingWithShrooms&&this.showDialog2()}},{key:"onAddElement",value:function(e){if(e.isClass(di)&&(e.power=1,e.hasPickaxe=!1),e.isClass(yi)){var t=this.scene.children.getByName("layer_2"),i=t.tilemap;this.exitEye=this.scene.add.sprite(48,16,"spark").setOrigin(.5,.5),this.exitEye.setTintFill(13784064),this.exitEye.setScale(2*t.scaleX,4*t.scaleX),this.exitEye.x=i.tileToWorldX(e.position.x-.5),this.exitEye.y=i.tileToWorldY(e.position.y-.4),this.exitEye.depth=100,this.exitEye.alpha=0}}},{key:"showDialog1_no_shrooms",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.leader.leadingPath=[{x:e.leader.position.x+1,y:e.leader.position.y}],e.setUpLeader()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[Ie("maze_1.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("maze_1.dialog_1.mary_say_2_empty")]},{who:"closeUp_Dwarf",text:[gt()(Ie("maze_1.dialog_1.dwarf_say_2_empty"))({NUM:9})]}]})}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.buyLeadingWithShrooms?(e.scene.events.emit("score:mushroom_given"),e.collectedShrooms--,e.leader.leadingPath=Object(p.a)(e.solvingPath)):e.leader.leadingPath=[{x:e.leader.position.x+1,y:e.leader.position.y}],e.setUpLeader()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[Ie("maze_1.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("maze_1.dialog_1.mary_say_1")],options:{slot0:{label:Ie("maze_1.dialog_1_option.yes"),slot:0,onSelect:function(){e.buyLeadingWithShrooms=!0,e.scene.events.emit("dialogue:nextPage")}},slot1:{label:Ie("maze_1.dialog_1_option.no"),slot:1,onSelect:function(){return e.scene.events.emit("dialogue:nextPage",1)}},slot2:null,slot3:null}},{who:"closeUp_Mary",text:[Ie("maze_1.dialog_1.mary_say_2_yes")],options:{slot2:null}},{who:"closeUp_Mary",text:[Ie("maze_1.dialog_1.mary_say_2_no")]}]})}},{key:"setUpLeader",value:function(){this.player.disconnect(),this.dwarfRun=!0,this.moveDwarf()}},{key:"moveDwarf",value:function(){var e=this;this.dwarfRun?(this.leader.isCloseEnough(this.player.position)&&0!==this.leader.leadingPath.length||(this.dwarfRun=!1),this.onNextTick((function(){e.leader.onPlayerMoves(e.player.position),e.moveDwarf()}))):(this.leader.animIdle(),this.player.reconnect())}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("maze_1.dialog_2.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("maze_1.dialog_2.dwarf_say_1")]}]})}}]),i}(Xe);Xt.key="maze_1";var zt=Xt,Qt=function(){function e(t){Object(g.a)(this,e),this.scene=t,this.map=this.scene.make.tilemap({tileWidth:20,tileHeight:20,width:3,height:1})}return Object(_.a)(e,[{key:"getArrow",value:function(){var e=this.map,t=e.addTilesetImage("arrows","hud-tiles",20,20,1,2),i=e.createBlankLayer("layer_arrow",t);return i.name="layer_arrow",i.depth=15,i.setScrollFactor(0),i.setScale(I),e.putTileAt(30,0,0)}},{key:"getArrowDown",value:function(){return this.getArrow()}},{key:"getArrowRight",value:function(){var e=this.getArrow();return e.rotation=-Math.PI/2,e}},{key:"getArrowUp",value:function(){var e=this.getArrow();return e.rotation=Math.PI,e}},{key:"getArrowLeft",value:function(){var e=this.getArrow();return e.rotation=Math.PI/2,e}}]),e}(),Jt=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The Dark Maze",e.easystar=new at.a.js,e.solvingPath=[],e.isMaze=!0,e.exitEye=null,e.dwarfRun=!1,e.buyLeadingWithShrooms=!1,e}return Object(_.a)(i,[{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a,s,n,o,r=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:t.lights.enable().setAmbientColor(0),a=this.objects.map((function(e){return e.map((function(e){return e.isClass(hi)||e.isClass(Ce)?0:1}))})),this.easystar.setGrid(a),this.easystar.setAcceptableTiles([0]),this.easystar.findPath(this.leader.position.x,this.leader.position.y,this.exit.position.x,this.exit.position.y,(function(e){null===e?r.shouldRestart=!0:(r.solvingPath=e.slice(1),r.leader.personalSpace=10)})),this.easystar.calculate(),t.events.once("levelstart",(function(){if(r.shouldRestart)t.levels.restart();else if(r.unfinished){r.totalShroomsAmount>0?r.showDialog1():r.showDialog1_no_shrooms();t.events.once("player_moves",(function e(){if(r.leader.leadingPath.length<r.solvingPath.length/3){r.leader.personalSpace=2;var i=r.solvingPath.at(-r.leader.leadingPath.length-4),a=new pi(_e.INTERACTION,r);a.order=9;var s=i.x,n=i.y;r.interactiveElements["".concat(s,"-").concat(n)]=a,a.setPosition({x:s,y:n})}else t.events.once("player_moves",e)}))}})),this.unfinished||(s=this.scene.children.getByName("layer_1"),(n=new We(_e.DEBRIS,this)).setPosition({x:this.leader.position.x-1,y:this.leader.position.y}),s.copy(0,4,1,1,2,5),this.setObjectAt(this.leader.position.x+1,this.leader.position.y,n),this.replaceByEmpty(this.leader),this.leader.alien.destroy(),this.leader.alien=null),t.children.getByName("layer_1").setPipeline("Light2D"),t.children.getByName("layer_2").setPipeline("Light2D"),t.children.getByName("layer_1z2").setPipeline("Light2D"),this.moveables.forEach((function(e){var t,i;return!e.isClass(di)&&(null===(t=e.alien)||void 0===t?void 0:t.active)&&(null===(i=e.alien)||void 0===i?void 0:i.setPipeline("Light2D"))})),(o=new pi(_e.INTERACTION,this)).order=-1,this.interactiveElements["".concat(this.exit.position.x-2,"-").concat(this.exit.position.y)]=o,o.setPosition({x:this.exit.position.x-2,y:this.exit.position.y}),this.scene.events.on("player_moves",this.updateLight.bind(this));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateLight",value:function(e){if(!this.exit)return!1;e.x===this.exit.position.x-3&&e.y===this.exit.position.y?(this.player.light.setRadius(500),this.player.light.setIntensity(1.3),this.eyeAnimation&&(this.exitEye.alpha=0,this.eyeAnimation.remove())):e.x===this.exit.position.x-2&&e.y===this.exit.position.y?(this.player.light.setRadius(250),this.player.light.setIntensity(.8),this.eyeAnimation&&this.eyeAnimation.remove(),this.exitEye.alpha=.1,this.eyeAnimation=this.scene.tweens.add({targets:this.exitEye,alpha:.2,duration:100,yoyo:!0,repeat:-1})):e.x===this.exit.position.x-1&&e.y===this.exit.position.y?(this.player.light.setIntensity(.3),this.player.light.setRadius(125),this.eyeAnimation&&this.eyeAnimation.remove(),this.exitEye.alpha=.3,this.eyeAnimation=this.scene.tweens.add({targets:this.exitEye,alpha:.5,duration:100,yoyo:!0,repeat:-1})):e.x===this.exit.position.x&&e.y===this.exit.position.y?this.player.light.setIntensity(.1):1.5!==this.player.light&&(this.player.light.setIntensity(1.5),this.player.light.setRadius(1e3))}},{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&this.onComplete(),9===e.order&&this.buyLeadingWithShrooms&&this.showDialog2()}},{key:"onAddElement",value:function(e){if(e.isClass(di)&&(e.power=1,e.hasPickaxe=!1,e.ligthTorch()),e.isClass(yi)){var t=this.scene.children.getByName("layer_2"),i=t.tilemap;this.exitEye=this.scene.add.sprite(48,16,"spark").setOrigin(.5,.5),this.exitEye.setTintFill(13784064),this.exitEye.setScale(2*t.scaleX,4*t.scaleX),this.exitEye.x=i.tileToWorldX(e.position.x-.5),this.exitEye.y=i.tileToWorldY(e.position.y-.4),this.exitEye.depth=100,this.exitEye.alpha=0}}},{key:"showDialog1_no_shrooms",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.leader.leadingPath=[{x:e.leader.position.x+1,y:e.leader.position.y}],e.setUpLeader()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("maze_2.dialog_1.mary_say_0")]},{who:"closeUp_Dwarf",text:[Ie("maze_2.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("maze_2.dialog_1.mary_say_2_empty")]},{who:"closeUp_Dwarf",text:[gt()(Ie("maze_2.dialog_1.dwarf_say_2_empty"))({NUM:9})]}]})}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.buyLeadingWithShrooms?(e.scene.events.emit("score:mushroom_given"),e.collectedShrooms--,e.leader.leadingPath=Object(p.a)(e.solvingPath)):e.leader.leadingPath=[{x:e.leader.position.x+1,y:e.leader.position.y}],e.setUpLeader()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("maze_2.dialog_1.mary_say_0")]},{who:"closeUp_Dwarf",text:[Ie("maze_2.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[Ie("maze_2.dialog_1.mary_say_1")],options:{slot0:{label:Ie("maze_2.dialog_1_option.yes"),slot:0,onSelect:function(){e.buyLeadingWithShrooms=!0,e.scene.events.emit("dialogue:nextPage")}},slot1:{label:Ie("maze_2.dialog_1_option.no"),slot:1,onSelect:function(){return e.scene.events.emit("dialogue:nextPage",1)}},slot2:null,slot3:null}},{who:"closeUp_Mary",text:[Ie("maze_2.dialog_1.mary_say_2_yes")],options:{slot2:null}},{who:"closeUp_Mary",text:[Ie("maze_2.dialog_1.mary_say_2_no")]}]})}},{key:"setUpLeader",value:function(){this.player.disconnect(),this.dwarfRun=!0,this.moveDwarf()}},{key:"moveDwarf",value:function(){var e=this;this.dwarfRun?(this.leader.isCloseEnough(this.player.position)&&0!==this.leader.leadingPath.length||(this.dwarfRun=!1),this.onNextTick((function(){e.leader.onPlayerMoves(e.player.position),e.moveDwarf()}))):(this.leader.animIdle(),this.player.reconnect())}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[Ie("maze_2.dialog_2.mary_say_1")]},{who:"closeUp_Dwarf",text:[Ie("maze_2.dialog_2.dwarf_say_1")]}]})}}]),i}(Xe);Jt.key="maze_2";var qt=Jt,Zt=function(e){return"ArrowUp"===e||"w"===e},$t=function(e){return"ArrowDown"===e||"s"===e},ei=function(e){return"ArrowLeft"===e||"a"===e},ti=function(e){return"ArrowRight"===e||"d"===e},ii=function(e){return"Enter"===e||"Spacebar"===e},ai=function(e){return"Escape"===e},si=function(e){return Zt(e)?Ee.UP:$t(e)?Ee.DOWN:ei(e)?Ee.LEFT:ti(e)?Ee.RIGHT:void 0},ni=function(){function e(t){Object(g.a)(this,e),this.scene=t,this.ROW_HEIGHT=0,this.MARGIN_LEFT=0,this.MARGIN_TOP=0,this.options=[],this.optionsByPage=[],this.scrollIndex=0,this.isVisible=!0,window.scene=this.scene}return Object(_.a)(e,[{key:"showConfirmNewGameMenu",value:function(){var e=this,t=[{label:Ie("menu.main.yes"),disabled:!1,selectable:!0,onSelect:function(){e.scene.navigateToScene("IntroScene")}},{label:Ie("menu.main.no"),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("SplashScreenScene")}}],i={label:Ie("menu.main.confirmNewGame"),disabled:!1,selectable:!1};this.drawSelectableOptions(i,t,0,1,2)}},{key:"showInitialMenu",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t,i,a,s=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0={label:Ie("menu.main.option_new"),disabled:!1,selectable:!0,onSelect:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.get(Oi.key);case 2:e.sent?s.scene.navigateToScene("ConfirmNewGameScene"):s.scene.navigateToScene("IntroScene");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},e.t1={label:Ie("menu.main.option_continue"),disabled:!1,selectable:!0,onSelect:function(){console.log(document.querySelector("canvas").width,document.querySelector("canvas").height,document.querySelector("canvas")),s.scene.navigateToScene("MenuScene")}},e.t2=Ie("menu.main.toBeContinue"),e.next=5,Ke.get(lt.key);case 5:if(e.t4=t=e.sent,e.t3=null===e.t4,e.t3){e.next=9;break}e.t3=void 0===t;case 9:if(!e.t3){e.next=13;break}e.t5=void 0,e.next=14;break;case 13:e.t5=t.comp;case 14:return e.t6=e.t5,e.t7=!(e.t6>0),e.next=18,Ke.get(lt.key);case 18:if(e.t9=i=e.sent,e.t8=null===e.t9,e.t8){e.next=22;break}e.t8=void 0===i;case 22:if(!e.t8){e.next=26;break}e.t10=void 0,e.next=27;break;case 26:e.t10=i.comp;case 27:e.t11=e.t10,e.t12=!(e.t11>0),e.t13=function(){return s.scene.navigateToScene("KiStageCompleted")},e.t14={label:e.t2,disabled:e.t7,selectable:e.t12,onSelect:e.t13},e.t15={label:"Options",disabled:!0,selectable:!1,onSelect:function(){return s.scene.navigateToScene("OptionsScene")}},a=[e.t0,e.t1,e.t14,e.t15],this.drawSelectableOptions(null,a);case 34:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showMainMenu",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t,i,a,s,n,o,r,l,u,d,p,y,m,f,v,g,_,E,O,S,T,x,b,A,k,w,N,R=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.toLocaleString("en-US",{minimumIntegerDigits:2})},x=function(){var e=Object(h.a)(c.a.mark((function e(t){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.get(t);case 2:return i=e.sent,e.abrupt("return",i?"".concat(T(i.collectedDiamonds),"/").concat(T(i.countDiamonds)):"__/__");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(h.a)(c.a.mark((function e(t){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.get(t);case 2:return i=e.sent,e.abrupt("return",i?"".concat(T(i.killedEnemies),"/").concat(T(i.countEnemies)):"__/__");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(h.a)(c.a.mark((function e(t){var i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.get(t);case 2:return i=e.sent,e.abrupt("return",i?"".concat(T(i.collectedShrooms),"/").concat(T(i.countShrooms)):"__/__");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(h.a)(c.a.mark((function e(t){var i,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.get(t);case 2:return i=e.sent,a=(100*(null===i||void 0===i?void 0:i.comp)).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}),e.abrupt("return",i?"".concat(a<=9?"  ":a<=99?" ":"").concat(a,"%"):"  0%");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.t3="Ki     1     ",e.next=8,x(Oi.key);case 8:return e.t4=e.sent,e.t2=e.t3.concat.call(e.t3,e.t4,"     "),e.next=12,b(Oi.key);case 12:return e.t5=e.sent,e.t1=e.t2.concat.call(e.t2,e.t5,"     "),e.next=16,A(Oi.key);case 16:return e.t6=e.sent,e.t0=e.t1.concat.call(e.t1,e.t6,"   "),e.next=20,k(Oi.key);case 20:return e.t7=e.sent,e.t8=e.t0.concat.call(e.t0,e.t7),e.t9=function(){return R.scene.navigateToScene("GameScene",{levelName:Oi.key})},e.t10={label:e.t8,disabled:!1,selectable:!0,onSelect:e.t9},e.t14="Ki     2     ",e.next=27,x(ht.key);case 27:return e.t15=e.sent,e.t13=e.t14.concat.call(e.t14,e.t15,"     "),e.next=31,b(ht.key);case 31:return e.t16=e.sent,e.t12=e.t13.concat.call(e.t13,e.t16,"     "),e.next=35,A(ht.key);case 35:return e.t17=e.sent,e.t11=e.t12.concat.call(e.t12,e.t17,"   "),e.next=39,k(ht.key);case 39:return e.t18=e.sent,e.t19=e.t11.concat.call(e.t11,e.t18),e.next=43,Ke.get(Oi.key);case 43:if(e.t21=t=e.sent,e.t20=null===e.t21,e.t20){e.next=47;break}e.t20=void 0===t;case 47:if(!e.t20){e.next=51;break}e.t22=void 0,e.next=52;break;case 51:e.t22=t.comp;case 52:return e.t23=e.t22,e.t24=!(e.t23>0),e.t25=function(){return R.scene.navigateToScene("GameScene",{levelName:ht.key})},e.t26={label:e.t19,disabled:e.t24,selectable:!0,onSelect:e.t25},e.t30="Ki     3     ",e.next=59,x(dt.key);case 59:return e.t31=e.sent,e.t29=e.t30.concat.call(e.t30,e.t31,"     "),e.next=63,b(dt.key);case 63:return e.t32=e.sent,e.t28=e.t29.concat.call(e.t29,e.t32,"     "),e.next=67,A(dt.key);case 67:return e.t33=e.sent,e.t27=e.t28.concat.call(e.t28,e.t33,"   "),e.next=71,k(dt.key);case 71:return e.t34=e.sent,e.t35=e.t27.concat.call(e.t27,e.t34),e.next=75,Ke.get(ht.key);case 75:if(e.t37=i=e.sent,e.t36=null===e.t37,e.t36){e.next=79;break}e.t36=void 0===i;case 79:if(!e.t36){e.next=83;break}e.t38=void 0,e.next=84;break;case 83:e.t38=i.comp;case 84:return e.t39=e.t38,e.t40=!(e.t39>0),e.t41=function(){return R.scene.navigateToScene("GameScene",{levelName:dt.key})},e.t42={label:e.t35,disabled:e.t40,selectable:!0,onSelect:e.t41},e.t46="Ki     4     ",e.next=91,x(yt.key);case 91:return e.t47=e.sent,e.t45=e.t46.concat.call(e.t46,e.t47,"     "),e.next=95,b(yt.key);case 95:return e.t48=e.sent,e.t44=e.t45.concat.call(e.t45,e.t48,"     "),e.next=99,A(yt.key);case 99:return e.t49=e.sent,e.t43=e.t44.concat.call(e.t44,e.t49,"   "),e.next=103,k(yt.key);case 103:return e.t50=e.sent,e.t51=e.t43.concat.call(e.t43,e.t50),e.next=107,Ke.get(dt.key);case 107:if(e.t53=a=e.sent,e.t52=null===e.t53,e.t52){e.next=111;break}e.t52=void 0===a;case 111:if(!e.t52){e.next=115;break}e.t54=void 0,e.next=116;break;case 115:e.t54=a.comp;case 116:return e.t55=e.t54,e.t56=!(e.t55>0),e.t57=function(){return R.scene.navigateToScene("GameScene",{levelName:yt.key})},e.t58={label:e.t51,disabled:e.t56,selectable:!0,onSelect:e.t57},e.t62="Ki     5     ",e.next=123,x(ft.key);case 123:return e.t63=e.sent,e.t61=e.t62.concat.call(e.t62,e.t63,"     "),e.next=127,b(ft.key);case 127:return e.t64=e.sent,e.t60=e.t61.concat.call(e.t61,e.t64,"     "),e.next=131,A(ft.key);case 131:return e.t65=e.sent,e.t59=e.t60.concat.call(e.t60,e.t65,"   "),e.next=135,k(ft.key);case 135:return e.t66=e.sent,e.t67=e.t59.concat.call(e.t59,e.t66),e.next=139,Ke.get(yt.key);case 139:if(e.t69=s=e.sent,e.t68=null===e.t69,e.t68){e.next=143;break}e.t68=void 0===s;case 143:if(!e.t68){e.next=147;break}e.t70=void 0,e.next=148;break;case 147:e.t70=s.comp;case 148:return e.t71=e.t70,e.t72=!(e.t71>0),e.t73=function(){return R.scene.navigateToScene("GameScene",{levelName:ft.key})},e.t74={label:e.t67,disabled:e.t72,selectable:!0,onSelect:e.t73},e.t78="Ki     6     ",e.next=155,x(Ot.key);case 155:return e.t79=e.sent,e.t77=e.t78.concat.call(e.t78,e.t79,"     "),e.next=159,b(Ot.key);case 159:return e.t80=e.sent,e.t76=e.t77.concat.call(e.t77,e.t80,"     "),e.next=163,A(Ot.key);case 163:return e.t81=e.sent,e.t75=e.t76.concat.call(e.t76,e.t81,"   "),e.next=167,k(Ot.key);case 167:return e.t82=e.sent,e.t83=e.t75.concat.call(e.t75,e.t82),e.next=171,Ke.get(ft.key);case 171:if(e.t85=n=e.sent,e.t84=null===e.t85,e.t84){e.next=175;break}e.t84=void 0===n;case 175:if(!e.t84){e.next=179;break}e.t86=void 0,e.next=180;break;case 179:e.t86=n.comp;case 180:return e.t87=e.t86,e.t88=!(e.t87>0),e.t89=function(){return R.scene.navigateToScene("GameScene",{levelName:Ot.key})},e.t90={label:e.t83,disabled:e.t88,selectable:!0,onSelect:e.t89},e.t94="Ki     7     ",e.next=187,x(Tt.key);case 187:return e.t95=e.sent,e.t93=e.t94.concat.call(e.t94,e.t95,"     "),e.next=191,b(Tt.key);case 191:return e.t96=e.sent,e.t92=e.t93.concat.call(e.t93,e.t96,"     "),e.next=195,A(Tt.key);case 195:return e.t97=e.sent,e.t91=e.t92.concat.call(e.t92,e.t97,"   "),e.next=199,k(Tt.key);case 199:return e.t98=e.sent,e.t99=e.t91.concat.call(e.t91,e.t98),e.next=203,Ke.get(Ot.key);case 203:if(e.t101=o=e.sent,e.t100=null===e.t101,e.t100){e.next=207;break}e.t100=void 0===o;case 207:if(!e.t100){e.next=211;break}e.t102=void 0,e.next=212;break;case 211:e.t102=o.comp;case 212:return e.t103=e.t102,e.t104=!(e.t103>0),e.t105=function(){return R.scene.navigateToScene("GameScene",{levelName:Tt.key})},e.t106={label:e.t99,disabled:e.t104,selectable:!0,onSelect:e.t105},e.t110="Ki     8     ",e.next=219,x(bt.key);case 219:return e.t111=e.sent,e.t109=e.t110.concat.call(e.t110,e.t111,"     "),e.next=223,b(bt.key);case 223:return e.t112=e.sent,e.t108=e.t109.concat.call(e.t109,e.t112,"     "),e.next=227,A(bt.key);case 227:return e.t113=e.sent,e.t107=e.t108.concat.call(e.t108,e.t113,"   "),e.next=231,k(bt.key);case 231:return e.t114=e.sent,e.t115=e.t107.concat.call(e.t107,e.t114),e.next=235,Ke.get(Tt.key);case 235:if(e.t117=r=e.sent,e.t116=null===e.t117,e.t116){e.next=239;break}e.t116=void 0===r;case 239:if(!e.t116){e.next=243;break}e.t118=void 0,e.next=244;break;case 243:e.t118=r.comp;case 244:return e.t119=e.t118,e.t120=!(e.t119>0),e.t121=function(){return R.scene.navigateToScene("GameScene",{levelName:bt.key})},e.t122={label:e.t115,disabled:e.t120,selectable:!0,onSelect:e.t121},e.t126="Ki     9     ",e.next=251,x(kt.key);case 251:return e.t127=e.sent,e.t125=e.t126.concat.call(e.t126,e.t127,"     "),e.next=255,b(kt.key);case 255:return e.t128=e.sent,e.t124=e.t125.concat.call(e.t125,e.t128,"     "),e.next=259,A(kt.key);case 259:return e.t129=e.sent,e.t123=e.t124.concat.call(e.t124,e.t129,"   "),e.next=263,k(kt.key);case 263:return e.t130=e.sent,e.t131=e.t123.concat.call(e.t123,e.t130),e.next=267,Ke.get(bt.key);case 267:if(e.t133=l=e.sent,e.t132=null===e.t133,e.t132){e.next=271;break}e.t132=void 0===l;case 271:if(!e.t132){e.next=275;break}e.t134=void 0,e.next=276;break;case 275:e.t134=l.comp;case 276:return e.t135=e.t134,e.t136=!(e.t135>0),e.t137=function(){return R.scene.navigateToScene("GameScene",{levelName:kt.key})},e.t138={label:e.t131,disabled:e.t136,selectable:!0,onSelect:e.t137},e.t142="Ki    10     ",e.next=283,x(Nt.key);case 283:return e.t143=e.sent,e.t141=e.t142.concat.call(e.t142,e.t143,"     "),e.next=287,b(Nt.key);case 287:return e.t144=e.sent,e.t140=e.t141.concat.call(e.t141,e.t144,"     "),e.next=291,A(Nt.key);case 291:return e.t145=e.sent,e.t139=e.t140.concat.call(e.t140,e.t145,"   "),e.next=295,k(Nt.key);case 295:return e.t146=e.sent,e.t147=e.t139.concat.call(e.t139,e.t146),e.next=299,Ke.get(kt.key);case 299:if(e.t149=u=e.sent,e.t148=null===e.t149,e.t148){e.next=303;break}e.t148=void 0===u;case 303:if(!e.t148){e.next=307;break}e.t150=void 0,e.next=308;break;case 307:e.t150=u.comp;case 308:return e.t151=e.t150,e.t152=!(e.t151>0),e.t153=function(){return R.scene.navigateToScene("GameScene",{levelName:Nt.key})},e.t154={label:e.t147,disabled:e.t152,selectable:!0,onSelect:e.t153},e.t158="Ki    11     ",e.next=315,x(It.key);case 315:return e.t159=e.sent,e.t157=e.t158.concat.call(e.t158,e.t159,"     "),e.next=319,b(It.key);case 319:return e.t160=e.sent,e.t156=e.t157.concat.call(e.t157,e.t160,"     "),e.next=323,A(It.key);case 323:return e.t161=e.sent,e.t155=e.t156.concat.call(e.t156,e.t161,"   "),e.next=327,k(It.key);case 327:return e.t162=e.sent,e.t163=e.t155.concat.call(e.t155,e.t162),e.next=331,Ke.get(Nt.key);case 331:if(e.t165=d=e.sent,e.t164=null===e.t165,e.t164){e.next=335;break}e.t164=void 0===d;case 335:if(!e.t164){e.next=339;break}e.t166=void 0,e.next=340;break;case 339:e.t166=d.comp;case 340:return e.t167=e.t166,e.t168=!(e.t167>0),e.t169=function(){return R.scene.navigateToScene("GameScene",{levelName:It.key})},e.t170={label:e.t163,disabled:e.t168,selectable:!0,onSelect:e.t169},e.t174="Ki    12     ",e.next=347,x(Mt.key);case 347:return e.t175=e.sent,e.t173=e.t174.concat.call(e.t174,e.t175,"     "),e.next=351,b(Mt.key);case 351:return e.t176=e.sent,e.t172=e.t173.concat.call(e.t173,e.t176,"     "),e.next=355,A(Mt.key);case 355:return e.t177=e.sent,e.t171=e.t172.concat.call(e.t172,e.t177,"   "),e.next=359,k(Mt.key);case 359:return e.t178=e.sent,e.t179=e.t171.concat.call(e.t171,e.t178),e.next=363,Ke.get(It.key);case 363:if(e.t181=p=e.sent,e.t180=null===e.t181,e.t180){e.next=367;break}e.t180=void 0===p;case 367:if(!e.t180){e.next=371;break}e.t182=void 0,e.next=372;break;case 371:e.t182=p.comp;case 372:return e.t183=e.t182,e.t184=!(e.t183>0),e.t185=function(){return R.scene.navigateToScene("GameScene",{levelName:Mt.key})},e.t186={label:e.t179,disabled:e.t184,selectable:!0,onSelect:e.t185},e.t187="".concat(Ie("menu.main.ruins").padEnd(6," ")," 1"),e.next=379,Ke.get(Mt.key);case 379:if(e.t189=y=e.sent,e.t188=null===e.t189,e.t188){e.next=383;break}e.t188=void 0===y;case 383:if(!e.t188){e.next=387;break}e.t190=void 0,e.next=388;break;case 387:e.t190=y.comp;case 388:return e.t191=e.t190,e.t192=!(e.t191>0),e.t193=function(){return R.scene.navigateToScene("GameScene",{levelName:zt.key})},e.t194={label:e.t187,disabled:e.t192,selectable:!0,onSelect:e.t193},e.t198="Ki    13     ",e.next=395,x(Ct.key);case 395:return e.t199=e.sent,e.t197=e.t198.concat.call(e.t198,e.t199,"     "),e.next=399,b(Ct.key);case 399:return e.t200=e.sent,e.t196=e.t197.concat.call(e.t197,e.t200,"     "),e.next=403,A(Ct.key);case 403:return e.t201=e.sent,e.t195=e.t196.concat.call(e.t196,e.t201,"   "),e.next=407,k(Ct.key);case 407:return e.t202=e.sent,e.t203=e.t195.concat.call(e.t195,e.t202),e.next=411,Ke.get(zt.key);case 411:if(e.t205=m=e.sent,e.t204=null===e.t205,e.t204){e.next=415;break}e.t204=void 0===m;case 415:if(!e.t204){e.next=419;break}e.t206=void 0,e.next=420;break;case 419:e.t206=m.comp;case 420:return e.t207=e.t206,e.t208=!(e.t207>0),e.t209=function(){return R.scene.navigateToScene("GameScene",{levelName:Ct.key})},e.t210={label:e.t203,disabled:e.t208,selectable:!0,onSelect:e.t209},e.t214="Ki    14     ",e.next=427,x(Pt.key);case 427:return e.t215=e.sent,e.t213=e.t214.concat.call(e.t214,e.t215,"     "),e.next=431,b(Pt.key);case 431:return e.t216=e.sent,e.t212=e.t213.concat.call(e.t213,e.t216,"     "),e.next=435,A(Pt.key);case 435:return e.t217=e.sent,e.t211=e.t212.concat.call(e.t212,e.t217,"   "),e.next=439,k(Pt.key);case 439:return e.t218=e.sent,e.t219=e.t211.concat.call(e.t211,e.t218),e.next=443,Ke.get(Ct.key);case 443:if(e.t221=f=e.sent,e.t220=null===e.t221,e.t220){e.next=447;break}e.t220=void 0===f;case 447:if(!e.t220){e.next=451;break}e.t222=void 0,e.next=452;break;case 451:e.t222=f.comp;case 452:return e.t223=e.t222,e.t224=!(e.t223>0),e.t225=function(){return R.scene.navigateToScene("GameScene",{levelName:Pt.key})},e.t226={label:e.t219,disabled:e.t224,selectable:!0,onSelect:e.t225},e.t230="Ki    15     ",e.next=459,x(Oi.key);case 459:return e.t231=e.sent,e.t229=e.t230.concat.call(e.t230,e.t231,"     "),e.next=463,b(Bt.key);case 463:return e.t232=e.sent,e.t228=e.t229.concat.call(e.t229,e.t232,"     "),e.next=467,A(Bt.key);case 467:return e.t233=e.sent,e.t227=e.t228.concat.call(e.t228,e.t233,"   "),e.next=471,k(Bt.key);case 471:return e.t234=e.sent,e.t235=e.t227.concat.call(e.t227,e.t234),e.next=475,Ke.get(Pt.key);case 475:if(e.t237=v=e.sent,e.t236=null===e.t237,e.t236){e.next=479;break}e.t236=void 0===v;case 479:if(!e.t236){e.next=483;break}e.t238=void 0,e.next=484;break;case 483:e.t238=v.comp;case 484:return e.t239=e.t238,e.t240=!(e.t239>0),e.t241=function(){return R.scene.navigateToScene("GameScene",{levelName:Bt.key})},e.t242={label:e.t235,disabled:e.t240,selectable:!0,onSelect:e.t241},e.t246="Ki    16     ",e.next=491,x(Gt.key);case 491:return e.t247=e.sent,e.t245=e.t246.concat.call(e.t246,e.t247,"     "),e.next=495,b(Gt.key);case 495:return e.t248=e.sent,e.t244=e.t245.concat.call(e.t245,e.t248,"     "),e.next=499,A(Gt.key);case 499:return e.t249=e.sent,e.t243=e.t244.concat.call(e.t244,e.t249,"   "),e.next=503,k(Gt.key);case 503:return e.t250=e.sent,e.t251=e.t243.concat.call(e.t243,e.t250),e.next=507,Ke.get(Bt.key);case 507:if(e.t253=g=e.sent,e.t252=null===e.t253,e.t252){e.next=511;break}e.t252=void 0===g;case 511:if(!e.t252){e.next=515;break}e.t254=void 0,e.next=516;break;case 515:e.t254=g.comp;case 516:return e.t255=e.t254,e.t256=!(e.t255>0),e.t257=function(){return R.scene.navigateToScene("GameScene",{levelName:Gt.key})},e.t258={label:e.t251,disabled:e.t256,selectable:!0,onSelect:e.t257},e.t262="Ki    17     ",e.next=523,x(Yt.key);case 523:return e.t263=e.sent,e.t261=e.t262.concat.call(e.t262,e.t263,"     "),e.next=527,b(Yt.key);case 527:return e.t264=e.sent,e.t260=e.t261.concat.call(e.t261,e.t264,"     "),e.next=531,A(Yt.key);case 531:return e.t265=e.sent,e.t259=e.t260.concat.call(e.t260,e.t265,"   "),e.next=535,k(Yt.key);case 535:return e.t266=e.sent,e.t267=e.t259.concat.call(e.t259,e.t266),e.next=539,Ke.get(Gt.key);case 539:if(e.t269=_=e.sent,e.t268=null===e.t269,e.t268){e.next=543;break}e.t268=void 0===_;case 543:if(!e.t268){e.next=547;break}e.t270=void 0,e.next=548;break;case 547:e.t270=_.comp;case 548:return e.t271=e.t270,e.t272=!(e.t271>0),e.t273=function(){return R.scene.navigateToScene("GameScene",{levelName:Yt.key})},e.t274={label:e.t267,disabled:e.t272,selectable:!0,onSelect:e.t273},e.t278="Ki    18     ",e.next=555,x(Kt.key);case 555:return e.t279=e.sent,e.t277=e.t278.concat.call(e.t278,e.t279,"     "),e.next=559,b(Kt.key);case 559:return e.t280=e.sent,e.t276=e.t277.concat.call(e.t277,e.t280,"     "),e.next=563,A(Kt.key);case 563:return e.t281=e.sent,e.t275=e.t276.concat.call(e.t276,e.t281,"   "),e.next=567,k(Kt.key);case 567:return e.t282=e.sent,e.t283=e.t275.concat.call(e.t275,e.t282),e.next=571,Ke.get(Yt.key);case 571:if(e.t285=E=e.sent,e.t284=null===e.t285,e.t284){e.next=575;break}e.t284=void 0===E;case 575:if(!e.t284){e.next=579;break}e.t286=void 0,e.next=580;break;case 579:e.t286=E.comp;case 580:return e.t287=e.t286,e.t288=!(e.t287>0),e.t289=function(){return R.scene.navigateToScene("GameScene",{levelName:Kt.key})},e.t290={label:e.t283,disabled:e.t288,selectable:!0,onSelect:e.t289},e.t291="".concat(Ie("menu.main.ruins").padEnd(6," ")," 2"),e.next=587,Ke.get(Kt.key);case 587:if(e.t293=O=e.sent,e.t292=null===e.t293,e.t292){e.next=591;break}e.t292=void 0===O;case 591:if(!e.t292){e.next=595;break}e.t294=void 0,e.next=596;break;case 595:e.t294=O.comp;case 596:return e.t295=e.t294,e.t296=!(e.t295>0),e.t297=function(){return R.scene.navigateToScene("GameScene",{levelName:qt.key})},e.t298={label:e.t291,disabled:e.t296,selectable:!0,onSelect:e.t297},e.t302="Ki    19     ",e.next=603,x(lt.key);case 603:return e.t303=e.sent,e.t301=e.t302.concat.call(e.t302,e.t303,"     "),e.next=607,b(lt.key);case 607:return e.t304=e.sent,e.t300=e.t301.concat.call(e.t301,e.t304,"     "),e.next=611,A(lt.key);case 611:return e.t305=e.sent,e.t299=e.t300.concat.call(e.t300,e.t305,"   "),e.next=615,k(lt.key);case 615:return e.t306=e.sent,e.t307=e.t299.concat.call(e.t299,e.t306),e.next=619,Ke.get(qt.key);case 619:if(e.t309=S=e.sent,e.t308=null===e.t309,e.t308){e.next=623;break}e.t308=void 0===S;case 623:if(!e.t308){e.next=627;break}e.t310=void 0,e.next=628;break;case 627:e.t310=S.comp;case 628:e.t311=e.t310,e.t312=!(e.t311>0),e.t313=function(){return R.scene.navigateToScene("GameScene",{levelName:lt.key})},e.t314={label:e.t307,disabled:e.t312,selectable:!0,onSelect:e.t313},w=[e.t10,e.t26,e.t42,e.t58,e.t74,e.t90,e.t106,e.t122,e.t138,e.t154,e.t170,e.t186,e.t194,e.t210,e.t226,e.t242,e.t258,e.t274,e.t290,e.t298,e.t314],N={label:Ie("menu.main.heading_scrore"),disabled:!1,selectable:!1},this.drawSelectableOptions(N,w,0,null,null,13);case 635:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showInGameMenu",value:function(){var e=this,t=[{label:Ie("menu.main.option_restart_level"),disabled:!1,selectable:!0,onSelect:function(){return e.scene.levels.restart()}},{label:Ie("menu.main.option_back_to_menu"),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("MenuScene")}}];this.drawSelectableOptions(null,t,0,4,1)}},{key:"drawSelectableOptions",value:function(e,t,i,a,s){var n=this,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5;this.options=t;var r=t.findIndex((function(e){return e.selectable&&!e.disabled})),l=r;if(i>=o-1)if(i<this.options.length){this.scrollIndex=i-o+1;var c=this.scrollIndex+o<this.options.length;c?(this.scrollIndex=i-o+2,l=o-2):l=o-1}else l=o,this.scrollIndex=i-o;else isNaN(i)||(l=i);var h=Math.floor(l/o)+1,u=l-Math.floor((h-1)*o),d=l;this.ROW_HEIGHT=li.pixelToScreen(15),this.MARGIN_LEFT=li.tileToScreen(a||1);var y=li.pixelToScreen(20),m=this.MARGIN_LEFT-y;this.MARGIN_TOP=li.tileToScreen(s||2);var f=new Qt(this.scene).getArrowRight();f.tilemapLayer.setPosition(m,this.MARGIN_TOP+this.ROW_HEIGHT*d-this.ROW_HEIGHT/2);var v=new Qt(this.scene).getArrowUp();v.tilemapLayer.setPosition(li.tileToScreen(19),this.MARGIN_TOP-this.ROW_HEIGHT),v.setAlpha(0===this.scrollIndex?.5:1),v.setVisible(o<this.options.length);var g=new Qt(this.scene).getArrowDown();if(g.tilemapLayer.setPosition(li.tileToScreen(19),this.MARGIN_TOP+this.ROW_HEIGHT*o-this.ROW_HEIGHT),g.setAlpha(this.scrollIndex+o<this.options.length?1:.5),g.setVisible(o<this.options.length),e){var _=[].concat(Object(p.a)(e.label.split("")),Object(p.a)(Array(Math.max(0,20-e.label.length)).fill(""))).join(""),E=Math.round(_.length/20),O=this.scene.add.text(this.MARGIN_LEFT,this.ROW_HEIGHT*-E+this.MARGIN_TOP,_,{fontFamily:"Emulogic",fontSize:"8px",fill:"#aee0c8",fontWeight:"regular"}).setVisible(!e.disabled);O.displayHeight=10*I,O.alpha=1,O.depth=16,O.name="header_text",O.setScale(I),O.setScrollFactor(0),O.setShadow(-1,1)}this.drawOptionsPage(this.scrollIndex,o,u),this.scene.input.keyboard.on("keydown",(function(e){if(!n.isVisible)return!1;var t=n.optionsByPage.filter((function(e){return!e.disabled})),i=!1;Zt(e.key)&&(1===u&&n.scrollIndex>0?(n.scrollIndex--,n.drawOptionsPage(n.scrollIndex,o,u)):u>0&&(i=u-1));var a=u===t.length-1;$t(e.key)&&!a&&(u===o-2&&n.scrollIndex+o<n.options.length?(n.scrollIndex++,n.drawOptionsPage(n.scrollIndex,o,u)):u<t.length-1&&(i=u+1));if(($t(e.key)||Zt(e.key))&&!1!==i){f.tilemapLayer.setPosition(m,n.MARGIN_TOP+n.ROW_HEIGHT*i-n.ROW_HEIGHT/2);var s=n.scene.children.getByName("menu_text_".concat(u));s.alpha="100%"===s.text.slice(-4)?1:.5,s.setColor("#aee0c8");var r=n.scene.children.getByName("menu_text_".concat(i));r.alpha=1,r.setColor("#fff"),u=i}v.setAlpha(0===n.scrollIndex?.5:1),g.setAlpha(u===t.length-1?.5:1),ii(e.key)&&(t[u].disabled||t[u].onSelect())}))}},{key:"drawOptionsPage",value:function(e,t,i){var a=this;this.scene.children.list.filter((function(e){return e.name.includes("menu_text")})).forEach((function(e){return e.destroy()})),this.optionsByPage=this.options.slice(e,e+t),this.optionsByPage.forEach((function(e,t){var s=[].concat(Object(p.a)(e.label.split("")),Object(p.a)(Array(Math.max(0,20-e.label.length)).fill(""))).join(""),n=a.scene.add.text(a.MARGIN_LEFT,a.ROW_HEIGHT*t+a.MARGIN_TOP,s,{fontFamily:"Emulogic",fontSize:"8px",fill:"#aee0c8",fontWeight:"regular"}).setVisible(!e.disabled);n.alpha="100%"===s.slice(-4)||t===i?1:.5,n.setColor(t===i?"#fff":"#aee0c8"),n.displayHeight=10*I,n.depth=16,n.name="menu_text_".concat(t),n.setScale(I),n.setScrollFactor(0),n.setShadow(-1,1)}))}}]),e}(),oi=function(){function e(t){Object(g.a)(this,e),this.scene=t,this.options=[],this.menuOptionsContainer=null,this.keyDownHandler=this.keyDownHandler.bind(this)}return Object(_.a)(e,[{key:"mount",value:function(){this.menuOptionsContainer=this.scene.add.container(0,0),this.menuOptionsContainer.setScrollFactor(0),this.currentSlot=0,this.scene.input.keyboard.on("keydown",this.keyDownHandler)}},{key:"unmount",value:function(){var e;this.scene.input.keyboard.off("keydown",this.keyDownHandler),this.menuOptionsContainer.destroy(),null===(e=this.arrow)||void 0===e||e.setVisible(!1),this.arrow=null}},{key:"visible",get:function(){return this.menuOptionsContainer.visible}},{key:"show",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.menuOptionsContainer.setVisible(!0),this.options=Object.keys(t).reduce((function(e,i){return null!==t[i]&&(e[i]=t[i]),e}),{});var i=Object.keys(this.options).sort()[0];this.currentSlot=this.options[i].slot,this.menuOptionsContainer.depth=20,this.menuOptionsContainer.setPosition(li.tileToScreen(4.5),li.tileToScreen(9));var a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=li.tileToScreen(0===i||1===i?0:9),s=li.tileToScreen(0===i||2===i?.25:1),n=e.scene.add.text(a,s,t,{fontFamily:"GameGirl",fontSize:"8px",fill:"#ffffff",lineSpacing:2});n.setScale(I),n.displayHeight=li.pixelToScreen(8),n.displayWidth=li.pixelToScreen(8*t.length),n.setShadow(-1,1),e.menuOptionsContainer.add(n)};Object.values(this.options).forEach((function(e){return a(e.label,e.slot)})),this.arrow||(this.arrow=new Qt(this.scene).getArrowRight(),this.arrow.name="menu_arrow",this.arrow.setSize(li.tileToPixels(.66),li.tileToPixels(.66))),this.setArrowPositionBySlot(this.currentSlot),this.arrow.setVisible(0!==this.options.length)}},{key:"hide",value:function(){for(var e;null===(t=this.menuOptionsContainer)||void 0===t?void 0:t.list.length;){var t,i,a;null===(i=this.menuOptionsContainer)||void 0===i||null===(a=i.list)||void 0===a||a.forEach((function(e){return e.destroy()}))}this.menuOptionsContainer.setVisible(!1),null===(e=this.arrow)||void 0===e||e.setVisible(!1)}},{key:"keyDownHandler",value:function(e){var t=this;if(this.menuOptionsContainer.visible){var i=this.currentSlot;if(Zt(e.key)&&(1===i||3===i)){var a=i-1;this.options["slot".concat(a)]&&(this.currentSlot=a)}if(ei(e.key)){var s=i-2;this.options["slot".concat(s)]?this.currentSlot=s:this.options["slot".concat(s-1)]&&(this.currentSlot=s-1)}if(ti(e.key)){var n=i+2;this.options["slot".concat(n)]?this.currentSlot=n:this.options["slot".concat(n+1)]&&(this.currentSlot=n+1)}if($t(e.key)&&(0===i||2===i)){var o=i+1;this.options["slot".concat(o)]&&(this.currentSlot=o)}if(ii(e.key)){var r=Object.values(this.options).find((function(e){return e.slot===t.currentSlot}));null===r||void 0===r||r.onSelect()}else this.setArrowPositionBySlot(this.currentSlot)}}},{key:"setArrowPositionBySlot",value:function(e){var t=-li.tileToScreen(.5),i=-li.tileToScreen(.4),a=li.tileToScreen(0===e||1===e?0:9),s=li.tileToScreen(0===e||2===e?.25:1);this.arrow.tilemapLayer.setPosition(a+t+this.menuOptionsContainer.x,s+i+this.menuOptionsContainer.y)}}]),e}(),ri=function(){function e(t){Object(g.a)(this,e),this.scene=t,this.tnContainer=null,this.participantSprites={},this.conversation={},this.currentDialogIndex=0,this.isShowing=!1,this.isFullTextDisplayed=!1,this.dialogOptions=new oi(this.scene),this.showDialog=this.showDialog.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.updateCharacterName=this.updateCharacterName.bind(this),this.tIDs=[]}return Object(_.a)(e,[{key:"mount",value:function(){var e=this;this.tIDs.push(setTimeout((function(){return e.scene.input.keyboard.addListener("keydown",e.handleKeyDown)}),500))}},{key:"unmount",value:function(){this.tIDs.forEach((function(e){return clearTimeout(e)}));var e=this.scene.children.getByName("layer_hud");e&&e.destroy();var t=this.scene.children.getByName("dialog_tn_container");t&&t.destroy();var i=this.scene.children.getByName("placeholder_text");i&&i.destroy(),this.overlay&&this.overlay.destroy(),this.topWindowboxing&&this.topWindowboxing.destroy(),this.bottomWindowboxing&&this.bottomWindowboxing.destroy()}},{key:"handleKeyDown",value:function(e){ii(e.key)&&this.isFullTextDisplayed&&!this.dialogOptions.visible&&(this.currentDialogIndex<this.conversation.length-1||this.scene.events.emit("dialogue:hide"))}},{key:"hideDialog",value:function(){var e=this;return this.scene.input.keyboard.removeListener("keydown",this.handleKeyDown),new Promise((function(t){var i=e.scene.children.list.find((function(e){return"layer_hud"===e.name})).tilemap;e.clearText(),e.dialogOptions.unmount(),e.scene.tweens.add({targets:[i.layers[0].tilemapLayer,e.tnContainer],y:li.tileToScreen(-7),duration:500,ease:"Back.In",onComplete:function(){e.isShowing=!1,t()}})}))}},{key:"showDialog",value:function(e){var t=this,i=e.participants,a=e.participantNames,s=void 0===a?[]:a,n=e.conversation;this.isShowing=!0,this.conversation=n,this.currentDialogIndex=0,this.prepareHUD(i,s),this.prepareText();var o=this.scene.children.list.find((function(e){return"layer_hud"===e.name})).tilemap;o.layers[0].tilemapLayer.y=this.tnContainer.y=li.tileToScreen(-8),this.scene.tweens.add({targets:this.overlay,alpha:.4,duration:500,ease:"Cubic.Out"}),this.scene.tweens.add({targets:[o.layers[0].tilemapLayer,this.tnContainer],y:li.tileToScreen(4),duration:500,ease:"Cubic.Out",onComplete:function(){t.dialogOptions.mount(),t.showMessage(t.conversation[t.currentDialogIndex])}})}},{key:"fullTextDisplayed",value:function(){var e=this;this.isFullTextDisplayed=!0,this.scene.events.emit("dialogue:message_shown",this.currentDialogIndex);var t={slot1:{label:Ie("menu.dialog_options.close"),slot:1,onSelect:function(){return e.scene.events.emit("dialogue:hide")}}},i={slot1:{label:Ie("menu.dialog_options.story"),slot:1,onSelect:function(){return e.showMessage(e.conversation[++e.currentDialogIndex])}},slot3:{label:Ie("menu.dialog_options.close"),slot:3,onSelect:function(){return e.scene.events.emit("dialogue:hide")}}},a={slot2:{label:Ie("menu.dialog_options.next"),slot:2,onSelect:function(){return e.showMessage(e.conversation[++e.currentDialogIndex])}},slot3:{label:Ie("menu.dialog_options.close"),slot:3,onSelect:function(){return e.scene.events.emit("dialogue:hide")}}},s={slot3:{label:Ie("menu.dialog_options.close"),slot:3,onSelect:function(){return e.scene.events.emit("dialogue:hide")}}},n=Object(Qe.a)(Object(Qe.a)(Object(Qe.a)(Object(Qe.a)(Object(Qe.a)({},1===this.conversation.length?t:{}),this.conversation.length>1&&0===this.currentDialogIndex?i:{}),this.currentDialogIndex>0&&this.currentDialogIndex<this.conversation.length-1?a:{}),this.currentDialogIndex===this.conversation.length-1&&this.conversation.length>1?s:{}),this.conversation[this.currentDialogIndex].options||{});this.dialogOptions.show(n)}},{key:"showMessage",value:function(e){var t=this;this.clearText(),this.dialogOptions.hide(),this.writeText(e.text);var i=this.scene.children.getByName("dialog_tn_container");Object.keys(this.participantSprites).forEach((function(a){if(a===e.who)t.participantSprites[a].clearTint(),i.list.find((function(e){return e.name==="char_".concat(a,"_text_to_remove")})).clearTint();else{t.participantSprites[a].setTint(3355443);var s=i.list.find((function(e){return e.name==="char_".concat(a,"_text_to_remove")}));null===s||void 0===s||s.setTint(10066329)}}))}},{key:"prepareHUD",value:function(t,i){this.overlay=this.scene.add.graphics(),this.overlay.clear(),this.overlay.fillStyle(0,1),this.overlay.fillRect(0,0,li.tileToScreen(20),li.tileToScreen(20)),this.overlay.alpha=0,this.overlay.setScrollFactor(0);var a,s,n,o=this.scene.make.tilemap({tileWidth:20,tileHeight:20,width:20,height:20}),r=o.addTilesetImage("hud-tiles","hud-tiles",20,20,1,2),l=o.createBlankLayer("layer_hud",r);switch(l.name="layer_hud",l.depth=15,l.setScrollFactor(0),l.setScale(I),this.tnContainer=this.scene.add.container(0,0),this.tnContainer.depth=20,this.tnContainer.name="dialog_tn_container",t.length){case 2:t[1]&&(a=t[1],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(I)).name="".concat(a,"_tn_to_remove"),s.x=li.tileToScreen(17)+li.pixelToScreen(10),s.y=li.tileToScreen(3)+li.pixelToScreen(2),s.setScrollFactor(0),s.setFlipX(!0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:17,y:3}),(n=this.scene.add.text(s.x-.25*li.tileToScreen(2),s.y+.8*li.tileToScreen(2),i[1]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(I/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n);case 1:t[0]&&(a=t[0],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(I)).name="".concat(a,"_tn_to_remove"),s.x=li.tileToScreen(0)+li.pixelToScreen(12),s.y=li.tileToScreen(3)+li.pixelToScreen(2),s.setScrollFactor(0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:0,y:3}),(n=this.scene.add.text(s.x-.25*li.tileToScreen(2),s.y+.8*li.tileToScreen(2),i[0]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(I/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n);break;case 4:t[3]&&(a=t[3],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(I)).name="".concat(a,"_tn_to_remove"),s.x=li.tileToScreen(17)+li.pixelToScreen(10),s.y=li.tileToScreen(4)+li.pixelToScreen(2),s.setScrollFactor(0),s.setFlipX(!0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:17,y:4}),(n=this.scene.add.text(s.x-.25*li.tileToScreen(2),s.y+.8*li.tileToScreen(2),i[3]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(I/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n);case 3:t[0]&&(a=t[0],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(I)).name="".concat(a,"_tn_to_remove"),s.x=li.tileToScreen(0)+li.pixelToScreen(12),s.y=li.tileToScreen(0)+li.pixelToScreen(2),s.setScrollFactor(0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:0,y:0}),(n=this.scene.add.text(s.x-.25*li.tileToScreen(2),s.y+.8*li.tileToScreen(2),i[0]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(I/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n),t[2]&&(a=t[2],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(I)).name="".concat(a,"_tn_to_remove"),s.x=li.tileToScreen(0)+li.pixelToScreen(12),s.y=li.tileToScreen(4)+li.pixelToScreen(2),s.setScrollFactor(0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:0,y:4}),(n=this.scene.add.text(s.x-.25*li.tileToScreen(2),s.y+.8*li.tileToScreen(2),i[2]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(I/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n),t[1]&&(a=t[1],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(I)).name="".concat(a,"_tn_to_remove"),s.x=li.tileToScreen(17)+li.pixelToScreen(10),s.y=li.tileToScreen(0)+li.pixelToScreen(2),s.setScrollFactor(0),s.setFlipX(!0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:17,y:0}),(n=this.scene.add.text(s.x-.25*li.tileToScreen(2),s.y+.8*li.tileToScreen(2),i[1]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(I/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n)}e.drawWindow(o,{w:14,h:7,x:3,y:0})}},{key:"updateCharacterName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"closeUp_Mary",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"???",i=this.scene.children.getByName("dialog_tn_container"),a=i.list.find((function(t){return t.name==="char_".concat(e,"_text_to_remove")}));a.setText(t)}},{key:"prepareText",value:function(){var e=this.scene.add.text(li.tileToScreen(3.5),li.tileToScreen(4.5)," ",{fontFamily:"GameGirl",fill:"#ffffff",lineSpacing:2});e.setScrollFactor(0),e.displayHeight=10*I,e.displayWidth=10*I,e.name="placeholder_text",e.depth=20,e.setShadow(-1,1)}},{key:"writeText",value:function(e){var t=this,i=this.scene.children.getByName("placeholder_text");this.isFullTextDisplayed=!1;for(var a=e.join("").split("\n"),s=[];a.length;){for(var n="",o=a.shift().split(" ");o.length;){var r=n,l=o.shift();(n+=l+" ").trim().length>26&&(s.push(r),o.unshift(l),n="")}s.push(n)}var c,h=s.join("\n"),u=function(){clearTimeout(c),h.length&&d(h.length)},d=function e(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=h.substring(0,a);h=h.substring(a),i.setText(i.text+s),h.length?(c=setTimeout((function(){return e(1)}),[".","!","?"].includes(s)?500:50),t.tIDs.push(c)):(t.scene.input.keyboard.off("keyup",u),t.fullTextDisplayed())};d(),this.tIDs.push(setTimeout((function(){return t.scene.input.keyboard.once("keyup",(function(e){(ii(e.key)||ai(e.key))&&u()}))}),500))}},{key:"clearText",value:function(){this.scene.children.getByName("placeholder_text").setText("")}}],[{key:"drawWindow",value:function(e,t){for(var i=t.w,a=t.h,s=t.x,n=t.y,o={TOP_LEFT:6,TOP_MIDDLE:7,TOP_RIGHT:8,LEFT:16,MIDDLE:17,RIGHT:18,BOTTOM_LEFT:26,BOTTOM_MIDDLE:27,BOTTOM_RIGHT:28},r=0;r<a;r++)for(var l=0;l<i;l++){var c=void 0;0===l&&0===r&&(c=o.TOP_LEFT),l>0&&l<i-1&&0===r&&(c=o.TOP_MIDDLE),l===i-1&&0===r&&(c=o.TOP_RIGHT),0===l&&r>0&&r<a-1&&(c=o.LEFT),l>0&&l<i-1&&r>0&&r<a-1&&(c=o.MIDDLE),l===i-1&&r>0&&r<a-1&&(c=o.RIGHT),0===l&&r===a-1&&(c=o.BOTTOM_LEFT),l>0&&l<i-1&&r===a-1&&(c=o.BOTTOM_MIDDLE),l===i-1&&r===a-1&&(c=o.BOTTOM_RIGHT),e.putTileAt(c,l+s,r+n)}}}]),e}(),li=function(){function e(t,i){var a=this;Object(g.a)(this,e),this.scene=t,this.inGameMenu=null,this.setUpPuseResumeGame(),this.mushroomsIcon=null,this.diamondsIcon=null,this.scene.events.off("game_paused"),this.scene.events.on("game_paused",(function(){return a.showPauseMenu()})),this.scene.events.off("game_resumed"),this.scene.events.on("game_resumed",(function(){return a.hidePauseMenu()}));var s=[this.scene.sound.add("rock_hit"),this.scene.sound.add("rock_hit2"),this.scene.sound.add("rock_hit3")];this.scene.events.off("sounds:rock_hit_hard"),this.scene.events.on("sounds:rock_hit_hard",(function(){return s[Math.trunc(10*Math.random())%3].play()}));var n=[this.scene.sound.add("rock_slide_hard1"),this.scene.sound.add("rock_slide_hard2"),this.scene.sound.add("rock_slide_hard3")];this.scene.events.off("sounds:rock_slide_hard"),this.scene.events.on("sounds:rock_slide_hard",(function(){return n[Math.trunc(10*Math.random())%3].play()}));var o=[this.scene.sound.add("rock_slide_soft1"),this.scene.sound.add("rock_slide_soft2"),this.scene.sound.add("rock_slide_soft3")];this.scene.events.off("sounds:rock_slide_soft"),this.scene.events.on("sounds:rock_slide_soft",(function(){return o[Math.trunc(10*Math.random())%3].play()}));var r=this.scene.sound.add("rock_hit_soft");this.scene.events.off("sounds:rock_hit_soft"),this.scene.events.on("sounds:rock_hit_soft",(function(){return r.play()}));var l=this.scene.sound.add("gem_hit");this.scene.events.off("sounds:gem_hit"),this.scene.events.on("sounds:gem_hit",(function(){return l.play()}));var u=this.scene.sound.add("explosion");this.scene.events.off("sounds:explosion"),this.scene.events.on("sounds:explosion",(function(){return u.play()}));var d=this.scene.sound.add("shroom_pick");this.scene.events.off("sounds:shroom_pick"),this.scene.events.on("sounds:shroom_pick",(function(){return d.play()}));var p=this.scene.sound.add("gem_pick");this.scene.events.off("sounds:gem_pick"),this.scene.events.on("sounds:gem_pick",(function(){return p.play()}));var y=this.scene.sound.add("coin");this.scene.events.off("sounds:coin"),this.scene.events.once("sounds:coin",(function(){return y.play()}));var m=[this.scene.sound.add("clear_hit1"),this.scene.sound.add("clear_hit2"),this.scene.sound.add("clear_hit3")];this.scene.events.off("sounds:clear_hit"),this.scene.events.on("sounds:clear_hit",(function(){return m[Math.trunc(10*Math.random())%3].play()}));var f=this.scene.sound.add("death_by_rock");this.scene.events.off("sounds:death_by_rock_hit"),this.scene.events.on("sounds:death_by_rock_hit",(function(){return f.play()}));var v=this.scene.sound.add("level_complete");this.scene.events.off("sounds:level_complete"),this.scene.events.on("sounds:level_complete",(function(){return v.play()})),i||this.drawScores(),this.dialogs=new ri(this.scene),this.scene.events.off("dialogue:show"),this.scene.events.on("dialogue:show",(function(e){var t,i;null===(t=a.scene.levels)||void 0===t||null===(i=t.current)||void 0===i||i.pause(),a.dialogs.mount(),a.dialogs.showDialog(e)})),this.scene.events.off("dialogue:updateCharacterName"),this.scene.events.on("dialogue:updateCharacterName",function(){var e=Object(h.a)(c.a.mark((function e(t){var i,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.key,s=t.name,a.dialogs.updateCharacterName(i,s);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.scene.events.off("dialogue:nextPage"),this.scene.events.on("dialogue:nextPage",Object(h.a)(c.a.mark((function e(){var t,i=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.length>0&&void 0!==i[0]?i[0]:0,a.dialogs.currentDialogIndex+=t,a.dialogs.showMessage(a.dialogs.conversation[++a.dialogs.currentDialogIndex]);case 3:case"end":return e.stop()}}),e)})))),this.scene.events.off("dialogue:hide"),this.scene.events.on("dialogue:hide",Object(h.a)(c.a.mark((function e(){var t,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dialogs.hideDialog();case 2:a.scene.events.emit("dialogue:hidden"),a.dialogs.unmount(),null===(t=a.scene.levels)||void 0===t||null===(i=t.current)||void 0===i||i.resume();case 5:case"end":return e.stop()}}),e)})))),this.topWindowboxing=this.scene.add.graphics(),this.topWindowboxing.fillStyle(0,1),this.topWindowboxing.fillRect(0,-e.tileToScreen(9),e.tileToScreen(20),e.tileToScreen(10)),this.topWindowboxing.y=-e.tileToScreen(1.5),this.topWindowboxing.setScrollFactor(0),this.topWindowboxing.depth=110;var _=document.querySelector("canvas").height/(R*I);this.bottomWindowboxing=this.scene.add.graphics(),this.bottomWindowboxing.fillStyle(0,1),this.bottomWindowboxing.fillRect(0,e.tileToScreen(_-1),e.tileToScreen(20),e.tileToScreen(10)),this.bottomWindowboxing.y=e.tileToScreen(1.5),this.bottomWindowboxing.setScrollFactor(0),this.bottomWindowboxing.depth=110}return Object(_.a)(e,[{key:"setWindowBoxBehaviour",value:function(){var t,i,a,s,n,o,r,l=this,c=this.scoresLayer;if(!c)return!1;var h={topY:(null===(t=this.topWindowboxing)||void 0===t?void 0:t.y)||0,botY:(null===(i=this.bottomWindowboxing)||void 0===i?void 0:i.y)||0,lsY:null===c||void 0===c?void 0:c.y,dsY:(null===(a=this.diamondsScore)||void 0===a?void 0:a.y)||0,diY:(null===(s=this.diamondsIcon)||void 0===s?void 0:s.y)||0,miY:(null===(n=this.mushroomsIcon)||void 0===n?void 0:n.y)||0,msY:(null===(o=this.mushroomsScore)||void 0===o?void 0:o.y)||0,dsgY:(null===(r=this.diamondsScoreGoal)||void 0===r?void 0:r.y)||0,pbarY:0,pboxY:0};this.scene.events.off("player:disconnected"),this.scene.events.on("player:disconnected",(function(){var t,i,a,s;h.topY=(null===(t=l.topWindowboxing)||void 0===t?void 0:t.y)||0,h.botY=(null===(i=l.bottomWindowboxing)||void 0===i?void 0:i.y)||0,h.dsgY=(null===(a=l.diamondsScoreGoal)||void 0===a?void 0:a.y)||0,h.dsY=(null===(s=l.diamondsScore)||void 0===s?void 0:s.y)||0;var n=l.scene.children.getByName("circularProgress"),o=l.scene.children.getByName("progressBar1"),r=l.scene.children.getByName("progressBox1"),u=l.scene.children.getByName("progressBar2"),d=l.scene.children.getByName("progressBox2"),p=l.scene.children.getByName("progressBar3"),y=l.scene.children.getByName("progressBox3");h.circY=(null===n||void 0===n?void 0:n.y)||e.tileToPixels(4),h.pbar1Y=(null===o||void 0===o?void 0:o.y)||e.tileToPixels(3.75),h.pbox1Y=(null===r||void 0===r?void 0:r.y)||e.tileToPixels(3.75),h.pbar2Y=(null===u||void 0===u?void 0:u.y)||e.tileToPixels(3.75),h.pbox2Y=(null===d||void 0===d?void 0:d.y)||e.tileToPixels(3.75),h.pbar3Y=(null===p||void 0===p?void 0:p.y)||e.tileToPixels(3.75),h.pbox3Y=(null===y||void 0===y?void 0:y.y)||e.tileToPixels(3.75),l.scene.tweens.add({targets:{y:0},y:e.tileToPixels(5),ease:"Linear",duration:250,onUpdate:function(e,t){l.topWindowboxing.y=h.topY+t.y,l.bottomWindowboxing.y=h.botY-t.y,c.y=h.lsY-t.y,l.diamondsScore&&(l.diamondsScore.y=h.dsY-t.y),l.diamondsIcon&&(l.diamondsIcon.y=h.diY-t.y),l.mushroomsIcon&&(l.mushroomsIcon.y=h.miY-t.y),l.mushroomsScore&&(l.mushroomsScore.y=h.msY-t.y),l.diamondsScoreGoal&&(l.diamondsScoreGoal.y=h.dsgY-t.y),n&&(n.y=h.circY-t.y),o&&(o.y=h.pbar1Y-t.y),r&&(r.y=h.pbox1Y-t.y),u&&(u.y=h.pbar2Y-t.y),d&&(d.y=h.pbox2Y-t.y),p&&(p.y=h.pbar3Y-t.y),y&&(y.y=h.pbox3Y-t.y)}})})),this.scene.events.off("player:reconnected"),this.scene.events.on("player:reconnected",(function(){var t=l.scene.children.getByName("layer_scores"),i={y:e.tileToPixels(5)},a=l.scene.children.getByName("circularProgress"),s=l.scene.children.getByName("progressBar1"),n=l.scene.children.getByName("progressBox1"),o=l.scene.children.getByName("progressBar2"),r=l.scene.children.getByName("progressBox2"),c=l.scene.children.getByName("progressBar3"),u=l.scene.children.getByName("progressBox3");l.scene.tweens.add({targets:i,y:0,ease:"Linear",duration:1e3,onUpdate:function(e,i){l.topWindowboxing.y=h.topY-(1-i.y),l.bottomWindowboxing.y=h.botY+(1-i.y),t.y=h.lsY-i.y,l.diamondsScore&&(l.diamondsScore.y=h.dsY-i.y),l.diamondsIcon&&(l.diamondsIcon.y=h.diY-i.y),l.mushroomsIcon&&(l.mushroomsIcon.y=h.miY-i.y),l.mushroomsScore&&(l.mushroomsScore.y=h.msY-i.y),l.diamondsScoreGoal&&(l.diamondsScoreGoal.y=h.dsgY-i.y),a&&(a.y=h.circY-i.y),s&&(s.y=h.pbar1Y-i.y),n&&(n.y=h.pbox1Y-i.y),o&&(o.y=h.pbar2Y-i.y),r&&(r.y=h.pbox2Y-i.y),c&&(c.y=h.pbar3Y-i.y),u&&(u.y=h.pbox3Y-i.y)}})}))}},{key:"destroy",value:function(){var e,t,i,a,s;null===(e=this.mushroomsIcon)||void 0===e||e.destroy(),null===(t=this.diamondsIcon)||void 0===t||t.destroy(),null===(i=this.mushroomsScore)||void 0===i||i.destroy(),null===(a=this.diamondsScore)||void 0===a||a.destroy(),null===(s=this.diamondsScoreGoal)||void 0===s||s.destroy(),this.scene.events.off("score:diamond_goal"),this.scene.events.off("score:diamond_set"),this.scene.events.off("score:diamond_goal_set"),this.scene.events.off("score:mushroom_collected"),this.scene.events.off("score:mushroom_given")}},{key:"onResize",value:function(){var t,i,a,s,n;if(!this.scene.children.getByName("layer_scores"))return!1;this.mushroomsIcon.setPosition(e.tileToScreen(18),e.tileToScreen(1)).setScale(1.5*I);var o=window.localStorage.getItem("shrooms")||"0";null===(t=this.mushroomsScore)||void 0===t||t.setPosition(e.tileToScreen(20)-this.MT_MARGIN_RIGHT,e.tileToScreen(1)),null===(i=this.mushroomsScore)||void 0===i||i.setScrollFactor(0),this.mushroomsScore&&(this.mushroomsScore.displayHeight=10*I),this.mushroomsScore&&(this.mushroomsScore.displayWidth=10*o.length*I),this.diamondsIcon.setPosition(e.tileToScreen(1)+this.D_MARGIN_LEFT,e.tileToScreen(1)).setScale(1.5*I),null===(a=this.diamondsScoreGoal)||void 0===a||a.setPosition(e.tileToScreen(3)-this.DT_MARGIN_RIGHT,e.tileToScreen(1)),this.diamondsScoreGoal&&(this.diamondsScoreGoal.displayHeight=8*I),this.diamondsScoreGoal&&(this.diamondsScoreGoal.displayWidth=16*I),null===(s=this.diamondsScore)||void 0===s||s.setPosition(e.tileToScreen(3)-this.DT_MARGIN_RIGHT,e.tileToScreen(1)-(null===(n=this.diamondsScoreGoal)||void 0===n?void 0:n.test)!=="00"?e.tileToScreen(.5):0),this.diamondsScore&&(this.diamondsScore.displayHeight=10*I),this.diamondsScore&&(this.diamondsScore.displayWidth=10*this.diamondsAmount.length*I)}},{key:"hidePauseMenu",value:function(){var e=this.scene.children.list.find((function(e){return"layer_pause_nenu"===e.name}));e&&(e.setVisible(!1),this.inGameMenu.isVisible=!1),this.scene.children.list.filter((function(e){return e.name.includes("menu_text")})).forEach((function(e){return e.destroy()})),this.scene.children.list.filter((function(e){return e.name.includes("_tn_to_remove")})).forEach((function(e){return e.destroy()})),this.scene.children.list.filter((function(e){return e.name.includes("layer_arrow")})).forEach((function(e){return e.destroy()}))}},{key:"preapreScoreTilemap",value:function(){var e=this.scene.make.tilemap({tileWidth:20,tileHeight:20,width:20,height:20});e.addTilesetImage("hud-tiles","hud-tiles",20,20,1,2);var t=e.addTilesetImage("hud-tiles","hud-tiles",20,20,1,2),i=e.createBlankLayer("layer_scores",t);return i.name="layer_scores",i.depth=6,i.setScrollFactor(0),i.setScale(I),this.scoresLayer=i,e}},{key:"drawKiBossScores",value:function(){var e=this.preapreScoreTilemap();ri.drawWindow(e,{w:3,h:2,x:0,y:0}),ri.drawWindow(e,{w:3,h:2,x:17,y:0});var t=this.scene.add.sprite(e.tileToWorldX(18),e.tileToWorldY(1)).play("closeUp_Abushgidim").setOrigin(.5,.5).setScale(I());t.depth=16,t.name="score_right_img",t.setScrollFactor(0),this.mushroomsIcon=t;this.D_MARGIN_LEFT=-2*I;var i=this.scene.add.sprite(e.tileToWorldX(1)+this.D_MARGIN_LEFT,e.tileToWorldY(1)+2*I()).play("closeUp_tentacles").setOrigin(.5,.5).setScale(I());i.depth=16,i.name="score_left_img",i.setScrollFactor(0),this.diamondsIcon=i,this.setWindowBoxBehaviour()}},{key:"drawScores",value:function(){var t=Object(h.a)(c.a.mark((function t(){var i,a,s,n,o=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.preapreScoreTilemap(),ri.drawWindow(i,{w:3,h:2,x:0,y:0}),ri.drawWindow(i,{w:3,h:2,x:17,y:0}),(a=this.scene.add.sprite(i.tileToWorldX(18),i.tileToWorldY(1)).play("closeUp_Mushroom").setOrigin(.5,.5).setScale(1.5*I)).depth=6,a.name="score_img",a.setScrollFactor(0),this.mushroomsIcon=a,9,this.MT_MARGIN_RIGHT=9*I,t.t0=Math,t.next=13,Ke.get("totalShroomsAmount");case 13:if(t.t1=t.sent,t.t1){t.next=16;break}t.t1=0;case 16:t.t2=t.t1,s=t.t0.max.call(t.t0,t.t2,0),this.mushroomsScore=this.scene.add.text(i.tileToWorldX(20)-this.MT_MARGIN_RIGHT,i.tileToWorldY(1),String(s),{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}),this.mushroomsScore.setData("amount",s),this.mushroomsScore.setOrigin(1,0),this.mushroomsScore.displayHeight=10*I,this.mushroomsScore.displayWidth=10*String(s).length*I,this.mushroomsScore.name="score_text_to_remove",this.mushroomsScore.depth=6,this.mushroomsScore.setScrollFactor(0),this.mushroomsScore.setShadow(-1,1),.5,this.D_MARGIN_LEFT=.5*I,(n=this.scene.add.sprite(i.tileToWorldX(1)+this.D_MARGIN_LEFT,i.tileToWorldY(1)).play("closeUp_Diamond").setOrigin(.5,.5).setScale(1.5*I)).depth=6,n.name="score_img",n.setScrollFactor(0),this.diamondsIcon=n,this.scene.events.once("score:diamond_goal",(function(){o.scene.tweens.add({targets:n,scale:2*I,ease:"Linear",duration:250,yoyo:!0})})),9,this.DT_MARGIN_RIGHT=9*I,this.diamondsAmount="0",this.diamondsScore=this.scene.add.text(i.tileToWorldX(3)-this.DT_MARGIN_RIGHT,i.tileToWorldY(1),this.diamondsAmount,{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}),this.diamondsScore.setOrigin(1,0),this.diamondsScore.displayHeight=10*I,this.diamondsScore.displayWidth=10*this.diamondsAmount.length*I,this.diamondsScore.name="score_text_to_remove",this.diamondsScore.depth=6,this.diamondsScore.setScrollFactor(0),this.diamondsScore.setShadow(-1,1),this.diamondsScoreGoal=this.scene.add.text(i.tileToWorldX(3)-this.DT_MARGIN_RIGHT,i.tileToWorldY(1),"00",{fontFamily:"GameGirl",fill:"gold",align:"right"}),this.diamondsScoreGoal.alpha=0,this.diamondsScoreGoal.setOrigin(1,0),this.diamondsScoreGoal.displayHeight=8*I,this.diamondsScoreGoal.displayWidth=16*I,this.diamondsScoreGoal.name="score_text_to_remove",this.diamondsScoreGoal.depth=6,this.diamondsScoreGoal.setScrollFactor(0),this.diamondsScoreGoal.setShadow(-1,1),this.scene.events.on("score:mushroom_collected",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=o.mushroomsScore.getData("amount")+e;o.mushroomsScore.setText(t)})),this.scene.events.on("score:mushroom_given",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=Number(o.mushroomsScore.getData("amount"))-e;o.mushroomsScore.setText(String(t))})),window.scene=this.scene,this.scene.events.on("score:diamond_set",(function(e){o.diamondsAmount=e,o.diamondsScore.setText(e)})),this.scene.events.once("score:diamond_goal_set",(function(t){o.scene.tweens.add({targets:o.diamondsScore,y:e.tileToScreen(.5),ease:"Linear",duration:250,onComplete:function(){}});var i=o.diamondsScoreGoal.x;o.diamondsScoreGoal.x+=e.tileToScreen(.5),o.diamondsScoreGoal.alpha=0,o.diamondsScoreGoal.setText(t),o.scene.tweens.add({targets:o.diamondsScoreGoal,x:i,alpha:1,ease:"Linear",duration:250,delay:200})})),this.setWindowBoxBehaviour();case 61:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"drawMenuOptions",value:function(e){this.inGameMenu=new ni(this.scene),this.inGameMenu.showInGameMenu()}},{key:"showPauseMenu",value:function(){var e=this.scene.children.list.find((function(e){return"layer_pause_nenu"===e.name}));if(e)return e.setVisible(!0),this.drawMenuOptions(),this.inGameMenu.isVisible=!0,!0;var t=this.scene.make.tilemap({tileWidth:20,tileHeight:20,width:20,height:20}),i=t.addTilesetImage("hud-tiles","hud-tiles",20,20,1,2),a=t.createBlankLayer("layer_pause_nenu",i);a.name="layer_pause_nenu",a.depth=15,a.setScrollFactor(0),a.setScale(I),ri.drawWindow(t,{w:14,h:3,x:3,y:0}),this.drawMenuOptions(t),this.inGameMenu.isVisible=!0}},{key:"setUpPuseResumeGame",value:function(){this.scene.input.keyboard.removeListener("keydown",this.onKeyDown.bind(this)),this.scene.input.keyboard.addListener("keydown",this.onKeyDown.bind(this))}},{key:"onKeyDown",value:function(e){var t=this;ai(e.key)&&!this.dialogs.isShowing&&this.scene.levels.current.player.connected&&(this.scene.levels.current.isPaused?function(){t.scene.levels.current.resume(),t.scene.events.emit("game_resumed")}:function(){t.scene.levels.current.pause(),t.scene.events.emit("game_paused")})()}}],[{key:"tileToScreen",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e.pixelToScreen(t*R)}},{key:"tileToPixels",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e*R}},{key:"pixelToScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e*I}}]),e}(),ci=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,e,a)).moveIntentDir=Ee.UP,s.scanDirection="CW",s.anchorPosition=null,s.line1=null,s.debug=!1,s}return Object(_.a)(i,[{key:"addedToScene",value:function(){this.debug&&(this.directionLine=this.level.scene.add.line(li.tileToScreen(this.position.x)+li.tileToScreen(1)/2,li.tileToScreen(this.position.y)+li.tileToScreen(1)/2,0,0,0,-li.tileToScreen(1),255),this.directionLine.setRotation(Math.PI/2),this.directionLine.width=1,this.directionLine.height=1,this.directionLine.setOrigin(.5,.5),this.anchorLine=this.level.scene.add.line(li.tileToScreen(this.position.x)+li.tileToScreen(1)/2,li.tileToScreen(this.position.y)+li.tileToScreen(1)/2,0,0,0,-li.tileToScreen(1),65280),this.anchorLine.setRotation(Math.PI/2),this.anchorLine.width=1,this.anchorLine.height=1,this.anchorLine.setOrigin(.5,.5))}},{key:"overrunBy",value:function(e){var t,i;e.isClass(B)||(null===(t=this.alien)||void 0===t||t.destroy(),null===(i=this.line1)||void 0===i||i.destroy(),this.level.onCharacterDie(this),this.level.onEnemyKill(this));(e.isClass(ie)||e.isClass(Y))&&this.level.scene.events.emit("sounds:death_by_rock_hit"),this.level.enemy_die_effect.x=this.alien.x,this.level.enemy_die_effect.y=this.alien.y,this.level.enemy_die_effect.play("enemy_dies")}},{key:"loop",value:function(){this.moveIntentDir===Ee.RIGHT&&this.alien.flipX&&this.alien.setFlipX(!1),this.moveIntentDir!==Ee.LEFT||this.alien.flipX||this.alien.setFlipX(!0),this.debug&&(this.directionLine.setPosition(li.tileToScreen(this.position.x)+li.tileToScreen(1)/2,li.tileToScreen(this.position.y)+li.tileToScreen(1)/2),this.directionLine.setRotation(this.moveIntentDir===Ee.UP?0:this.moveIntentDir===Ee.RIGHT?Math.PI/2:this.moveIntentDir===Ee.DOWN?Math.PI:3*Math.PI/2),this.anchorPosition&&(this.anchorLine.setPosition(li.tileToScreen(this.position.x)+li.tileToScreen(1)/2,li.tileToScreen(this.position.y)+li.tileToScreen(1)/2),this.anchorLine.setRotation(this.anchorPosition.y<this.position.y?0:this.anchorPosition.x>this.position.x?Math.PI/2:this.anchorPosition.y>this.position.y?Math.PI:3*Math.PI/2)))}}]),i}(Fe);ci.className=U;var hi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a,s){var n;return Object(g.a)(this,i),(n=t.call(this,e,a)).name=s,n.moveIntentDir="",n.isFollowing=!1,n.isLeading=!1,n.leadingPath=[],a.scene.events.on("player_moves",n.onPlayerMoves.bind(Object(Ge.a)(n))),n.personalSpace=3,n}return Object(_.a)(i,[{key:"lookUp",value:function(){this.moveIntentDir=Ee.UP,this.alien.play("dwarf_look_up")}},{key:"onPlayerMoves",value:function(e){if(this.isCloseEnough(e)&&this.isLeading&&this.leadingPath.length){var t=this.leadingPath.shift();this.calcMoveIntentForLeader(t),this.level.moveObject(this,t)}}},{key:"isCloseEnough",value:function(e){var t=Math.abs(this.position.x-e.x),i=Math.abs(this.position.y-e.y);return t<this.personalSpace&&i<this.personalSpace}},{key:"calcMoveIntentForLeader",value:function(e){this.moveIntentDir=this.position.y<e.y?Ee.DOWN:this.moveIntentDir,this.moveIntentDir=this.position.y>e.y?Ee.UP:this.moveIntentDir,this.position.x<e.x&&(this.moveIntentDir=Ee.LEFT,this.animRunRight()),this.position.x>e.x&&(this.moveIntentDir=Ee.RIGHT,this.animRunLeft())}},{key:"destroy",value:function(){}},{key:"animIdle",value:function(){var e;null===(e=this.alien)||void 0===e||e.play("".concat(this.name,"_idle"))}},{key:"animRun",value:function(){var e="";this.moveIntentDir===Ee.UP&&(e="_up"),this.moveIntentDir===Ee.DOWN&&(e="_down");var t="".concat(this.name,"_run").concat(e);this.alien.anims.currentAnim.key!==t&&this.alien.play(t)}},{key:"animRunLeft",value:function(){this.alien.setFlipX(!0),this.alien.setOrigin(.25,.25)}},{key:"animRunRight",value:function(){this.alien.setFlipX(!1),this.alien.setOrigin(0,.25)}},{key:"animLayRight",value:function(){var e,t;null===(e=this.alien)||void 0===e||e.setFlipX(!1),null===(t=this.alien)||void 0===t||t.play("".concat(this.name,"_laying"))}},{key:"animLayLeft",value:function(){var e,t;null===(e=this.alien)||void 0===e||e.setFlipX(!0),null===(t=this.alien)||void 0===t||t.play("".concat(this.name,"_laying"))}},{key:"die",value:function(){this.inactive=!0,this.alien.alpha=0,this.level.scene.events.off("player_moves",this.onPlayerMoves),this.destroy()}},{key:"overrunBy",value:function(e){e.isClass(ie)&&this.level.scene.events.emit("sounds:death_by_rock_hit"),e.isClass(B)||this.die()}},{key:"runningOver",value:function(e){e.isClass(U)&&this.die()}}]),i}(Fe);hi.className=G;var ui=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!1,isPickable:!0,isCrushable:!1,level:a})).strength=4,s}return Object(_.a)(i,[{key:"overrunBy",value:function(e){e.isClass(di)&&(this.alien.destroy(),this.shine.destroy(),this.level.onJewelPick(this),this.level.scene.events.emit("sounds:gem_pick")),e.isClass(Le)&&(this.alien.destroy(),this.shine.destroy(),this.alien.destroy())}},{key:"move",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"move",this).call(this,e),this.shine||(this.shine=this.level.scene.add.sprite(48,16).setOrigin(.05,.2).play("diamond_shine"),this.shine.setScale(I()),this.shine.depth=4.5),this.shine.x=li.tileToScreen(e.x),this.shine.y=li.tileToScreen(e.y),this.isFalling?this.shine.stop():this.shine.play("diamond_shine")}}]),i}(Be);ui.className=Y;var di=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;Object(g.a)(this,i),(s=t.call(this,e,a)).power=.5,s.moveIntentDir="",s.connected=!0,s.torch=null,s.mandatoryPath=[],s.ligth=null,s.impersonateRockford=!1;var n=a.scene;return n.input.keyboard.removeListener("keydown",s.onKeyDown),n.input.keyboard.addListener("keydown",s.onKeyDown.bind(Object(Ge.a)(s))),n.input.keyboard.removeListener("keyup",s.onKeyUp),n.input.keyboard.addListener("keyup",s.onKeyUp.bind(Object(Ge.a)(s))),s}return Object(_.a)(i,[{key:"disconnect",value:function(){if(!this.connected)return!1;this.connected=!1,this.moveIntentDir="",this.inactive||this.animIdle(),this.level.scene.events.emit("player:disconnected")}},{key:"reconnect",value:function(){if(this.connected)return!1;this.connected=!0,this.level.scene.events.emit("player:reconnected")}},{key:"onKeyUp",value:function(e){si(this.moveIntentDir)===si(e.key)&&this.connected&&(this.moveIntentDir="",this.pushingDirection=null)}},{key:"onKeyDown",value:function(e){!e.repeat&&(Zt(e.key)||$t(e.key)||ei(e.key)||ti(e.key))&&this.connected&&(this.moveIntentDir=si(e.key),this.isMoving||this.level.playerLoop())}},{key:"destroy",value:function(){}},{key:"moveToNextPosition",value:function(){if(!this.mandatoryPath.length)return this.moveIntentDir="",this.animIdle(),!1;var e=this.mandatoryPath.shift();return this.calcMoveIntent(e),this.level.moveObject(this,e),!0}},{key:"calcMoveIntent",value:function(e){this.moveIntentDir=this.position.y<e.y?Ee.DOWN:this.moveIntentDir,this.moveIntentDir=this.position.y>e.y?Ee.UP:this.moveIntentDir,this.position.x<e.x&&(this.moveIntentDir=Ee.LEFT,this.animRunRight()),this.position.x>e.x&&(this.moveIntentDir=Ee.RIGHT,this.animRunLeft())}},{key:"animIdle",value:function(){var e,t,i,a,s,n,o=this.hasPickaxe?"brave_idle_pickaxe":this.impersonateRockford?"brave_idle_rockford":"brave_idle";""!==this.moveIntentDir&&this.canMoveDir(this.moveIntentDir)||this.inactive||(null===(e=this.alien)||void 0===e||e.play(o),null===(t=this.alien)||void 0===t||t.setFlipX(!1),null===(i=this.alien)||void 0===i||i.setOrigin(0,.25),null===(a=this.torch)||void 0===a||a.play("torch_idle"),null===(s=this.torch)||void 0===s||s.setFlipX(!1),null===(n=this.torch)||void 0===n||n.setOrigin(0,.25))}},{key:"animPushRight",value:function(){var e,t,i,a;null===(e=this.alien)||void 0===e||e.play("brave_push"),this.alien.setFlipX(!1),this.alien.setOrigin(0,.25),null===(t=this.torch)||void 0===t||t.play("torch_push"),null===(i=this.torch)||void 0===i||i.setFlipX(!1),null===(a=this.torch)||void 0===a||a.setOrigin(0,.25)}},{key:"animPushLeft",value:function(){var e,t,i,a;null===(e=this.alien)||void 0===e||e.play("brave_push"),this.alien.setFlipX(!0),this.alien.setOrigin(.25,.25),null===(t=this.torch)||void 0===t||t.play("torch_push"),null===(i=this.torch)||void 0===i||i.setFlipX(!0),null===(a=this.torch)||void 0===a||a.setOrigin(.25,.25)}},{key:"animRun",value:function(){var e="",t="",i="_run";Zt(this.moveIntentDir)&&(e="_up"),$t(this.moveIntentDir)&&(e="_down"),this.isBrakingGround&&(i="_break"),this.hasPickaxe&&(t="_pickaxe",""===e&&this.isBrakingGround&&Math.random()>.5&&(t+="_alt"));var a,s="brave"+i+t+e;this.alien.anims.currentAnim.key===s||this.inactive||(this.alien.play(s),null===(a=this.torch)||void 0===a||a.play("torch_run"+e))}},{key:"animRunRight",value:function(){var e,t;this.alien.setFlipX(!1),this.alien.setOrigin(0,.25),null===(e=this.torch)||void 0===e||e.setFlipX(!1),null===(t=this.torch)||void 0===t||t.setOrigin(0,.25)}},{key:"animRunLeft",value:function(){var e,t;this.alien.setFlipX(!0),this.alien.setOrigin(.25,.25),null===(e=this.torch)||void 0===e||e.setFlipX(!0),null===(t=this.torch)||void 0===t||t.setOrigin(.25,.25)}},{key:"die",value:function(){var e=this;this.inactive=!0;var t=this.level.scene;t.input.keyboard.off("keydown"),t.input.keyboard.off("keyup"),this.level.onCharacterDie(this),this.alien.play("brave_dies"),this.alien.on(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){e.destroy(),e.alien.alpha=0}))}},{key:"overrunBy",value:function(e){e.isClass(z)&&this.level.scene.events.emit("sounds:death_by_rock_hit"),e.constructor.className!==hi.className&&this.die()}},{key:"runningOver",value:function(e){if(e.isClass(ci)&&this.die(),e.isClass(Je)){var t=this.level.scene.children.getByName("layer_1").tilemap;this.level.break_effect.x=t.tileToWorldX(e.position.x),this.level.break_effect.y=t.tileToWorldY(e.position.y),this.level.break_effect.play("ground_breaks")}if(e.isClass(ui)){var i=this.level.scene.children.getByName("layer_1").tilemap;this.level.pick_effect.x=i.tileToWorldX(e.position.x),this.level.pick_effect.y=i.tileToWorldY(e.position.y),this.level.pick_effect.play("jewel_pick")}}},{key:"setupLight",value:function(){this.light=this.level.scene.lights.addLight(this.alien.x,this.alien.y,1e3).setColor(15124680).setIntensity(1.5)}},{key:"ligthTorch",value:function(){this.light||this.setupLight(),this.alien.alpha=1,this.torch=this.level.scene.add.sprite(48,16).setOrigin(0,.25),this.torch.setScale(this.alien.scaleX),this.torch.depth=4.5,this.torch.play("torch_idle"),this.level.scene.time.addEvent({delay:10,callback:function(){var e,t;this.torch&&(this.torch.x=null===(e=this.alien)||void 0===e?void 0:e.x,this.torch.y=null===(t=this.alien)||void 0===t?void 0:t.y)},callbackScope:this,repeat:-1}),this.level.scene.time.addEvent({delay:100,callback:function(){var e,t;this.light&&(this.light.x=this.alien.x,this.light.y=this.alien.y),!this.torch&&(null===(e=this.light)||void 0===e?void 0:e.intensity)>0&&this.light.setIntensity(this.light.intensity-.3);var i=this.position.y===this.level.exit.position.y&&Math.abs(this.position.x-this.level.exit.position.x)<=3;this.torch&&(null===(t=this.light)||void 0===t?void 0:t.intensity)<1.5&&!i&&(this.light.setIntensity(this.light.intensity+.3),d.a.Geom.Ellipse.Random(this.alien,this.light))},callbackScope:this,repeat:-1})}},{key:"setOffTorch",value:function(){this.torch.destroy(),this.torch=null,this.light.setIntensity(0),this.light=null}}]),i}(Fe);di.className=B;var pi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,e,a)).ephemeral=!0,s}return Object(_.a)(i,[{key:"overrunBy",value:function(e){e.isClass(di)&&this.level.onInteractWith(this)}}]),i}(Ce);pi.className=V;var yi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.apply(this,arguments)}return i}(pi);yi.className=J;var mi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!0,isPickable:!1,isCrushable:!0,level:a})).reach=1,s.strength=5,s.objectsToDestroyByExplostion=[],s.objectsToReachByExplostion=[],s.exploded=!1,s.key=Math.random(),s}return Object(_.a)(i,[{key:"addedToScene",value:function(){var e=this.level.scene.add.particles("spark").setScale(I);this.emitter=e.createEmitter(),this.emitter.setQuantity(15),this.emitter.setFrequency(1e3),this.emitter.setAngle({min:-180,max:90}),this.emitter.setSpeed({min:5,max:7}),this.emitter.setGravityY(1),this.emitter.setGravityX(.01),this.emitter.setLifespan({min:1e3,max:5e3}),this.emitter.alpha.onChange(.5),this.emitter.tint.onChange(13784064),this.emitter.stop()}},{key:"explode",value:function(){var e,t=this;if(this.exploded)return!1;null===(e=this.alien)||void 0===e||e.destroy(),this.level.parallelMovables=this.level.parallelMovables.filter((function(e){return e!==t})),this.level.replaceByEmpty(this),this.exploded=!0;for(var i=this.position.x-this.reach;i<=this.position.x+this.reach;i++)for(var a=function(e){var a=t.level.getObjectAt(i,e),s=a.isBreakable&&(a.strength||0)<10;if(s&&!t.level.objectIsEmpty(a)&&(t.objectsToDestroyByExplostion.push(a),a.isClass(z)&&(a.freeze=!0,t.level.parallelMovables=t.level.parallelMovables.filter((function(e){return e!==a})))),s||t.level.objectIsEmpty(a)||t.objectsToReachByExplostion.push(a),s||t.level.objectIsEmpty(a)||a&&a.isClass(Q)){var n=new Le(_e.EXPLOSION,t.level);n.setPosition({x:i,y:e}),t.level.setObjectAt(i,e,n),t.objectsToDestroyByExplostion.push(n)}},s=this.position.y-this.reach;s<=this.position.y+this.reach;s++)a(s);setTimeout((function(){return t.onExplode()}),125),this.level.scene.events.emit("sounds:explosion"),this.level.scene.events.emit("barre:explode",this),this.level.scene.cameras.main.shake(500,.003)}},{key:"onExplode",value:function(){var e=this,t=this.level;this.objectsToDestroyByExplostion.forEach((function(e){var i=new Le(_e.EXPLOSION,t);e.isClass(Le)||(e.overrunBy(i),t.onDestroyElement(e))})),this.objectsToDestroyByExplostion=[],this.objectsToReachByExplostion.forEach((function(t){t&&t.hitBy(new Le(_e.EXPLOSION,e.level))})),this.objectsToReachByExplostion=[],this.emitter.setPosition({min:li.tileToPixels(this.position.x),max:li.tileToPixels(this.position.x+1)},{min:li.tileToPixels(this.position.y),max:li.tileToPixels(this.position.y+1)}),this.level.onNextTick((function(t){e.emitter.stop()}))}},{key:"overrunBy",value:function(){this.explode()}},{key:"runningOver",value:function(e){e.isClass(Q)||this.explode()}}]),i}(Be);mi.className=ae;var fi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!1,isPickable:!0,isCrushable:!1,level:a})).strength=4,s}return Object(_.a)(i,[{key:"overrunBy",value:function(e){e.isClass(di)&&(this.alien.visible=!1,this.level.onMushroomPick(this),this.level.scene.events.emit("sounds:shroom_pick"),this.level.scene.events.emit("score:mushroom_collected")),e.isClass(Le)&&(this.alien.visible=!1,this.alien.destroy())}}]),i}(Be);fi.className=F;var vi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e,a){var s;return Object(g.a)(this,i),(s=t.call(this,{id:e,isRigid:!0,isBreakable:!1,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).isLit=!1,s.light=null,s.alien=a.scene.add.sprite(48,16).setOrigin(0,.5).play("wall_torch_idle"),s.alien.on(d.a.Animations.Events.ANIMATION_COMPLETE,(function(){s.isLit&&(s.alien.flipX?s.alien.setOrigin(0,.5):s.alien.setOrigin(.15,.5),s.alien.setFlipX(!s.alien.flipX),s.alien.play("wall_torch_lit"))})),s.alien.setScale(I()),s.strength=20,s.leftTrigger=null,s.rightTrigger=null,s}return Object(_.a)(i,[{key:"ignite",value:function(){this.alien.play("wall_torch_lighting"),this.isLit=!0,this.setUpLights()}},{key:"setPosition",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(k.a)(Object(w.a)(i.prototype),"setPosition",this).call(this,t),this.alien.x=li.tileToScreen(t.x),this.alien.y=li.tileToScreen(t.y),this.level.onNextTick((function(){a.setIgniteTriggers()}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setUpLights",value:function(){this.light=this.level.scene.lights.addLight(li.tileToScreen(this.position.x),li.tileToScreen(this.position.y),1e3).setColor(15124680).setIntensity(0),this.level.scene.time.addEvent({delay:100,callback:function(){if(!this.alien)return!1;this.light.intensity<1.5&&this.light.setIntensity(this.light.intensity+.3),d.a.Geom.Ellipse.Random({x:this.alien.x+li.tileToPixels(1),y:this.alien.y,width:this.alien.width,height:this.alien.height},this.light)},callbackScope:this,repeat:-1})}},{key:"proximityTrigger",value:function(e){e.isClass(di)&&e.torch&&!this.isLit&&this.ignite()}},{key:"setIgniteTriggers",value:function(){var e=this.level.getObjectAt(this.position.x-1,this.position.y),t=this.level.getObjectAt(this.position.x+1,this.position.y);if(e){var i=new pi(_e.INTERACTION,this);i.setPosition(e.position),i.overrunBy=this.proximityTrigger.bind(this),this.level.interactiveElements["".concat(i.position.x,"-").concat(i.position.y)]=i,this.leftTrigger=i}if(t){var a=new pi(_e.INTERACTION,this);a.setPosition(t.position),a.overrunBy=this.proximityTrigger.bind(this),this.level.interactiveElements["".concat(a.position.x,"-").concat(a.position.y)]=a,this.rightTrigger=a}}}]),i}(Ue);vi.className=j;var gi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.apply(this,arguments)}return i}($e);gi.className=L;var _i=gi,Ei=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The beginning",e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var a,s,n,o=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.unfinished&&t.events.once("levelstart",(function(){return o.showDialog1()})),(a=this.scene.add.image(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,"light_beam")).x=li.tileToScreen(14),a.y=li.tileToScreen(1),a.setOrigin(0,0),a.setScale(2*I),a.scaleX=2.4*I,a.setScrollFactor(1),a.depth=4.5,a.alpha=.5,s=t.add.particles("spark").setScale(I),(n=s.createEmitter()).setPosition({min:li.tileToPixels(17),max:li.tileToPixels(28)},{min:li.tileToPixels(0),max:li.tileToPixels(10)}),n.setQuantity(5),n.setFrequency(2e4),n.setAngle({min:0,max:360}),n.setSpeed(5),n.setGravityY(.1),n.setGravityX(0),n.setLifespan({min:1e4,max:5e4}),n.alpha.onChange(.5);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_1.dialog_1.mary_say_1")],options:[]}]})}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[Ie("level_1.dialog_2.mary_say_1")],options:[]}]})}},{key:"onInteractWith",value:function(e){Object(k.a)(Object(w.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(yi)&&this.onComplete(),e.isClass(pi)&&0===e.order&&this.unfinished&&this.showDialog2()}}]),i}(Xe);Ei.key="level_1";var Oi=Ei,Si=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this)).name="The escape",e.winningLoopRef=e.winningLoop.bind(Object(Ge.a)(e)),e}return Object(_.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.a)(Object(w.a)(i.prototype),"connectToScene",this).call(this,t);case 2:this.voidLevel=t.children.getByName("layer_1").tilemap.height-1,this.fx=this.scene.sound.add("earthquake"),t.events.on("update",this.winningLoopRef),this.startVoid(t);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"startVoid",value:function(e){var t=this,i=e.cameras.main;setTimeout((function(){i.shake(2e3,.005),t.fx.play()}),1500)}},{key:"playerLoop",value:function(){Object(k.a)(Object(w.a)(i.prototype),"playerLoop",this).call(this),this.voidLoop()}},{key:"resetAutoVoidTimer",value:function(){clearTimeout(this.autoDestroyTID),this.autoDestroyTID=setTimeout(this.destroyMap.bind(this),5e3)}},{key:"destroyMap",value:function(){var e=this;this.resetAutoVoidTimer();var t=this.scene.children.getByName("layer_1");if(!t)return!1;var i=t.tilemap,a=this.scene.cameras.main,s=this.voidLevel;t.fill(100,0,s,i.width,1),this.objects[s].forEach((function(t,i){(t.isClass($e)||t.isClass(Je))&&(e.objects[s][i]=new Ce(_e.EMPTY,e))})),this.moveables=this.moveables.filter((function(t){var i;return!(t.position.y>e.voidLevel)||(null===(i=t.alien)||void 0===i||i.destroy(),!1)})),a.shake(1e3,.001),this.fx.play(),this.voidLevel--,this.player.position.y>this.voidLevel&&(this.player.die(),this.onCharacterDie(this.player))}},{key:"voidLoop",value:function(){this.player.isMoving&&this.player.nextMoveDir===Ee.UP?(this.resetAutoVoidTimer(),this.voidLevel-this.player.position.y>8&&this.destroyMap()):this.player.isMoving&&""!==this.player.nextMoveDir&&this.destroyMap()}},{key:"destroy",value:function(){this.scene.events.off("update",this.winningLoopRef),this.fx.stop(),clearTimeout(this.autoDestroyTID)}},{key:"winningLoop",value:function(){this.player.position.y<5&&(clearTimeout(this.autoDestroyTID),this.scene.events.off("update",this.winningLoopRef),this.onComplete())}},{key:"onAddElement",value:function(e){e.isClass(di)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(Xe);Si.key="level_finale";var Ti,xi=Si,bi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e){var a;Object(g.a)(this,i),(a=t.call(this,{game:e,renderTarget:!0,fragShader:"\n  #ifdef GL_ES\n      precision highp float;\n  #endif\n\n  #define PI 3.1415926538\n\n  // Samplers\n  varying vec2 outTexCoord;\n  uniform sampler2D uMainSampler;\n\n  // Parameters\n  uniform vec2 curvature;\n  uniform vec2 screenResolution;\n  uniform vec2 scanLineOpacity;\n  uniform float vignetteOpacity;\n  uniform float brightness;\n  uniform float vignetteRoundness;\n\n\n  vec2 curveRemapUV(vec2 uv)\n  {\n      // as we near the edge of our screen apply greater distortion using a sinusoid.\n\n      uv = uv * 2.0 - 1.0;\n  vec2 offset = abs(uv.yx) / vec2(curvature.x, curvature.y);\n  uv = uv + uv * offset * offset;\n  uv = uv * 0.5 + 0.5;\n      return uv;\n  }\n\n  vec4 scanLineIntensity(float uv, float resolution, float opacity)\n  {\n      float intensity = sin(uv * resolution * PI * 2.0);\n      intensity = ((0.5 * intensity) + 0.5) * 0.9 + 0.1;\n      return vec4(vec3(pow(intensity, opacity)), 1.0);\n  }\n\n  vec4 vignetteIntensity(vec2 uv, vec2 resolution, float opacity, float roundness)\n  {\n      float intensity = uv.x * uv.y * (1.0 - uv.x) * (1.0 - uv.y);\n      return vec4(vec3(clamp(pow((resolution.x / roundness) * intensity, opacity), 0.0, 1.0)), 1.0);\n  }\n\n  void main(void) \n  {\n      vec2 remappedUV = curveRemapUV(vec2(outTexCoord.x, outTexCoord.y));\n      vec4 baseColor = texture2D(uMainSampler, remappedUV);\n\n      baseColor *= vignetteIntensity(remappedUV, screenResolution, vignetteOpacity, vignetteRoundness);\n\n      baseColor *= scanLineIntensity(remappedUV.x, screenResolution.y, scanLineOpacity.x);\n      baseColor *= scanLineIntensity(remappedUV.y, screenResolution.x, scanLineOpacity.y);\n\n      baseColor *= vec4(vec3(brightness), 1.0);\n\n      if (remappedUV.x < 0.0 || remappedUV.y < 0.0 || remappedUV.x > 1.0 || remappedUV.y > 1.0){\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      } else {\n          gl_FragColor = baseColor;\n      }\n  }\n",uniforms:["uMainSampler","curvature","screenResolution","scanLineOpacity","vignetteOpacity","brightness","vignetteRoundness"]})).set2f("curvature",6,100);var s=document.querySelector("#content").width,n=document.querySelector("#content").height;return a.set2f("screenResolution",s,n),a.set2f("scanLineOpacity",.5,.05),a.set1f("vignetteOpacity",.5),a.set1f("vignetteRoundness",1),a.set1f("brightness",1.25),window.document.querySelector("#content").style.marginLeft=0,window.document.querySelector("#content").style.marginTop=0,a}return Object(_.a)(i,[{key:"onPreRender",value:function(){document.querySelector("#content").width,document.querySelector("#content").height;this.set2f("screenResolution",640,480)}}]),i}(d.a.Renderer.WebGL.Pipelines.PostFXPipeline),Ai=function(){function e(t){Object(g.a)(this,e),this.scene=t,this.value=0,this.progressBar=null,this.progressBox=null,this.loadingText=null,this.percentText=null,this.draw()}return Object(_.a)(e,[{key:"setValue",value:function(e){this.value=e,this.updateProgress(),this.value>=1&&this.unload()}},{key:"updateProgress",value:function(){var e,t,i,a,s,n,o,r,l,c,h,u,d=(null===(e=this.scene)||void 0===e||null===(t=e.cameras)||void 0===t||null===(i=t.main)||void 0===i?void 0:i.worldView.x)+(null===(a=this.scene)||void 0===a||null===(s=a.cameras)||void 0===s||null===(n=s.main)||void 0===n?void 0:n.width)/2,p=(null===(o=this.scene)||void 0===o||null===(r=o.cameras)||void 0===r||null===(l=r.main)||void 0===l?void 0:l.worldView.y)+(null===(c=this.scene)||void 0===c||null===(h=c.cameras)||void 0===h||null===(u=h.main)||void 0===u?void 0:u.height)/2;this.percentText.setText(parseInt(100*this.value)+"%"),this.progressBar.clear(),this.progressBar.fillStyle(16777215,1),this.progressBar.fillRect(d-150,p-15,300*this.value,30)}},{key:"draw",value:function(){var e,t,i,a,s,n,o,r,l,c,h,u;this.progressBar=this.scene.add.graphics(),this.progressBox=this.scene.add.graphics(),this.progressBox.fillStyle(2236962,.8);var d=(null===(e=this.scene)||void 0===e||null===(t=e.cameras)||void 0===t||null===(i=t.main)||void 0===i?void 0:i.worldView.x)+(null===(a=this.scene)||void 0===a||null===(s=a.cameras)||void 0===s||null===(n=s.main)||void 0===n?void 0:n.width)/2,p=(null===(o=this.scene)||void 0===o||null===(r=o.cameras)||void 0===r||null===(l=r.main)||void 0===l?void 0:l.worldView.y)+(null===(c=this.scene)||void 0===c||null===(h=c.cameras)||void 0===h||null===(u=h.main)||void 0===u?void 0:u.height)/2,y=this.scene.cameras.main.width,m=this.scene.cameras.main.height;this.progressBox.fillRect(d-160,p-25,320,50),this.loadingText=this.scene.make.text({x:y/2,y:m/2-50,text:Ie("menu.main.loading_message"),style:{font:"20px monospace",fill:"#ffffff"}}),this.loadingText.setOrigin(.5,.5),this.percentText=this.scene.make.text({x:y/2,y:p+50,text:"0%",style:{font:"18px monospace",fill:"#ffffff"}}),this.percentText.setOrigin(.5,.5)}},{key:"unload",value:function(){this.progressBar.destroy(),this.progressBox.destroy(),this.loadingText.destroy(),this.percentText.destroy()}}]),e}(),ki=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.call(this,"LandingScene")}return Object(_.a)(i,[{key:"preload",value:function(){this.cameras.main.setPostPipeline(bi);var e=new Ai(this);this.load.on("progress",(function(t){e.setValue(t)})),this.load.on("complete",(function(){window.WebFont.load({custom:{families:["GameGirl","Emulogic"]},active:function(){e.setValue(1)}})})),this.load.script("webfont","https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"),this.load.image("main-tiles","./assets/tilemaps/world1_tiles_20x20.png"),this.load.image("gates-tiles","./assets/tilemaps/gates_tilemap_20x20.png"),this.load.image("hud-tiles","./assets/tilemaps/hud_tilemap_20x20.png"),this.load.image(lt.key,"./assets/maps/level_19.png"),this.load.image("".concat(lt.key,"_bg"),"./assets/maps/level_19_bg.png"),this.load.image(Oi.key,"./assets/maps/level_1.png"),this.load.image("".concat(Oi.key,"_bg"),"./assets/maps/level_1_bg.png"),this.load.image(ht.key,"./assets/maps/level_2.png"),this.load.image("".concat(ht.key,"_bg"),"./assets/maps/level_2_bg.png"),this.load.image(dt.key,"./assets/maps/level_3.png"),this.load.image("".concat(dt.key,"_bg"),"./assets/maps/level_3_bg.png"),this.load.image(yt.key,"./assets/maps/level_4.png"),this.load.image("".concat(yt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(ft.key,"./assets/maps/level_5.png"),this.load.image("".concat(ft.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(Ot.key,"./assets/maps/level_6.png"),this.load.image("".concat(Ot.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(Tt.key,"./assets/maps/level_7.png"),this.load.image("".concat(Tt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(bt.key,"./assets/maps/level_8.png"),this.load.image("".concat(bt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(kt.key,"./assets/maps/level_9.png"),this.load.image("".concat(kt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(Nt.key,"./assets/maps/level_10.png"),this.load.image("".concat(Nt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(It.key,"./assets/maps/level_11.png"),this.load.image("".concat(It.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(Mt.key,"./assets/maps/level_12.png"),this.load.image("".concat(Mt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(Ct.key,"./assets/maps/level_13.png"),this.load.image("".concat(Ct.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(Pt.key,"./assets/maps/level_14.png"),this.load.image("".concat(Pt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(Bt.key,"./assets/maps/level_15.png"),this.load.image("".concat(Bt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(Gt.key,"./assets/maps/level_16.png"),this.load.image("".concat(Gt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(Yt.key,"./assets/maps/level_17.png"),this.load.image("".concat(Yt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(Kt.key,"./assets/maps/level_18.png"),this.load.image("".concat(Kt.key,"_bg"),"./assets/maps/level_default_bg.png"),this.load.image(xi.key,"./assets/maps/level_finale.png"),this.load.image("Stage1_bg","./assets/images/stage_1_bg_art.png"),this.load.image("IntroTiamat","./assets/images/intro_tiamat.png"),this.load.image("IntroSky","./assets/images/intro_sky.png"),this.load.image("IntroClouds","./assets/images/intro_clouds.png"),this.load.image("IntroGround","./assets/images/intro_ground.png"),this.load.image("IntroGroundHigh","./assets/images/intro_ground_high.png"),this.load.image("IntroGroundBreak","./assets/images/intro_ground_break.png"),this.load.image("IntroComet","./assets/images/intro_comet.png"),this.load.image("IntroPeopleClimbing","./assets/images/intro_people_climbing.png"),this.load.image("IntroPeoplePraying","./assets/images/intro_people_praying.png"),this.load.image("IntroPeoplePrayingHigh","./assets/images/intro_people_praying_high.png"),this.load.image("IntroPeopleDescending","./assets/images/intro_people_descending.png"),this.load.image("IntroPeopleFalling","./assets/images/intro_people_falling.png"),this.load.image("IntroPeopleJumping","./assets/images/intro_people_jumping.png"),this.load.image("IntroStorm","./assets/images/intro_storm.png"),this.load.image("Prologue","./assets/images/Prologue.png"),this.load.image("thechild","./assets/images/thechild.png"),this.load.image("theworld","./assets/images/theworld.png"),this.load.image("Tiamat","./assets/images/Tiamat.png"),this.load.image("Cover","./assets/images/cover.png"),this.load.image("Bossfight","./assets/images/Bossfight.png"),this.load.image("Bossfighthands","./assets/images/Bossfighthands.png"),this.load.image("spark","./assets/sprites/flare_blue.png"),this.load.image("light_beam","./assets/sprites/light_beam.png"),this.load.spritesheet("boulder","./assets/sprites/boulder_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("explosion","./assets/sprites/explosion_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("torch","./assets/sprites/torch_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("brave","./assets/sprites/brave_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("bro","./assets/sprites/bro_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("dwarf","./assets/sprites/dwarf_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("boss","./assets/sprites/boss_sprite.png",{frameWidth:20,frameHeight:20}),this.load.spritesheet("gate","./assets/sprites/gate_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("bat","./assets/sprites/bat_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("pickables","./assets/sprites/pickables_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("closeUp","./assets/sprites/close_up_sprite.png",{frameWidth:40,frameHeight:40}),this.load.spritesheet("closeUpItems","./assets/sprites/close_up_sprite.png",{frameWidth:20,frameHeight:20}),this.load.audio("credits","./assets/audio/Score/Opening Credits_.mp3"),this.load.audio("opening_peace","./assets/audio/Score/NormalDay.mp3"),this.load.audio("opening_quakes","./assets/audio/Score/Earthquakes+Tiamat.mp3"),this.load.audio("credits","./assets/audio/Score/NormalDay.mp3"),this.load.audio("levels_surface","./assets/audio/Score/1st 7 Levels.mp3"),this.load.audio("swarf_chat_music","./assets/audio/Score/MushroomDwarfDialogue(loop).mp3"),this.load.audio("generic_chat_music","./assets/audio/Score/GenericDialogue(loop).mp3"),this.load.audio("escape_music","./assets/audio/Score/BossBattle_EscapeTheVoid!(loop).mp3"),this.load.audio("rock_hit","./assets/audio/SFX/RockHit.mp3"),this.load.audio("rock_hit2","./assets/audio/SFX/RockHit2.mp3"),this.load.audio("rock_hit3","./assets/audio/SFX/RockHit3.wav"),this.load.audio("rock_hit_soft","./assets/audio/SFX/RockHitSoft.mp3"),this.load.audio("explosion","./assets/audio/SFX/MidSizeExplosion.mp3"),this.load.audio("clear_hit1","./assets/audio/SFX/PickaxeClearingGround1.mp3"),this.load.audio("clear_hit2","./assets/audio/SFX/PickaxeClearingGround2.mp3"),this.load.audio("clear_hit3","./assets/audio/SFX/PickaxeClearingGround3.mp3"),this.load.audio("rock_slide_hard1","./assets/audio/SFX/RockSlideHard1.mp3"),this.load.audio("rock_slide_hard2","./assets/audio/SFX/RockSlideHard2.mp3"),this.load.audio("rock_slide_hard3","./assets/audio/SFX/RockSlideHard3.mp3"),this.load.audio("rock_slide_soft1","./assets/audio/SFX/RockSlideSoft1.mp3"),this.load.audio("rock_slide_soft2","./assets/audio/SFX/RockSlideSoft2.mp3"),this.load.audio("rock_slide_soft3","./assets/audio/SFX/RockSlideSoft3.mp3"),this.load.audio("coin","./assets/audio/SFX/CoinSound.mp3"),this.load.audio("gem_hit","./assets/audio/SFX/GemHitRock.mp3"),this.load.audio("shroom_pick","./assets/audio/SFX/MushroomPickUp.mp3"),this.load.audio("gem_pick","./assets/audio/SFX/DiamondPickUp.mp3"),this.load.audio("death_by_rock","./assets/audio/SFX/DeathByRock.mp3"),this.load.audio("level_complete","./assets/audio/SFX/Level Finish.mp3"),this.load.audio("earthquake","./assets/audio/SFX/Earthquake.mp3")}},{key:"navigateToScene",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.cameras.main.fade(500,0,0,0),this.cameras.main.once("camerafadeoutcomplete",(function(){t.scene.start(e,i)}))}},{key:"create",value:function(){var e=this;this.add.text(80*I(),121*I()+20*I(),Ie("menu.main.key_to_start"),{fontFamily:"GameGirl",fontSize:"40px",fill:"#ffffff"}).setShadow(-1,1).setScale(I()/5),this.input.keyboard.on("keydown",(function(t){e.navigateToScene("SplashScreenScene")}))}}]),i}(d.a.Scene),wi=function(e){return window.credits_score||(window.credits_score=e.sound.add("credits",{loop:!0,valume:0})),window.credits_score},Ni=function(e){Di(e);var t=wi(e);t.isPlaying||(t.play(),t.volume=0,e.tweens.add({targets:t,volume:1,delay:10,ease:"Linear",duration:1e3}))},Ri=function(e){var t=wi(e);t.isPlaying&&e.tweens.add({targets:t,volume:0,ease:"Linear",duration:1e3,onComplete:function(){t.stop()}})},Ii=function(e){return window.resume_score||(window.resume_score=e.sound.add("generic_chat_music",{loop:!0,valume:0})),window.resume_score},Di=function(e){var t=Ii(e);t.isPlaying&&e.tweens.add({targets:t,volume:0,ease:"Linear",duration:1e3,onComplete:function(){t.stop()}})},Mi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.call(this,"MenuScene")}return Object(_.a)(i,[{key:"preload",value:function(){}},{key:"navigateToScene",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.cameras.main.fade(500,0,0,0),this.tweens.add({targets:Ti,volume:0,ease:"Linear",duration:500,onComplete:function(){Ti.pause(),t.scene.start(e,i)}})}},{key:"create",value:function(){var e=this;this.cameras.main.setPostPipeline(bi),this.cameras.main.setBackgroundColor("#486859");var t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"Stage1_bg"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.max(i,a);t.setScale(1.5*s).setScrollFactor(0),t.name="background_art",Ni(this),Ti=this.sound.add("credits",{loop:!0}),window.WebFont.load({custom:{families:["GameGirl"]},active:function(){e.cameras.main.fadeIn(500,0,0,0),e.events.emit("scene_ready",e.sys.config),Ti=e.sound.add("credits",{loop:!0}),e.input.keyboard.off("keydown"),e.input.keyboard.on("keydown",(function(t){console.log(t.key),ai(t.key)&&e.navigateToScene("SplashScreenScene")})),new ni(e).showMainMenu()}})}}]),i}(d.a.Scene),Ui=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){var e;return Object(g.a)(this,i),(e=t.call(this,"IntroScene")).images={tiamat:null,sky:null,clouds:null,storm:null,ground:null,ground_high:null,ground_break:null,comet:null,people_climbing:null,people_paying:null,people_paying_high:null,people_descending:null,people_falling:null,people_jumping:null},e.texts={line1:null,line2:null,line3:null,level_title:null},e.sounds={background_music:null,dramatic_music:null,earthquake:null},e}return Object(_.a)(i,[{key:"preload",value:function(){Ke.reset()}},{key:"createAnimations",value:function(){this.anims.create({key:"closeUp_Mary",frames:this.anims.generateFrameNumbers("closeUp",{frames:[0]}),repeat:0}),this.anims.create({key:"closeUp_Marduk",frames:this.anims.generateFrameNumbers("closeUp",{frames:[1]}),repeat:0}),this.anims.create({key:"closeUp_Dwarf",frames:this.anims.generateFrameNumbers("closeUp",{frames:[2]}),repeat:0}),this.anims.create({key:"closeUp_Tiamat",frames:this.anims.generateFrameNumbers("closeUp",{frames:[5]}),repeat:0})}},{key:"createSounds",value:function(){this.sounds.background_music=this.sound.add("opening_peace",{loop:!0}),this.sounds.dramatic_music=this.sound.add("opening_quakes",{loop:!0}),this.sounds.earthquake=this.sound.add("earthquake")}},{key:"createTextPlaceholders",value:function(){this.texts.line1=this.createTextLine(-4),this.texts.line2=this.createTextLine(-3),this.texts.line3=this.createTextLine(-2),this.texts.level_title=this.createTextLine(0),this.texts.level_title.setPosition(this.cameras.main.width/2,this.cameras.main.height/2),this.texts.level_title._shadow.setPosition(this.cameras.main.width/2,this.cameras.main.height/2),this.texts.level_title.setOrigin(.5,.5),this.texts.level_title._shadow.setOrigin(.5,.5),this.texts.level_title.alpha=0,this.texts.level_title._shadow.alpha=0,this.texts.level_title.setText(Ie("stage_1.title"))}},{key:"createTextLine",value:function(e){var t=10*I,i=e<0?this.cameras.main.height:0,a=e<0?-1:1,s=2*I,n=i+Math.abs(t*e)*a,o=this.add.text(80,10,"",{fontFamily:"GameGirl",fontSize:"10px",fill:"#ffffff"}).setScale(I).setPosition(s,n);o.displayHeight=t;var r=this.add.text(o.x+5,o.y-5,"",o.style).setScale(I);return r.displayHeight=o.displayHeight,o.setTint(3355443),r._setText=r.setText,r._shadow=o,r.setText=function(e){r._shadow.setText(e),r._setText(e)},r}},{key:"createImages",value:function(){this.images.sky=this.createFullscreenImage("IntroSky"),this.images.clouds=this.createFullscreenImage("IntroClouds"),this.images.tiamat=this.createFullscreenImage("IntroTiamat"),this.images.ground=this.createFullscreenImage("IntroGround"),this.images.comet=this.createFullscreenImage("IntroComet"),this.images.storm=this.createFullscreenImage("IntroStorm"),this.images.ground_high=this.createFullscreenImage("IntroGroundHigh"),this.images.ground_break=this.createFullscreenImage("IntroGroundBreak"),this.images.people_climbing=this.createFullscreenImage("IntroPeopleClimbing"),this.images.people_falling=this.createFullscreenImage("IntroPeopleFalling"),this.images.people_paying=this.createFullscreenImage("IntroPeoplePraying"),this.images.people_paying_high=this.createFullscreenImage("IntroPeoplePrayingHigh"),this.images.people_descending=this.createFullscreenImage("IntroPeopleDescending"),this.images.people_jumping=this.createFullscreenImage("IntroPeopleJumping")}},{key:"createFullscreenImage",value:function(e){var t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,e);return t.setScale(I).setScrollFactor(0),t.alpha=0,t}},{key:"animEnterTiamat",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var i=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){i.tweens.add({targets:i.images.tiamat,alpha:1,duration:t,ease:"Linear",onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"animExitTiamat",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var i=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){i.tweens.add({targets:i.images.tiamat,alpha:0,duration:t,ease:"Linear",onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"animEnterWorld",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:t.images.sky,alpha:1,duration:2500,ease:"Linear"}),t.tweens.add({targets:t.images.clouds,alpha:1,delay:3e3,duration:2500,ease:"Linear"}),t.tweens.add({targets:t.images.comet,alpha:1,delay:6e3,duration:2500,ease:"Linear"}),t.tweens.add({targets:t.images.ground,alpha:1,delay:9e3,duration:2500,ease:"Linear",onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animEnterPeople",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 3e3,e.abrupt("return",new Promise((function(e){t.tweens.add({targets:t.images.people_climbing,delay:3e3,alpha:1,duration:1e3,yoyo:!0,hold:1e3,ease:"Linear"}),t.tweens.add({targets:t.images.people_paying,alpha:1,delay:5e3,duration:1e3,ease:"Linear",onComplete:e})})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animGroundTransition",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:[t.images.people_paying,t.images.ground],alpha:0,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.images.people_paying_high,t.images.ground_high],alpha:1,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.images.people_paying_high],alpha:0,delay:2e3,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.images.people_descending],alpha:1,delay:2e3,duration:1e3,ease:"Linear",completeDelay:2e3,onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animPage",value:function(){var e=Object(h.a)(c.a.mark((function e(t){var i=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){i.texts.line1.alpha=i.texts.line2.alpha=i.texts.line3.alpha=0,i.tweens.add({targets:[i.texts.line1,i.texts.line1._shadow,i.texts.line2,i.texts.line2._shadow,i.texts.line3,i.texts.line3._shadow],alpha:1,duration:1e3,completeDelay:t,onComplete:function(){i.tweens.add({targets:[i.texts.line1,i.texts.line1._shadow,i.texts.line2,i.texts.line2._shadow,i.texts.line3,i.texts.line3._shadow],alpha:0,duration:1e3,onComplete:e})}})})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"animPage1",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.texts.line1.setText(Ie("intro.story_page_1.line_1")),this.texts.line2.setText(Ie("intro.story_page_1.line_2")),e.abrupt("return",this.animPage(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animPage2",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.texts.line1.setText(Ie("intro.story_page_2.line_1")),this.texts.line2.setText(Ie("intro.story_page_2.line_2")),this.texts.line3.setText(Ie("intro.story_page_2.line_3")),e.abrupt("return",this.animPage(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animPage3",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.texts.line1.setText(Ie("intro.story_page_3.line_1")),this.texts.line2.setText(Ie("intro.story_page_3.line_2")),this.texts.line3.setText(Ie("intro.story_page_3.line_3")),e.abrupt("return",this.animPage(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animPage4",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.texts.line1.setText(Ie("intro.story_page_4.line_1")),this.texts.line2.setText(Ie("intro.story_page_4.line_2")),this.texts.line3.setText(""),e.abrupt("return",this.animPage(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animPage5",value:function(){var e=Object(h.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.texts.line1.setText(Ie("intro.story_page_5.line_1")),this.texts.line2.setText(Ie("intro.story_page_5.line_2")),this.texts.line3.setText(""),e.abrupt("return",this.animPage(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animEarthquake",value:function(){var e=Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cameras.main.shake(2e3,.005),this.sounds.earthquake.play();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"animStormEnter",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:[t.images.storm],alpha:1,duration:2e3,ease:"Linear",completeDelay:2e3,onComplete:function(){t.images.clouds.alpha=0,t.images.comet.alpha=0,t.images.ground.alpha=0,t.images.sky.alpha=0,e()}})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animEnterFalling",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:[t.images.ground_high,t.images.people_descending],alpha:0,delay:1e3,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.images.ground_break,t.images.people_falling],alpha:1,delay:1e3,duration:1e3,ease:"Linear",completeDelay:2e3,onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animEnterJumping",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:[t.images.people_falling],alpha:0,delay:1e3,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.images.people_jumping],alpha:1,delay:1e3,duration:1e3,ease:"Linear",completeDelay:5e3,onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animLevelTitle",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:[t.images.people_jumping,t.images.ground_break,t.images.storm],alpha:0,delay:1e3,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.texts.level_title,t.texts.level_title._shoadow],alpha:1,delay:1e3,duration:1e3,ease:"Linear",completeDelay:5e3,onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"playMusic",value:function(){this.sounds.background_music.play()}},{key:"playDramaticMusic",value:function(){var e=this;this.tweens.add({targets:this.sounds.background_music,volume:0,duration:500,completeDelay:1e3,onComplete:function(){e.sounds.background_music.stop(),e.sounds.dramatic_music.play()}})}},{key:"exitMusic",value:function(){var e=this;this.tweens.add({targets:this.sounds.dramatic_music,volume:0,duration:1500,onComplete:function(){e.sounds.dramatic_music.stop()}})}},{key:"create",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ri(this),this.cameras.main.setPostPipeline(bi),new li(this,!0),this.createAnimations(),this.createSounds(),this.createImages(),this.createTextPlaceholders(),this.playMusic(),this.animEnterTiamat(5e3),e.next=11,this.animPage1(8e3);case 11:return this.animEnterWorld(),e.next=14,this.animPage2(8e3);case 14:return this.animEnterPeople(),e.next=17,this.animPage3(8e3);case 17:return e.next=19,this.showFirstDialogs();case 19:return e.next=21,this.animExitTiamat(5e3);case 21:return e.next=23,this.animGroundTransition();case 23:return e.next=25,this.showSecondDialogs();case 25:return this.playDramaticMusic(),e.next=28,this.animStormEnter();case 28:return this.animEarthquake(),this.animEnterFalling(),e.next=32,this.animPage4(4e3);case 32:return this.animPage5(6e3),e.next=35,this.animEnterJumping();case 35:return this.exitMusic(),e.next=38,this.animLevelTitle();case 38:this.cameras.main.fade(1e3,0,0,0),this.cameras.main.once("camerafadeoutcomplete",(function(){return t.scene.start("GameScene",{levelName:Oi.key})}));case 40:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showFirstDialogs",value:function(){var e=this;return this.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Tiamat","closeUp_Marduk"],participantNames:["Mary","Tiamat","Marduk"],conversation:[{who:"closeUp_Tiamat",text:[Ie("intro.dialog_1.tiamat_say_1")]},{who:"closeUp_Mary",text:[Ie("intro.dialog_1.mary_say_1")]},{who:"closeUp_Tiamat",text:[Ie("intro.dialog_1.tiamat_say_2")]},{who:"closeUp_Mary",text:[Ie("intro.dialog_1.mary_say_2")]},{who:"closeUp_Tiamat",text:[Ie("intro.dialog_1.tiamat_say_3")]},{who:"closeUp_Marduk",text:[Ie("intro.dialog_1.marduk_say_1")]},{who:"closeUp_Mary",text:[Ie("intro.dialog_1.mary_say_3")]},{who:"closeUp_Tiamat",text:[Ie("intro.dialog_1.tiamat_say_4")]},{who:"closeUp_Tiamat",text:[Ie("intro.dialog_1.tiamat_say_5")]},{who:"closeUp_Tiamat",text:[Ie("intro.dialog_1.tiamat_say_6")]}]}),new Promise((function(t){e.levels={current:{pause:function(){return!1},resume:function(){setTimeout(t,1e3)}}}}))}},{key:"showSecondDialogs",value:function(){var e=this;return this.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Marduk"],participantNames:["Mary","Marduk"],conversation:[{who:"closeUp_Marduk",text:[Ie("intro.dialog_2.marduk_say_1")]},{who:"closeUp_Mary",text:[Ie("intro.dialog_2.mary_say_1")]},{who:"closeUp_Marduk",text:[Ie("intro.dialog_2.marduk_say_2")]},{who:"closeUp_Mary",text:[Ie("intro.dialog_2.mary_say_2")]},{who:"closeUp_Marduk",text:[Ie("intro.dialog_2.marduk_say_3")]},{who:"closeUp_Mary",text:[Ie("intro.dialog_2.mary_say_3")]},{who:"closeUp_Marduk",text:[Ie("intro.dialog_2.marduk_say_4")]}]}),new Promise((function(t){e.levels={current:{pause:function(){return!1},resume:function(){setTimeout(t,1e3)}}}}))}},{key:"showThirdDialogs",value:function(){var e=this;this.levels={current:{pause:function(){return!1},resume:function(){e.tweens.add({targets:e.quakesMusic,volume:0,duration:500,completeDelay:500,onComplete:function(){e.scene.start("GameScene",{level:1})}})}}},this.events.emit("dialogue:show",{participants:[],conversation:[{who:"",text:["- A fissure opens up","beneath Marduk and he","falls into"]},{who:"",text:["- Mary rolls her eyes","and jumps in after"]}]})}},{key:"animateIntro",value:function(){var e=this;this.cameras.main.pan(this.renderer.width,this.renderer.height/2,2e3,"Sine.easeInOut"),this.cameras.main.once(d.a.Cameras.Scene2D.Events.PAN_COMPLETE,(function(){e.cameras.main.shake(2e3,.02),e.tweens.add({targets:e.children.getByName("dark"),y:.3*-e.renderer.height,duration:2e3}),e.tweens.add({targets:e.children.getByName("partner"),y:e.renderer.height,delay:2e3,duration:2e3,ease:"Sine.in"}),e.tweens.add({targets:e.children.getByName("player"),y:e.renderer.height,x:{value:e.children.getByName("player").x+150,duration:1e3,ease:"Cubic.easeOut"},delay:4e3,duration:2e3,ease:"Back.easeInOut",onComplete:function(){e.cameras.main.fade(1e3,0,0,0),e.cameras.main.once("camerafadeoutcomplete",(function(){e.scene.start("GameScene",{level:1})}))}})}))}}]),i}(d.a.Scene),Ci=i(35),Li=function(e,t){for(var i=e.get(t).getSourceImage(),a=Array(i.height).fill("000000").map((function(){return Array(i.width).fill("000000")})),s=0;s<i.width;s++)for(var n=0;n<i.height;n++){var o=e.getPixel(s,n,t),r="".concat(d.a.Display.Color.ComponentToHex(o.r)).concat(d.a.Display.Color.ComponentToHex(o.g)).concat(d.a.Display.Color.ComponentToHex(o.b));a[n][s]=r}return a},Pi=function(e){return e.toLocaleString("en-US",{minimumIntegerDigits:2})},ji=function(e,t){return"number"==typeof t?"".concat(Pi(e),"/").concat(Pi(t)):"__/__"},Bi=function(e){var t=(100*e).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return e?" ".concat(t<=9?"  ":t<=99?" ":"").concat(t,"%"):"   -"},Hi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.apply(this,arguments)}return i}(Pe);Hi.className=$;var Gi,Fi=["",lt,Oi,ht,dt,yt,ft,Ot,Tt,bt,kt,Nt,It,Mt,zt,Ct,Pt,Bt,Gt,Yt,qt,Kt,lt],Wi=function(e){var t,i=Fi.findIndex((function(t){return t.key===e}));do{i++,t=Fi[i]}while("string"===typeof t||i>Fi.length);return t.key},Yi=function(){function e(t){var i=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(g.a)(this,e),this.currentName=a,this.currentIndex=Fi.findIndex((function(e){return e.id===i.currentName})),this.scene=t,this.start()}return Object(_.a)(e,[{key:"start",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t,i,s,n,o,r=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Fi.find((function(e){return e.key===r.currentName})),this.current=new t,i=this.generateConfig(),s=Object(a.a)(i,2),n=s[0],o=s[1],this.current.config=n,this.current.bgConfig=o,this.map=this.createMap(),this.createBackground(),e.next=9,this.current.connectToScene(this.scene);case 9:this.scene.cameras.main.once("camerafadeincomplete",(function(){r.scene.events.emit("levelstart")})),this.current.pause();case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"restart",value:function(){var e=this;this.scene.cameras.main.fade(500,0,0,0),this.scene.cameras.main.once("camerafadeoutcomplete",(function(){var t;e.scene.events.off("player_moves"),e.current.destroy(),e.scene.children.list.forEach((function(e){e.destroy()})),e.scene.rules.destroy(),e.scene.ui.destroy(),null===(t=e.scene.levels.current)||void 0===t||t.destroy(),e.scene.scene.restart({levelName:e.currentName,isRestart:!0})}))}},{key:"next",value:function(){this.currentIndex+=1,"string"===typeof Fi[this.currentIndex]&&Fi[this.currentIndex].includes("cinematic")?this.scene.scene.start("ConnectorScene",{id:this.currentIndex,name:Fi[this.currentIndex]}):Fi[this.currentIndex]?this.start():this.scene.scene.start("MenuScene")}},{key:"generateConfig",value:function(){var e,t,i=this.scene,a=this.current.constructor.key;if(this.current.isMaze){e=Array(24).fill("000000").map((function(e){return Array(81).fill("000000")})),Object(Ci.a)(40,10,!0,Math.round(Math.random()*Math.pow(10,8))).forEach((function(t){t.forEach((function(t){var i=2*t.x+1,a=2*t.y+1+3;e[a-1][i]=t.top?_e.WALL:_e.EMPTY,t.top&&(e[a-1][i+1]=_e.WALL,e[a-1][i-1]=_e.WALL),e[a][i+1]=t.right?_e.WALL:_e.EMPTY,t.right&&(e[a+1][i+1]=_e.WALL,e[a-1][i+1]=_e.WALL),e[a+1][i]=t.bottom?_e.WALL:_e.EMPTY,t.bottom&&(e[a+1][i+1]=_e.WALL,e[a+1][i-1]=_e.WALL),e[a][i-1]=t.left?_e.WALL:_e.EMPTY,t.left&&(e[a+1][i-1]=_e.WALL,e[a-1][i-1]=_e.WALL),e[a][i]=_e.EMPTY}))})),e[4][1]=_e.PLAYER,e[5][1]=_e.DWARF,e[5][2]=_e.EMPTY;var s=e.findIndex((function(e){var t=e.slice(-1).pop()!==_e.EMPTY,i=e.slice(-4,-1).every((function(e){return e===_e.EMPTY}));return t&&i}));e[s][e[0].length-1]=_e.EXIT,this.buildWallsAroundGate(e)}else e=Li(i.textures,a),t=Li(i.textures,"".concat(a,"_bg"));return[e,t]}},{key:"buildWallsAroundGate",value:function(e){e.forEach((function(t,i){t.forEach((function(t,a){t===_e.EXIT&&(e[i-1][a]=_e.DEBRIS,e[i-1][a-1]=_e.DEBRIS,e[i-1][a-2]=_e.DEBRIS,e[i+1][a]=_e.DEBRIS,e[i+1][a-1]=_e.DEBRIS,e[i+1][a-2]=_e.DEBRIS)}))}))}},{key:"createBackground",value:function(){var e=this.scene.add.image(0,0,"Stage1_bg"),t=this.scene.cameras.main.width/e.width,i=this.scene.cameras.main.height/e.height,a=Math.max(t,i);e.setOrigin(0,0),e.setScale(1.5*a).setScrollFactor(.1),e.name="level_background_art",e.depth=-2}},{key:"createMap",value:function(){var e=this,t=this.scene,i=this.current,a=t.data.get("custom_scale"),s=this.scene.cameras.main,n=this.map,o=this.mapZ2,r=this.underlayMap;n&&n.scene&&(n.destroy(),o.destroy(),r.destroy()),n=t.make.tilemap({tileWidth:20,tileHeight:20,width:i.config[0].length,height:i.config.length}),o=t.make.tilemap({tileWidth:20,tileHeight:20,width:i.config[0].length,height:i.config.length}),r=t.make.tilemap({tileWidth:20,tileHeight:20,width:i.config[0].length,height:i.config.length}),window.map=n;var l=n.addTilesetImage("tiles","main-tiles",20,20,1,2),c=n.addTilesetImage("tiles-gates","gates-tiles",20,20,1,2),h=o.addTilesetImage("tiles-z2","gates-tiles",20,20,1,2),u=r.addTilesetImage("under-tiles","main-tiles",20,20,1,2),d=n.createBlankLayer("layer_1",l);d.name="layer_1",d.depth=0;var p=n.createBlankLayer("layer_2",c);p.name="layer_2",p.depth=0;var y=o.createBlankLayer("layer_1z2",h);y.name="layer_1z2",y.depth=5;var m=r.createBlankLayer("layer_0",u);return m.name="layer_0",m.depth=-1,d.setScale(a),p.setScale(a),y.setScale(a),m.setScale(1.01*a),m.setScrollFactor(.95),i.config.forEach((function(t,a){t.forEach((function(t,s){var l=t;if(i.bgConfig){var c=i.bgConfig[a][s];r.putTileAt(Oe[c],s,a)}if([_e.WALL,_e.DEBRIS,_e.GROUND,_e.ART,_e.ART2,_e.EXIT,_e.TORCH].includes(l)){if(l===_e.WALL||l===_e.TORCH)l=e.current.isMaze?1:Se.calculateWallTileWithNeighbours(a,s,i.config),n.putTileAt(l,s,a,!1,"layer_1");else if(l===_e.DEBRIS)n.putTileAt(Se[l],s,a,!1,"layer_1");else if(l===_e.GROUND)l=Se.calculateGroundTileWithNeighbours(a,s,i.config),n.putTileAt(l,s,a,!1,"layer_1");else if([_e.ART,_e.ART2].includes(l)){n.putTileAt(21,s,a,!1,"layer_1");var h=[_e.ART,_e.ART2].includes(i.config[a][s+1]);if([_e.ART,_e.ART2].includes(i.config[a][s-1]))return!1;h?(n.putTileAt(21,s+1,a,!1,"layer_1"),n.putTileAt(Se[l]+3,s-1,a,!1,"layer_2").setFlipX(!0),n.putTileAt(Se[l]+2,s,a,!1,"layer_2").setFlipX(!0),n.putTileAt(Se[l]+1,s+1,a,!1,"layer_2").setFlipX(!0),n.putTileAt(Se[l],s+2,a,!1,"layer_2").setFlipX(!0),n.putTileAt(Se[l]+10+3,s-1,a+1,!1,"layer_2").setFlipX(!0),n.putTileAt(Se[l]+10+2,s,a+1,!1,"layer_2").setFlipX(!0),n.putTileAt(Se[l]+10+1,s+1,a+1,!1,"layer_2").setFlipX(!0),n.putTileAt(Se[l]+10,s+2,a+1,!1,"layer_2").setFlipX(!0)):(n.putTileAt(Se[l],s,a,!1,"layer_2"),n.putTileAt(Se[l]+1,s+1,a,!1,"layer_2"),n.putTileAt(Se[l]+2,s+2,a,!1,"layer_2"),n.putTileAt(Se[l]+3,s+3,a,!1,"layer_2"),n.putTileAt(Se[l]+10,s,a+1,!1,"layer_2"),n.putTileAt(Se[l]+10+1,s+1,a+1,!1,"layer_2"),n.putTileAt(Se[l]+10+2,s+2,a+1,!1,"layer_2"),n.putTileAt(Se[l]+10+3,s+3,a+1,!1,"layer_2"))}else if(l===_e.EXIT){var u=Se[l+("level_ki_finale"===e.current.id?"_2":"_1")];n.putTileAt(u-3,s-1,a,!1,"layer_2"),n.putTileAt(u-10-4,s-2,a-1,!1,"layer_2"),n.putTileAt(u-4,s-2,a,!1,"layer_2"),o.putTileAt(u-10-2,s-2,a-1),o.putTileAt(u-10-1,s-1,a-1),o.putTileAt(u-10,s,a-1),o.putTileAt(u-2,s-2,a),o.putTileAt(u-1,s-1,a),o.putTileAt(u,s,a),o.putTileAt(u+10-2,s-2,a+1),o.putTileAt(u+10-1,s-1,a+1),o.putTileAt(u+10,s,a+1)}}else if([_e.HANGING_2,_e.HANGING_3,_e.HANGING_4,_e.HANGING_5].includes(l)){var p=Se.calculateWallTileWithNeighbours(a,s,i.config);n.putTileAt(p,s,a,!1,"layer_1"),i.config[a][s]=_e.WALL;var y={x:s,y:a},m="liana_start",f=e.scene.add.sprite(48,16).setOrigin(0,.2).play(m);f.setScale(d.scaleX),f.x=n.tileToWorldX(y.x),f.y=n.tileToWorldY(y.y),f.depth=5;var v=new Hi(l,e.current);v.position=Object(Qe.a)({},y),v.alien=f,i.decorationElements["".concat(y.x,"-").concat(y.y)]=v,y.y++,m=[_e.HANGING_3,_e.HANGING_4,_e.HANGING_5].includes(l)?"liana_middle":"liana_end",(f=e.scene.add.sprite(48,16).setOrigin(0,.2).play(m)).setScale(d.scaleX),f.x=n.tileToWorldX(y.x),f.y=n.tileToWorldY(y.y),f.depth=5,(v=new Hi(l,e.current)).position=Object(Qe.a)({},y),v.alien=f,i.decorationElements["".concat(y.x,"-").concat(y.y)]=v,[_e.HANGING_3,_e.HANGING_4,_e.HANGING_5].includes(l)&&(y.y++,m=_e.HANGING_3===l?"liana_end":"liana_middle",(f=e.scene.add.sprite(48,16).setOrigin(0,.2).play(m)).setScale(d.scaleX),f.x=n.tileToWorldX(y.x),f.y=n.tileToWorldY(y.y),f.depth=5,(v=new Hi(l,e.current)).position=Object(Qe.a)({},y),v.alien=f,i.decorationElements["".concat(y.x,"-").concat(y.y)]=v),[_e.HANGING_4,_e.HANGING_5].includes(l)&&(y.y++,m=_e.HANGING_4===l?"liana_end":"liana_middle",(f=e.scene.add.sprite(48,16).setOrigin(0,.2).play(m)).setScale(d.scaleX),f.x=n.tileToWorldX(y.x),f.y=n.tileToWorldY(y.y),f.depth=5,(v=new Hi(l,e.current)).position=Object(Qe.a)({},y),v.alien=f,i.decorationElements["".concat(y.x,"-").concat(y.y)]=v),[_e.HANGING_5].includes(l)&&(y.y++,m="liana_end",(f=e.scene.add.sprite(48,16).setOrigin(0,.2).play(m)).setScale(d.scaleX),f.x=n.tileToWorldX(y.x),f.y=n.tileToWorldY(y.y),f.depth=5,(v=new Hi(l,e.current)).position=Object(Qe.a)({},y),v.alien=f,i.decorationElements["".concat(y.x,"-").concat(y.y)]=v)}else i.bgConfig||n.putTileAt(Se[_e.EMPTY],s,a,!1,"layer_1")}))})),s.setBounds(0,0,d.width*d.scaleX,d.height*d.scaleY),s.zoom=1,this.underlayMap=r,this.mapZ2=o,n}}]),e}(),Vi=function(){function e(t){var i=this;Object(g.a)(this,e),this.scene=t,this.timer=0,this.worldTickFreq=N,t.events.on(d.a.Scenes.Events.UPDATE,this.onSceneUpdate.bind(this)),t.events.off("levelcompleted"),t.events.on("levelcompleted",(function(e){t.events.emit("sounds:level_complete"),t.tweens.add({targets:i.music,volume:1,ease:"Linear",duration:500,onComplete:function(){i.music.stop()}}),t.cameras.main.fade(3e3,0,0),t.cameras.main.once("camerafadeoutcomplete",(function(){t.scene.start("LevelResumeScene",Object(Qe.a)({level:t.levels.current.constructor.key},e))}))})),t.events.removeListener("levelstart",this.onLevelStart.bind(this)),t.events.addListener("levelstart",this.onLevelStart.bind(this))}return Object(_.a)(e,[{key:"destroy",value:function(){var e;null===(e=this.music)||void 0===e||e.stop(),this.scene.events.off(d.a.Scenes.Events.UPDATE),this.scene.events.off("levelstart")}},{key:"onLevelStart",value:function(){this.setUpCameraFollow(),this.scene.levels.current.id===lt.key?(this.music=this.scene.sound.add("levels_surface",{loop:!0,valume:0}),this.scene.isRestart||(this.music.play(),this.scene.tweens.add({targets:this.music,volume:1,ease:"Linear",duration:500}))):(this.music=this.scene.sound.add("levels_surface",{loop:!0,valume:0}),this.music.play(),this.scene.tweens.add({targets:this.music,volume:1,ease:"Linear",duration:500}))}},{key:"setUpCameraFollow",value:function(){var e=Object(h.a)(c.a.mark((function e(){var t,i=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{x:0,y:0,width:1,height:1},this.scene.cameras.main.startFollow(t,!1,.05,.05),e.next=5,this.panAndFollow(this.scene.levels.current.focusObject);case 5:this.scene.levels.current.resume();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"panAndFollow",value:function(e){var t=this;return new Promise((function(i){t.scene.cameras.main.pan(e.x,e.y,2e3,d.a.Math.Easing.Cubic.InOut,null,(function(t,a){1===a&&(t.startFollow(e,!0,.05,.05),i())}))}))}},{key:"onSceneUpdate",value:function(e,t){if(this.timer+=t,this.timer>=this.worldTickFreq){for(;this.timer>this.worldTickFreq;)this.timer-=this.worldTickFreq;this.scene.levels.current.gravityLoop()}}},{key:"calcCompletion",value:function(e,t,i,a,s,n){var o=(t+a+n+1)/(e+i+s+1);return Math.round(100*o)/100}}]),e}(),Ki=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.call(this,"GameScene")}return Object(_.a)(i,[{key:"create",value:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ri(this),Di(this),this.cameras.main.setPostPipeline(bi),this.data.set("custom_scale",I),this.isRestart=i.isRestart,this.game.scale.scaleMode=d.a.Scale.RESIZE,this.handleScales(),this.createAnimations(),this.ui=new li(this,i.levelName===lt.key),(null===(e=this.levels)||void 0===e?void 0:e.current)&&this.levels.current.cleanLevel(),this.levels=new Yi(this,i.levelName,i.isRestart),this.cameras.main.fadeIn(1e3,0,0,0),this.rules=new Vi(this),this.events.on(d.a.Scenes.Events.SHUTDOWN,(function(){t.rules.destroy(),t.ui.destroy()}))}},{key:"navigateToScene",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.cameras.main.fade(500,0,0,0),this.cameras.main.once("camerafadeoutcomplete",(function(){var a;t.rules.destroy(),t.ui.destroy(),(null===(a=t.levels)||void 0===a?void 0:a.current)&&(t.levels.current.cleanLevel(),t.levels.current.destroy()),t.scene.start(e,i)}))}},{key:"handleScales",value:function(){var e=this;window.addEventListener("resize",(function(){var t;e.children.list.forEach((function(e){e.setScale(I,document.querySelector("canvas").height/11/R)})),e.ui.onResize();var i=e.children.getByName("layer_1");if(!i)return!1;null===(t=e.levels)||void 0===t||t.current.updatePositionsOnScale(),e.cameras.main.setBounds(0,0,i.width*i.scaleX,i.height*i.scaleY)}))}},{key:"createAnimations",value:function(){this.anims.create({key:"boulder_roll_right",frames:this.anims.generateFrameNumbers("boulder",{frames:[7,10,8,7]}),frameRate:16,repeat:0}),this.anims.create({key:"boulder_roll_left",frames:this.anims.generateFrameNumbers("boulder",{frames:[7,8,10,7]}),frameRate:16,repeat:0}),this.anims.create({key:"diamond_roll_right",frames:this.anims.generateFrameNumbers("boulder",{frames:[55,56,57,60,61,62,63,54]}),frameRate:32,repeat:0}),this.anims.create({key:"diamond_roll_left",frames:this.anims.generateFrameNumbers("boulder",{frames:[63,62,61,60,57,56,55,54]}),frameRate:32,repeat:0}),this.anims.create({key:"boulder_idle",frames:this.anims.generateFrameNumbers("boulder",{frames:[7]}),frameRate:1,repeat:0}),this.anims.create({key:"wall_torch_lit",frames:this.anims.generateFrameNumbers("boulder",{frames:[12,13,14,15,16,17]}),frameRate:10,repeat:0}),this.anims.create({key:"wall_torch_lighting",frames:this.anims.generateFrameNumbers("boulder",{frames:[26,27,28,29]}),frameRate:10,repeat:0}),this.anims.create({key:"wall_torch_idle",frames:this.anims.generateFrameNumbers("boulder",{frames:[25]}),frameRate:10,repeat:0}),this.anims.create({key:"barrel_idle",frames:this.anims.generateFrameNumbers("boulder",{frames:[70]}),repeat:0}),this.anims.create({key:"barrel_roll_right",frames:this.anims.generateFrameNumbers("boulder",{frames:[71,76,77,70]}),frameRate:12,repeat:0}),this.anims.create({key:"barrel_roll_left",frames:this.anims.generateFrameNumbers("boulder",{frames:[77,76,71,70]}),frameRate:12,repeat:0}),this.anims.create({key:"pillar_idle",frames:this.anims.generateFrameNumbers("boulder",{frames:[66]}),frameRate:1,repeat:0}),this.anims.create({key:"pillar_roll_right",frames:this.anims.generateFrameNumbers("boulder",{frames:[67,68,69,66]}),frameRate:12,repeat:0}),this.anims.create({key:"pillar_roll_left",frames:this.anims.generateFrameNumbers("boulder",{frames:[69,68,67,66]}),frameRate:12,repeat:0}),this.anims.create({key:"liana_start",frames:this.anims.generateFrameNumbers("boulder",{frames:[72]}),frameRate:12,repeat:0}),this.anims.create({key:"liana_middle",frames:this.anims.generateFrameNumbers("boulder",{frames:[78]}),frameRate:12,repeat:0}),this.anims.create({key:"liana_end",frames:this.anims.generateFrameNumbers("boulder",{frames:[84]}),frameRate:12,repeat:0}),this.anims.create({key:"explosion_explode",frames:this.anims.generateFrameNumbers("explosion",{frames:[0,1,2,3,4,5,6,7]}),frameRate:16,repeat:0}),this.anims.create({key:"diamond_idle",frames:this.anims.generateFrameNumbers("boulder",{frames:[54]}),frameRate:16,repeat:-1}),this.anims.create({key:"diamond_shine",frames:this.anims.generateFrameNumbers("boulder",{frames:[53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,58,59,64,65,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53]}),frameRate:16,repeat:-1}),this.anims.create({key:"mushroom_idle",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[20]}),frameRate:1,repeat:0}),this.anims.create({key:"pickaxe_idle",frames:this.anims.generateFrameNumbers("pickables",{frames:[6]}),frameRate:1,repeat:0}),this.anims.create({key:"brave_idle",frames:this.anims.generateFrameNumbers("brave",{frames:[0,0,0,0,0,0,0,0,0,0,1,1,1,0,2,2,2,2,2,2,2,0]}),frameRate:4,repeat:-1}),this.anims.create({key:"brave_idle_rockford",frames:this.anims.generateFrameNumbers("brave",{frames:[3,3,3,4,5,5,5,5,5,5,5,5,5,5,6,7,5,5,6,7,5,5,5,6,7,5,5,6,7,5,5,5,5,5,5,5,5,6,7,5,5,6,7,5,5,5,6,7,5,5,6,7,5,5,5,5,5,5,5,5,6,7,5,5,6,7,5,5,5,6,7,5,5,6,7,5,5,5,5,5,5,5,5,6,7,5,5,6,7,5,5,5,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3]}),frameRate:8,repeat:-1}),this.anims.create({key:"brave_idle_pickaxe",frames:this.anims.generateFrameNumbers("brave",{frames:[32,32,32,32,32,32,32,32,32,32,33,33,33,32,34,34,34,34,34,34,34,32]}),frameRate:4,repeat:-1}),this.anims.create({key:"brave_run",frames:this.anims.generateFrameNumbers("brave",{frames:[8,9,10,11,12,13,14,15]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_run_up",frames:this.anims.generateFrameNumbers("brave",{frames:[56,57,58,59,60,61,62,63]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_run_pickaxe_up",frames:this.anims.generateFrameNumbers("brave",{frames:[56,57,58,59,60,61,62,63]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_run_down",frames:this.anims.generateFrameNumbers("brave",{frames:[64,65,66,67,68,69,70,71]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_run_pickaxe_down",frames:this.anims.generateFrameNumbers("brave",{frames:[72,73,74,75,76,77,78,79]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_run_pickaxe",frames:this.anims.generateFrameNumbers("brave",{frames:[16,17,18,19,20,21,22,23]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_break_pickaxe",frames:this.anims.generateFrameNumbers("brave",{frames:[40,41,41,42,43]}),frameRate:20,repeat:-1}),this.anims.create({key:"brave_break_pickaxe_up",frames:this.anims.generateFrameNumbers("brave",{frames:[44,45,45,46,47]}),frameRate:20,repeat:-1}),this.anims.create({key:"brave_break_pickaxe_down",frames:this.anims.generateFrameNumbers("brave",{frames:[52,53,53,54,55]}),frameRate:20,repeat:-1}),this.anims.create({key:"brave_break_pickaxe_alt",frames:this.anims.generateFrameNumbers("brave",{frames:[48,49,49,50,51]}),frameRate:20,repeat:-1}),this.anims.create({key:"brave_push",frames:this.anims.generateFrameNumbers("brave",{frames:[24,24,24,24,25,26,27]}),frameRate:16,repeat:0}),this.anims.create({key:"brave_dies",frames:this.anims.generateFrameNumbers("brave",{frames:[28,29,30,31,30,31]}),frameRate:14,repeat:0}),this.anims.create({key:"torch_idle",frames:this.anims.generateFrameNumbers("torch",{frames:[0,1,2,3]}),frameRate:10,repeat:-1}),this.anims.create({key:"torch_run",frames:this.anims.generateFrameNumbers("torch",{frames:[8,9,10,11,12,13,14,15]}),frameRate:10,repeat:-1}),this.anims.create({key:"torch_run_up",frames:this.anims.generateFrameNumbers("torch",{frames:[56,57,58,59,60,61,62,63]}),frameRate:10,repeat:-1}),this.anims.create({key:"torch_run_down",frames:this.anims.generateFrameNumbers("torch",{frames:[64,65,66,67,68,69,70,71]}),frameRate:10,repeat:-1}),this.anims.create({key:"torch_push",frames:this.anims.generateFrameNumbers("torch",{frames:[24,25,26,27,24,25,26]}),frameRate:10,repeat:-1}),this.anims.create({key:"torch_break_pickaxe",frames:this.anims.generateFrameNumbers("torch",{frames:[40,41,41,42,43]}),frameRate:20,repeat:-1}),this.anims.create({key:"bat_move",frames:this.anims.generateFrameNumbers("boulder",{frames:[18,19,20,21,22,23,24]}),frameRate:12,repeat:-1}),this.anims.create({key:"ground_breaks",frames:this.anims.generateFrameNumbers("boulder",{frames:[30,31,32,33,34,35,36,37,38,39,40]}),frameRate:12,repeat:0}),this.anims.create({key:"ground_disolves",frames:this.anims.generateFrameNumbers("boulder",{frames:[32,33,34,35,36,37,38,39,40]}),frameRate:12,repeat:0}),this.anims.create({key:"jewel_pick",frames:this.anims.generateFrameNumbers("boulder",{frames:[42,43,44,45,46,40]}),frameRate:12,repeat:0}),this.anims.create({key:"enemy_dies",frames:this.anims.generateFrameNumbers("boulder",{frames:[47,48,49,50,51,52,40]}),frameRate:12,repeat:0}),this.anims.create({key:"closeUp_Mary",frames:this.anims.generateFrameNumbers("closeUp",{frames:[0]}),repeat:0}),this.anims.create({key:"closeUp_Marduk",frames:this.anims.generateFrameNumbers("closeUp",{frames:[1]}),repeat:0}),this.anims.create({key:"closeUp_Dwarf",frames:this.anims.generateFrameNumbers("closeUp",{frames:[2]}),repeat:0}),this.anims.create({key:"closeUp_Tiamat",frames:this.anims.generateFrameNumbers("closeUp",{frames:[5]}),repeat:0}),this.anims.create({key:"closeUp_Pickaxe",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[6]}),repeat:0}),this.anims.create({key:"closeUp_Mushroom",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[8]}),repeat:0}),this.anims.create({key:"closeUp_Diamond",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[7]}),repeat:0}),this.anims.create({key:"closeUp_Abushgidim",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[26]}),repeat:0}),this.anims.create({key:"closeUp_tentacles",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[27]}),repeat:0}),this.anims.create({key:"bro_idle",frames:this.anims.generateFrameNumbers("bro",{frames:[0,0,0,0,0,0,0,1,1,1,0,2,2,2,2,2,2,2,0,0,0,1,1,1,1,1,1,0,0,0,2,2,2,0,0,1,1,1,0]}),frameRate:4,repeat:-1}),this.anims.create({key:"bro_run",frames:this.anims.generateFrameNumbers("bro",{frames:[8,9,10,11,12,13,14,15]}),frameRate:10,repeat:-1}),this.anims.create({key:"bro_run_up",frames:this.anims.generateFrameNumbers("bro",{frames:[56,57,58,59,60,61,62,63]}),frameRate:10,repeat:-1}),this.anims.create({key:"bro_run_down",frames:this.anims.generateFrameNumbers("bro",{frames:[64,65,66,67]}),frameRate:16,repeat:-1}),this.anims.create({key:"bro_laying",frames:this.anims.generateFrameNumbers("bro",{frames:[31]}),frameRate:14,repeat:0}),this.anims.create({key:"dwarf_idle",frames:this.anims.generateFrameNumbers("dwarf",{frames:[0,0,0,0,0,0,0,0,0,0,1,1,1,0,2,2,2,2,2,2,2,0]}),frameRate:4,repeat:-1}),this.anims.create({key:"dwarf_run",frames:this.anims.generateFrameNumbers("dwarf",{frames:[8,9,10,11,12,13,14,15]}),frameRate:10,repeat:-1}),this.anims.create({key:"dwarf_run_up",frames:this.anims.generateFrameNumbers("dwarf",{frames:[56,57,58,59,60,61,62,63]}),frameRate:10,repeat:-1}),this.anims.create({key:"dwarf_look_up",frames:this.anims.generateFrameNumbers("dwarf",{frames:[57]}),frameRate:1,repeat:-1}),this.anims.create({key:"dwarf_run_down",frames:this.anims.generateFrameNumbers("dwarf",{frames:[64,65,66,67]}),frameRate:16,repeat:-1}),this.anims.create({key:"exit_block",frames:this.anims.generateFrameNumbers("boulder",{frames:[0,1,2,3,4,5]}),frameRate:10,repeat:-1}),this.anims.create({key:"moonAltarTop",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[26]}),repeat:0}),this.anims.create({key:"moonAltarBottom",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[37]}),repeat:0}),this.anims.create({key:"sunAltarTop",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[27]}),repeat:0}),this.anims.create({key:"sunAltarBottom",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[38]}),repeat:0}),this.anims.create({key:"chunkHorizontalEven_idle",frames:this.anims.generateFrameNumbers("boss",{frames:[0]}),repeat:-1}),this.anims.create({key:"chunkHorizontalOdd_idle",frames:this.anims.generateFrameNumbers("boss",{frames:[10]}),repeat:-1}),this.anims.create({key:"chunkCurveEven_idle",frames:this.anims.generateFrameNumbers("boss",{frames:[20]}),repeat:-1}),this.anims.create({key:"chunkCurveOdd_idle",frames:this.anims.generateFrameNumbers("boss",{frames:[30]}),repeat:-1}),this.anims.create({key:"chunkHeadEven_idle",frames:this.anims.generateFrameNumbers("boss",{frames:[70]}),repeat:-1}),this.anims.create({key:"chunkHeadOdd_idle",frames:this.anims.generateFrameNumbers("boss",{frames:[60]}),repeat:-1}),this.anims.create({key:"chunkHorizontalEven_grow",frames:this.anims.generateFrameNumbers("boss",{frames:[60,61,62,63,64,0,0,0]}),frameRate:12,repeat:0}),this.anims.create({key:"chunkHorizontalOdd_grow",frames:this.anims.generateFrameNumbers("boss",{frames:[70,71,72,73,74,10,10,10]}),frameRate:12,repeat:0}),this.anims.create({key:"chunkCurveOdd_grow",frames:this.anims.generateFrameNumbers("boss",{frames:[80,81,82,83,84]}),frameRate:12,repeat:0}),this.anims.create({key:"chunkCurveEven_grow",frames:this.anims.generateFrameNumbers("boss",{frames:[90,91,92,93,94]}),frameRate:12,repeat:0}),this.anims.create({key:"chunkHeadEven_grow",frames:this.anims.generateFrameNumbers("boss",{frames:[9,9,9,50,51,52,53,70]}),frameRate:12,repeat:0}),this.anims.create({key:"chunkHeadOdd_grow",frames:this.anims.generateFrameNumbers("boss",{frames:[9,9,9,40,41,42,43,60]}),frameRate:12,repeat:0}),this.anims.create({key:"chunkHeadEven_shrink",frames:this.anims.generateFrameNumbers("boss",{frames:[70,53,52,51,50,9]}),frameRate:24,repeat:0}),this.anims.create({key:"chunkHeadOdd_shrink",frames:this.anims.generateFrameNumbers("boss",{frames:[60,43,42,41,40,9]}),frameRate:24,repeat:0}),this.anims.create({key:"chunkHorizontalEven_shrink",frames:this.anims.generateFrameNumbers("boss",{frames:[0,0,0,64,63,62,61,60]}),frameRate:24,repeat:0}),this.anims.create({key:"chunkHorizontalOdd_shrink",frames:this.anims.generateFrameNumbers("boss",{frames:[10,10,10,74,73,72,71,70]}),frameRate:24,repeat:0}),this.anims.create({key:"chunkCurveOdd_shrink",frames:this.anims.generateFrameNumbers("boss",{frames:[85,85,84,83,82,81,80]}),frameRate:24,repeat:0}),this.anims.create({key:"chunkCurveEven_shrink",frames:this.anims.generateFrameNumbers("boss",{frames:[95,95,94,93,92,91,90]}),frameRate:24,repeat:0}),this.anims.create({key:"bossCenterTop",frames:this.anims.generateFrameNumbers("boss",{frames:[6]}),frameRate:12,repeat:0}),this.anims.create({key:"bossCenterMid",frames:this.anims.generateFrameNumbers("boss",{frames:[16]}),frameRate:12,repeat:0}),this.anims.create({key:"bossCenterBottom",frames:this.anims.generateFrameNumbers("boss",{frames:[26]}),frameRate:12,repeat:0}),this.anims.create({key:"bossSideTop",frames:this.anims.generateFrameNumbers("boss",{frames:[7]}),frameRate:12,repeat:0}),this.anims.create({key:"bossSideMid",frames:this.anims.generateFrameNumbers("boss",{frames:[17]}),frameRate:12,repeat:0}),this.anims.create({key:"bossSideBottom",frames:this.anims.generateFrameNumbers("boss",{frames:[27]}),frameRate:12,repeat:0}),this.anims.create({key:"bossBorderTop",frames:this.anims.generateFrameNumbers("boss",{frames:[8]}),frameRate:12,repeat:0}),this.anims.create({key:"bossBorderMid",frames:this.anims.generateFrameNumbers("boss",{frames:[18]}),frameRate:12,repeat:0}),this.anims.create({key:"bossBorderBottom",frames:this.anims.generateFrameNumbers("boss",{frames:[28]}),frameRate:12,repeat:0}),this.anims.create({key:"bossWombTop",frames:this.anims.generateFrameNumbers("boss",{frames:[45]}),frameRate:12,repeat:0}),this.anims.create({key:"bossWombBottom1",frames:this.anims.generateFrameNumbers("boss",{frames:[44]}),frameRate:12,repeat:0}),this.anims.create({key:"bossWombBottom2_idle",frames:this.anims.generateFrameNumbers("boss",{frames:[54]}),frameRate:12,repeat:0}),this.anims.create({key:"bossWombBottom2_birth",frames:this.anims.generateFrameNumbers("boss",{frames:[54,55,56,57,57,58,58,59]}),frameRate:12,repeat:0}),this.anims.create({key:"bossWombBottom2_blocked",frames:this.anims.generateFrameNumbers("boss",{frames:[54,55,56,57,56,57,56,57,56,55]}),frameRate:12,repeat:0})}}]),i}(d.a.Scene),Xi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.call(this,"ConnectorScene")}return Object(_.a)(i,[{key:"preload",value:function(){}},{key:"createAnimations",value:function(){this.anims.create({key:"closeUp_Mary",frames:this.anims.generateFrameNumbers("closeUp",{frames:[0]}),repeat:0}),this.anims.create({key:"closeUp_Marduk",frames:this.anims.generateFrameNumbers("closeUp",{frames:[1]}),repeat:0}),this.anims.create({key:"closeUp_Dwarf",frames:this.anims.generateFrameNumbers("closeUp",{frames:[2]}),repeat:0}),this.anims.create({key:"closeUp_Tiamat",frames:this.anims.generateFrameNumbers("closeUp",{frames:[3]}),repeat:0})}},{key:"getMusicFromName",value:function(e){switch(e){case"cinematic_1":return"swarf_chat_music";default:return"generic_chat_music"}}},{key:"getImageByName",value:function(e){var t,i,a,s;switch(e){default:case"cinematic_1":t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/1.5,"Tiamat"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.max(i,a),t.setScale(4*s).setScrollFactor(0);break;case"cinematic_last":t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"Tiamat"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.max(i,a),t.setScale(s).setScrollFactor(0);break;case"cinematic_last_2":t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"thechild"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.max(i,a),t.setScale(s).setScrollFactor(0)}return t}},{key:"create",value:function(e){var t=e.id,i=e.name;this.currentLevel=t,this.createAnimations();var a=this.getMusicFromName(i);this.environmentMusic=this.sound.add(a,{loop:!0}),this.environmentMusic.play(),new li(this,!0),this.cameras.main.setPostPipeline(bi),this.getImageByName(i).name="background_art",this["showDialogLevel_".concat(i)]()}},{key:"showDialogLevel_cinematic_escape",value:function(){var e=this;this.levels={current:{pause:function(){return!1},resume:function(){setTimeout((function(){e.environmentMusic.stop(),e.cameras.main.fade(1e3,0,0,0),e.cameras.main.once("camerafadeoutcomplete",(function(){e.scene.start("GameScene",{level:e.currentLevel+1})}))}),1e3)}}},this.events.emit("dialogue:show",{participants:["closeUp_Marduk","closeUp_Mary"],conversation:[{who:"closeUp_Marduk",text:["Do you feel it Mary?","Do you feel her presence","below?"]},{who:"closeUp_Mary",text:["I do... But what","does it mean?"]},{who:"closeUp_Marduk",text:["That I do not know... But","it does not portend well.","I have learned so much in","so little time. Mary...I","can\u2019t recognize the man","I once was. I felt","bound by obligation,","I was trapped, Mary."]},{who:"closeUp_Mary",text:["It is time, Marduk","we have to escape","from here before","Tiamat stops us"," ","go!!!"]}]})}},{key:"showDialogLevel_cinematic_last_2",value:function(){var e=this;this.levels={current:{pause:function(){e.tweens.add({targets:e.children.getByName("background_art"),alpha:0,duration:500,onComplete:function(){var t=e.getImageByName("cinematic_last_2");t.alpha=0,e.tweens.add({targets:t,alpha:1,duration:500})}})},resume:function(){setTimeout((function(){e.tweens.add({targets:e.environmentMusic,valume:0,duration:500}),e.cameras.main.fade(1e3,0,0,0),e.cameras.main.once("camerafadeoutcomplete",(function(){e.scene.start("CreditsScene")}))}),1e3)}}},this.events.emit("dialogue:show",{participants:["closeUp_Marduk","closeUp_Dwarf"],conversation:[{who:"closeUp_Dwarf",text:["That's not how things work","where I come from. Marduk,","You have been preparing","for this moment since","your life began. Do you","have the courage to","forge your own destiny?"]}]})}},{key:"showDialogLevel_cinematic_last",value:function(){var e=this;this.levels={current:{pause:function(){return!1},resume:function(){setTimeout((function(){e.showDialogLevel_cinematic_last_2()}),1e3)}}},this.events.emit("dialogue:show",{participants:["closeUp_Marduk","closeUp_Tiamat"],conversation:[{who:"closeUp_Marduk",text:["How could you do this? We","are your creations. This","is your land. How could","you lie to us!?","Why have you forsaken us?"]},{who:"closeUp_Tiamat",text:["Life is a cycle. The","catalyst comet is a part","of this cycle: I did not","lie when I said the Comet","was the source of the","earthquakes."]},{who:"closeUp_Tiamat",text:["However: I am a force of","this world. It is through","my actions that things","occur. I am bound to the","will of the comet: for","truly we are one. I am","nature: and this...is","within my nature."]},{who:"closeUp_Tiamat",text:["I may have created","everything, yet still:","there was a natural order","to life that preceded me."]},{who:"closeUp_Tiamat",text:["You are finite in your","perspective Marduk.","Death signifies new","beginnings."," ","This is Destiny."]},{who:"closeUp_Marduk",text:["Who would accept a fate","such as this? We have done","no wrong. We worship and","revere you. We are your","children! Would you","really destroy us?"]},{who:"closeUp_Tiamat",text:["The end was written","in the beginning.","Fate cannot be rewritten."]}]})}},{key:"showDialogLevel_cinematic_1",value:function(){var e=this;this.levels={current:{pause:function(){return!1},resume:function(){setTimeout((function(){e.tweens.add({targets:e.environmentMusic,volume:0,duration:500}),e.cameras.main.fade(1e3,0,0,0),e.cameras.main.once("camerafadeoutcomplete",(function(){e.scene.start("GameScene",{level:e.currentLevel+1})}))}),1e3)}}},this.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Marduk","closeUp_Dwarf"],conversation:[{who:"closeUp_Mary",text:["There you are! I was","worried about you!","Are you okay?"]},{who:"closeUp_Marduk",text:["- marduk has been crying -","Thank Tiamat You\u2019re here!","I made a mistake. I ate","one of the mushrooms. I","don\u2019t feel well\u2026I think I","broke my leg falling from","the surface."]},{who:"closeUp_Mary",text:["Are you going to","throw up!?","Can you stand?"]},{who:"closeUp_Marduk",text:["No\u2026.I don\u2019t think so."]},{who:"closeUp_Mary",text:["What are we going to do","with you."]},{who:"closeUp_Dwarf",text:["You know\u2026..there's","nothing wrong with being","sad or afraid. It\u2019s","nature's way of guiding","us towards a brighter","future."]},{who:"closeUp_Marduk",text:["WHAT ON EARTH IS THAT!?","Don\u2019t patronize me foul","beast."]},{who:"closeUp_Mary",text:["You really need to learn","when to shut your mouth.","Marduk. You have become","rude & foul tempered."]},{who:"closeUp_Dwarf",text:["I mean he\u2019s right.","I am a monster.","I'm... different."]},{who:"closeUp_Mary",text:["You don\u2019t seem like","a monster to me."]},{who:"closeUp_Dwarf",text:["That\u2019s because we're","going to make a deal"]},{who:"closeUp_Marduk",text:["I don\u2019t make deals with...","your kind..."]},{who:"closeUp_Dwarf",text:["But You Will...in time...","things change. People grow.","Even you Marduk. I think","we could be great friends.","In Fact. It Is Prophecy"]}]})}}]),i}(d.a.Scene),zi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.call(this,"CreditsScene")}return Object(_.a)(i,[{key:"create",value:function(){this.normalDayMusic=this.sound.add("opening_peace",{loop:!0}),this.normalDayMusic.play(),this.cameras.main.setPostPipeline(bi);var e=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"theworld"),t=this.cameras.main.width/e.width,i=this.cameras.main.height/e.height,a=Math.max(t,i);e.setScale(a).setScrollFactor(0),e.name="background_art",e.alpha=0,this.tweens.add({targets:e,alpha:1,duration:5e3}),this.add.text(80,10,"THE END",{fontFamily:"GameGirl",fontSize:"10px",fill:"#ffffff"}).setScale(2*t).setPosition(2*t,this.cameras.main.height-80*i).setShadow(-1,1).displayHeight=10*i,this.add.text(80,10,"Thanks for playing",{fontFamily:"GameGirl",fontSize:"10px",fill:"#ffffff"}).setScale(.9*t).setPosition(2*t,this.cameras.main.height-30*i).setShadow(-1,1).displayHeight=10*i}}]),i}(d.a.Scene),Qi=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(){return Object(g.a)(this,i),t.call(this,"ConfirmNewGameScene")}return Object(_.a)(i,[{key:"preload",value:function(){}},{key:"navigateToScene",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.cameras.main.fade(500,0,0,0),this.tweens.add({targets:Gi,volume:0,ease:"Linear",duration:500,onComplete:function(){Gi.pause(),t.scene.start(e,i)}})}},{key:"create",value:function(){var e=this;this.cameras.main.setPostPipeline(bi),this.cameras.main.setBackgroundColor("#486859");var t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/3,"Bossfight"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.max(i,a);t.setScale(1.5*s).setScrollFactor(0),t.name="background_art",Gi=this.sound.add("credits",{loop:!0}),window.WebFont.load({custom:{families:["GameGirl"]},active:function(){e.cameras.main.fadeIn(500,0,0,0),e.events.emit("scene_ready",e.sys.config),Gi=e.sound.add("credits",{loop:!0}),e.input.keyboard.off("keydown"),e.input.keyboard.on("keydown",(function(t){ai(t.key)&&e.navigateToScene("SplashScreenScene")})),new ni(e).showConfirmNewGameMenu()}})}}]),i}(d.a.Scene),Ji=i(18),qi=i(36),Zi=function(){var e=Object(s.useContext)(f),t=e.game,i=e.scene,n=e.sceneProps,o=Object(s.useState)({}),r=Object(a.a)(o,2),l=r[0],c=r[1];return Object(s.useLayoutEffect)((function(){i&&c(function(e,t){return e.scene.scenes.forEach((function(e){e.events.off(d.a.Scenes.Events.READY),e.events.once(d.a.Scenes.Events.READY,(function(){e.events.off(d.a.Scenes.Events.RENDER),e.events.once(d.a.Scenes.Events.RENDER,(function(){c(Object(Qe.a)(Object(Qe.a)({},e),{},{camera:e.cameras.main,cameras:e.cameras,scene:e}))}))}))})),{game:e,scene:t,sceneProps:n,camera:t.cameras.main,cameras:t.cameras,scenes:e.scene.scenes,scenesManager:e.scene}}(t,i))}),[t,i]),l},$i=Object(s.forwardRef)((function(e,t){var i=e.args,a=e.type,n=void 0===a?"Shape":a,o=e.addedToScene,r=void 0===o?function(){}:o,l=e.addedToSceneForParent,c=void 0===l?function(){}:l,h=e.children,u=(e.dataParentRef,Object(Ji.a)(e,["args","type","addedToScene","addedToSceneForParent","children","dataParentRef"])),y=Zi().scene,f=Object(s.useRef)(),v=Object(s.useRef)(),g=t||f,_=Object(s.useCallback)((function(e,t){Object.keys(t).forEach((function(i){((null===e||void 0===e?void 0:e.hasOwnProperty(i))||(null===e||void 0===e?void 0:e.__proto__.hasOwnProperty(i)))&&("function"===typeof e[i]?e[i](t[i]):e[i]=t[i])}))}),[u]);return Object(s.useLayoutEffect)((function(){return _(g.current,u)}),[u]),Object(s.useEffect)((function(){if(y){var e=Object(qi.a)(d.a.GameObjects[n],[y].concat(Object(p.a)(i)));g.current=e,e.once(d.a.GameObjects.Events.ADDED_TO_SCENE,(function(){r(e),c(e),_(e,u)})),v.current=setTimeout((function(){y.add.existing(e)}))}return function(){var e;null===g||void 0===g||null===(e=g.current)||void 0===e||e.destroy()}}),[y]),Object(s.useEffect)((function(){return function(){clearTimeout(v.current)}}),[]),Object(m.jsx)(m.Fragment,{children:h})}));$i.displayName="GameObject";var ea=$i,ta=Object(s.forwardRef)((function(e,t){var i,a,n,o,r=e.args,l=e.children,c=Object(Ji.a)(e,["args","children"]),h=Object(s.useRef)(),u=t||h;return Object(s.useEffect)((function(){var e;"string"===typeof l&&(null===(e=u.current)||void 0===e||e.setText(l))}),[l]),Object(m.jsx)(ea,Object(Qe.a)({ref:u,type:"Text",args:[null!==(i=null===r||void 0===r?void 0:r[0])&&void 0!==i?i:c.x,null!==(a=null===r||void 0===r?void 0:r[1])&&void 0!==a?a:c.y,"string"===typeof l?l:null!==(n=null===r||void 0===r?void 0:r[2])&&void 0!==n?n:"",null!==(o=null===r||void 0===r?void 0:r[3])&&void 0!==o?o:c.style]},c))}));ta.displayName="Text";var ia=ta,aa=Object(s.forwardRef)((function(e,t){var i=e.args,a=void 0===i?[0,0]:i,n=(e.addedToScene,e.children),o=Object(Ji.a)(e,["args","addedToScene","children"]),r=Object(s.useRef)(),l=t||r,c=function(e){l.current.add(e)};return Object(m.jsx)(ea,Object(Qe.a)(Object(Qe.a)({ref:l,type:"Container",args:a},o),{},{children:function e(t){return s.Children.toArray(t).map((function(t){return String(t.type).includes("react.fragment")?Object(s.cloneElement)(t,{children:e(t.props.children)}):Object(s.cloneElement)(t,{addedToSceneForParent:c})}))}(n)}))}));aa.displayName="Container";var sa=aa,na=Object(s.forwardRef)((function(e,t){var i=e.args,a=(e.children,Object(Ji.a)(e,["args","children"])),n=Object(s.useRef)(),o=t||n;return Object(m.jsx)(ea,Object(Qe.a)({ref:o,type:"Sprite",args:i},a))}));na.displayName="Sprite";var oa=na,ra=function(){var e=Zi(),t=e.game,i=e.scene,n=e.sceneProps,o=Object(s.useState)(0),r=Object(a.a)(o,2),l=r[0],c=r[1],h=Object(s.useState)(0),u=Object(a.a)(h,2),d=u[0],p=u[1],y=Object(s.useState)([Ie("menu.main.score_op_next"),Ie("menu.main.score_op_repeat"),Ie("menu.main.score_op_exit")]),f=Object(a.a)(y,1)[0],v=Object(s.useRef)(),g=Object(s.useRef)(),_=Object(s.useCallback)((function(e){if(ai(e.key)&&t.scene.start("SplashScreenScene"),$t(e.key)&&l<f.length-1&&c((function(e){return e+1})),Zt(e.key)&&l>0&&c((function(e){return e-1})),ii(e.key))switch(l){default:case 0:i.scene.start("GameScene",{levelName:Wi(null===n||void 0===n?void 0:n.level)});break;case 1:i.scene.start("GameScene",{levelName:null===n||void 0===n?void 0:n.level});break;case 2:i.scene.start("MenuScene")}}),[t,i,l,f,n]);Object(s.useEffect)((function(){return i&&(null===i||void 0===i||i.input.keyboard.addListener("keydown",_),function(e){var t=Ii(e);t.isPlaying||(t.play(),t.volume=0,e.tweens.add({targets:t,volume:1,delay:10,ease:"Linear",duration:1e3}))}(i)),function(){i&&i.input.keyboard.removeListener("keydown",_)}}),[i,_]),Object(s.useEffect)((function(){g.current=i,null===i||void 0===i||i.anims.create({key:"arrow_menu",frames:i.anims.generateFrameNumbers("hud",{frames:[30]}),repeat:0})}),[i]),Object(s.useEffect)((function(){return d<5&&(v.current=setTimeout((function(){return p((function(e){return e+1}))}),800)),function(){return clearTimeout(v.current)}}),[d]),Object(s.useEffect)((function(){return function(){clearTimeout(v.current),g.current.input.keyboard.off("keydown")}}),[]);var E=function(e){e.displayHeight=10*I,e.depth=16,e.name="header_text",e.setScale(I),e.setScrollFactor(0),e.setShadow(-1,1)},O={fontFamily:"Emulogic",fontSize:"8px",fill:"#aee0c8",fontWeight:"regular"},S=li.tileToScreen(1),T=li.tileToScreen(5),x=li.tileToScreen(1),b=li.tileToScreen(.75),A=li.tileToScreen(7);return Object(m.jsxs)(sa,{x:T,y:S,children:[Object(m.jsx)(ia,{x:x,y:0,setStyle:O,addedToScene:E,children:"KI - ".concat((null===n||void 0===n?void 0:n.level.includes("maze"))?Ie("menu.main.ruins"):Ie("menu.main.chamber")," ").concat(null===n||void 0===n?void 0:n.level.replace(/level_|maze_/,"")," ").concat((null===n||void 0===n?void 0:n.level.includes("maze"))?"":Ie("menu.main.of")+" 19")}),d>0&&Object(m.jsxs)(s.Fragment,{children:[Object(m.jsx)(ia,{x:x,y:2*b,setStyle:O,alpha:(null===n||void 0===n?void 0:n.collectedDiamonds)<(null===n||void 0===n?void 0:n.countDiamonds)?.8:1,addedToScene:E,children:Ie("menu.main.score_gems")}),Object(m.jsx)(ia,{x:x+li.tileToScreen(6),y:2*b,setStyle:O,alpha:(null===n||void 0===n?void 0:n.collectedDiamonds)<(null===n||void 0===n?void 0:n.countDiamonds)?.8:1,addedToScene:E,children:ji(null===n||void 0===n?void 0:n.collectedDiamonds,null===n||void 0===n?void 0:n.countDiamonds)})]},"gems_score"),d>1&&Object(m.jsxs)(s.Fragment,{children:[Object(m.jsx)(ia,{x:x,y:3*b,setStyle:O,alpha:(null===n||void 0===n?void 0:n.killedEnemies)<(null===n||void 0===n?void 0:n.countEnemies)?.8:1,addedToScene:E,children:Ie("menu.main.score_enemies")}),Object(m.jsx)(ia,{x:x+li.tileToScreen(6),y:3*b,setStyle:O,alpha:(null===n||void 0===n?void 0:n.killedEnemies)<(null===n||void 0===n?void 0:n.countEnemies)?.8:1,addedToScene:E,children:ji(null===n||void 0===n?void 0:n.killedEnemies,null===n||void 0===n?void 0:n.countEnemies)})]},"enemies_score"),d>2&&Object(m.jsxs)(s.Fragment,{children:[Object(m.jsx)(ia,{x:x,y:4*b,setStyle:O,alpha:(null===n||void 0===n?void 0:n.collectedShrooms)<(null===n||void 0===n?void 0:n.countShrooms)?.8:1,addedToScene:E,children:Ie("menu.main.score_shrooms")}),Object(m.jsx)(ia,{x:x+li.tileToScreen(6),y:4*b,setStyle:O,alpha:(null===n||void 0===n?void 0:n.collectedShrooms)<(null===n||void 0===n?void 0:n.countShrooms)?.8:1,addedToScene:E,children:ji(null===n||void 0===n?void 0:n.collectedShrooms,null===n||void 0===n?void 0:n.countShrooms)})]},"shrooms_score"),Object(m.jsx)(ia,{x:x,y:4.75*b,setStyle:O,addedToScene:E,children:"--------------------"}),d>3&&Object(m.jsxs)(s.Fragment,{children:[Object(m.jsx)(ia,{x:x,y:5.5*b,setStyle:O,alpha:(null===n||void 0===n?void 0:n.comp)<=(null===n||void 0===n?void 0:n.prevBest)?.8:1,addedToScene:E,children:Ie("menu.main.score_comp")}),Object(m.jsx)(ia,{x:x+li.tileToScreen(6),y:5.5*b,setStyle:O,alpha:(null===n||void 0===n?void 0:n.comp)<=(null===n||void 0===n?void 0:n.prevBest)?.8:1,addedToScene:E,children:Bi(null===n||void 0===n?void 0:n.comp)})]},"total_score"),d>4&&Object(m.jsxs)(s.Fragment,{children:[Object(m.jsx)(ia,{x:x,y:6.5*b,setStyle:Object(Qe.a)(Object(Qe.a)({},O),{},{fill:(null===n||void 0===n?void 0:n.prevBest)>=(null===n||void 0===n?void 0:n.comp)?"#aee0c8":"#ffd700"}),addedToScene:E,children:Ie("menu.main.score_best")}),Object(m.jsx)(ia,{x:x+li.tileToScreen(6),y:6.5*b,setStyle:Object(Qe.a)(Object(Qe.a)({},O),{},{fill:(null===n||void 0===n?void 0:n.prevBest)>=(null===n||void 0===n?void 0:n.comp)?"#aee0c8":"#ffd700"}),addedToScene:E,children:Bi(Math.max(null===n||void 0===n?void 0:n.prevBest,null===n||void 0===n?void 0:n.comp))})]},"best_score"),f.map((function(e,t){return Object(m.jsxs)(s.Fragment,{children:[l===t&&Object(m.jsx)(oa,{args:[100,100,"arrow"],x:x-li.tileToScreen(1.3),y:A+b*t+li.tileToScreen(.15),addedToScene:function(e){return null===e||void 0===e?void 0:e.play("arrow_menu").setRotation(-Math.PI/2).setScale(I).setOrigin(.5,0)}}),Object(m.jsx)(ia,{alpha:l===t?1:.5,args:[x,A+b*t,e,{fontFamily:"Emulogic",fontSize:"8px",fill:"#aee0c8",fontWeight:"regular"}],addedToScene:E})]},"row_".concat(t))}))]})},la={preload:function(){this.load.spritesheet("hud","./assets/tilemaps/hud_tilemap_20x20.png",{frameWidth:20,frameHeight:20,margin:1,sapcing:2})},create:function(){this.cameras.main.setPostPipeline(bi)}},ca={fontFamily:"GameGirl",fontSize:"8px",fill:"#aee0c8",lineSpacing:2,fontWeight:"regular"},ha="PAGE1",ua="PAGE2",da=function(){var e=Zi(),t=(e.game,e.scene),i=(e.sceneProps,Object(s.useState)(ha)),n=Object(a.a)(i,2),o=n[0],r=n[1],l=Object(s.useRef)(!1),c=[{xOffset:5,yOffset:0,text:Ie("outro_ki.title"),delay:1e3},{xOffset:5,yOffset:2,text:Ie("outro_ki.toBrContinue"),delay:2500},{xOffset:1,yOffset:4,text:Ie("outro_ki.discharge"),delay:1500},{xOffset:1,yOffset:5,text:Ie("outro_ki.whatsNext"),delay:1500},{xOffset:1,yOffset:6,text:Ie("outro_ki.followUs"),delay:1500},{xOffset:1,yOffset:7,text:Ie("outro_ki.ourName"),delay:1500},{xOffset:1,yOffset:9,text:Ie("outro_ki.msgLine1"),delay:1500},{xOffset:1,yOffset:10,text:Ie("outro_ki.msgLine2"),delay:1500},{xOffset:1,yOffset:13,text:Ie("outro_ki.msgLine3"),delay:1500}],h=[{xOffset:0,yOffset:0,text:Ie("outro_ki.credits"),delay:500},{xOffset:0,yOffset:2,text:Ie("outro_ki.creditsLine1"),delay:2500},{xOffset:0,yOffset:3,text:Ie("outro_ki.creditsLine2"),delay:1500},{xOffset:0,yOffset:4,text:Ie("outro_ki.creditsLine3"),delay:1500},{xOffset:0,yOffset:5,text:Ie("outro_ki.creditsLine4"),delay:1500},{xOffset:0,yOffset:7,text:Ie("outro_ki.creditsLine5"),delay:3500}],u=Object(s.useCallback)((function(e){console.log(e),"Enter"===e.key&&o===ha&&l.current&&r(ua),"Enter"===e.key&&o===ua&&l.current}),[o,r]);Object(s.useEffect)((function(){return t&&(t.cameras&&t.cameras.main.setPostPipeline(bi),t.input.keyboard.addListener("keyup",u),Ni(t)),function(){null===t||void 0===t||t.input.keyboard.off("keyup")}}),[t,u]);var d=function(e){e.displayHeight=10*I(),e.depth=16,e.name="header_text",e.setScale(I()),e.setScrollFactor(0),e.setShadow(-1,1)},p=Object(s.useCallback)((function(e,i,a){var s=e.reduce((function(e,t,a){return a<=i&&(e+=t.delay),e}),0);t.tweens.add({targets:a,alpha:1,ease:"Linear",duration:500,delay:s,onComplete:function(){i===e.length-1&&(l.current=!0)}})}),[t]),y=li.tileToScreen(1),f=li.tileToScreen(1),v=li.tileToScreen(1),g=li.tileToScreen(.75);li.tileToScreen(7);return Object(m.jsxs)(m.Fragment,{children:[o===ha&&Object(m.jsx)(sa,{x:f,y:y,children:c.map((function(e,t){return Object(m.jsx)(ia,{x:v*e.xOffset,y:g*e.yOffset,setStyle:ca,addedToScene:function(e){e.alpha=0,p(c,t,e),d(e)},children:e.text},e.text)}))}),o===ua&&Object(m.jsx)(sa,{x:f,y:y,children:h.map((function(e,t){return Object(m.jsx)(ia,{x:v*e.xOffset,y:g*e.yOffset,setStyle:ca,addedToScene:function(e){e.alpha=0,p(h,t,e),d(e)},children:e.text},e.text)}))})]})},pa={preload:function(){this.load.spritesheet("hud","./assets/tilemaps/hud_tilemap_20x20.png",{frameWidth:20,frameHeight:20,margin:1,sapcing:2})},create:function(){this.cameras.main.setPostPipeline(bi)}},ya=Object(s.forwardRef)((function(e,t){var i=e.args,a=(e.children,Object(Ji.a)(e,["args","children"])),n=Object(s.useRef)(),o=t||n;return Object(m.jsx)(ea,Object(Qe.a)({ref:o,type:"Image",args:i},a))}));ya.displayName="Image";var ma=ya,fa=function(){var e,t,i,a,n,o=Zi().scene;Object(s.useEffect)((function(){o&&(o.cameras.main.setPostPipeline(bi),Ni(o),o.navigateToScene=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o.cameras.main.fade(500,0,0,0),o.tweens.add({targets:o.titlesMusic,volume:0,ease:"Linear",duration:500,onComplete:function(){var i;null===(i=o.titlesMusic)||void 0===i||i.pause(),o.scene.start(e,t)}})})}),[o]);return Object(m.jsx)(sa,{children:(null===o||void 0===o||null===(e=o.cameras)||void 0===e?void 0:e.main)&&Object(m.jsx)(ma,{args:[(null===o||void 0===o||null===(t=o.cameras)||void 0===t||null===(i=t.main)||void 0===i?void 0:i.width)/2,(null===o||void 0===o||null===(a=o.cameras)||void 0===a||null===(n=a.main)||void 0===n?void 0:n.height)/2,"Cover"],addedToScene:function(e){var t,i,a;if(!(null===o||void 0===o||null===(t=o.cameras)||void 0===t?void 0:t.main))return!1;var s=(null===o||void 0===o||null===(i=o.cameras)||void 0===i?void 0:i.main.width)/e.width,n=(null===o||void 0===o||null===(a=o.cameras)||void 0===a?void 0:a.main.height)/e.height,r=Math.min(s,n);e.setOrigin(.5,.5),e.setScale(r).setScrollFactor(0),e.name="background_art",new ni(o).showInitialMenu()}})})},va={preload:function(){},create:function(){}},ga=function(e){Object(E.a)(i,e);var t=Object(O.a)(i);function i(e){var a;return Object(g.a)(this,i),(a=t.call(this,{game:e,fragShader:"\nprecision mediump float;\n\nuniform sampler2D uMainSampler[%count%];\nuniform float gray;\n\nvarying vec2 outTexCoord;\nvarying float outTexId;\nvarying vec4 outTint;\nvarying vec2 fragCoord;\n\nvoid main()\n{\n    vec4 texture;\n\n    %forloop%\n\n    gl_FragColor = texture;\n    gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126 * gl_FragColor.r + 0.7152 * gl_FragColor.g + 0.0722 * gl_FragColor.b), gray);\n}\n",uniforms:["uProjectionMatrix","uMainSampler","gray"]}))._gray=0,a}return Object(_.a)(i,[{key:"onPreRender",value:function(){this.set1f("gray",this._gray)}},{key:"gray",get:function(){return this._gray},set:function(e){this._gray=e}}]),i}(d.a.Renderer.WebGL.Pipelines.MultiPipeline),_a=i(40),Ea=i(41),Oa=i(38),Sa=i(39),Ta=function(e){var t=e.name,i=e.children,n=Object(s.useState)(!1),o=Object(a.a)(n,2),r=o[0],l=o[1],c=Zi(),h=c.game,u=c.scene;return Object(s.useEffect)((function(){(null===h||void 0===h?void 0:h.scene.isActive(t))&&u&&l(!0)}),[h,t,u]),r?i:null},xa=function(){var e=Zi(),t=e.game,i=e.scene,n=Object(s.useState)(0),o=Object(a.a)(n,2),r=o[0],l=o[1],c=Object(s.useState)([0,0,0,0]),h=Object(a.a)(c,2),u=h[0],d=h[1],y=Object(s.useState)(["Music","Sounds","CRT Effect","Language"]),f=Object(a.a)(y,1)[0],v=Object(s.useState)([["On","Off"],["On","Off"],["On","Off"],["Spanish","English"]]),g=Object(a.a)(v,1)[0],_=Object(s.useCallback)((function(e){if(ai(e.key)&&t.scene.start("SplashScreenScene"),$t(e.key)&&r<f.length-1&&l((function(e){return e+1})),Zt(e.key)&&r>0&&l((function(e){return e-1})),ii(e.key)){var i=Object(p.a)(u);i[r]=(i[r]+1)%g[r].length,d(i)}}),[t,r,f,g,u]);Object(s.useEffect)((function(){return null===i||void 0===i||i.input.keyboard.addListener("keydown",_),function(){return null===i||void 0===i?void 0:i.input.keyboard.removeListener("keydown",_)}}),[i,_]),Object(s.useEffect)((function(){return console.log()}),[]);var E=li.tileToScreen(1),O=li.tileToScreen(1),S=li.tileToScreen(4),T=li.tileToScreen(8);return Object(m.jsxs)(m.Fragment,{children:[f.map((function(e,t){return Object(m.jsx)(ia,{alpha:r===t?1:.5,args:[E,O*t+S,e,{fontFamily:"Emulogic",fontSize:"8px",fill:"#aee0c8",fontWeight:"regular"}],addedToScene:function(e){e.displayHeight=10*I,e.depth=16,e.name="header_text",e.setScale(I),e.setScrollFactor(0),e.setShadow(-1,1)}},e)})),g.map((function(e,t){var i=e[u[t]];return Object(m.jsx)(ia,{alpha:r===t?1:.5,text:i,args:[E+T,O*t+S,i,{fontFamily:"Emulogic",fontSize:"8px",fill:"#aee0c8",fontWeight:"regular"}],addedToScene:function(e){e.displayHeight=10*I,e.depth=16,e.name="header_text",e.setScale(I),e.setScrollFactor(0),e.setShadow(-1,1)}},"sub_opt_".concat(t))}))]})},ba={width:"100%",height:"100%",parent:window.document.querySelector("#content"),type:d.a.WEBGL,scale:{mode:d.a.Scale.RESIZE,max:{width:16*window.document.body.clientHeight/9,height:window.document.body.clientHeight},autoCenter:d.a.Scale.CENTER_BOTH},backgroundColor:"#000000",disableContextMenu:!0,pixelArt:!0,roundPixels:!1,scene:[ki,Mi,Ui,Ki,Xi,zi,Qi],pipeline:{CRTFilter:bi,Gray:ga,GrayAlt:ga},plugins:{global:[{key:"rexFade",plugin:_a.a,start:!1},{key:"rexFlash",plugin:Ea.a,start:!0},{key:"rexCircularProgressPlugin",plugin:Oa.a,start:!0},{key:"rexTintRGB",plugin:Sa.a,start:!0}]}};function Aa(){var e=document.querySelector("#root"),t=document.querySelector("#content");e.clientWidth/e.clientHeight>.56?(t.style.width="100%",t.style.height=e.clientWidth/.56+"px"):(t.style.width=.56*e.clientHeight+"px",t.style.height="100%")}var ka=function(){var e=Object(s.useState)(),t=Object(a.a)(e,2),i=t[0],n=t[1];return Object(s.useEffect)((function(){return De(Object(h.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.bootUp();case 2:n(!0);case 3:case"end":return e.stop()}}),e)})))),window.addEventListener("resize",Aa),Aa(),function(){window.removeEventListener("resize",Aa)}}),[]),Object(s.useEffect)((function(){if(i)return window.addEventListener("resize",Aa),Aa(),function(){window.removeEventListener("resize",Aa)}}),[i]),i?Object(m.jsxs)(A,{args:ba,children:[Object(m.jsx)(Ta,{name:"KiStageCompleted",config:pa,children:Object(m.jsx)(da,{})}),Object(m.jsx)(Ta,{name:"SplashScreenScene",config:va,children:Object(m.jsx)(fa,{})}),Object(m.jsx)(Ta,{name:"LevelResumeScene",args:la,children:Object(m.jsx)(ra,{})}),Object(m.jsx)(Ta,{name:"OptionsScene",args:la,children:Object(m.jsx)(xa,{})})]}):null},wa=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,57)).then((function(t){var i=t.getCLS,a=t.getFID,s=t.getFCP,n=t.getLCP,o=t.getTTFB;i(e),a(e),s(e),n(e),o(e)}))};i(37),i(28);r.a.render(Object(m.jsx)(n.a.StrictMode,{children:Object(m.jsx)(ka,{})}),document.getElementById("content")),wa()}},[[56,1,2]]]);
//# sourceMappingURL=main.9206a90a.chunk.js.map