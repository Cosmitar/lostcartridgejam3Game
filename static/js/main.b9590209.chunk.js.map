{"version":3,"sources":["scenes/MenuScene.js","components/UI.js","libs/react-phaser-fiber/PhaserProvider.js","libs/react-phaser-fiber/components/Canvas.js","utils/constants.js","utils/CRTShaderFX.js","scenes/IntroScene.js","components/objects/GameObject.js","components/objects/Destroyable.js","components/objects/Moveable.js","components/objects/Fallable.js","components/objects/Boulder.js","components/objects/Character.js","components/objects/Enemy.js","components/objects/Player.js","components/objects/Wall.js","components/objects/Ground.js","components/objects/Empty.js","components/objects/Interactive.js","components/objects/Barrel.js","components/objects/Explosion.js","components/objects/Jewel.js","components/objects/Mushroom.js","components/levels/levelBase.js","components/LevelManager.js","components/levels/level_1.js","components/levels/level_2.js","components/levels/level_3.js","components/levels/level_4.js","components/levels/level_5.js","components/levels/level_6.js","components/Rules.js","scenes/GameScene.js","scenes/ConnectorScene.js","scenes/CreditsScene.js","Game.js","reportWebVitals.js","index.js"],"names":["titlesMusic","tnContainer","context","createContext","PhaserProvider","game","children","useState","ready","setReady","useEffect","Provider","value","Canvas","forwardRef","canvasRef","args","fallbackRef","useRef","ref","setGame","callbacks","postBoot","scene","scenes","events","once","Phaser","Scenes","Events","PRE_RENDER","s","load","on","Loader","COMPLETE","Game","current","TICK_TIME","SCALE","Math","round","window","innerWidth","PIXEL_NAME","EMPTY","PLAYER","GROUND","BOULDER","WALL","ENEMY","JEWEL","BARREL","EXPLOSION","INTERACTION","MUSHROOM","DIRS","DOWN","UP","LEFT","RIGHT","PIXEL_TO_TILEMAP_POSITION","x","y","data","W","N","E","S","BlurPostFX","renderTarget","fragShader","uniforms","set2f","set1f","Renderer","WebGL","Pipelines","PostFXPipeline","MenuScene","this","add","text","fontFamily","fontSize","fill","setScale","script","image","process","spritesheet","frameWidth","frameHeight","audio","sceneId","props","cameras","main","fade","tweens","targets","volume","ease","duration","onComplete","pause","start","setPostPipeline","CRTFilter","setBackgroundColor","width","height","scaleX","scaleY","scale","max","setScrollFactor","name","WebFont","custom","families","active","fadeIn","emit","sys","config","sound","loop","play","currentOption","arrow","graphics","fillStyle","color","alpha","fillTriangle","setPosition","menuOptions","label","disabled","onSelect","navigateToScene","level","forEach","o","idx","txt","setVisible","displayHeight","input","keyboard","event","newOption","key","length","Scene","participantSprites","UI","noScores","off","showPauseMenu","hidePauseMenu","rockHit","floor","random","gemHit","shroomPick","gemPick","clearHit","deathByRockHit","levelComplete","drawScores","participants","conversation","who","levels","prepareHUD","prepareText","map","list","find","ch","tilemap","layers","tilemapLayer","tileToWorldY","lastDialog","shift","onNextPage","isFullTextDisplayed","getByName","join","show","removeListener","message","clearText","writeText","showMoreIndicator","hideMoreIndicator","Object","keys","k","clearTint","setTint","addListener","resume","putTileAt","HALF_TILE","TILE_SIZE","textObj","tileToWorldX","displayWidth","depth","timerId","charPlaceholder","letters","fastForward","clearTimeout","putLetter","len","char","substr","setText","setTimeout","includes","mushroomsScore","destroy","diamondsScore","l","p","tn","make","tileWidth","tileHeight","tileset","addTilesetImage","layer","createBlankLayer","container","sprite","setOrigin","setFlipX","el","filter","scoreTileset","scoresLayer","pickaxeScore","localStorage","getItem","msh","shroomsAmount","align","diamond","diamondsAmount","amount","Number","setItem","restart","opt","row","split","handleKeyDown","isPaused","existingLayer","drawMenuOptions","IntroScene","anims","create","frames","generateFrameNumbers","repeat","createAnimations","normalDayMusic","quakesMusic","line1","line2","line3","showFirstDialogs","showSecondDialogs","stop","showThirdDialogs","pan","renderer","Cameras","Scene2D","PAN_COMPLETE","shake","delay","GameObject","id","isRigid","isBreakable","isFlat","isPickable","isCrushable","power","strength","force","weight","position","alien","isMoveable","coords","className","Destroyable","inactive","onDestroyElement","Moveable","Fallable","isFalling","nextPos","destinationElement","isDestinationInBounds","getObjectAt","destinationIsEmpty","isDestinationEmpty","destinationIsCrushable","destinationInBounds","pathElement","pathClear","objectIsEmpty","restingElement","canRest","canFallDown","canRollTo","Boulder","Character","pushingDirection","neighbour","emptyPlace","canBrakeNeighbour","canMove","nothingBesides","isPositionClear","isAboutToFall","canPush","moveObject","Enemy","moveIntentDir","anchorPosition","constructor","Player","onCharacterDie","onKeyDown","bind","onKeyUp","isMoving","playerLoop","die","Wall","Ground","Empty","isEmpty","Interactive","onInteractWith","Barrel","onExplode","explode","Explosion","explosion","fillRect","objects","Jewel","visible","onJewelPick","Mushroom","onMushroomPick","Level","moveables","player","playerTimeoutId","phaserScene","intOrder","r","c","element","boulder","mushroom","barrel","Animations","ANIMATION_COMPLETE","enemy","order","push","onAddElement","sort","a","b","canFallLeft","canFallRight","enemiesLoop","newAnchor","nextDir","backToTrackDir","nextAnchorPos","helperDirCalc","canMoveUp","canMoveDown","canMoveLeft","canMoveRight","e","pos","origin","overrunBy","runningOver","setObjectAt","move","console","warn","found","i","j","obj","xInBounds","yInBounds","LEVELS","LevelBase","pickaxe","updateLight","dist","Distance","Snake","setAlpha","forEachTile","tile","winningLoopRef","winningLoop","voidLevel","fx","startVoid","camera","voidLoop","autoDestroyTID","destroyMap","resetAutoVoidTimer","LevelManager","currentLevel","currentIndex","generateConfig","createMap","connectToScene","rules","ui","levelId","textures","get","getSourceImage","levelConfig","Array","pixColor","getPixel","Display","Color","ComponentToHex","g","levelData","calculateWallTileWithNeighbours","setBounds","zoom","Rules","timer","worldTickFreq","UPDATE","onSceneUpdate","setUpPuseResumeGame","setUpCameraFollowPlayer","music","next","onLevelStart","valume","cam","getPlayerPos","smoothFactor","scrollX","scrollY","time","delta","gravityLoop","GameScene","set","scaleMode","Scale","RESIZE","handleScales","SHUTDOWN","scalables","Map","clearScalables","clear","removeFromScalables","delete","addToScalables","updateScale","addEventListener","rows","frameRate","ConnectorScene","musicName","getMusicFromName","environmentMusic","getImageByName","img","showDialogLevel_cinematic_last_2","gameConfig","type","AUTO","backgroundColor","disableContextMenu","pixelArt","roundPixels","CreditsScene","pipeline","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","style","bottom","right","version","document","getElementById"],"mappings":"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ACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GAEtB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GAEtB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GAEtB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GAEtB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GAEtB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,G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EAAG,EAAG,GACpB5B,EAAI4B,UAAU,EAAG,EAAG,GACpB5B,EAAI4B,UAAU,EAAG,GAAI,GACrB5B,EAAI4B,UAAU,EAAG,GAAI,GACrB5B,EAAI4B,UAAU,EAAG,GAAI,GACrB5B,EAAI4B,UAAU,EAAG,GAAI,GACrB5B,EAAI4B,UAAU,EAAG,GAAI,GACrB5B,EAAI4B,UAAU,EAAG,GAAI,GACrB5B,EAAI4B,UAAU,EAAG,GAAI,GAErB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GAEtB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GAEtB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GAEtB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GAEtB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GACtB5B,EAAI4B,UAAU,GAAI,GAAI,GAEtB5B,EAAI4B,UAAU,GAAI,EAAG,GACrB5B,EAAI4B,UAAU,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","file":"static/js/main.b9590209.chunk.js","sourcesContent":["import Phaser from 'phaser'\nimport { SCALE } from '../utils/constants'\nimport CRTFilter from '../utils/CRTShaderFX'\n\nlet titlesMusic\nexport default class MenuScene extends Phaser.Scene {\n  constructor () {\n    super('MenuScene');\n  }\n\n  preload () {\n    const txt = this.add.text(80 * SCALE, (121) * SCALE + 20 * SCALE,\n      'LOADING.... PLEASE WAIT',\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"10px\",\n        fill: \"#ffffff\",\n      }\n    )\n  \n    txt.setScale(SCALE)\n    this.load.script('webfont', 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js');\n    this.load.image('main-tiles', process.env.PUBLIC_URL + '/assets/tilemaps/tilemap_20x20.png');\n    this.load.image('hud-tiles', process.env.PUBLIC_URL + '/assets/tilemaps/hud_tilemap_20x20.png');\n    this.load.image('level_1', process.env.PUBLIC_URL + '/assets/maps/level_1.png');\n    this.load.image('level_2', process.env.PUBLIC_URL + '/assets/maps/level_2.png');\n    this.load.image('level_3', process.env.PUBLIC_URL + '/assets/maps/level_3.png');\n    this.load.image('level_4', process.env.PUBLIC_URL + '/assets/maps/level_4.png');\n    this.load.image('level_5', process.env.PUBLIC_URL + '/assets/maps/level_5.png');\n    this.load.image('level_6', process.env.PUBLIC_URL + '/assets/maps/level_6.png');\n    this.load.image('Prologue', process.env.PUBLIC_URL + '/assets/images/Prologue.png');\n    this.load.image('thechild', process.env.PUBLIC_URL + '/assets/images/thechild.png');\n    this.load.image('theworld', process.env.PUBLIC_URL + '/assets/images/theworld.png');\n    this.load.image('Tiamat', process.env.PUBLIC_URL + '/assets/images/Tiamat.png');\n    this.load.image('Bossfight', process.env.PUBLIC_URL + '/assets/images/Bossfight.png');\n    this.load.image('Bossfighthands', process.env.PUBLIC_URL + '/assets/images/Bossfighthands.png');\n    this.load.spritesheet('boulder', process.env.PUBLIC_URL + '/assets/sprites/boulder_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('brave', process.env.PUBLIC_URL + '/assets/sprites/brave_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('bat', process.env.PUBLIC_URL + '/assets/sprites/bat_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('pickables', process.env.PUBLIC_URL + '/assets/sprites/pickables_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('closeUp', process.env.PUBLIC_URL + '/assets/sprites/close_up_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.audio('credits', process.env.PUBLIC_URL + '/assets/audio/Score/Opening Credits_.mp3');\n    this.load.audio('opening_peace', process.env.PUBLIC_URL + '/assets/audio/Score/NormalDay.mp3');\n    this.load.audio('opening_quakes', process.env.PUBLIC_URL + '/assets/audio/Score/Earthquakes+Tiamat.mp3');\n    this.load.audio('credits', process.env.PUBLIC_URL + '/assets/audio/Score/NormalDay.mp3');\n    this.load.audio('levels_surface', process.env.PUBLIC_URL + '/assets/audio/Score/1st 7 Levels.mp3');\n    this.load.audio('swarf_chat_music', process.env.PUBLIC_URL + '/assets/audio/Score/MushroomDwarfDialogue(loop).mp3');\n    this.load.audio('generic_chat_music', process.env.PUBLIC_URL + '/assets/audio/Score/GenericDialogue(loop).mp3');\n    this.load.audio('escape_music', process.env.PUBLIC_URL + '/assets/audio/Score/BossBattle_EscapeTheVoid!(loop).mp3');\n    this.load.audio('rock_hit', process.env.PUBLIC_URL + '/assets/audio/SFX/RockHit.mp3');\n    this.load.audio('rock_hit2', process.env.PUBLIC_URL + '/assets/audio/SFX/RockHit2.mp3');\n    this.load.audio('rock_hit3', process.env.PUBLIC_URL + '/assets/audio/SFX/RockHit3.wav');\n    this.load.audio('clear_hit1', process.env.PUBLIC_URL + '/assets/audio/SFX/PickaxeClearingGround1.mp3');\n    this.load.audio('clear_hit2', process.env.PUBLIC_URL + '/assets/audio/SFX/PickaxeClearingGround2.mp3');\n    this.load.audio('clear_hit3', process.env.PUBLIC_URL + '/assets/audio/SFX/PickaxeClearingGround3.mp3');\n    this.load.audio('gem_hit', process.env.PUBLIC_URL + '/assets/audio/SFX/GemHitRock.mp3');\n    this.load.audio('shroom_pick', process.env.PUBLIC_URL + '/assets/audio/SFX/MushroomPickUp.mp3');\n    this.load.audio('gem_pick', process.env.PUBLIC_URL + '/assets/audio/SFX/DiamondPickUp.mp3');\n    this.load.audio('death_by_rock', process.env.PUBLIC_URL + '/assets/audio/SFX/DeathByRock.mp3')\n    this.load.audio('level_complete', process.env.PUBLIC_URL + '/assets/audio/SFX/Level Finish.mp3')\n    this.load.audio('earthquake', process.env.PUBLIC_URL + '/assets/audio/SFX/Earthquake.mp3')\n    // this.load.on(Phaser.Loader.Events.PROGRESS, console.log)\n  }\n\n  navigateToScene(sceneId, props = {}) {\n    this.cameras.main.fade(500, 0, 0, 0)\n    this.tweens.add({  \n      targets: titlesMusic,\n      volume: 0,\n      ease: 'Linear',\n      duration: 500,\n      onComplete: () => {\n        titlesMusic.pause()\n        this.scene.start(sceneId, props)\n      },\n    });\n  }\n\n  create() {\n    this.cameras.main.setPostPipeline(CRTFilter);\n    this.cameras.main.setBackgroundColor(\"#486859\")\n\n    let image = this.add.image(this.cameras.main.width / 2, this.cameras.main.height / 3, 'Bossfight')\n    let scaleX = this.cameras.main.width / image.width\n    let scaleY = this.cameras.main.height / image.height\n    let scale = Math.max(scaleX, scaleY)\n    image.setScale(scale * 1.5).setScrollFactor(0)\n    image.name = 'background_art'\n\n    window.WebFont.load({\n      custom: {\n          families: [ 'GameGirl' ]\n      },\n      active: () => {\n        this.cameras.main.fadeIn(500, 0, 0, 0)\n        this.events.emit('scene_ready', this.sys.config)\n\n        titlesMusic = this.sound.add('credits', { loop: true });\n        titlesMusic.play()\n        \n        // this.events.once(Phaser.Scenes.Events.WAKE, () => console.log(Phaser.Scenes.Events.WAKE))\n        // this.events.once(Phaser.Scenes.Events.UPDATE, () => console.log(Phaser.Scenes.Events.UPDATE))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_WAKE, () => console.log(Phaser.Scenes.Events.TRANSITION_WAKE))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_START, () => console.log(Phaser.Scenes.Events.TRANSITION_START))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_OUT, () => console.log(Phaser.Scenes.Events.TRANSITION_OUT))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_INIT, () => console.log(Phaser.Scenes.Events.TRANSITION_INIT))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_COMPLETE, () => console.log(Phaser.Scenes.Events.TRANSITION_COMPLETE))\n        // this.events.once(Phaser.Scenes.Events.START, () => console.log(Phaser.Scenes.Events.START))\n        // this.events.once(Phaser.Scenes.Events.SLEEP, () => console.log(Phaser.Scenes.Events.SLEEP))\n        // this.events.once(Phaser.Scenes.Events.SHUTDOWN, () => console.log(Phaser.Scenes.Events.SHUTDOWN))\n        // this.events.once(Phaser.Scenes.Events.RESUME, () => console.log(Phaser.Scenes.Events.RESUME))\n        // this.events.once(Phaser.Scenes.Events.RENDER, () => console.log(Phaser.Scenes.Events.RENDER))\n        // this.events.once(Phaser.Scenes.Events.READY, () => console.log(Phaser.Scenes.Events.READY))\n        // this.events.once(Phaser.Scenes.Events.PRE_RENDER, () => console.log(Phaser.Scenes.Events.PRE_RENDER))\n        // this.events.once(Phaser.Scenes.Events.PAUSE, () => console.log(Phaser.Scenes.Events.PAUSE))\n        // this.events.once(Phaser.Scenes.Events.CREATE, () => console.log(Phaser.Scenes.Events.CREATE))\n        // this.events.once(Phaser.Scenes.Events.BOOT, () => console.log(Phaser.Scenes.Events.BOOT))\n\n        let currentOption = 0\n\n        const arrow = this.add.graphics({ fillStyle: { color: 0xffffff, alpha: 1 } })\n        arrow.fillTriangle(0, 0, 5, 5, 0, 10).setPosition(70 * SCALE, 20 * SCALE)\n        // arrow.setPosition(70 * SCALE, ((12 * newOption) + 2) * SCALE)\n        arrow.setScale(SCALE)\n        \n        const menuOptions = [{\n          label: 'New Game',\n          disabled: false,\n          onSelect: () => this.navigateToScene('IntroScene')\n        }, {\n          label: 'Level 1',\n          disabled: false && window.localStorage.getItem('level_1') !== 'true',\n          onSelect: () => this.navigateToScene('GameScene', { level: 1 })\n        }, {\n          label: 'Level 2',\n          disabled: false && window.localStorage.getItem('level_2') !== 'true',\n          onSelect: () => this.navigateToScene('GameScene', { level: 3 })\n        }, {\n          label: 'Level 3',\n          disabled: false && window.localStorage.getItem('level_3') !== 'true',\n          onSelect: () => this.navigateToScene('GameScene', { level: 4 })\n        }, {\n          label: 'Level 4',\n          disabled: false && window.localStorage.getItem('level_4') !== 'true',\n          onSelect: () => this.navigateToScene('GameScene', { level: 5 })\n        }, {\n          label: 'Level 5',\n          disabled: false && window.localStorage.getItem('level_5') !== 'true',\n          onSelect: () => this.navigateToScene('GameScene', { level: 6 })\n        }, {\n          label: 'Level 6',\n          disabled: false && window.localStorage.getItem('level_6') !== 'true',\n          onSelect: () => this.navigateToScene('GameScene', { level: 8 })\n        }\n        // , {\n        //   label: 'Cinematic final',\n        //   disabled: false,\n        //   onSelect: () => this.navigateToScene('ConnectorScene', { id: 8, name: 'cinematic_last' } )\n        // }\n        // , {\n        //   label: 'Cinematic final',\n        //   disabled: false,\n        //   onSelect: () => this.navigateToScene('ConnectorScene', { id: 7, name: 'cinematic_escape' } )\n        // }\n      ]\n\n        menuOptions.forEach((o, idx) => {\n          const txt = this.add.text(80 * SCALE, (12 * idx + 1) * SCALE + 20 * SCALE,\n            o.label,\n            {\n              fontFamily: 'GameGirl',\n              fontSize: \"10px\",\n              fill: \"#ffffff\",\n            }\n          ).setVisible(!o.disabled)\n          txt.displayHeight = 10 * SCALE\n          txt.setScale(SCALE)\n          // txt.displayWidth = idx * 10 * SCALE\n\n        })\n\n        this.input.keyboard.on('keydown', event => {\n          let newOption = false\n          if (event.key === 'ArrowUp') {\n            newOption = currentOption > 0 ? currentOption - 1 : menuOptions.length - 1\n          }\n          if (event.key === 'ArrowDown') {\n            newOption = currentOption < menuOptions.length - 1 ? currentOption + 1 : 0\n          }\n          if(newOption !== false && !menuOptions[newOption].disabled) {\n            arrow.setPosition(70 * SCALE, ((12 * newOption) + 2) * SCALE + 20 * SCALE)\n            currentOption = newOption\n          }\n          if (event.key === 'Enter') {\n            if(!menuOptions[currentOption].disabled) {\n              menuOptions[currentOption].onSelect()\n            }\n          }\n        })\n      }\n    })\n  }\n}\n","import { TILE_SIZE, SCALE } from '../utils/constants'\nimport Phaser from 'phaser'\n\n// let map\nlet tnContainer\nlet participantSprites = {}\nexport default class UI {\n  showMoreIndicator() { this.scene.children.list.find(ch => ch.name === 'layer_hud').tilemap.putTileAt(66, 15, 6)}\n  hideMoreIndicator() { this.scene.children.list.find(ch => ch.name === 'layer_hud').tilemap.putTileAt(67, 15, 6)}\n  constructor(scene, noScores) {\n    this.scene = scene\n    this.scene.events.off('game_paused')\n    this.scene.events.on('game_paused', () => this.showPauseMenu())\n    this.scene.events.off('game_resumed')\n    this.scene.events.on('game_resumed', () => this.hidePauseMenu())\n\n    const rockHit1 = this.scene.sound.add('rock_hit')\n    const rockHit2 = this.scene.sound.add('rock_hit2')\n    const rockHit3 = this.scene.sound.add('rock_hit3')\n    const rockHit = [rockHit1, rockHit2, rockHit3]\n    this.scene.events.off('sounds:rock_hit')\n    this.scene.events.on('sounds:rock_hit', () => rockHit[Math.floor(Math.random()*10) % 3].play())\n    \n    \n    const gemHit = this.scene.sound.add('gem_hit')\n    this.scene.events.off('sounds:gem_hit')\n    this.scene.events.on('sounds:gem_hit', () => gemHit.play())\n    \n    const shroomPick = this.scene.sound.add('shroom_pick')\n    this.scene.events.off('sounds:shroom_pick')\n    this.scene.events.on('sounds:shroom_pick', () => shroomPick.play())\n    \n    const gemPick = this.scene.sound.add('gem_pick')\n    this.scene.events.off('sounds:gem_pick')\n    this.scene.events.on('sounds:gem_pick', () => gemPick.play())\n\n    const clearHit1 = this.scene.sound.add('clear_hit1')\n    const clearHit2 = this.scene.sound.add('clear_hit2')\n    const clearHit3 = this.scene.sound.add('clear_hit3')\n    const clearHit = [clearHit1, clearHit2, clearHit3]\n    this.scene.events.off('sounds:clear_hit')\n    this.scene.events.on('sounds:clear_hit', () => clearHit[Math.floor(Math.random()*10) % 3].play())\n\n    const deathByRockHit = this.scene.sound.add('death_by_rock')\n    this.scene.events.once('sounds:death_by_rock_hit', () => deathByRockHit.play())\n\n    const levelComplete = this.scene.sound.add('level_complete')\n    this.scene.events.off('sounds:level_complete')\n    this.scene.events.on('sounds:level_complete', () => levelComplete.play())\n    if(!noScores) {\n      this.drawScores()\n    }\n\n    this.scene.events.off('dialogue:show')\n    this.scene.events.on('dialogue:show', ({\n      participants = ['closeUp_Mary', 'closeUp_Dwarf', 'closeUp_Marduk', 'closeUp_Tiamat'],\n      conversation = [\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"abcdefghijklmnopqrstuvwx\",\n            \"Hi, I'm Mary\",\n            \"citizen of sumaria\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"Hi, my name is marduk\",\n            \"I am a man\",\n            \"and I don’t need your\",\n            \"help.\"\n          ]\n        },\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n            \"Hello\",\n            \"you can Call Me M.D\",\n            \"The Medical Doctor and\",\n            \"Mushroom Dwarf!\"\n          ]\n        },{\n          who: 'closeUp_Tiamat',\n          text: [\n            \"you all know me\",\n            \"pray before you godess\",\n            \"<< tiamat >>.\",\n          ]\n        },\n      ]\n    }) => {\n      this.scene.levels?.current?.pause()\n      this.prepareHUD(participants)\n      this.prepareText()\n      const map = this.scene.children.list.find(ch => ch.name === 'layer_hud').tilemap\n      map.layers[0].tilemapLayer.y = tnContainer.y = -map.tileToWorldY(5)\n\n      this.scene.tweens.add({\n        targets: [map.layers[0].tilemapLayer, tnContainer],\n        y: map.tileToWorldY(9),\n        duration: 500,\n        ease: 'Cubic.Out',\n        onComplete: () => {\n          let lastDialog = conversation.shift()\n          const onNextPage = (event) => {\n            const isFullTextDisplayed = this.scene.children.getByName('placeholder_text').text.length === lastDialog.text.join('\\n').length\n            if(event.key === 'Enter' && isFullTextDisplayed) {\n              if (conversation.length) {\n                lastDialog = conversation.shift()\n                show(lastDialog)\n              } else {\n                this.scene.events.emit('dialogue:hide')\n                this.scene.input.keyboard.removeListener('keydown', onNextPage)\n              }\n            }\n          }\n          const show = message => {\n            this.clearText()\n            this.writeText(message.text)\n            if(conversation.length) {\n              this.showMoreIndicator()\n            } else {\n              this.hideMoreIndicator()\n            }\n            Object.keys(participantSprites).forEach(k => {\n              if (k === message.who) {\n                // participantSprites[k].alpha = 1\n                participantSprites[k].clearTint()\n              } else {\n                // participantSprites[k].alpha = 0.5\n                participantSprites[k].setTint(0x333333)\n              }\n            })\n            this.scene.input.keyboard.removeListener('keydown', onNextPage)\n            this.scene.input.keyboard.addListener('keydown', onNextPage)\n          }\n          show(lastDialog)\n        }\n      })\n    })\n    this.scene.events.off('dialogue:hide')\n    this.scene.events.on('dialogue:hide', () => {\n      const map = this.scene.children.list.find(ch => ch.name === 'layer_hud').tilemap\n      this.clearText()\n      this.scene.tweens.add({\n        targets: [map.layers[0].tilemapLayer, tnContainer],\n        y: -map.tileToWorldY(5),\n        duration: 500,\n        ease: 'Back.In',\n        onComplete: () => {\n          this.scene.levels?.current?.resume()\n        }\n      })\n    })\n    \n  }\n\n  prepareText() {\n    const map = this.scene.children.list.find(ch => ch.name === 'layer_hud').tilemap\n    const HALF_TILE = TILE_SIZE / 2 * SCALE\n    const textObj = this.scene.add.text(\n      map.tileToWorldX(4) - HALF_TILE,\n      map.tileToWorldY(5) - HALF_TILE,\n      \" \",\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"90px\",\n        fill: \"#ffffff\",\n      }\n    )\n    textObj.displayHeight = 10 * SCALE\n    textObj.displayWidth = 10 * SCALE\n    textObj.name = 'placeholder_text'\n    textObj.depth = 10\n  }\n  writeText(text) {\n    const charPlaceholder = this.scene.children.getByName('placeholder_text')\n    let letters = text.join('\\n')\n    let timerId\n    const fastForward = () => {\n      clearTimeout(timerId)\n      putLetter(letters.length)\n    }\n    const putLetter = (len = 1) => {\n      const char = letters.substr(0, len)\n      letters = letters.substr(len)\n      charPlaceholder.setText(charPlaceholder.text + char)\n      if (letters.length) {\n        timerId = setTimeout(() => putLetter(1),\n          ['.','!','?'].includes(char) ? 500 : 50)\n      }\n    }\n    putLetter()\n    setTimeout(() => this.scene.input.keyboard.once('keyup', fastForward), 500)\n  }\n\n  clearText() {\n    this.scene.children.getByName('placeholder_text').text = ''\n    // this.scene.children.list.filter(el => el.name === 'placeholder_text').forEach(el => el.setText(\"\"))\n  }\n\n  destroy() {\n    this.mushroomsScore.destroy()\n    this.diamondsScore.destroy()\n    this.scene.events.off('score:diamond_collected')\n    this.scene.events.off('score:mushroom_collected')\n  }\n\n  prepareHUD(participants) {\n    const l = this.scene.children.getByName('layer_hud')\n    if (l) {\n      l.destroy()\n    }\n    // Creating a blank tilemap with dimensions matching the dungeon\n    const map = this.scene.make.tilemap({ tileWidth: 20, tileHeight: 20, width: 20, height: 20 });\n\n    // addTilesetImage: function (tilesetName, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid)\n    let tileset = map.addTilesetImage('hud-tiles', 'hud-tiles', 20, 20, 1, 2);\n\n    let layer = map.createBlankLayer('layer_hud', tileset);\n    layer.name = 'layer_hud'\n    layer.depth = 5\n    layer.setScrollFactor(0)\n    layer.setScale(SCALE)\n  \n    // Fill with black tiles\n    // layer.fill(1)\n    let p, tn\n    tnContainer = this.scene.add.container(0,0)\n    tnContainer.depth = 10\n    // tnContainer.setScale(SCALE)\n    // tnContainer.y = -this.scene.renderer.height/2\n    switch (participants.length) {\n      case 2:\n        if (participants[1]) {\n          p = participants[1]\n          tn = this.scene.add.sprite(0, 0).play(p).setOrigin(0, 0.25).setScale(SCALE * 1.5)\n          tn.name = `${p}_tn_to_remove`\n          tn.x = map.tileToWorldX(17) + 10 * SCALE\n          tn.y = map.tileToWorldY(3) + 2 * SCALE\n          tn.setFlipX(true)\n          tnContainer.add(tn)\n          participantSprites[p] = tn\n        }\n\n        /// TN MIDDLE RIGHT\n        map.putTileAt(0, 17, 2)\n        map.putTileAt(1, 18, 2)\n        map.putTileAt(2, 19, 2)\n\n        map.putTileAt(11, 17, 3)\n        map.putTileAt(12, 18, 3)\n        map.putTileAt(13, 19, 3)\n        \n        map.putTileAt(22, 17, 4)\n        map.putTileAt(23, 18, 4)\n        map.putTileAt(24, 19, 4)\n      // eslint-disable-next-line no-fallthrough\n      case 1:\n        if (participants[0]) {\n          p = participants[0]\n          tn = this.scene.add.sprite(0, 0).play(p).setOrigin(0, 0.25).setScale(SCALE * 1.5)\n          tn.name = `${p}_tn_to_remove`\n          tn.x = map.tileToWorldX(0) + 12 * SCALE\n          tn.y = map.tileToWorldY(3) + 2 * SCALE\n          tnContainer.add(tn)\n          participantSprites[p] = tn\n        }\n        /// TN MIDDLE LEFT\n        map.putTileAt(0, 0, 2)\n        map.putTileAt(1, 1, 2)\n        map.putTileAt(2, 2, 2)\n  \n        map.putTileAt(11, 0, 3)\n        map.putTileAt(12, 1, 3)\n        map.putTileAt(13, 2, 3)\n        \n        map.putTileAt(22, 0, 4)\n        map.putTileAt(23, 1, 4)\n        map.putTileAt(24, 2, 4)  \n        break\n      case 4:\n        /// TN LOWER RIGHT\n        if (participants[3]) {\n          p = participants[3]\n          tn = this.scene.add.sprite(0, 0).play(p).setOrigin(0, 0.25).setScale(SCALE * 1.5)\n          tn.name = `${p}_tn_to_remove`\n          tn.x = map.tileToWorldX(17) + 10 * SCALE\n          tn.y = map.tileToWorldY(5) + 2 * SCALE\n          tn.setFlipX(true)\n          tnContainer.add(tn)\n          participantSprites[p] = tn\n        }\n        map.putTileAt(0, 17, 4)\n        map.putTileAt(1, 18, 4)\n        map.putTileAt(2, 19, 4)\n\n        map.putTileAt(11, 17, 5)\n        map.putTileAt(12, 18, 5)\n        map.putTileAt(13, 19, 5)\n        \n        map.putTileAt(22, 17, 6)\n        map.putTileAt(23, 18, 6)\n        map.putTileAt(24, 19, 6)\n      // eslint-disable-next-line no-fallthrough\n      case 3:\n        /// TN UPPER LEFT\n        if (participants[0]) {\n          p = participants[0]\n          tn = this.scene.add.sprite(0, 0).play(p).setOrigin(0, 0.25).setScale(SCALE * 1.5)\n          tn.name = `${p}_tn_to_remove`\n          tn.x = map.tileToWorldX(0) + 12 * SCALE\n          tn.y = map.tileToWorldY(1) + 2 * SCALE\n          tnContainer.add(tn)\n          participantSprites[p] = tn\n        }\n        map.putTileAt(0, 0, 0)\n        map.putTileAt(1, 1, 0)\n        map.putTileAt(2, 2, 0)\n\n        map.putTileAt(11, 0, 1)\n        map.putTileAt(12, 1, 1)\n        map.putTileAt(13, 2, 1)\n        \n        map.putTileAt(22, 0, 2)\n        map.putTileAt(23, 1, 2)\n        map.putTileAt(24, 2, 2)\n\n        /// TN BOTTOM LEFT\n        if (participants[2]) {\n          p = participants[2]\n          tn = this.scene.add.sprite(0, 0).play(p).setOrigin(0, 0.25).setScale(SCALE * 1.5)\n          tn.name = `${p}_tn_to_remove`\n          tn.x = map.tileToWorldX(0) + 12 * SCALE\n          tn.y = map.tileToWorldY(5) + 2 * SCALE\n          tnContainer.add(tn)\n          participantSprites[p] = tn\n        }\n\n        map.putTileAt(0, 0, 4)\n        map.putTileAt(1, 1, 4)\n        map.putTileAt(2, 2, 4)\n\n        map.putTileAt(11, 0, 5)\n        map.putTileAt(12, 1, 5)\n        map.putTileAt(13, 2, 5)\n        \n        map.putTileAt(22, 0, 6)\n        map.putTileAt(23, 1, 6)\n        map.putTileAt(24, 2, 6)\n\n        /// TN UPPER RIGHT\n        if (participants[1]) {\n          p = participants[1]\n          tn = this.scene.add.sprite(0, 0).play(p).setOrigin(0, 0.25).setScale(SCALE * 1.5)\n          tn.name = `${p}_tn_to_remove`\n          tn.x = map.tileToWorldX(17) + 10 * SCALE\n          tn.y = map.tileToWorldY(1) + 2 * SCALE\n          tn.setFlipX(true)\n          tnContainer.add(tn)\n          participantSprites[p] = tn\n        }\n        map.putTileAt(0, 17, 0)\n        map.putTileAt(1, 18, 0)\n        map.putTileAt(2, 19, 0)\n\n        map.putTileAt(11, 17, 1)\n        map.putTileAt(12, 18, 1)\n        map.putTileAt(13, 19, 1)\n        \n        map.putTileAt(22, 17, 2)\n        map.putTileAt(23, 18, 2)\n        map.putTileAt(24, 19, 2)\n        break\n      default:\n    }\n\n    // DIALOG AREA\n    map.putTileAt(0, 3, 0)\n    map.putTileAt(1, 4, 0)\n    map.putTileAt(1, 5, 0)\n    map.putTileAt(1, 6, 0)\n    map.putTileAt(1, 7, 0)\n    map.putTileAt(1, 8, 0)\n    map.putTileAt(1, 9, 0)\n    map.putTileAt(1, 10, 0)\n    map.putTileAt(1, 11, 0)\n    map.putTileAt(1, 12, 0)\n    map.putTileAt(1, 13, 0)\n    map.putTileAt(1, 14, 0)\n    map.putTileAt(1, 15, 0)\n    map.putTileAt(2, 16, 0)\n\n    map.putTileAt(11, 3, 1)\n    map.putTileAt(12, 4, 1)\n    map.putTileAt(12, 5, 1)\n    map.putTileAt(12, 6, 1)\n    map.putTileAt(12, 7, 1)\n    map.putTileAt(12, 8, 1)\n    map.putTileAt(12, 9, 1)\n    map.putTileAt(12, 10, 1)\n    map.putTileAt(12, 11, 1)\n    map.putTileAt(12, 12, 1)\n    map.putTileAt(12, 13, 1)\n    map.putTileAt(12, 14, 1)\n    map.putTileAt(12, 15, 1)\n    map.putTileAt(13, 16, 1)\n\n    map.putTileAt(11, 3, 2)\n    map.putTileAt(12, 4, 2)\n    map.putTileAt(12, 5, 2)\n    map.putTileAt(12, 6, 2)\n    map.putTileAt(12, 7, 2)\n    map.putTileAt(12, 8, 2)\n    map.putTileAt(12, 9, 2)\n    map.putTileAt(12, 10, 2)\n    map.putTileAt(12, 11, 2)\n    map.putTileAt(12, 12, 2)\n    map.putTileAt(12, 13, 2)\n    map.putTileAt(12, 14, 2)\n    map.putTileAt(12, 15, 2)\n    map.putTileAt(13, 16, 2)\n\n    map.putTileAt(11, 3, 3)\n    map.putTileAt(12, 4, 3)\n    map.putTileAt(12, 5, 3)\n    map.putTileAt(12, 6, 3)\n    map.putTileAt(12, 7, 3)\n    map.putTileAt(12, 8, 3)\n    map.putTileAt(12, 9, 3)\n    map.putTileAt(12, 10, 3)\n    map.putTileAt(12, 11, 3)\n    map.putTileAt(12, 12, 3)\n    map.putTileAt(12, 13, 3)\n    map.putTileAt(12, 14, 3)\n    map.putTileAt(12, 15, 3)\n    map.putTileAt(13, 16, 3)\n\n    map.putTileAt(11, 3, 4)\n    map.putTileAt(12, 4, 4)\n    map.putTileAt(12, 5, 4)\n    map.putTileAt(12, 6, 4)\n    map.putTileAt(12, 7, 4)\n    map.putTileAt(12, 8, 4)\n    map.putTileAt(12, 9, 4)\n    map.putTileAt(12, 10, 4)\n    map.putTileAt(12, 11, 4)\n    map.putTileAt(12, 12, 4)\n    map.putTileAt(12, 13, 4)\n    map.putTileAt(12, 14, 4)\n    map.putTileAt(12, 15, 4)\n    map.putTileAt(13, 16, 4)\n\n    map.putTileAt(11, 3, 5)\n    map.putTileAt(12, 4, 5)\n    map.putTileAt(12, 5, 5)\n    map.putTileAt(12, 6, 5)\n    map.putTileAt(12, 7, 5)\n    map.putTileAt(12, 8, 5)\n    map.putTileAt(12, 9, 5)\n    map.putTileAt(12, 10, 5)\n    map.putTileAt(12, 11, 5)\n    map.putTileAt(12, 12, 5)\n    map.putTileAt(12, 13, 5)\n    map.putTileAt(12, 14, 5)\n    map.putTileAt(12, 15, 5)\n    map.putTileAt(13, 16, 5)\n\n    map.putTileAt(22, 3, 6)\n    map.putTileAt(23, 4, 6)\n    map.putTileAt(23, 5, 6)\n    map.putTileAt(23, 6, 6)\n    map.putTileAt(23, 7, 6)\n    map.putTileAt(23, 8, 6)\n    map.putTileAt(23, 9, 6)\n    map.putTileAt(23, 10, 6)\n    map.putTileAt(23, 11, 6)\n    map.putTileAt(23, 12, 6)\n    map.putTileAt(23, 13, 6)\n    map.putTileAt(23, 14, 6)\n    map.putTileAt(23, 15, 6)\n    map.putTileAt(24, 16, 6)\n\n    // map.putTileAt(66, 10, 6)\n  }\n\n\n  hidePauseMenu() {\n    const layer = this.scene.children.list.find(el => el.name === 'layer_pause_nenu')\n    if (layer) {\n      layer.setVisible(false)\n    }\n    \n    this.scene.children.list.filter(el => el.name === 'menu_text').forEach(el => el.destroy())\n    this.scene.children.list.filter(el => el.name.includes('_tn_to_remove')).forEach(el => el.destroy())\n    \n  }\n\n  drawScores() {\n    // Creating a blank tilemap with dimensions matching the dungeon\n    const map = this.scene.make.tilemap({ tileWidth: 20, tileHeight: 20, width: 20, height: 20 });\n    // addTilesetImage: function (tilesetName, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid)\n    map.addTilesetImage('hud-tiles', 'hud-tiles', 20, 20, 1, 2);\n    \n    \n    let scoreTileset = map.addTilesetImage('hud-tiles', 'hud-tiles', 20, 20, 1, 2);\n\n    let scoresLayer = map.createBlankLayer('layer_scores', scoreTileset);\n    scoresLayer.name = 'layer_scores'\n    scoresLayer.depth = 5\n    scoresLayer.setScrollFactor(0)\n    \n    scoresLayer.setScale(SCALE)\n    // LEFT\n    map.putTileAt(3, 0, 0)\n    map.putTileAt(4, 1, 0)\n    map.putTileAt(5, 2, 0)\n\n    map.putTileAt(14, 0, 1)\n    map.putTileAt(15, 1, 1)\n    map.putTileAt(16, 2, 1)\n\n    // MIDDLE\n    // map.putTileAt(3, 7, 0)\n    // map.putTileAt(4, 8, 0)\n    // map.putTileAt(4, 9, 0)\n    // map.putTileAt(4, 10, 0)\n    // map.putTileAt(4, 11, 0)\n    // map.putTileAt(5, 12, 0)\n\n    // map.putTileAt(14, 7, 1)\n    // map.putTileAt(15, 8, 1)\n    // map.putTileAt(15, 9, 1)\n    // map.putTileAt(15, 10, 1)\n    // map.putTileAt(15, 11, 1)\n    // map.putTileAt(16, 12, 1)\n\n    // RIGHT\n    map.putTileAt(3, 17, 0)\n    map.putTileAt(4, 18, 0)\n    map.putTileAt(5, 19, 0)\n\n    map.putTileAt(14, 17, 1)\n    map.putTileAt(15, 18, 1)\n    map.putTileAt(16, 19, 1)\n\n    this.pickaxeScore = window.localStorage.getItem('pickaxe')\n    const s = this.scene.add.sprite(\n      map.tileToWorldX(9) + 10 * SCALE,\n      map.tileToWorldY(0) + 10 * SCALE,\n    ).play('closeUp_Pickaxe').setOrigin(0.1, 0.15).setScale(SCALE)\n    s.depth = 6\n    s.setScrollFactor(0)\n    s.setVisible(this.pickaxeScore === 'true')\n    \n\n    // const s1 = this.scene.add.sprite(\n    //   map.tileToWorldX(9) + 10 * SCALE,\n    //   map.tileToWorldY(0) + 10 * SCALE,\n    // ).play('closeUp_Mushroom').setOrigin(0.1, 0.15).setScale(SCALE)\n    // s1.depth = 6\n    // s1.setScrollFactor(0)\n\n    const msh = this.scene.add.sprite(\n      map.tileToWorldX(17) + 3 * SCALE * 1.5,\n      map.tileToWorldY(0) + 5 * SCALE,\n    ).play('closeUp_Mushroom').setOrigin(0.1, 0.15).setScale(SCALE * 1.5)\n    msh.depth = 6\n    msh.setScrollFactor(0)\n    \n    const shroomsAmount = window.localStorage.getItem('shrooms') || '0'\n    this.mushroomsScore = this.scene.add.text(\n      (map.tileToWorldX(19) + 3 * SCALE * 1.5) - shroomsAmount.length * 10 * SCALE + 8 * SCALE,\n      map.tileToWorldY(1),\n      shroomsAmount,\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"90px\",\n        fill: \"#ffffff\",\n        align: 'right'\n      }\n    )\n    this.mushroomsScore.displayHeight = 10 * SCALE\n    this.mushroomsScore.displayWidth = shroomsAmount.length * 10 * SCALE\n    this.mushroomsScore.name = 'score_text_to_remove'\n    this.mushroomsScore.depth = 6\n    this.mushroomsScore.setScrollFactor(0)\n\n    const diamond = this.scene.add.sprite(\n      map.tileToWorldX(0) + 3 * SCALE * 1.5,\n      map.tileToWorldY(0) + 5 * SCALE,\n    ).play('closeUp_Diamond').setOrigin(0.1, 0.15).setScale(SCALE * 1.5)\n    diamond.depth = 6\n    diamond.setScrollFactor(0)\n\n    const diamondsAmount = window.localStorage.getItem('diamonds') || '0'\n    this.diamondsScore = this.scene.add.text(\n      (map.tileToWorldX(2) + 3 * SCALE * 1.5) - diamondsAmount.length * 10 * SCALE + 8 * SCALE,\n      map.tileToWorldY(1),\n      diamondsAmount,\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"90px\",\n        fill: \"#ffffff\",\n        align: 'right'\n      }\n    )\n    this.diamondsScore.displayHeight = 10 * SCALE\n    this.diamondsScore.displayWidth = diamondsAmount.length * 10 * SCALE\n    this.diamondsScore.name = 'score_text_to_remove'\n    this.diamondsScore.depth = 6\n    this.diamondsScore.setScrollFactor(0)\n\n    this.scene.events.on('score:mushroom_collected', () => {\n      const map = this.scene.children.getByName('layer_scores').tilemap\n      const amount = Number(window.localStorage.getItem('shrooms') || 0) + 1\n      window.localStorage.setItem('shrooms', amount)\n      this.mushroomsScore.setText(amount)\n      // this.mushroomsScore.setPosition(\n      //   (map.tileToWorldX(19) + 3 * SCALE * 1.5) - String(amount).length * 10 * SCALE + 8 * SCALE,\n      //   map.tileToWorldY(1),\n      // )\n    })\n    window.scene = this.scene\n    this.scene.events.on('score:diamond_collected', () => {\n      const map = this.scene.children.getByName('layer_scores').tilemap\n      const amount = Number(window.localStorage.getItem('diamonds') || 0) + 1\n      window.localStorage.setItem('diamonds', amount)\n      this.diamondsScore.setText(amount)\n      // this.diamondsScore.setPosition(\n      //   (map.tileToWorldX(2) + 3 * SCALE * 1.5) - String(amount).length * 10 * SCALE + 8 * SCALE,\n      //   map.tileToWorldY(1),\n      // )\n    })\n  }\n\n  drawMenuOptions(map) {\n    let currentOption = 0\n\n    const arrow = this.scene.add.graphics({ fillStyle: { color: 0xffffff, alpha: 1 } })\n    arrow.fillTriangle(0, 1, 5, 6, 0, 11).setPosition(\n      map.tileToWorldX(4) - 10 * SCALE,\n      map.tileToWorldY(1)\n    )\n    arrow.setScale(SCALE)\n    arrow.depth = 16\n    arrow.name = 'menu_text'\n    \n    const menuOptions = [{\n      label: 'Restart level',\n      disabled: false,\n      onSelect: () => this.scene.levels.restart()\n    }, {\n      label: 'Exit to menu',\n      disabled: false,\n      onSelect: () => this.scene.scene.start('MenuScene')\n    }]\n    menuOptions.forEach((opt, row) => {\n      opt.label.split('').forEach((ch, idx) => {\n        const textObj = this.scene.add.text(\n          map.tileToWorldX(4 + idx) - (idx * 10 * SCALE),\n          map.tileToWorldY(1 + row),// - (row * 8 * SCALE) - 5 * SCALE,\n          ch,\n          {\n            fontFamily: 'GameGirl',\n            fontSize: \"90px\",\n            fill: \"#ffffff\",\n          })\n          textObj.displayHeight = 10 * SCALE\n          textObj.displayWidth = 10 * SCALE\n          textObj.depth = 16\n          textObj.name = 'menu_text'\n        })\n      })\n\n    const handleKeyDown = event => {\n      let newOption = false\n      if (event.key === 'ArrowUp') {\n        newOption = currentOption > 0 ? currentOption - 1 : menuOptions.length - 1\n      }\n      if (event.key === 'ArrowDown') {\n        newOption = currentOption < menuOptions.length - 1 ? currentOption + 1 : 0\n      }\n      if(newOption !== false) {\n        arrow.setPosition(\n          map.tileToWorldX(4) - 10 * SCALE,\n          map.tileToWorldY(newOption + 1)\n        )\n        currentOption = newOption\n      }\n      if (event.key === 'Enter') {\n        if(!menuOptions[currentOption].disabled) {\n          this.hidePauseMenu()\n          if(this.scene.levels.current.isPaused) {\n            menuOptions[currentOption].onSelect()\n          }\n        }\n      } else {\n        this.scene.input.keyboard.once('keydown', handleKeyDown)\n      }\n    }\n    this.scene.input.keyboard.once('keydown', handleKeyDown)\n  }\n  showPauseMenu() {\n    const existingLayer = this.scene.children.list.find(el => el.name === 'layer_pause_nenu')\n    if (existingLayer) {\n      existingLayer.setVisible(true)\n      this.drawMenuOptions(existingLayer.tilemap)\n      return true\n    }\n    \n    // Creating a blank tilemap with dimensions matching the dungeon\n    const map = this.scene.make.tilemap({ tileWidth: 20, tileHeight: 20, width: 20, height: 20 });\n    // addTilesetImage: function (tilesetName, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid)\n    let tileset = map.addTilesetImage('hud-tiles', 'hud-tiles', 20, 20, 1, 2);\n\n    let layer = map.createBlankLayer('layer_pause_nenu', tileset);\n    layer.name = 'layer_pause_nenu'\n    layer.depth = 15\n    layer.setScrollFactor(0)\n\n    layer.setScale(SCALE)\n\n    // DIALOG AREA\n    map.putTileAt(0, 3, 0)\n    map.putTileAt(1, 4, 0)\n    map.putTileAt(1, 5, 0)\n    map.putTileAt(1, 6, 0)\n    map.putTileAt(1, 7, 0)\n    map.putTileAt(1, 8, 0)\n    map.putTileAt(1, 9, 0)\n    map.putTileAt(1, 10, 0)\n    map.putTileAt(1, 11, 0)\n    map.putTileAt(1, 12, 0)\n    map.putTileAt(1, 13, 0)\n    map.putTileAt(1, 14, 0)\n    map.putTileAt(1, 15, 0)\n    map.putTileAt(2, 16, 0)\n\n    map.putTileAt(11, 3, 1)\n    map.putTileAt(12, 4, 1)\n    map.putTileAt(12, 5, 1)\n    map.putTileAt(12, 6, 1)\n    map.putTileAt(12, 7, 1)\n    map.putTileAt(12, 8, 1)\n    map.putTileAt(12, 9, 1)\n    map.putTileAt(12, 10, 1)\n    map.putTileAt(12, 11, 1)\n    map.putTileAt(12, 12, 1)\n    map.putTileAt(12, 13, 1)\n    map.putTileAt(12, 14, 1)\n    map.putTileAt(12, 15, 1)\n    map.putTileAt(13, 16, 1)\n\n    map.putTileAt(11, 3, 2)\n    map.putTileAt(12, 4, 2)\n    map.putTileAt(12, 5, 2)\n    map.putTileAt(12, 6, 2)\n    map.putTileAt(12, 7, 2)\n    map.putTileAt(12, 8, 2)\n    map.putTileAt(12, 9, 2)\n    map.putTileAt(12, 10, 2)\n    map.putTileAt(12, 11, 2)\n    map.putTileAt(12, 12, 2)\n    map.putTileAt(12, 13, 2)\n    map.putTileAt(12, 14, 2)\n    map.putTileAt(12, 15, 2)\n    map.putTileAt(13, 16, 2)\n\n    map.putTileAt(11, 3, 3)\n    map.putTileAt(12, 4, 3)\n    map.putTileAt(12, 5, 3)\n    map.putTileAt(12, 6, 3)\n    map.putTileAt(12, 7, 3)\n    map.putTileAt(12, 8, 3)\n    map.putTileAt(12, 9, 3)\n    map.putTileAt(12, 10, 3)\n    map.putTileAt(12, 11, 3)\n    map.putTileAt(12, 12, 3)\n    map.putTileAt(12, 13, 3)\n    map.putTileAt(12, 14, 3)\n    map.putTileAt(12, 15, 3)\n    map.putTileAt(13, 16, 3)\n\n    map.putTileAt(11, 3, 4)\n    map.putTileAt(12, 4, 4)\n    map.putTileAt(12, 5, 4)\n    map.putTileAt(12, 6, 4)\n    map.putTileAt(12, 7, 4)\n    map.putTileAt(12, 8, 4)\n    map.putTileAt(12, 9, 4)\n    map.putTileAt(12, 10, 4)\n    map.putTileAt(12, 11, 4)\n    map.putTileAt(12, 12, 4)\n    map.putTileAt(12, 13, 4)\n    map.putTileAt(12, 14, 4)\n    map.putTileAt(12, 15, 4)\n    map.putTileAt(13, 16, 4)\n\n    map.putTileAt(11, 3, 5)\n    map.putTileAt(12, 4, 5)\n    map.putTileAt(12, 5, 5)\n    map.putTileAt(12, 6, 5)\n    map.putTileAt(12, 7, 5)\n    map.putTileAt(12, 8, 5)\n    map.putTileAt(12, 9, 5)\n    map.putTileAt(12, 10, 5)\n    map.putTileAt(12, 11, 5)\n    map.putTileAt(12, 12, 5)\n    map.putTileAt(12, 13, 5)\n    map.putTileAt(12, 14, 5)\n    map.putTileAt(12, 15, 5)\n    map.putTileAt(13, 16, 5)\n\n    map.putTileAt(22, 3, 6)\n    map.putTileAt(23, 4, 6)\n    map.putTileAt(23, 5, 6)\n    map.putTileAt(23, 6, 6)\n    map.putTileAt(23, 7, 6)\n    map.putTileAt(23, 8, 6)\n    map.putTileAt(23, 9, 6)\n    map.putTileAt(23, 10, 6)\n    map.putTileAt(23, 11, 6)\n    map.putTileAt(23, 12, 6)\n    map.putTileAt(23, 13, 6)\n    map.putTileAt(23, 14, 6)\n    map.putTileAt(23, 15, 6)\n    map.putTileAt(24, 16, 6)\n    \n    this.drawMenuOptions(map)\n  }\n}","import { useState, createContext, useEffect } from 'react'\n\nexport const context = createContext()\n\nconst PhaserProvider = ({ game, children }) => {\n  const [ready, setReady] = useState()\n  \n  // delay to let the context value to propagate before rendering children.\n  // this way children can implement usePhaser confident that objects returned are not null\n  useEffect(() => {\n    setReady(!!game)\n  }, [game])\n\n  return (\n    <context.Provider value={{ game }}>\n      {\n        ready ? children : null\n      }\n    </context.Provider>\n  )\n}\n\nexport default PhaserProvider\n","import Phaser from 'phaser'\nimport { useEffect, forwardRef, useRef, useState } from 'react'\nimport PhaserProvider from '../PhaserProvider'\n\n/**\n * Creates a new Phaser.Game with given arguments.\n * triggers functions to store game into context\n */\nconst Canvas = forwardRef(({\n  args,\n  children\n}, canvasRef) => {\n  const fallbackRef = useRef()\n  const ref = canvasRef || fallbackRef\n  const [game, setGame] = useState()\n  const [ready, setReady] = useState()\n  args.callbacks = { postBoot: game => {\n    setGame(game)\n    game.scene.scenes[0].events.once(Phaser.Scenes.Events.PRE_RENDER, s => {\n      game.scene.scenes[0].load.on(Phaser.Loader.Events.COMPLETE, () => setReady(true))\n      \n    })\n  }}\n  useEffect(() => {\n\n    const game = new Phaser.Game(args)\n    ref.current = game\n    \n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n  return ready ? <PhaserProvider game={game}>{children}</PhaserProvider> : null\n})\n\nexport default Canvas\n","export const TICK_TIME = 250\nexport const PLAYER_TICK_TIME = TICK_TIME - 25\nexport const TILE_SIZE = 20\nexport const TILES_BY_SCREEN = 20\n\nexport const SCALE = Math.round((window.innerWidth/TILES_BY_SCREEN * 100 / TILE_SIZE/100)*100)/100\n\nexport const PIXEL_NAME = {\n  EMPTY: '000000',\n  PLAYER: 'ff00ff',\n  GROUND: '663300',\n  BOULDER: '999999',\n  WALL: '0000ff',\n  ENEMY: 'ff0000',\n  JEWEL: 'ffff00',\n  BARREL: '00ffff',\n  EXPLOSION: 'ffffff',\n  INTERACTION: '00ff00',\n  MUSHROOM: '9900ff'\n}\n\nexport const DIRS = {\n  DOWN: 'ArrowDown',\n  UP: 'ArrowUp',\n  LEFT: 'ArrowLeft',\n  RIGHT: 'ArrowRight',\n}\n\nexport const PIXEL_TO_TILEMAP_POSITION = {\n  [PIXEL_NAME.EMPTY]: 0,\n  [PIXEL_NAME.WALL]: 1,\n  [PIXEL_NAME.GROUND]: 2,\n  calculateWallTileWithNeighbours: (x, y, data) => {\n    const W = (data[x]||[])[y-1] === PIXEL_NAME.WALL ? 'W' : '-'\n    const N = (data[x-1]||[])[y] === PIXEL_NAME.WALL ? 'N' : '-'\n    const E = (data[x]||[])[y+1] === PIXEL_NAME.WALL ? 'E' : '-'\n    const S = (data[x+1]||[])[y] === PIXEL_NAME.WALL ? 'S' : '-'\n    switch(`${N}${E}${S}${W}`) {\n      case '----':\n        default:\n        return 11\n      case 'NESW':\n        return 12\n      case 'N---':\n        return 13\n      case '-E--':\n        return 14\n      case '--S-':\n        return 15\n      case '---W':\n        return 16\n      case 'NE--':\n        return 17\n      case '-ES-':\n        return 18\n      case '--SW':\n        return 19\n      case 'N--W':\n        return 20\n      case 'NES-':\n        return 22\n      case '-ESW':\n        return 23\n      case 'N-SW':\n        return 24\n      case 'NE-W':\n        return 25\n      case 'N-S-':\n        return 27\n      case '-E-W':\n        return 26\n    }\n  }\n}","import Phaser from \"phaser\";\nconst fragShader = `\n#define SHADER_NAME BLUR_FS\n\nprecision mediump float;\n\n//\"in\" attributes from our vertex shader\nvarying vec2 outTexCoord;\n\n//declare uniforms\nuniform sampler2D uMainSampler;\nuniform float uResolution;\nuniform float radius;\nuniform vec2 dir;\n\nvoid main()\n{\n    //this will be our RGBA sum\n    vec4 sum = vec4(0.0);\n\n    //our original texcoord for this fragment\n    vec2 tc = outTexCoord;\n\n    //the amount to blur, i.e. how far off center to sample from\n    //1.0 -> blur by one pixel\n    //2.0 -> blur by two pixels, etc.\n    float blur = radius/uResolution;\n\n    //the direction of our blur\n    //(1.0, 0.0) -> x-axis blur\n    //(0.0, 1.0) -> y-axis blur\n    float hstep = dir.x;\n    float vstep = dir.y;\n\n    //apply blurring, using a 9-tap filter with predefined gaussian weights\",\n\n    sum += texture2D(uMainSampler, vec2(tc.x - 4.0*blur*hstep, tc.y - 4.0*blur*vstep)) * 0.0162162162;\n    sum += texture2D(uMainSampler, vec2(tc.x - 3.0*blur*hstep, tc.y - 3.0*blur*vstep)) * 0.0540540541;\n    sum += texture2D(uMainSampler, vec2(tc.x - 2.0*blur*hstep, tc.y - 2.0*blur*vstep)) * 0.1216216216;\n    sum += texture2D(uMainSampler, vec2(tc.x - 1.0*blur*hstep, tc.y - 1.0*blur*vstep)) * 0.1945945946;\n\n    sum += texture2D(uMainSampler, vec2(tc.x, tc.y)) * 0.2270270270;\n\n    sum += texture2D(uMainSampler, vec2(tc.x + 1.0*blur*hstep, tc.y + 1.0*blur*vstep)) * 0.1945945946;\n    sum += texture2D(uMainSampler, vec2(tc.x + 2.0*blur*hstep, tc.y + 2.0*blur*vstep)) * 0.1216216216;\n    sum += texture2D(uMainSampler, vec2(tc.x + 3.0*blur*hstep, tc.y + 3.0*blur*vstep)) * 0.0540540541;\n    sum += texture2D(uMainSampler, vec2(tc.x + 4.0*blur*hstep, tc.y + 4.0*blur*vstep)) * 0.0162162162;\n\n    //discard alpha for our simple demo,return\n    gl_FragColor =  vec4(sum.rgb, 1.0);\n}\n`;\n\nconst fragCRTShader = `\n  #ifdef GL_ES\n      precision highp float;\n  #endif\n\n  #define PI 3.1415926538\n\n  // Samplers\n  varying vec2 outTexCoord;\n  uniform sampler2D uMainSampler;\n\n  // Parameters\n  uniform vec2 curvature;\n  uniform vec2 screenResolution;\n  uniform vec2 scanLineOpacity;\n  uniform float vignetteOpacity;\n  uniform float brightness;\n  uniform float vignetteRoundness;\n\n\n  vec2 curveRemapUV(vec2 uv)\n  {\n      // as we near the edge of our screen apply greater distortion using a sinusoid.\n\n      uv = uv * 2.0 - 1.0;\n  vec2 offset = abs(uv.yx) / vec2(curvature.x, curvature.y);\n  uv = uv + uv * offset * offset;\n  uv = uv * 0.5 + 0.5;\n      return uv;\n  }\n\n  vec4 scanLineIntensity(float uv, float resolution, float opacity)\n  {\n      float intensity = sin(uv * resolution * PI * 2.0);\n      intensity = ((0.5 * intensity) + 0.5) * 0.9 + 0.1;\n      return vec4(vec3(pow(intensity, opacity)), 1.0);\n  }\n\n  vec4 vignetteIntensity(vec2 uv, vec2 resolution, float opacity, float roundness)\n  {\n      float intensity = uv.x * uv.y * (1.0 - uv.x) * (1.0 - uv.y);\n      return vec4(vec3(clamp(pow((resolution.x / roundness) * intensity, opacity), 0.0, 1.0)), 1.0);\n  }\n\n  void main(void) \n  {\n      vec2 remappedUV = curveRemapUV(vec2(outTexCoord.x, outTexCoord.y));\n      vec4 baseColor = texture2D(uMainSampler, remappedUV);\n\n      baseColor *= vignetteIntensity(remappedUV, screenResolution, vignetteOpacity, vignetteRoundness);\n\n      baseColor *= scanLineIntensity(remappedUV.x, screenResolution.y, scanLineOpacity.x);\n      baseColor *= scanLineIntensity(remappedUV.y, screenResolution.x, scanLineOpacity.y);\n\n      baseColor *= vec4(vec3(brightness), 1.0);\n\n      if (remappedUV.x < 0.0 || remappedUV.y < 0.0 || remappedUV.x > 1.0 || remappedUV.y > 1.0){\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      } else {\n          gl_FragColor = baseColor;\n      }\n  }\n`;\n\nexport default class BlurPostFX extends Phaser.Renderer.WebGL.Pipelines.PostFXPipeline\n{\n    constructor (game)\n    {\n        super({\n            game,\n            renderTarget: true,\n            fragShader: fragCRTShader,\n            // uniforms: [\n            //     'uProjectionMatrix',\n            //     'uMainSampler',\n            //     'uResolution',\n            //     'radius',\n            //     'dir'\n            // ]\n            uniforms: [\n                // 'uProjectionMatrix',\n                'uMainSampler',\n                'curvature',\n                'screenResolution',\n                'scanLineOpacity',\n                'vignetteOpacity',\n                'brightness',\n                'vignetteRoundness',\n            ]\n        });\n        this.set2f(\"curvature\", 6.0, 6.0);\n        this.set2f(\"screenResolution\", 320, 240);\n        this.set2f(\"scanLineOpacity\", 0.5, 0.5);\n        this.set1f(\"vignetteOpacity\", 0.5);\n        this.set1f(\"vignetteRoundness\", 1.0)\n        this.set1f(\"brightness\", 1.5);\n    }\n\n    onPreRender () \n    {\n        // const r = Math.abs(2 * Math.sin(this.game.loop.time * 10))\n        // this.set1f('uResolution', this.renderer.width);\n        // this.set1f('radius', r);\n        // this.set2f('dir', 1.0, 1.0);\n\n    }\n}","import Phaser from 'phaser'\nimport { SCALE, TILES_BY_SCREEN, TILE_SIZE } from '../utils/constants'\nimport CRTFilter from '../utils/CRTShaderFX'\nimport UI from '../components/UI'\n\nexport default class IntroScene extends Phaser.Scene {\n  constructor () {\n    super('IntroScene');\n  }\n  \n  preload () {\n    window.localStorage.setItem('diamonds', 0)\n    window.localStorage.setItem('shrooms', 0)\n    window.localStorage.setItem('level_1', 'false')\n    window.localStorage.setItem('level_2', 'false')\n    window.localStorage.setItem('level_3', 'false')\n    window.localStorage.setItem('level_4', 'false')\n    window.localStorage.setItem('level_5', 'false')\n    window.localStorage.setItem('level_6', 'false')\n  }\n\n  createAnimations() {\n    this.anims.create({\n      key: 'closeUp_Mary',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 0 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Marduk',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 1 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Dwarf',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 2 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Tiamat',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 3 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Pickaxe',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 4 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Mushroom',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 5 ] }),\n      repeat: 0,\n    })\n  }\n  create() {\n    this.createAnimations()\n    this.normalDayMusic = this.sound.add('opening_peace', { loop: true })\n    this.normalDayMusic.play();\n    this.quakesMusic = this.sound.add('opening_quakes', { loop: true });\n\n    const ui = new UI(this, true)\n\n    this.cameras.main.setPostPipeline(CRTFilter);\n    let image = this.add.image(this.cameras.main.width / 2, this.cameras.main.height / 2, 'Prologue')\n    let scaleX = this.cameras.main.width / image.width\n    let scaleY = this.cameras.main.height / image.height\n    let scale = Math.max(scaleX, scaleY)\n    image.setScale(scale * 1.5).setScrollFactor(0)\n    image.name = 'background_art'\n\n    this.tweens.add({\n      targets: image,\n      scale: scale,\n      duration: 10000,\n      ease: 'Linear'\n    })\n    const line1 = this.add.text(80, 10, \"\",\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"10px\",\n        fill: \"#ffffff\",\n      }\n    ).setScale(scaleX * 0.9).setPosition(2 * scaleX, this.cameras.main.height - 10 * 4 * scaleY)\n    line1.displayHeight = 10 * scaleY\n    const line2 = this.add.text(80, 10, \"\",\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"10px\",\n        fill: \"#ffffff\",\n      }\n    ).setScale(scaleX * 0.9).setPosition(2 * scaleX, this.cameras.main.height - 10 * 3 * scaleY)\n    line2.displayHeight = 10 * scaleY\n    const line3 = this.add.text(80, 10, \"\",\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"10px\",\n        fill: \"#ffffff\",\n      }\n    ).setScale(scaleX * 0.9).setPosition(2 * scaleX, this.cameras.main.height - 10 * 2 * scaleY)\n    line3.displayHeight = 10 * scaleY\n\n    line1.alpha = line2.alpha = line3.alpha = 0\n    \n    line1.setText('In the beginning: There was nothing,')\n    line2.setText('except for the goddess tiamat')\n    \n    this.tweens.add({\n      targets: [line1, line2, line3],\n      alpha: 1,\n      duration: 1000\n    })\n\n    setTimeout(() => {\n      this.tweens.add({\n        targets: [line1, line2, line3],\n        alpha: 0,\n        duration: 1000,\n        onComplete: () =>  {\n          line1.setText('she formed the world as she pleased')\n          line2.setText('Giving life to the sumarian people,')\n          line3.setText('creating them in her image')\n\n          this.tweens.add({\n            targets: [line1, line2, line3],\n            alpha: 1,\n            duration: 1000\n          })\n        }\n      })\n      \n    }, 8000);\n\n    setTimeout(() => {\n      this.tweens.add({\n        targets: [line1, line2, line3],\n        alpha: 0,\n        duration: 1000,\n        onComplete: () =>  {\n          line1.setText('The ancient land of Sumaria. An')\n          line2.setText('eternal paradise where immortal')\n          line3.setText('beings live in infinite harmony')\n\n          this.tweens.add({\n            targets: [line1, line2, line3],\n            alpha: 1,\n            duration: 1000,\n            onComplete: () => {\n              setTimeout(() => {\n                this.tweens.add({\n                  targets: [line1, line2, line3],\n                  alpha: 0,\n                  duration: 1000,\n                  onComplete: () => {\n                    this.showFirstDialogs()\n                  }\n                })\n              }, 8000);\n            }\n          })\n        }\n      })\n      \n    }, 8000 * 2);\n    // this.showFirstDialogs()\n    // this.showSecondDialogs()\n  }\n\n  showFirstDialogs() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => false,\n        resume: () => {\n          setTimeout(() => {\n            this.showSecondDialogs()\n          }, 1000);\n        }\n      }\n    }\n    this.events.emit('dialogue:show', {\n      participants: ['closeUp_Mary', 'closeUp_Tiamat', 'closeUp_Marduk'],\n      conversation: [\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n            \"My beloved: why do you\",\n            \"call for me?\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"Our lord. A mysterious\",\n            \"comet dashes across the\",\n            \"sky. Our land has been\",\n            \"ravaged by monstrous\",\n            \"quakes, mysterious holes\",\n            \"have been appearing,\",\n            \"those who fall in never\",\n            \"return. Please my lady,\",\n            \"calm the earth. Let us\",\n            \"rest in peace.\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n            \"The Catalyst Comet.\",\n            \"C/1995 O1 It appears once\",\n            \"every 2,533 years. I do\",\n            \"not control its path.\",\n            \"With it’s coming.\",\n            \"Calamity Strikes.\"\n          ]\n        },{\n          who: 'closeUp_Mary',\n          text: [\n            \"We, your children, beseech\",\n            \"thee. Guide us towards a\",\n            \"resolution that might save\",\n            \"our people.\"\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n            \"The Guardian ventures\",\n            \"within the holes created\",\n            \"in the earth. You must\",\n            \"discover the purpose of\",\n            \"these mushrooms that now\",\n            \"proliferate the land.\",\n            \"Collect them and deliver\",\n            \"them to me at the core of\",\n            \"the planet.\"\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n            \"Perhaps within these\",\n            \"mysterious objects lies a\",\n            \"solution to the terrors of\",\n            \"The Catalyst Comet.\"\n          ]\n        }\n      ]\n    })\n    \n  }\n\n  showSecondDialogs() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => false,\n        resume: () => {\n          this.tweens.add({\n            targets: this.children.getByName('background_art'),\n            alpha: 0,\n            duration: 1000\n          })\n          this.tweens.add({\n            targets: this.normalDayMusic,\n            volume: 0,\n            duration: 500,\n            onComplete: () => {\n              this.normalDayMusic.stop()\n              this.quakesMusic.play()\n              setTimeout(() => {\n                this.showThirdDialogs()\n              }, 1000);\n            }\n          })\n        }\n      }\n    }\n    this.events.emit('dialogue:show', {\n      participants: ['closeUp_Mary', 'closeUp_Marduk'],\n      conversation: [\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"-Sigh-\",\n            \"It is a man's duty\",\n            \"I suppose.\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"Then I shall\",\n            \"accompany you:\",\n            \"There is safety\",\n            \"in numbers.\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"Nonsense. How would a\",\n            \"frail priestess be of\",\n            \"any benefit? \",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"I am not frail. I am\",\n            \"actually well versed in\",\n            \"digging. The maintenance\",\n            \"of the church keeps my\",\n            \"mind and body active,\",\n            \"I am frequently required\",\n            \"to lift heavy objects and\",\n            \"despite my size have\",\n            \"no problems doing so.\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"I am a man, to endanger a\",\n            \"woman's life by accepting\",\n            \"her aid in such a perilous\",\n            \"task would disgrace me.\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"Why must you always be\",\n            \"like this Marduk? I\",\n            \"remember when we used to\",\n            \"play in the garden as\",\n            \"children. You haven’t\",\n            \"always been this stubborn\",\n            \"and aggressive. I know the\",\n            \"current state of the world\",\n            \"has us all in a panic.\"\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"But come to your senses.\",\n            \"Let me help you. There\",\n            \"are greater things at\",\n            \"stake than your pride.\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"I don't need your help.\",\n          ]\n        },\n      ]\n    })\n  }\n\n  showThirdDialogs() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => false,\n        resume: () => {\n          this.tweens.add({\n            targets: this.quakesMusic,\n            volume: 0,\n            duration: 500,\n          })\n          setTimeout(() => {\n            this.scene.start('GameScene', { level: 1 })\n          }, 1000);\n        }\n      }\n    }\n\n    this.events.emit('dialogue:show', {\n      participants: [],\n      conversation: [\n        {\n          who: '',\n          text: [\n            \"- A fissure opens up\",\n            \"beneath Marduk and he\",\n            \"falls into\",\n          ]\n        },\n        {\n          who: '',\n          text: [\n            \"- Mary rolls her eyes\",\n            \"and jumps in after\",\n          ]\n        },\n      ]\n    })\n  }\n  animateIntro() {\n\n    this.cameras.main.pan(this.renderer.width, this.renderer.height/2, 2000, 'Sine.easeInOut');\n    this.cameras.main.once(Phaser.Cameras.Scene2D.Events.PAN_COMPLETE, () => {\n      this.cameras.main.shake(2000, 0.02)\n      this.tweens.add({\n        targets: this.children.getByName('dark'),\n        y: -this.renderer.height * 0.3,\n        duration: 2000\n      })\n      this.tweens.add({\n        targets: this.children.getByName('partner'),\n        y: this.renderer.height,\n        delay: 2000,\n        duration: 2000,\n        ease: 'Sine.in'\n      })\n      this.tweens.add({\n        targets: this.children.getByName('player'),\n        y: this.renderer.height,\n        x: {\n          value: this.children.getByName('player').x + 150,\n          duration: 1000,\n          ease: 'Cubic.easeOut',\n        },\n        delay: 4000,\n        duration: 2000,\n        ease: 'Back.easeInOut',\n        onComplete: () => {\n          this.cameras.main.fade(1000, 0, 0, 0)\n          this.cameras.main.once('camerafadeoutcomplete', () => void this.scene.start('GameScene', { level: 1}))\n        }\n      })\n\n    })\n  }\n}\n","export default class GameObject {\n  constructor({ id, isRigid, isBreakable, isFlat, isPickable, isCrushable, level }) {\n    this.id = id\n    // can't be moved nor affected by gravity\n    // wall, ground\n    this.isRigid = isRigid\n\n    // destroyable under circumstances like explosions\n    // ground, boulder, diamond\n    this.isBreakable = isBreakable\n\n    // rounded objects (like boulders and diamonds) above remain still\n    // character, ground, wall\n    this.isFlat = isFlat\n\n    // can be collected by characters\n    // diamond\n    this.isPickable = isPickable\n\n    // crush under pression\n    // character, enemies, dynamite, barrel\n    this.isCrushable = isCrushable\n\n    // energy to break things\n    this.power = 0\n\n    // how resistant to brake it is\n    this.strength = 0\n\n    // how hard can push\n    this.force = 0\n\n    // how much force can resist before move\n    this.weight = 0\n\n    this.level = level\n\n    this.position = null\n    this.alien = null\n    this.isMoveable = !this.isRigid\n  }\n\n  setPosition(coords) {\n    this.position = coords\n  }\n\n  canMove() {\n    return this.isMoveable\n  }\n  overrunBy(){}\n  runningOver(){}\n  canFallDown() { return false }\n  canFallLeft() { return false }\n  canFallRight() { return false }\n  \n}\n\nGameObject.className = 'GameObject'\n","import GameObject from './GameObject'\n\nexport default class Destroyable extends GameObject {\n  constructor(props) {\n    super(props)\n    this.inactive = false\n  }\n  overrunBy(el) {\n    if(el.power > this.strength) {\n      this.level.onDestroyElement(this)\n      this.inactive = true\n    }\n  }\n}\n\nDestroyable.className = 'Destroyable'\n","import Destroyable from './Destroyable'\n\nexport default class Moveable extends Destroyable {\n  move({ x, y }) {\n    super.setPosition({ x, y})\n    // this.isMoving = false\n  }\n}\n\nMoveable.className = 'Moveable'\n","import Moveable from './Moveable'\n\nexport default class Fallable extends Moveable {\n  constructor(props) {\n    super(props)\n    this.isFalling = 0 // increment on each loop that the element is falling\n  }\n\n  canFallDown() {\n    const nextPos = { x: this.position.x, y: this.position.y + 1 }\n    const destinationInBounds = this.level.isDestinationInBounds(nextPos.x, nextPos.y)\n    const destinationElement = destinationInBounds && this.level.getObjectAt(nextPos.x, nextPos.y)\n    const destinationIsEmpty = this.level.isDestinationEmpty(nextPos.x, nextPos.y)\n    const destinationIsCrushable = destinationElement.isCrushable && this.isFalling\n    const canFall = destinationIsEmpty || destinationIsCrushable\n\n    return canFall\n  }\n  canRollTo(x, y) {\n    const nextPos = { x, y }\n    const destinationInBounds = this.level.isDestinationInBounds(nextPos.x, nextPos.y)\n    const pathElement = destinationInBounds && this.level.getObjectAt(nextPos.x, this.position.y)\n    const pathClear = destinationInBounds && this.level.objectIsEmpty(pathElement)\n    const destinationElement = destinationInBounds && this.level.getObjectAt(nextPos.x, nextPos.y)\n    const destinationIsEmpty = this.level.objectIsEmpty(destinationElement)\n    const restingElement = destinationInBounds && this.level.getObjectAt(this.position.x, this.position.y + 1)\n    const canRest = !this.level.isDestinationEmpty(this.position.x, this.position.y + 1) && restingElement.isFlat\n    const canRoll = destinationInBounds && destinationIsEmpty && pathClear && !canRest && restingElement && !restingElement.isFalling\n    \n    return canRoll\n  }\n  canFallRight() {\n    return !this.canFallDown() && this.canRollTo(this.position.x + 1, this.position.y + 1)\n  }\n  canFallLeft() {\n    return !this.canFallDown() && this.canRollTo(this.position.x - 1, this.position.y + 1)\n  }\n}\n\nFallable.className = 'Fallable'\n","import Fallable from './Fallable'\n\nexport default class Boulder extends Fallable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: false,\n      isPickable: false,\n      isCrushable: false,\n      level\n    })\n    this.strength = 5\n  }\n}\nBoulder.className = 'Boulder'\n","import Moveable from './Moveable'\nimport { DIRS } from '../../utils/constants'\n\nexport default class Character extends Moveable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: true,\n      level\n    })\n    this.pushingDirection = null\n  }\n  \n  canMove(x, y) {\n    const neighbour = this.level.getObjectAt(x, y)\n    const emptyPlace = this.level.objectIsEmpty(neighbour)\n    const canBrakeNeighbour = neighbour?.isBreakable && this.power >= neighbour.strength\n    return emptyPlace || canBrakeNeighbour || neighbour.isPickable ? neighbour : false\n  }\n\n  canMoveUp() {\n    return this.canMove(this.position.x, this.position.y - 1)\n  }\n  canMoveDown() {\n    return this.canMove(this.position.x, this.position.y + 1)\n  }\n  canMoveLeft() {\n    const neighbour = this.level.getObjectAt(this.position.x - 1, this.position.y)\n    const nothingBesides = this.level.isPositionClear(this.position.x - 2, this.position.y)\n    const isAboutToFall = this.level.isPositionClear(this.position.x - 1, this.position.y + 1)\n    const canPush = neighbour?.isMoveable && nothingBesides && !isAboutToFall\n\n    let canMove = this.canMove(this.position.x - 1, this.position.y)\n    if(!canMove && canPush) {\n      if(this.pushingDirection === DIRS.LEFT) {\n        canMove = true\n        this.level.moveObject(neighbour, { x: this.position.x - 2, y: this.position.y })\n        // clears pushing dir to let a new loop to push again\n        this.pushingDirection = ''\n      } else {\n        this.pushingDirection = DIRS.LEFT\n      }\n    }\n    return canMove\n  }\n  canMoveRight() {\n    const neighbour = this.level.getObjectAt(this.position.x + 1, this.position.y)\n    const nothingBesides = this.level.isPositionClear(this.position.x + 2, this.position.y)\n    const isAboutToFall = this.level.isPositionClear(this.position.x + 1, this.position.y + 1)\n    const canPush = neighbour?.isMoveable && nothingBesides && !isAboutToFall\n\n    let canMove = this.canMove(this.position.x + 1, this.position.y)\n    if(!canMove && canPush) {\n      if(this.pushingDirection === DIRS.RIGHT) {\n        canMove = true\n        this.level.moveObject(neighbour, { x: this.position.x + 2, y: this.position.y })\n        // clears pushing dir to let a new loop to push again\n        this.pushingDirection = ''\n      } else {\n        this.pushingDirection = DIRS.RIGHT\n      }\n    }\n    return canMove\n  }\n}\n\nCharacter.className = 'Character'\n","import Character from './Character'\nimport Player from './Player'\nimport Boulder from './Boulder'\nimport { DIRS } from '../../utils/constants'\n\nexport default class Enemy extends  Character {\n  constructor(id, level) {\n    super(id, level)\n    this.moveIntentDir = DIRS.UP\n    this.anchorPosition = null\n  }\n  overrunBy(el) {\n    if(el.constructor.className !== Player.className) {\n      // this.alien.visible = false\n      // this.alien.alpha = 0.5\n      this.alien?.destroy()\n      this.level.onCharacterDie(this)\n    }\n    if (el.constructor.className === Boulder.className) {\n      this.level.scene.events.emit('sounds:death_by_rock_hit')\n    }\n  }\n}\n\nEnemy.className = 'Enemy'\n","import Character from './Character'\nimport Enemy from './Enemy'\nimport { DIRS } from '../../utils/constants'\nimport Boulder from './Boulder'\n\nexport default class Player extends Character {\n  constructor(id, level) {\n    super(id, level)\n    this.power = 0.5\n    this.moveIntentDir = ''\n\n    const scene = level.scene\n    scene.input.keyboard.removeListener('keydown', this.onKeyDown.bind(this))\n    scene.input.keyboard.addListener('keydown', this.onKeyDown.bind(this))\n\n    scene.input.keyboard.removeListener('keyup', this.onKeyUp.bind(this))\n    scene.input.keyboard.addListener('keyup', this.onKeyUp.bind(this))\n  }\n  onKeyUp(event) {\n    if (this.moveIntentDir === event.key) {\n      this.moveIntentDir = ''\n      this.pushingDirection = null\n    }\n  }\n  onKeyDown(event) {\n    if(!event.repeat && [DIRS.UP, DIRS.DOWN, DIRS.LEFT, DIRS.RIGHT].includes(event.key)) {\n      this.moveIntentDir = event.key;\n      // calls loop to avoid delay between key press and visual movement at the begining of next loop\n      if(!this.isMoving) {\n        this.level.playerLoop()\n      }\n    }\n  }\n  destroy() {\n    const scene = this.level.scene\n    // animate die\n    scene.input.keyboard.off('keydown')\n    scene.input.keyboard.off('keyup')\n  }\n\n  die() {\n    this.inactive = true\n    this.alien.alpha = 0\n    this.destroy()\n    this.level.onCharacterDie(this)\n  }\n\n  overrunBy(el) {\n    if (el.constructor.className === Boulder.className) {\n      this.level.scene.events.emit('sounds:death_by_rock_hit')\n    }\n    this.die()\n  }\n  runningOver(el) {\n    if(el.constructor.className === Enemy.className) {\n      this.die()\n    }\n  }\n}\n\nPlayer.className = 'Player'\n","import GameObject from './GameObject'\n\nexport default class Wall extends GameObject {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: true,\n      isBreakable: false,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: false,\n      level\n    })\n  }\n}\n\nWall.className = 'Wall'\n","import { PIXEL_TO_TILEMAP_POSITION, PIXEL_NAME } from '../../utils/constants'\nimport Destroyable from './Destroyable'\n\nexport default class Ground extends Destroyable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: true,\n      isBreakable: true,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: false,\n      level\n    })\n    this.strength = 1\n  }\n\n  overrunBy(el) {\n    super.overrunBy(el)\n    // assume is player who overruns ground\n    const layer = this.level.scene.children.getByName('layer_1')\n    const { tilemap: map } = layer\n    map.putTileAt(PIXEL_TO_TILEMAP_POSITION[PIXEL_NAME.EMPTY], this.position.x, this.position.y)\n    this.level.scene.events.emit('sounds:clear_hit')\n  }\n}\n\nGround.className = 'Ground'\n","export default class Empty {\n  constructor(id, level) {\n    this.id = id\n    this.level = level\n    this.isEmpty = true\n  }\n  setPosition(coords) {\n    this.position = coords\n  }\n}\n\nEmpty.className = 'Empty'\n","import Empty from './Empty'\nimport Player from './Player'\n\nexport default class Interactive extends Empty {\n  overrunBy(el) {\n    if (el.constructor.className === Player.className) {\n      this.level.onInteractWith(this)\n    }\n  }\n}\n\nInteractive.className = 'Interactive'\n","import Fallable from './Fallable'\n\nexport default class Barrel extends Fallable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: true,\n      level\n    })\n  }\n  explode() {\n    // this.alien.alpha = 0.5\n    this.alien.destroy()\n    this.level.onExplode(this)\n  }\n  overrunBy(el) {\n    this.explode()\n  }\n}\nBarrel.className = 'Barrel'\n\n","import GameObject from './GameObject'\nimport Empty from './Empty'\nimport { PIXEL_NAME, TICK_TIME } from '../../utils/constants'\n\nexport default class Explosion extends GameObject {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: true,\n      level\n    })\n    this.power = 10\n  }\n  setPosition(x, y) {\n    this.position = { x, y }\n    \n    const layer = this.level.scene.children.getByName('layer_1')\n    const { tilemap: map } = layer\n    const explosion = this.level.scene.add.graphics({ fillStyle: { color: 0xff0000, alpha: 1 } })\n    explosion.fillRect(0, 0, map.tileWidth, map.tileHeight)\n    explosion.setScale(layer.scaleX)\n\n    explosion.x = map.tileToWorldX(x)\n    explosion.y = map.tileToWorldY(y)\n\n    this.level.scene.tweens.add({\n      targets: explosion,\n      alpha: 0,\n      duration: TICK_TIME,\n      onComplete: () => {\n        explosion.destroy()\n        this.level.objects[y][x] = new Empty(PIXEL_NAME.EMPTY, this.level)\n      }\n    });\n    \n    this.alien = explosion\n    \n  }\n}\n\nExplosion.className = 'Explosion'\n","import Fallable from './Fallable'\nimport Player from './Player'\n\nexport default class Jewel extends Fallable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: false,\n      isPickable: true,\n      isCrushable: false,\n      level\n    })\n    this.strength = 4\n  }\n  overrunBy(el) {\n    if(el.constructor.className === Player.className) {\n      this.alien.visible = false\n      this.level.onJewelPick(this)\n      this.level.scene.events.emit('sounds:gem_pick')\n      this.level.scene.events.emit('score:diamond_collected')\n    } else {\n      super.overrunBy(el)\n    }\n  }\n}\n\nJewel.className = 'Jewel'\n","import Fallable from './Fallable'\nimport Player from './Player'\n\nexport default class Mushroom extends Fallable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: false,\n      isPickable: true,\n      isCrushable: false,\n      level\n    })\n    this.strength = 4\n  }\n  overrunBy(el) {\n    if(el.constructor.className === Player.className) {\n      this.alien.visible = false\n      this.level.onMushroomPick(this)\n      this.level.scene.events.emit('sounds:shroom_pick')\n      this.level.scene.events.emit('score:mushroom_collected')\n    } else {\n      super.overrunBy(el)\n    }\n  }\n}\n\nMushroom.className = 'Mushroom'\n","import Phaser from 'phaser'\nimport { TICK_TIME, PLAYER_TICK_TIME, PIXEL_NAME, DIRS, PIXEL_TO_TILEMAP_POSITION } from \"../../utils/constants\"\nimport {\n  Player,\n  Boulder,\n  Wall,\n  Empty,\n  Ground,\n  Barrel,\n  Enemy,\n  Interactive,\n  Jewel,\n  Explosion,\n  Mushroom,\n} from '../objects'\n\nclass Level {\n  constructor(config) {\n    this.config = config\n    this.moveables = []\n    this.objects = []\n    this.scene = null\n    this.player = null\n    this.playerTimeoutId = 0\n    this.isPaused = false\n  }\n\n  connectToScene(phaserScene) {\n    window.localStorage.setItem(this.id, 'true')\n    this.scene = phaserScene\n    const layer = this.scene.children.getByName('layer_1')\n    const { tilemap: map } = layer\n    if(this.objects.length) {\n      this.objects = []\n    }\n    \n\n    let intOrder = 0\n    this.objects = this.config.map((r, y) => r.map((c, x) => {\n      // factory\n      let element\n      \n      switch(c) {\n        case PIXEL_NAME.WALL:\n          element = new Wall(c, this)\n          element.setPosition({ x, y })\n          break;\n        case PIXEL_NAME.GROUND:\n          element = new Ground(c, this)\n          element.setPosition({ x, y })\n          break;\n        case PIXEL_NAME.BOULDER:\n          const boulder = this.scene.add.sprite(48, 16).setOrigin(0, 0.25).play('boulder_idle')\n          boulder.setScale(layer.scaleX)\n          boulder.x = map.tileToWorldX(x)\n          boulder.y = map.tileToWorldY(y)\n          \n          element = new Boulder(c, this)\n          element.alien = boulder\n          break;\n        case PIXEL_NAME.JEWEL:\n          const diamond = this.scene.add.sprite(48, 16).setOrigin(0, 0.25).play('diamond_idle')\n          diamond.setScale(layer.scaleX)\n          diamond.x = map.tileToWorldX(x)\n          diamond.y = map.tileToWorldY(y)\n          \n          \n          \n          element = new Jewel(c, this)\n          element.alien = diamond\n          break;\n        case PIXEL_NAME.MUSHROOM:\n          const mushroom = this.scene.add.sprite(48, 16).setOrigin(0, 0.25).play('mushroom_idle')\n          mushroom.setScale(layer.scaleX)\n          mushroom.x = map.tileToWorldX(x)\n          mushroom.y = map.tileToWorldY(y)\n          \n          \n          \n          element = new Mushroom(c, this)\n          element.alien = mushroom\n          break;\n        case PIXEL_NAME.BARREL:\n          const barrel = this.scene.add.graphics({ fillStyle: { color: 0x663300, alpha: 1 } })\n          barrel.setScale(layer.scaleX)\n          // barrel.fillRect(0, 0, map.tileWidth * layer.scaleX, map.tileHeight * layer.scaleY)\n          barrel.fillRect(0, 0, map.tileWidth, map.tileHeight)\n\n          barrel.x = map.tileToWorldX(x)\n          barrel.y = map.tileToWorldY(y)\n          \n          element = new Barrel(c, this)\n          element.alien = barrel\n          break;\n        case PIXEL_NAME.PLAYER:\n          const player = this.scene.add.sprite(48, 16).setOrigin(0, 0.25).play('brave_idle')\n          player.setScale(layer.scaleX)\n          player.x = map.tileToWorldX(x)\n          player.y = map.tileToWorldY(y)\n\n          player.name = 'brave'\n          player.on(Phaser.Animations.Events.ANIMATION_COMPLETE, () => {\n            if(!player.isMoving) {\n              // player.play('brave_idle')\n            }\n          })\n\n          element = new Player(c, this)\n          element.alien = player\n\n          // add shortcut reference\n          this.player = element\n          break;\n        case PIXEL_NAME.ENEMY:\n          // const enemy = this.scene.add.graphics({ fillStyle: { color: 0xff0000, alpha: 1 } })\n          // enemy.fillRect(0, 0, map.tileWidth, map.tileHeight)\n          // enemy.setScale(layer.scaleX)\n          // this.scene.addToScalables(enemy, { x, y })\n          // enemy.x = map.tileToWorldX(x)\n          // enemy.y = map.tileToWorldY(y)\n\n          const enemy = this.scene.add.sprite(48, 16).setOrigin(0, 0.25).play('bat_move')\n          enemy.setScale(layer.scaleX)\n          enemy.x = map.tileToWorldX(x)\n          enemy.y = map.tileToWorldY(y)\n          \n          element = new Enemy(c, this)\n          element.alien = enemy\n          break;\n        case PIXEL_NAME.INTERACTION:\n          element = new Interactive(c, this)\n          element.order = intOrder++\n          break;\n        default:\n          element = new Empty(c, this);\n\n      }\n      element.setPosition({ x, y })\n      if (!this.objectIsEmpty(element) && !element.isRigid) {\n        // enters backward to start evaluating lower elements into gravityLoop\n        // this.moveables.unshift(element)\n        this.moveables.push(element)\n      }\n      this.onAddElement(element)\n      return element\n    }))\n  }\n\n  gravityLoop() {\n    if (this.isPaused) { return }\n    this.moveables.sort((a, b) => a.position.y - b.position.y).forEach(el => {\n      const canFallDown = el.canFallDown()\n      const canFallLeft = el.canFallLeft()\n      const canFallRight = el.canFallRight()\n      let nextPos\n      if(canFallDown) {\n        nextPos = { x: el.position.x, y: el.position.y + 1 }\n      }\n      if (!canFallDown && canFallLeft) {\n        nextPos = { x: el.position.x - 1, y: el.position.y}\n        if(el.isFalling) {\n          nextPos.y ++\n        }\n      }\n      if (!canFallDown && !canFallLeft && canFallRight) {\n        nextPos = { x: el.position.x + 1, y: el.position.y}\n        if(el.isFalling) {\n          nextPos.y ++\n        }\n      }\n\n      if (nextPos) {\n        this.moveObject(el, nextPos)\n        if (el.isFalling && (canFallLeft || canFallRight) && el.constructor.className === Boulder.className && this.player.pushingDirection !== '') {\n          this.scene.events.emit('sounds:rock_hit')\n        }\n        if (el.isFalling && (canFallLeft || canFallRight) && el.constructor.className === Jewel.className) {\n          this.scene.events.emit('sounds:gem_hit')\n        }\n        el.isFalling++\n      } else {\n        if (el.isFalling && el.constructor.className === Boulder.className) {\n          this.scene.events.emit('sounds:rock_hit')\n        }\n        if (el.isFalling && el.constructor.className === Jewel.className) {\n          this.scene.events.emit('sounds:gem_hit')\n        }\n        if(el.isFalling && el.constructor.className === Barrel.className) {\n          el.explode()\n        }\n        el.isFalling = 0\n      }\n    })\n\n    this.enemiesLoop()\n  }\n  enemiesLoop() {\n\n    if(this.isPaused) { return }\n    let nextPos, neighbour, isDestinationEmpty, isPerpToAnchor, newAnchor, nextDir, backToTrackDir, nextAnchorPos\n    \n    const helperDirCalc = (enemy, nextPos, nextDir, backToTrackDir, nextAnchorPos) => {\n      neighbour = this.getObjectAt(nextPos.x, nextPos.y)\n      isDestinationEmpty = this.objectIsEmpty(neighbour) || neighbour?.constructor.className === Player.className // this.isDestinationEmpty(nextPos.x, nextPos.y)\n      if (!isDestinationEmpty && !enemy.anchorPosition) {\n        enemy.anchorPosition = neighbour.position\n        // counter clockwise\n        enemy.moveIntentDir = nextDir\n      }\n      if (isDestinationEmpty && neighbour.constructor.className === Player.className) {\n        this.moveObject(enemy, nextPos)\n      }\n      if (isDestinationEmpty) {\n        if (!enemy.anchorPosition) {\n          enemy.moveIntentDir = nextDir\n          return\n        }\n        isPerpToAnchor = enemy.position.x === enemy.anchorPosition.x || enemy.position.y === enemy.anchorPosition.y\n        // scenario 1: enemy is perpendicular to anchor\n        if (isPerpToAnchor) {\n          // updates anchor counter clockwise\n          newAnchor = this.getObjectAt(nextAnchorPos.x, nextAnchorPos.y)\n          if (!this.objectIsEmpty(newAnchor) && newAnchor?.constructor.className !== Player.className) {\n            enemy.anchorPosition = newAnchor.position\n          } else {\n            enemy.moveIntentDir = backToTrackDir\n          }\n        }\n        this.moveObject(enemy, nextPos)\n      } else {\n        enemy.anchorPosition = neighbour.position\n        enemy.moveIntentDir = nextDir\n      }\n    }\n    this.moveables\n    .filter(el => el.constructor.className === Enemy.className)\n    .forEach(enemy => {\n      // potential path finding mechanism @see https://github.com/qiao/PathFinding.js\n      // if(!enemy.path) {\n      //   const grid = new window.PF.Grid(this.objects.map(row => row.map(el => el.isEmpty ? 0 : 1)));\n      //   enemy.pathfinder = new window.PF.AStarFinder();\n      //   const path = enemy.pathfinder.findPath(enemy.position.x, enemy.position.y, thi.player.position.x, this.player.position.y, grid);\n      // }\n      switch(enemy.moveIntentDir) {\n        case DIRS.UP:\n          nextPos = { x: enemy.position.x, y: enemy.position.y - 1}\n          nextDir = DIRS.LEFT\n          backToTrackDir = DIRS.RIGHT\n          nextAnchorPos = { x: nextPos.x + 1, y: nextPos.y }\n          helperDirCalc(enemy, nextPos, nextDir, backToTrackDir, nextAnchorPos)\n          \n          break;\n        case DIRS.RIGHT:\n          nextPos = { x: enemy.position.x + 1, y: enemy.position.y}\n          nextDir = DIRS.UP\n          backToTrackDir = DIRS.DOWN\n          nextAnchorPos = { x: nextPos.x, y: nextPos.y + 1 }\n          helperDirCalc(enemy, nextPos, nextDir, backToTrackDir, nextAnchorPos)\n          \n          break;\n        case DIRS.DOWN:\n          nextPos = { x: enemy.position.x, y: enemy.position.y + 1}\n          nextDir = DIRS.RIGHT\n          backToTrackDir = DIRS.LEFT\n          nextAnchorPos = { x: nextPos.x - 1, y: nextPos.y }\n          helperDirCalc(enemy, nextPos, nextDir, backToTrackDir, nextAnchorPos)\n          \n          break;\n        case DIRS.LEFT:\n          nextPos = { x: enemy.position.x - 1, y: enemy.position.y}\n          nextDir = DIRS.DOWN\n          backToTrackDir = DIRS.UP\n          nextAnchorPos = { x: nextPos.x, y: nextPos.y - 1 }\n          helperDirCalc(enemy, nextPos, nextDir, backToTrackDir, nextAnchorPos)\n          \n          break;\n\n        default:\n          break;\n      }\n    })\n  }\n  playerLoop() {\n    if(this.isPaused || this.player.inactive) { return }\n    clearTimeout(this.playerTimeoutId)\n    const player = this.player\n    \n    const nextPos = { x: player.position.x, y: player.position.y }\n    switch(player.moveIntentDir) {\n      case DIRS.UP:\n        if(player.canMoveUp()) nextPos.y -= 1\n        break;\n      case DIRS.DOWN:\n        if(player.canMoveDown()) nextPos.y += 1\n        break;\n      case DIRS.LEFT:\n        if(player.canMoveLeft()) nextPos.x -= 1\n        break;\n      case DIRS.RIGHT:\n        if(player.canMoveRight()) nextPos.x += 1\n        break;\n      default:break;\n    }\n    if ((player.position.x !== nextPos.x || player.position.y !== nextPos.y) && !player.isMoving) {\n      player.isMoving = true\n      if (player.position.x < nextPos.x) {\n        player.alien.setOrigin(0, 0.25)\n        player.alien.setFlipX(false)\n      }\n      if (player.position.x > nextPos.x) {\n        player.alien.setFlipX(true)\n        player.alien.setOrigin(0.25, 0.25)\n      }\n      player.alien.emit('player_moves', nextPos)\n      this.moveObject(player, nextPos)\n    }\n\n    this.playerTimeoutId = setTimeout(() => {\n      if(!player.alien) {\n        return false\n      }\n      player.isMoving = false\n      try {\n        player.alien?.play('brave_idle')\n\n      }catch(e){}\n      if(player.moveIntentDir !== '' && player.alien) {\n        this.playerLoop()\n      }\n    }, PLAYER_TICK_TIME);\n  }\n  // afterPlayerLoop(cb) {\n  //   this.afterPlayerLoopCallbacks.push(cb)\n  // }\n  moveObject(el, pos) {\n    const layer = this.scene.children.getByName('layer_1')\n    if(!layer) { return false }\n    const { tilemap: map } = layer\n    const origin = { x: el.position.x, y: el.position.y }\n    // assume destination is occupeable\n    const destinationElement = this.getObjectAt(pos.x, pos.y)\n    if (!this.objectIsEmpty(destinationElement) || destinationElement.constructor.className === Interactive.className) {\n      destinationElement.overrunBy(el)\n      el.runningOver(destinationElement)\n    }\n\n    if(el.inactive) return\n\n    // clear origin position\n    this.setObjectAt(origin.x, origin.y, new Empty(PIXEL_NAME.EMPTY, this))\n    // fill destination position\n    this.setObjectAt(pos.x, pos.y, el)\n    \n    // updates element position\n    el.move(pos)\n    if(el.constructor.className === Player.className && el.alien) {\n      // alien anim\n      this.scene.tweens.add({\n        targets: el.alien,\n        x: {\n          value: map.tileToWorldX(pos.x),\n          duration: PLAYER_TICK_TIME,\n        },\n        y: {\n          value: map.tileToWorldY(pos.y),\n          duration: PLAYER_TICK_TIME,\n        },\n      });\n      el.alien?.play('brave_run')\n    }\n    if(el.constructor.className === Enemy.className) {\n      // alien anim\n      this.scene.tweens.add({\n        targets: el.alien,\n        x: {\n          value: map.tileToWorldX(pos.x),\n          duration: TICK_TIME,\n        },\n        y: {\n          value: map.tileToWorldY(pos.y),\n          duration: TICK_TIME,\n        },\n      });\n    }\n    if(el.constructor.className === Jewel.className || el.constructor.className === Mushroom.className) {\n      // alien anim\n      this.scene.tweens.add({\n        targets: el.alien,\n        x: {\n          value: map.tileToWorldX(pos.x),\n          duration: TICK_TIME * 0.5,\n        },\n        y: {\n          value: map.tileToWorldY(pos.y),\n          delay: pos.x !== origin.x ? TICK_TIME * 0.5 : 0,\n          duration: pos.x !== origin.x ? TICK_TIME * 0.5 : TICK_TIME,\n        },\n        // duration: TICK_TIME,\n      });\n    }\n    if(el.constructor.className === Barrel.className) {\n      // alien anim\n      this.scene.tweens.add({\n        targets: el.alien,\n        x: {\n          value: map.tileToWorldX(pos.x),\n          duration: TICK_TIME * 0.5,\n        },\n        y: {\n          value: map.tileToWorldY(pos.y),\n          delay: pos.x !== origin.x ? TICK_TIME * 0.5 : 0,\n          duration: pos.x !== origin.x ? TICK_TIME * 0.5 : TICK_TIME,\n        },\n        // duration: TICK_TIME,\n      });\n    }\n    if(el.constructor.className === Boulder.className) {\n      // alien anim\n      this.scene.tweens.add({\n        targets: el.alien,\n        x: {\n          value: map.tileToWorldX(pos.x),\n          duration: TICK_TIME * 0.5,\n        },\n        y: {\n          value: map.tileToWorldY(pos.y),\n          delay: pos.x !== origin.x ? TICK_TIME * 0.5 : 0,\n          duration: pos.x !== origin.x ? TICK_TIME * 0.5 : TICK_TIME,\n        },\n        // duration: TICK_TIME,\n      });\n      if (pos.x !== origin.x) {\n        el.alien.play(pos.x > origin.x ? 'boulder_roll_right' : 'boulder_roll_left')\n      }\n    }\n  }\n  pause() {\n    this.isPaused = true\n  }\n  resume() {\n    this.isPaused = false\n  }\n  destroy(){}\n  onCharacterDie(el) {\n    this.setObjectAt(el.position.x, el.position.y,  new Empty(PIXEL_NAME.EMPTY, this))\n    this.moveables = this.moveables.filter(e => e !== el)\n    if (el.constructor.className === Player.className) {\n      el.moveIntentDir = ''\n      // this.player = null\n      this.scene.levels.restart()\n    }\n  }\n  onJewelPick(el) {\n    this.setObjectAt(el.position.x, el.position.y,  new Empty(PIXEL_NAME.EMPTY, this))\n    this.moveables = this.moveables.filter(e => e !== el)\n  }\n  onMushroomPick(el) {\n    this.setObjectAt(el.position.x, el.position.y,  new Empty(PIXEL_NAME.EMPTY, this))\n    this.moveables = this.moveables.filter(e => e !== el)\n  }\n  onDestroyElement(el) {\n    if(el.constructor.className === Boulder.className) {\n    }\n    this.setObjectAt(el.position.x, el.position.y,  new Empty(PIXEL_NAME.EMPTY, this))\n    this.moveables = this.moveables.filter(e => e !== el)\n  }\n  onExplode(el) {\n    this.setObjectAt(el.position.x, el.position.y,  new Empty(PIXEL_NAME.EMPTY, this))\n    this.moveables = this.moveables.filter(e => e !== el)\n    for(let x = el.position.x - 2; x <= el.position.x + 2; x++) {\n      for(let y = el.position.y - 2; y < el.position.y + 2; y++) {\n        const el = this.getObjectAt(x, y)\n        const explosion = new Explosion(PIXEL_NAME.EXPLOSION, this)\n        if(el.isBreakable || this.objectIsEmpty(el)) {\n          explosion.setPosition(x, y)\n          this.objects[y][x] = explosion\n        }\n        if (el && !this.objectIsEmpty(el)){\n          el.overrunBy(explosion)\n        }\n      }\n    }\n  }\n  onComplete() {\n    this.objects.forEach(row => row.forEach(el => {\n      if(el.alien) {\n        el.alien.destroy()\n        el.alien = null\n      }\n    }))\n    this.pause()\n    this.scene.events.emit('levelcompleted', this)\n    // this.moveables = []\n    // this.objects.map(el => el.alien?.destroy())\n  }\n  onInteractWith(el) {\n    console.warn(`implement interaction for ${this.id}`)\n  }\n  onAddElement(el) {\n    console.warn(`implement element added ${this.id}`)\n  }\n  getPlayerPos() { return this.player.position}\n  getConfigAt(x, y) {\n    return this.isDestinationInBounds(x, y) && this.config[y][x]\n  }\n  getCoords(id) {\n    const found = []\n    for(let i = 0; i < this.config.length; i++) {\n      for(let j = 0; j < this.config[i].length; j++) {\n        if (this.config[i][j] === id) {\n          found.push({x: j, y: i})\n        }\n      }\n    }\n    return found\n  }\n  getObjectAt(x, y) {\n    return this.isDestinationInBounds(x, y) && this.objects[y][x]\n  }\n  setObjectAt(x, y, obj) {\n    this.objects[y][x] = obj\n  }\n  isPositionClear(x, y) {\n    return this.getObjectAt(x, y).isEmpty\n  }\n  isDestinationInBounds(x, y) {\n    const xInBounds = x < this.config[0].length && x >= 0\n    const yInBounds = y < this.config.length && y >= 0\n    return xInBounds && yInBounds\n  }\n  objectIsEmpty(el) {\n    return el.isEmpty\n  }\n  isDestinationEmpty(x, y) {\n    return this.getObjectAt(x, y).isEmpty\n  }\n}\n\nexport default Level\n","import Phaser from 'phaser'\nimport { PIXEL_NAME, PIXEL_TO_TILEMAP_POSITION } from '../utils/constants'\nimport Level1 from './levels/level_1'\nimport Level2 from './levels/level_2'\nimport Level3 from './levels/level_3'\nimport Level4 from './levels/level_4'\nimport Level5 from './levels/level_5'\nimport Level6 from './levels/level_6'\n\nconst LEVELS = ['', Level1, 'cinematic_1', Level2, Level3, Level4, Level5, 'cinematic_escape', Level6, 'cinematic_last']\n\nexport default class LevelManager {\n  constructor(scene, currentLevel = 0) {\n    this.currentIndex = currentLevel\n    this.scene = scene\n    // this.currentIndex = currentLevel - 1\n    // this.current = new LEVELS[this.currentIndex]()\n    this.start()\n  }\n  \n  start() {\n    this.current = new LEVELS[this.currentIndex]()\n    this.current.config = this.generateConfig()\n    this.map = this.createMap()\n    this.current.connectToScene(this.scene)\n    this.current.pause()\n    this.scene.cameras.main.once('camerafadeincomplete', () => {\n      this.current.resume()\n      this.scene.events.emit('levelstart')\n    })\n  }\n  restart() {\n    this.scene.cameras.main.fade(500, 0, 0, 0)\n    this.scene.cameras.main.once('camerafadeoutcomplete', () => {\n      this.current.destroy()\n      this.scene.children.list.forEach(ch => {\n        // ch.kill()\n        ch.destroy()\n      })\n      this.scene.rules.destroy()\n      this.scene.ui.destroy()\n      this.scene.scene.restart({ level: this.currentIndex })\n      // this.currentIndex -= 1\n      // this.next()\n      // this.scene.cameras.main.fadeIn(500, 0, 0, 0)\n    })\n  }\n\n  next() {\n    // destroy and unload\n    this.currentIndex += 1\n    if(typeof LEVELS[this.currentIndex] === 'string' && LEVELS[this.currentIndex].includes('cinematic')) {\n      this.scene.scene.start('ConnectorScene', { id: this.currentIndex, name: LEVELS[this.currentIndex]})\n    } else if (LEVELS[this.currentIndex]) {\n      this.start()\n    } else {\n      this.scene.scene.start('MenuScene')\n    }\n\n  }\n\n  generateConfig() {\n    const scene = this.scene\n    const levelId = this.current.id\n    var texture = scene.textures.get(levelId);\n    var image = texture.getSourceImage();\n    const levelConfig = Array(image.height).fill('000000').map(r => Array(image.width).fill('000000'))\n    for(let j = 0; j < image.width; j++) {\n      for(let i = 0; i < image.height; i++) {\n        const pixColor = scene.textures.getPixel(j, i, levelId)\n        const key = `${Phaser.Display.Color.ComponentToHex(pixColor.r)}${Phaser.Display.Color.ComponentToHex(pixColor.g)}${Phaser.Display.Color.ComponentToHex(pixColor.b)}`\n        levelConfig[i][j] = key\n      }\n    }\n    return levelConfig\n  }\n\n  createMap() {\n    const scene = this.scene\n    const levelData = this.current\n    const SCALE = scene.data.get('custom_scale')\n    const camera = this.scene.cameras.main\n\n    let map = this.map\n    if(map && map.scene) {\n      map.destroy()\n    }\n\n    // Creating a blank tilemap with dimensions matching the dungeon\n    map = scene.make.tilemap({ tileWidth: 20, tileHeight: 20, width: levelData.config[0].length, height: levelData.config.length });\n\n    // addTilesetImage: function (tilesetName, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid)\n    let tileset = map.addTilesetImage('tiles', 'main-tiles', 20, 20, 1, 2);\n\n    let layer = map.createBlankLayer('layer_1', tileset);\n    layer.name = 'layer_1'\n    layer.depth = 0\n\n    layer.setScale(SCALE)\n\n    // Fill with black tiles\n    layer.fill(1)\n\n    levelData.config.forEach((row, x) => {\n      row.forEach((el, y) => {\n        const tile = levelData.config[x][y]\n        if (\n          ![\n            PIXEL_NAME.EMPTY,\n            PIXEL_NAME.PLAYER,\n            PIXEL_NAME.BOULDER,\n            PIXEL_NAME.JEWEL,\n            PIXEL_NAME.INTERACTION,\n            PIXEL_NAME.MUSHROOM,\n            PIXEL_NAME.ENEMY,\n          ].includes(tile)\n        ) {\n          if (tile === PIXEL_NAME.WALL) {\n            const tile = PIXEL_TO_TILEMAP_POSITION.calculateWallTileWithNeighbours(x, y, levelData.config)\n            map.putTileAt(tile, y, x)\n          } else {\n            map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile], y, x)\n          }\n        } else {\n          map.putTileAt(PIXEL_TO_TILEMAP_POSITION[PIXEL_NAME.EMPTY], y, x)\n        }\n      })\n    })\n\n    // set up camera\n    camera.setBounds(0, 0, layer.width * layer.scaleX, layer.height * layer.scaleY);\n    camera.zoom = 1\n\n    return map\n  }\n}","import LevelBase from './levelBase'\n\nclass Level1 extends LevelBase {\n  constructor() {\n    super()\n    this.id = 'level_1'\n    this.name = 'The beginning'\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene)\n    scene.events.once('levelstart', () => {\n      scene.events.emit('dialogue:show', {\n        participants: ['closeUp_Mary', 'closeUp_Dwarf'],\n        conversation: [\n          {\n            who: 'closeUp_Dwarf',\n            text: [\n              \"Well look who decided to\",\n              \"jump into the hole. Let\",\n              \"me guess. You're here to\",\n              \"take all of these precious\",\n              \"mushrooms. But\",\n              \"what about me!\",\n              \"Don't I deserve a few\",\n              \"shrooms?\",\n              \"I'll tell ya what.\"\n            ]\n          },\n          {\n            who: 'closeUp_Dwarf',\n            text: [\n               \"Give me some of your\",\n               \"mushrooms at the end of\",\n               \"this level. Maybe i'll\",\n               \"tell you how to beat the\",\n               \"game. For Now… Why don't\",\n               \"you try moving those\",\n               \"boulders?\",\n            ]\n          },\n          {\n            who: 'closeUp_Mary',\n            text: [\n              \"I guess I should find\",\n              \"Marduk.\",\n            ]\n          },\n          {\n            who: 'closeUp_Dwarf',\n            text: [\n              \"You can also reset the\",\n              \"level by pressing escape.\",\n              \"Although i'm not sure\",\n              \"why you'd bother.\",\n            ]\n          },\n        ]\n      })\n    })\n  }\n\n  onInteractWith(el) {\n    if(el.order === 0) {\n      this.onComplete()\n    }\n  }\n}\n\nexport default Level1\n","import LevelBase from './levelBase'\nimport { Interactive } from '../objects'\nimport { PIXEL_TO_TILEMAP_POSITION, PIXEL_NAME } from '../../utils/constants'\n\nclass Level2 extends LevelBase {\n  constructor() {\n    super()\n    this.id = 'level_2'\n    this.name = 'The finding'\n  }\n\n  onInteractWith(el) {\n    if(el.order === 1) {\n      el.alien.destroy()\n      const layer = this.scene.children.getByName('layer_1')\n      const { tilemap: map } = layer\n      this.player.moveIntentDir = ''\n      this.scene.events.emit('dialogue:show', {\n        participants: ['closeUp_Mary', 'closeUp_Dwarf'],\n        conversation: [\n          {\n            who: 'closeUp_Mary',\n            text: [\n              \"This thing is incredible,\",\n              \"I cut through earth like\",\n              \"butter.\",\n            ]\n          },\n          {\n            who: 'closeUp_Dwarf',\n            text: [\n              \"The power of the pickaxe\",\n              \"is within you:\",\n              \"Now you can walk through\",\n              \"the ground.\",\n            ]\n          },\n          {\n            who: 'closeUp_Mary',\n            text: [\n              \"How are you communicating\",\n              \"with me? Telepathy?\",\n            ]\n          },\n          {\n            who: 'closeUp_Dwarf',\n            text: [\n               \"I've felt new powers\",\n               \"awaken within me since\",\n               \"the comet's arrival.\",\n               \"There are many things\",\n               \"about me you have yet\",\n              \"to understand.\",\n            ]\n          },\n        ]\n      })\n      \n      this.player.power = 1\n      map.putTileAt(PIXEL_TO_TILEMAP_POSITION[PIXEL_NAME.EMPTY], el.position.x, el.position.y)\n    }\n    if(el.order === 0) {\n      this.onComplete()\n    }\n  }\n\n  onAddElement(el) {\n    if(el.constructor.className === Interactive.className && el.order === 1) {\n      const layer = this.scene.children.getByName('layer_1')\n      const { tilemap: map } = layer\n      const pickaxe = this.scene.add.sprite(48, 16).setOrigin(0, 0.25).play('pickaxe_idle')\n      pickaxe.setScale(layer.scaleX)\n      pickaxe.x = map.tileToWorldX(el.position.x)\n      pickaxe.y = map.tileToWorldY(el.position.y)\n\n      el.alien = pickaxe\n    }\n  }\n}\n\nexport default Level2\n","import LevelBase from './levelBase'\nimport { Player } from '../objects'\n\nclass Level3 extends LevelBase {\n  constructor() {\n    super()\n    this.id = 'level_3'\n    this.name = 'The blocking'\n  }\n\n  onInteractWith(el) {\n    if(el.order === 0) {\n      this.onComplete()\n    }\n  }\n\n  onAddElement(el) {\n    if(el.constructor.name === Player.name) {\n      el.power = 1\n    }\n  }\n}\n\nexport default Level3\n","import LevelBase from './levelBase'\nimport { Player } from '../objects'\n\nclass Level4 extends LevelBase {\n  constructor() {\n    super()\n    this.id = 'level_4'\n    this.name = 'The encounter'\n  }\n\n  onInteractWith(el) {\n    if(el.order === 0) {\n      this.onComplete()\n    }\n  }\n  onAddElement(el) {\n    if(el.constructor.name === Player.name) {\n      el.power = 1\n    }\n  }\n}\n\nexport default Level4\n","import Phaser from 'phaser'\nimport LevelBase from './levelBase'\nimport { Player } from '../objects'\n\n\nclass Level5 extends LevelBase {\n  constructor() {\n    super()\n    this.id = 'level_5'\n    this.name = 'Hard Work'\n  }\n  connectToScene(scene) {\n    super.connectToScene(scene)\n    scene.events.on('update', this.updateLight.bind(this))\n  }\n  destroy() {\n    this.scene.events.off('update', this.updateLight.bind(this))\n  }\n\n  updateLight() {\n    const layer = this.scene.children.getByName('layer_1')\n    if(!layer) {\n      return true\n    }\n    const map = layer.tilemap\n    let origin = this.player.position\n    this.moveables.forEach(el => {\n      var dist = Phaser.Math.Distance.Snake(\n          origin.x,\n          origin.y,\n          el.position.x,\n          el.position.y\n      );\n\n      el.alien?.setAlpha(1 - 0.1 * dist);\n    })\n    map.forEachTile((tile) => {\n      var dist = Phaser.Math.Distance.Snake(\n          origin.x,\n          origin.y,\n          tile.x,\n          tile.y\n      );\n\n      tile.setAlpha(1 - 0.1 * dist);\n    });\n\n  }\n\n  onInteractWith(el) {\n    if (el.order === 0) {\n      this.onComplete()\n    }\n  }\n  onAddElement(el) {\n    if(el.constructor.name === Player.name) {\n      el.power = 1\n    }\n  }\n}\n\nexport default Level5\n","import LevelBase from './levelBase'\nimport { PIXEL_NAME, DIRS } from '../../utils/constants'\nimport { Player, Wall, Ground, Empty } from '../objects'\n\n\nclass Level6 extends LevelBase {\n  constructor() {\n    super()\n    this.id = 'level_6'\n    this.name = 'The escape'\n\n    this.winningLoopRef = this.winningLoop.bind(this)\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene)\n    this.voidLevel = scene.children.getByName('layer_1').tilemap.height - 1\n    this.fx = this.scene.sound.add('earthquake')\n    // scene.events.once('levelstart', () => {\n    //   scene.events.emit('dialogue:show', {\n    //     participants: ['closeUp_Mary', 'closeUp_Tiamat'],\n    //     conversation: [\n    //       {\n    //         who: 'closeUp_Tiamat',\n    //         text: [\n    //           \"STOP!!\",\n    //           \"I will destroy everything\",\n    //           \"if i have to.\",\n    //           \"you belong to me!!\",\n    //         ]\n    //       }\n    //     ]\n    //   })\n    // })\n    scene.events.on('update', this.winningLoopRef)\n    this.startVoid(scene)\n    \n  }\n  startVoid(phaserScene) {\n    const camera = phaserScene.cameras.main\n    setTimeout(() => {\n      camera.shake(2000, 0.005)\n      this.fx.play()\n    }, 1500)\n    // destroy ground up to 1 tiles before player\n  }\n  playerLoop() {\n    super.playerLoop()\n    this.voidLoop()\n  }\n  resetAutoVoidTimer() {\n    clearTimeout(this.autoDestroyTID)\n    this.autoDestroyTID = setTimeout(this.destroyMap.bind(this), 5000)\n  }\n  destroyMap() {\n    this.resetAutoVoidTimer()\n    const layer = this.scene.children.getByName('layer_1')\n    if(!layer) {\n      return false\n    }\n    const { tilemap: map } = layer\n    const camera = this.scene.cameras.main\n    const y = this.voidLevel\n    layer.fill(100, 0, y, map.width, 1)\n    this.objects[y].forEach((el, x) => {\n      if (el.constructor.name === Wall.name || el.constructor.name === Ground.name) {\n        this.objects[y][x] = new Empty(PIXEL_NAME.EMPTY, this)\n      }\n    })\n    \n    this.moveables = this.moveables.filter(el => {\n      if (el.position.y > this.voidLevel) {\n        el.alien?.destroy()\n        return false\n      }\n      return true\n    })\n\n    camera.shake(1000, 0.001)\n    this.fx.play()\n    this.voidLevel--\n\n    // eval death.\n    if (this.player.position.y > this.voidLevel) {\n      this.player.die()\n      this.onCharacterDie(this.player)\n    }\n  }\n  voidLoop() {\n    // detect player move direction\n    if (this.player.isMoving && this.player.moveIntentDir === DIRS.UP) {\n      this.resetAutoVoidTimer()\n      // if moves up\n      if(this.voidLevel - this.player.position.y > 8) {\n        // only detroy ground when more than 3 tiles of space\n        this.destroyMap()\n      }\n    } else if(this.player.isMoving && this.player.moveIntentDir !== '') {\n      // if moves sides or down\n      // destroy ground\n      this.destroyMap()      \n    }\n\n  }\n  destroy() {\n    this.scene.events.off('update', this.winningLoopRef)\n    this.fx.stop()\n    clearTimeout(this.autoDestroyTID)\n    \n  }\n\n  winningLoop() {\n    if(this.player.position.y < 5) {\n      clearTimeout(this.autoDestroyTID)\n      this.scene.events.off('update', this.winningLoopRef)\n      this.onComplete()\n    }\n  }\n\n  onAddElement(el) {\n    if(el.constructor.name === Player.name) {\n      el.power = 1\n    }\n  }\n}\n\nexport default Level6\n","import Phaser from 'phaser'\nimport { TICK_TIME } from '../utils/constants'\n\nexport default class Rules {\n  constructor(scene) {\n    this.scene = scene\n    // gravity loop\n    this.timer = 0\n    this.worldTickFreq = TICK_TIME\n    // scene.events.removeListener(Phaser.Scenes.Events.UPDATE, this.onSceneUpdate)\n    scene.events.on(Phaser.Scenes.Events.UPDATE, this.onSceneUpdate.bind(this))\n\n    this.setUpPuseResumeGame()\n    this.setUpCameraFollowPlayer()\n    scene.events.off('levelcompleted')\n    scene.events.on('levelcompleted', () => {\n      scene.events.emit('sounds:level_complete')\n      scene.tweens.add({\n        targets: this.music,\n        volume: 1,\n        ease: 'Linear',\n        duration: 500,\n        onComplete: () => {\n          this.music.stop()\n        },\n      });\n      scene.cameras.main.fade(3000, 0, 0)\n      scene.cameras.main.once('camerafadeoutcomplete', () => {\n        scene.levels.next()\n        scene.cameras.main.fadeIn(1000, 0, 0)\n      })\n    })\n    scene.events.removeListener('levelstart', this.onLevelStart.bind(this))\n    scene.events.addListener('levelstart', this.onLevelStart.bind(this))\n  }\n  destroy() {\n    this.music?.stop()\n    // this.music.destroy()\n    this.scene.events.off(Phaser.Scenes.Events.UPDATE)\n    this.scene.events.off('levelstart')\n  }\n  onLevelStart() {\n    if(this.scene.levels.current.id === 'level_6') {\n      this.music = this.scene.sound.add('escape_music', { loop: true, valume: 0 })\n      \n    }else {\n      if(this.scene.levels.current.id.includes('level_')) {\n        this.music = this.scene.sound.add('levels_surface', { loop: true, valume: 0 })\n      }\n    }\n    this.music.play()\n    // music.volume = 0\n    this.scene.tweens.add({  \n      targets: this.music,\n      volume: 1,\n      ease: 'Linear',\n      duration: 500,\n      onComplete: () => {\n      //   titlesMusic.pause()\n      //   scene.start(sceneId, props)\n      },\n    });\n  }\n\n  setUpCameraFollowPlayer() {\n    this.scene.events.addListener(Phaser.Scenes.Events.UPDATE, () => {\n      const cam = this.scene.cameras.main\n      const layer = this.scene.children.getByName('layer_1')\n      if (!layer) {\n        return false\n      }\n      const { tilemap: map } = layer\n      const {x, y} = this.scene.levels.current.getPlayerPos()\n      if (cam && map) {\n        var smoothFactor = 0.9;\n  \n        cam.scrollX = smoothFactor * cam.scrollX + (1 - smoothFactor) * (map.tileToWorldX(x) - cam.width * 0.5);\n        cam.scrollY = smoothFactor * cam.scrollY + (1 - smoothFactor) * (map.tileToWorldY(y) - cam.height * 0.5);\n      }\n    })\n  }\n\n  setUpPuseResumeGame() {\n    this.scene.input.keyboard.removeListener('keydown', this.onKeyDown.bind(this))\n    this.scene.input.keyboard.addListener('keydown', this.onKeyDown.bind(this))\n  }\n  onKeyDown(event) {\n    const pauseGame = () => {\n      this.scene.levels.current.pause()\n      this.scene.events.emit('game_paused')\n    }\n    const resumeGame = () => {\n      this.scene.levels.current.resume()\n      this.scene.events.emit('game_resumed')\n    }\n    if(event.key === 'Escape') {\n      const action = this.scene.levels.current.isPaused ? resumeGame : pauseGame\n      action()\n    }\n  }\n\n  onSceneUpdate(time, delta) {\n    this.timer += delta\n    if (this.timer >= this.worldTickFreq) {\n      while (this.timer > this.worldTickFreq) {\n          this.timer -= this.worldTickFreq\n      }\n      this.scene.levels.current.gravityLoop()\n    }\n  }\n}\n","import Phaser from 'phaser'\nimport { TILES_BY_SCREEN, TILE_SIZE, TICK_TIME, SCALE } from '../utils/constants';\nimport LevelManager from '../components/LevelManager'\nimport Rules from '../components/Rules'\nimport UI from '../components/UI'\nimport CRTFilter from '../utils/CRTShaderFX'\n\nexport default class GameScene extends Phaser.Scene {\n  constructor () {\n    super('GameScene');\n    \n  }\n\n  create(data = {}) {\n    this.cameras.main.setPostPipeline(CRTFilter);\n    this.data.set('custom_scale', SCALE)\n\n    this.game.scale.scaleMode = Phaser.Scale.RESIZE\n    this.handleScales()\n    this.createAnimations()\n    this.levels = new LevelManager(this, data.level)\n\n    this.cameras.main.fadeIn(1000, 0, 0, 0)\n    this.rules = new Rules(this)\n    this.ui = new UI(this)\n    this.events.on(Phaser.Scenes.Events.SHUTDOWN, () => {\n      this.rules.destroy()\n      this.ui.destroy()\n    })\n  }\n\n  \n  handleScales() {\n    const SCALE = this.data.get('custom_scale')\n    const scalables = new Map()\n    this.clearScalables = () => void scalables.clear()\n      this.removeFromScalables = el => scalables.delete(el)\n      this.addToScalables = (el, coords) => {\n        el.setScale(SCALE)\n        scalables.set(el, coords)\n      }\n      this.updateScale = scale => {\n        scalables.forEach((coords, el) => el?.setScale(scale))\n      }\n      window.addEventListener('resize', () => {\n        const scale = Math.round((window.innerWidth/TILES_BY_SCREEN * 100 / TILE_SIZE/100)*100)/100\n        const layer = this.children.getByName('layer_1')\n        if(!layer) {\n          return false\n        }\n        const { tilemap: map } = layer\n        layer.setScale(scale)\n        // this.children.list.forEach(el => {\n        //   if(el.type === 'TilemapLayer') {\n        //     el.setScale(scale)\n        //   }\n        // })\n        this.levels.current.objects.forEach((rows, y) => {\n          rows.forEach((obj, x) => {\n            if(obj.alien) {\n              obj.alien.setScale(scale)\n              obj.alien.x = map.tileToWorldX(x)\n              obj.alien.y = map.tileToWorldY(y)\n            }\n          })\n        })\n        const camera = this.cameras.main\n        camera.setBounds(0, 0, layer.width * layer.scaleX, layer.height * layer.scaleY);\n      })\n  }\n\n  createAnimations() {\n    this.anims.create({\n      key: 'boulder_roll_right',\n      frames: this.anims.generateFrameNumbers('boulder', { frames: [ 0, 1, 2, 0 ] }),\n      frameRate: 12,\n      repeat: 0\n    })\n    this.anims.create({\n      key: 'boulder_roll_left',\n      frames: this.anims.generateFrameNumbers('boulder', { frames: [ 0, 2, 1, 0 ] }),\n      frameRate: 12,\n      repeat: 0\n    })\n    this.anims.create({\n      key: 'boulder_idle',\n      frames: this.anims.generateFrameNumbers('boulder', { frames: [ 0 ] }),\n      frameRate: 1,\n      repeat: 0\n    })\n    this.anims.create({\n      key: 'diamond_idle',\n      frames: this.anims.generateFrameNumbers('pickables', { frames: [ 0 ] }),\n      frameRate: 1,\n      repeat: 0\n    })\n    this.anims.create({\n      key: 'mushroom_idle',\n      frames: this.anims.generateFrameNumbers('pickables', { frames: [ 3 ] }),\n      frameRate: 1,\n      repeat: 0\n    })\n    this.anims.create({\n      key: 'pickaxe_idle',\n      frames: this.anims.generateFrameNumbers('pickables', { frames: [ 6 ] }),\n      frameRate: 1,\n      repeat: 0\n    })\n    this.anims.create({\n      key: 'brave_idle',\n      frames: this.anims.generateFrameNumbers('brave', { frames: [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 2, 2, 2, 2, 2, 2, 2, 0 ] }),\n      frameRate: 4,\n      repeat: -1\n    })\n    this.anims.create({\n      key: 'brave_run',\n      frames: this.anims.generateFrameNumbers('brave', { frames: [ 3, 4, 5, 3 ] }),\n      frameRate: (1000/TICK_TIME) * 4,\n      repeat: 0\n    })\n    this.anims.create({\n      key: 'bat_move',\n      frames: this.anims.generateFrameNumbers('bat', { frames: [ 0, 0, 1, 1, 2, 2, 2, 2, 1, 1 ] }),\n      frameRate: (1000/TICK_TIME) * 5,\n      repeat: -1\n    })\n    this.anims.create({\n      key: 'closeUp_Mary',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 0 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Marduk',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 1 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Dwarf',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 2 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Tiamat',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 3 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Pickaxe',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 4 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Mushroom',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 5 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Diamond',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 6 ] }),\n      repeat: 0,\n    })\n  }\n}","import Phaser from 'phaser'\nimport { SCALE, TILES_BY_SCREEN, TILE_SIZE } from '../utils/constants'\nimport CRTFilter from '../utils/CRTShaderFX'\nimport UI from '../components/UI'\n\nexport default class ConnectorScene extends Phaser.Scene {\n  constructor () {\n    super('ConnectorScene');\n  }\n  \n  preload () {\n    \n  }\n\n  createAnimations() {\n    this.anims.create({\n      key: 'closeUp_Mary',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 0 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Marduk',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 1 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Dwarf',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 2 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Tiamat',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 3 ] }),\n      repeat: 0,\n    })\n  }\n  getMusicFromName(name) {\n    switch(name) {\n      case 'cinematic_1':\n        return 'swarf_chat_music'\n      default:\n        return 'generic_chat_music'\n    }\n  }\n  \n  getImageByName(name) {\n    let image, scaleX, scaleY, scale\n    switch(name) {\n      default:\n      case 'cinematic_1':\n        image = this.add.image(this.cameras.main.width / 2, this.cameras.main.height / 1.5, 'Tiamat')\n        scaleX = this.cameras.main.width / image.width\n        scaleY = this.cameras.main.height / image.height\n        scale = Math.max(scaleX, scaleY)\n        image.setScale(scale * 4).setScrollFactor(0)\n        break\n      case 'cinematic_last':\n        image = this.add.image(this.cameras.main.width /2, this.cameras.main.height/2, 'Tiamat')\n        scaleX = this.cameras.main.width / image.width\n        scaleY = this.cameras.main.height / image.height\n        scale = Math.max(scaleX, scaleY)\n        image.setScale(scale).setScrollFactor(0)\n        break\n      case 'cinematic_last_2':\n        image = this.add.image(this.cameras.main.width /2, this.cameras.main.height/2, 'thechild')\n        scaleX = this.cameras.main.width / image.width\n        scaleY = this.cameras.main.height / image.height\n        scale = Math.max(scaleX, scaleY)\n        image.setScale(scale).setScrollFactor(0)\n        break\n    }\n    return image\n  }\n  create({id, name}) {\n    this.currentLevel = id\n    this.createAnimations()\n    const musicName = this.getMusicFromName(name)\n    this.environmentMusic = this.sound.add(musicName, { loop: true });\n    this.environmentMusic.play();\n\n    new UI(this, true)\n\n    this.cameras.main.setPostPipeline(CRTFilter);\n    let image = this.getImageByName(name)\n    image.name = 'background_art'\n\n    this[`showDialogLevel_${name}`]()\n    \n  }\n  showDialogLevel_cinematic_escape() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => false,\n        resume: () => {\n          setTimeout(() => {\n            this.environmentMusic.stop()\n            // this.environmentMusic.destroy()\n            this.cameras.main.fade(1000, 0, 0, 0)\n            this.cameras.main.once('camerafadeoutcomplete', () => void this.scene.start('GameScene', { level: this.currentLevel + 1 }))\n          }, 1000);\n        }\n      }\n    }\n\n    this.events.emit('dialogue:show', {\n      participants: ['closeUp_Marduk', 'closeUp_Mary'],\n      conversation: [\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"Do you feel it Mary?\",\n            \"Do you feel her presence\",\n            \"below?\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n             \"I do... But what\",\n             \"does it mean?\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n             \"That I do not know... But\",\n             \"it does not portend well.\",\n             \"I have learned so much in\",\n             \"so little time. Mary...I\",\n             \"can’t recognize the man\",\n             \"I once was. I felt\",\n             \"bound by obligation,\",\n             \"I was trapped, Mary.\"\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n             \"It is time, Marduk\",\n             \"we have to escape\",\n             \"from here before\",\n             \"Tiamat stops us\",\n             \" \",\n             \"go!!!\"\n          ]\n        },\n      ]\n    })\n\n  }\n\n  showDialogLevel_cinematic_last_2() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => {\n          this.tweens.add({\n            targets: this.children.getByName('background_art'),\n            alpha: 0,\n            duration: 500,\n            onComplete: () => {\n              const img = this.getImageByName('cinematic_last_2')\n              img.alpha = 0\n              this.tweens.add({\n                targets: img,\n                alpha: 1,\n                duration: 500,\n              })\n            }\n          })\n        },\n        resume: () => {\n          setTimeout(() => {\n            this.tweens.add({\n              targets:this.environmentMusic,\n              valume: 0,\n              duration: 500,\n            })\n            \n            this.cameras.main.fade(1000, 0, 0, 0)\n            this.cameras.main.once('camerafadeoutcomplete', () => void this.scene.start('CreditsScene'))\n          }, 1000);\n        }\n      }\n    }\n    this.events.emit('dialogue:show', {\n      participants: ['closeUp_Marduk', 'closeUp_Dwarf'],\n      conversation: [\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n             \"That's not how things work\",\n             \"where I come from. Marduk,\",\n             \"You have been preparing\",\n             \"for this moment since\",\n             \"your life began. Do you\",\n             \"have the courage to\",\n             \"forge your own destiny?\",\n          ]\n        },\n      ]\n    })\n    \n  }\n  showDialogLevel_cinematic_last() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => false,\n        resume: () => {\n          setTimeout(() => {\n            this.showDialogLevel_cinematic_last_2()\n            // this.cameras.main.fade(1000, 0, 0, 0)\n            // this.cameras.main.once('camerafadeoutcomplete', () => void this.scene.start('GameScene', { level: this.currentLevel + 1 }))\n          }, 1000);\n        }\n      }\n    }\n\n    this.events.emit('dialogue:show', {\n      participants: ['closeUp_Marduk', 'closeUp_Tiamat'],\n      conversation: [\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"How could you do this? We\",\n            \"are your creations. This\",\n            \"is your land. How could\",\n            \"you lie to us!?\",\n            \"Why have you forsaken us?\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n            \"Life is a cycle. The\",\n            \"catalyst comet is a part\",\n            \"of this cycle: I did not\",\n            \"lie when I said the Comet\",\n            \"was the source of the\",\n            \"earthquakes.\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n             \"However: I am a force of\",\n             \"this world. It is through\",\n             \"my actions that things\",\n             \"occur. I am bound to the\",\n             \"will of the comet: for\",\n             \"truly we are one. I am\",\n             \"nature: and this...is\",\n             \"within my nature.\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n             \"I may have created\",\n             \"everything, yet still:\",\n             \"there was a natural order\",\n             \"to life that preceded me.\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n             \"You are finite in your\",\n             \"perspective Marduk.\",\n             \"Death signifies new\",\n             \"beginnings.\",\n             \" \",\n             \"This is Destiny.\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n             \"Who would accept a fate\",\n             \"such as this? We have done\",\n             \"no wrong. We worship and\",\n             \"revere you. We are your\",\n             \"children! Would you\",\n             \"really destroy us?\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n            \"The end was written\",\n            \"in the beginning.\",\n            \"Fate cannot be rewritten.\"\n          ]\n        },\n      ]\n    })\n  }\n  showDialogLevel_cinematic_1() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => false,\n        resume: () => {\n          setTimeout(() => {\n            this.tweens.add({\n              targets: this.environmentMusic,\n              volume: 0,\n              duration: 500,\n            })\n            this.cameras.main.fade(1000, 0, 0, 0)\n            this.cameras.main.once('camerafadeoutcomplete', () => void this.scene.start('GameScene', { level: this.currentLevel + 1 }))\n          }, 1000);\n        }\n      }\n    }\n    this.events.emit('dialogue:show', {\n      participants: ['closeUp_Mary', 'closeUp_Marduk', 'closeUp_Dwarf'],\n      conversation: [\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"There you are! I was\",\n            \"worried about you!\",\n            \"Are you okay?\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"- marduk has been crying -\",\n            \"Thank Tiamat You’re here!\",\n            \"I made a mistake. I ate\",\n            \"one of the mushrooms. I\",\n            \"don’t feel well…I think I\",\n            \"broke my leg falling from\",\n            \"the surface.\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"Are you going to\",\n            \"throw up!?\",\n            \"Can you stand?\",\n          ]\n        },{\n          who: 'closeUp_Marduk',\n          text: [\n            \"No….I don’t think so.\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"What are we going to do\",\n            \"with you.\",\n          ]\n        },\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n            \"You know…..there's\",\n            \"nothing wrong with being\",\n            \"sad or afraid. It’s\",\n            \"nature's way of guiding\",\n            \"us towards a brighter\",\n            \"future.\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"WHAT ON EARTH IS THAT!?\",\n            \"Don’t patronize me foul\",\n            \"beast.\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"You really need to learn\",\n            \"when to shut your mouth.\",\n            \"Marduk. You have become\",\n            \"rude & foul tempered.\",\n          ]\n        },\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n            \"I mean he’s right.\",\n            \"I am a monster.\",\n            \"I'm... different.\"\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"You don’t seem like\",\n            \"a monster to me.\",\n          ]\n        },\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n            \"That’s because we're\",\n            \"going to make a deal\"\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"I don’t make deals with...\",\n            \"your kind...\",\n          ]\n        },\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n            \"But You Will...in time...\",\n            \"things change. People grow.\",\n            \"Even you Marduk. I think\",\n            \"we could be great friends.\",\n            \"In Fact. It Is Prophecy\",\n          ]\n        }\n      ]\n    }) \n  }\n}\n","import Phaser from 'phaser'\nimport { SCALE, TILES_BY_SCREEN, TILE_SIZE } from '../utils/constants'\nimport CRTFilter from '../utils/CRTShaderFX'\nimport UI from '../components/UI'\n\nexport default class IntroScene extends Phaser.Scene {\n  constructor () {\n    super('CreditsScene');\n  }\n\n  create() {\n    this.normalDayMusic = this.sound.add('opening_peace', { loop: true })\n    this.normalDayMusic.play();\n\n    this.cameras.main.setPostPipeline(CRTFilter);\n    let image = this.add.image(this.cameras.main.width / 2, this.cameras.main.height / 2, 'theworld')\n    let scaleX = this.cameras.main.width / image.width\n    let scaleY = this.cameras.main.height / image.height\n    let scale = Math.max(scaleX, scaleY)\n    image.setScale(scale).setScrollFactor(0)\n    image.name = 'background_art'\n    image.alpha = 0\n    this.tweens.add({\n      targets: image,\n      alpha: 1,\n      duration: 5000,\n    })\n    const line1 = this.add.text(80, 10, \"THE END\",\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"10px\",\n        fill: \"#ffffff\",\n      }\n    ).setScale(scaleX * 2).setPosition(2 * scaleX, this.cameras.main.height - 20 * 4 * scaleY)\n    line1.displayHeight = 10 * scaleY\n    const line2 = this.add.text(80, 10, \"Thanks for playing\",\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"10px\",\n        fill: \"#ffffff\",\n      }\n    ).setScale(scaleX * 0.9).setPosition(2 * scaleX, this.cameras.main.height - 10 * 3 * scaleY)\n    line2.displayHeight = 10 * scaleY\n  }\n}","import Phaser from 'phaser'\nimport Canvas from './libs/react-phaser-fiber/components/Canvas'\nimport MenuScene from './scenes/MenuScene'\nimport IntroScene from './scenes/IntroScene'\nimport GameScene from './scenes/GameScene'\nimport ConnectorScene from './scenes/ConnectorScene'\nimport CreditsScene from './scenes/CreditsScene'\nimport CRTFilter from './utils/CRTShaderFX'\n\nconst gameConfig = {\n  width: \"100%\",\n  height: \"100%\",\n  type: Phaser.AUTO,\n  backgroundColor: '#000000',\n  disableContextMenu: true,\n  pixelArt: true,\n  roundPixels: false,\n  scene: [MenuScene, IntroScene, GameScene, ConnectorScene, CreditsScene],\n  pipeline: { CRTFilter }\n}\nfunction Game() {\n  return (\n    <Canvas args={gameConfig} />\n  );\n}\n\nexport default Game;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Game from './Game';\nimport reportWebVitals from './reportWebVitals';\nimport config from '../package.json'\n\nReactDOM.render(\n  <React.StrictMode>\n    <Game />\n    <div style={{\n      position: 'absolute',\n      bottom: 0,\n      right: 0,\n      fontSize: 10,\n      color: 'gray'\n    }}>v{config.version}</div>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}