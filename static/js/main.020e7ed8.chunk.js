(this.webpackJsonplostcartridgejam3=this.webpackJsonplostcartridgejam3||[]).push([[0],{11:function(module,__webpack_exports__,__webpack_require__){"use strict";var DB_NAME="data",DB_INITIAL_STATE={totalShroomsAmount:0,tripDone:!1},memDB=DB_INITIAL_STATE,bootUp=function(){var e=window.localStorage.getItem(DB_NAME)||"";return memDB=""!==e?JSON.parse(e):DB_INITIAL_STATE},persist=function(){return window.localStorage.setItem(DB_NAME,JSON.stringify(memDB))},get=function get(key){return eval("memDB.".concat(key))},set=function(e,t){switch(typeof t){case"string":safeSet(e,"`".concat(t,"`"));break;case"number":case"boolean":safeSet(e,t);break;default:case"object":safeSet(e,"JSON.parse(`".concat(JSON.stringify(t),"`)"))}persist()},reset=function(){memDB=DB_INITIAL_STATE,persist()},safeSet=function safeSet(key,value){return eval("memDB.".concat(key," = ").concat(value))},getLevels=function(){return Object.keys(memDB).map((function(e){return e.includes("level_")?memDB[e]:null})).filter(Boolean)};bootUp(),__webpack_exports__.a={get:get,set:set,reset:reset,getLevels:getLevels}},31:function(e){e.exports=JSON.parse('{"menu":{"main":{"loading_message":"LOADING... PLEASE WAIT","option_new":"New Game","option_continue":"Continue","yes":"Yes","no":"No","on":"On","off":"Off","english":"English","spanish":"Spanish","heading_scrore":"level        gems   threats   shrooms   comp","score_gems":"gems","score_enemies":"threats","score_shrooms":"shrooms","score_comp":"comp","score_best":"best","score_op_next":"next","score_op_repeat":"repeat","score_op_exit":"exit","chamber":"chamber","ruins":"ruins"},"dialog_options":{"close":"close","story":"story","next":"next","yes":"yes","no":"no"}},"intro":{"story_page_1":{"line_1":"In the beginning: There was nothing,","line_2":"except for the goddess Tiamat"},"story_page_2":{"line_1":"she formed the world as she pleased","line_2":"Giving life to the sumarian people,","line_3":"creating them in her image"},"story_page_3":{"line_1":"The ancient land of Sumaria. An","line_2":"eternal paradise where immortal","line_3":"beings live in infinite harmony"},"dialog_1":{"tiamat_say_1":"My beloved: why do you call for me?","mary_say_1":"Our lord. A mysterious comet dashes across the sky. Our land has been ravaged by monstrous quakes, mysterious holes have been appearing, those who fall in never return. Please my lady, calm the earth.","tiamat_say_2":"The Catalyst Comet. It appears once every 2,533 years. I do not control its path. With it\'s coming, calamity strikes","mary_say_2":"We, your children, beseech thee. Guide us towards a resolution that might save our people.","tiamat_say_3":"Nothing you can do but accept your fate.","marduk_say_1":"Yes, We must accept our destiny.","mary_say_3":"But Lord, I\'m begging you, there must be something we can do for you to deliver us from evil.","tiamat_say_4":"hummm... Listen carefully, I will say it only once.","tiamat_say_5":"The Guardian ventures within the holes created in the earth, Discover the purpose of these mushrooms that now proliferate the land. Collect them and deliver them to me at the core of the planet.","tiamat_say_6":"Perhaps within these mysterious objects lies a solution to the terrors of The Catalyst Comet."},"dialog_2":{"marduk_say_1":"-Sigh- It is a man\'s duty I suppose.","mary_say_1":"Then I shall accompany you: There is safety in numbers.","marduk_say_2":"Nonsense. How would a frail priestess be of any benefit?","mary_say_2":"I am not frail. I am actually well versed in digging. The maintenance of the church keeps my mind and body active.","marduk_say_3":"I am a man, to endanger a woman\'s life by accepting her aid in such a perilous task would disgrace me.","mary_say_3":"But come to your senses. Let me help you. There are greater things at stake than your pride.","marduk_say_4":"I don\'t need your help."},"story_page_4":{"line_1":"A fissure opens up beneath Marduk","line_2":"and he falls into"},"story_page_5":{"line_1":"Mary rolls her eyes...","line_2":"and jumps in after his brother"}},"stage_1":{"title":"STAGE 1: KI"},"levels":{"goal_dialog":{"dwarf_say_1":"REMEMBER, I NEED ${GOAL} DIAMONDS. YOU ONLY HAVE ${NUM}"}},"level_1":{"dialog_1":{"mary_say_1":"What a mysterious place. Marduk can\'t be far from here. I WILL WALK A LITTLE AND SEE IF I FIND HIM."},"dialog_2":{"mary_say_1":"THIS DOESN\'T LOOK QUITE NATURAL. IT\'S LIKE SOMEONE PUT IT HERE FOR A REASON."}},"level_2":{"dialog_1":{"mary_say_1":"MARDUUUUUK!!!! I can\'t see him. But I\'m sure I can push those boulders for a better view."},"dialog_2":{"mary_say_1":"What a beautiful gem, I will keep it."}},"level_3":{"dialog_1":{"mary_say_1":"those flying creatures look dangerous, better if i don\'t touch them. i will scare them away with a boulder."},"dialog_4":{"mary_say_1":"This thing is incredible!, I cut through earth like butter."},"discarded_dialog_3":{"mary_say_1":"Oops! hope I haven\'t bothered anybody."}},"level_4":{"dialog_1":{"mary_say_1":"WOW! THOSE QUAKES CAN BE DENGEROUS DOWN HERE"}},"level_5":{"dialog_1":{"mary_say_1":"Hey! Who are you?.","dwarf_say_1":"That\'s my pickaxe, give it back to me.","mary_say_2":"No. I found it back there and I need it.","dwarf_say_2":"But it\'s mine... Look, I shouldn\'t even be talking to you. I better go.","mary_say_3":"Wait! come here a moment."}},"level_6":{"dialog_1":{"mary_say_1":"YOU AGAIN! LOOK, I CAN\'T GIVE YOUR PICKAXE BACK.","dwarf_say_1":"THERE ARE BIGGER ISSUES THAN THAT... THEY KNOW YOUR ARE DOWN HERE.","mary_say_2":"WHO KNOWS?","dwarf_say_2":"THEY HAVE SENT ANGELS TO BLOCK THE ENTRANCE OF KI\'S CHAMBERS. YOU WILL NOT ADVANCE.","mary_say_3":"I MUST FIND THE WAY, TELL ME HOW CAN I AVOID THEM.","dwarf_say_3":"YOU WON\'T MAKE IT ALONE, BUT I CAN  HELP YOU, IN EXCHANGE OF...","mary_say_4":"NOT THE PICKAXE. PERIOD.","dwarf_say_4":"...I CAN LEND YOU MY PICKAXE AND MOVE THE ANGELS AWAY FROM THE PATH, ONLY IF YOU CAN COLLECT ENOUGH GEMS FOR ME.","dwarf_say_5":"GET ME 10 JEWELS IN THIS CHAMBER AND I WILL CLEAR THE WAY FOR YOU.","mary_say_5":"Deal!"},"dialog_2":{"mary_say_1":"THE ANGEL BLOCKING MY PATH."},"dialog_3":{"mary_say_1":"WELL, I GOT YOUR JEWELS. BY THE WAY, DO YOU HAVE A NAME?","dwarf_say_1":"MY NAME IS SHMERIDOCK","mary_say_2":"I WILL CALL YOU \'DOC\'... AND YOU CAN CALL ME MARY","dwarf_say_2":"I KNOW THAT. NOW, LET ME HONOUR MY WORD"},"dialog_4":{"dwarf_say_1":"REMEMBER, I NEED 10 DIAMONDS TO CLEAR THE WAY. YOU ONLY HAVE ${NUM}"}},"level_8":{"dialog_1":{"mary_say_1":"DOC, I\'M GLAD TO SEE YOU HERE. I WAS WONDERING IF YOU CAN GUIDE ME TO FIND MARDUK. CAN YOU?","dwarf_say_1":"I CAN, I JUST NEED SOME EXTRA ENERGY. GIVE ME ONE SHROOM AND I WILL UNLEASH MY POWER TO HELP YOU","mary_say_2":"I DON\'T KNOW DOC. THESE SHROOMS ARE FOR MARDUK TO FULFILL TIAMAT COMMAND. LET ME THINK...","mary_say_3_yes":"HERE, TAKE IT AND HOPE YOU CAN FIND HIM","mary_say_3_no":"NO, SHROOMS ARE NOT FOR YOU, THEY ARE FOR MARDUK, I JUST DON\'T KNOW HOW TO FIND HIM"},"dialog_1_option":{"yes":"YES, GIVE A SHROOM","no":"NO, KEEP THE SHROOM"},"dialog_1_no_shrooms":{"mary_say_1":"DOC, I\'M GLAD TO SEE YOU HERE. I WAS WONDERING IF YOU CAN GUIDE ME TO FIND MARDUK. CAN YOU?","dwarf_say_1":"I CAN, I JUST NEED SOME EXTRA ENERGY. IF YOU ONLY HAD A SHROOM, I WOULD UNLEASH MY POWER TO HELP YOU","mary_say_2":"I\'M SURE I SAW SOME OF THEM IN PREVIOUS CHAMBERS, I\'LL BACK THERE AND GET ONE FOR YOU","dwarf_say_2":"GO BACK TO CHAMBER ${NUM}, MUST BE A SHROOM THERE"},"dialog_1_repeat":{"dwarf_say_1":"SO, HAVE YOU CHANGED YOUR MIND?","mary_say_1":"MMM...","mary_say_2_yes":"HERE, TAKE IT AND HOPE YOU CAN FIND HIM","mary_say_2_no":"NO, SHROOMS ARE NOT FOR YOU, THEY ARE FOR MARDUK, I JUST DON\'T KNOW HOW TO FIND HIM"},"dialog_1_no_shrooms_repeat":{"dwarf_say_1":"SO, ARE YOU GOING TO GET THAT SHROOM?","mary_say_1":"YES, I WANT TO FIND MARDUK","dwarf_say_2":"GO BACK TO CHAMBER ${NUM}, MUST BE A SHROOM THERE"},"dialog_2":{"dwarf_say_1":"THERE YOU ARE... HELLO MARDUK","marduk_say_1":"WHAT ON EARTH IS THAT!? DON\'T EAT ME FOUL BEAST","dwarf_say_2":"THERE\'S NO NEED TO BE RUDE JUST BECAUSE I\'M DIFFERENT","marduk_say_2":"DON\'T PATRONIZE ME MONSTER AND REVEAL YOUR TRUE INTENTIONS","dwarf_say_3":"I\'M HERE TO HELP YOUR SISTER TO FIND YOU, SHE IS VERY WORRIED ABOUT YOU.","marduk_say_3":"THIS CAN\'T BE HAPPENING. HOW CAN I TRUST YOU? WHAT EVEN ARE YOU? WHERE DID YOU COME FROM?","dwarf_say_4":"I HAVE MANY NAMES. I HAVE BORN FROM DEEP WITHIN THE EARTH, CALLED TO LIFE BY THE FIRE ITSELF.","dwarf_say_5":"IF YOU ARE MORE OPEN, I CAN HELP YOUR SISTER AND YOU AS WELL.","marduk_say_4":"WHAT KIND OF FOUL NIGHTMARE IS THIS! I DON\'T MAKE DEALS WITH... YOUR KIND","dwarf_say_6":"BUT YOU WILL... IN TIME... THINGS CHANGE. PEOPLE GROW. EVEN YOU MARDUK. I THINK WE COULD BE GREAT FRIENDS. IN FACT. IT IS PROPHECY","dwarf_say_7":"I ALREADY HAVE WHAT I CAME FOR, NOW I CAN HELP MARY TO FIND YOU. GOOD BYE MARDUK..."},"dialog_3":{"mary_say_1":"SO!? HAVE YOU FOUND HIM? IS HE FINE?","dwarf_say_1":"YES MARY, BUT DIDN\'T EXPECT SUCH A RUDE AND FOUL TEMPERED PERSON","mary_say_2":"-SIGHT- HE REALLY NEEDS TO LEARN WHEN TO SHUT HIS MOUTH. YOU HAVE BEEN VERY KIND DOC, CAN YOU TELL ME WHERE I CAN FIND MY BROTHER?","dwarf_say_2":"THAT\'S HOW IT SHOULD BE MARY, FOLLOW THE LION HEAD ENTRANCE, I\'LL WAIT FOR YOU IN THE NEXT CHAMBER. NOW I NEED TO REST A MOMENT..."}},"level_10":{"dialog_1":{"mary_say_1":"WHAT IS THIS PLACE, DOC?","dwarf_say_1":"THIS USED TO BE A STRONGHOLD, THE BULWARK OF A BEAUTIFUL DWARF CITY"},"dialog_2":{"mary_say_1":"USED TO BE? WHAT HAPPENED?..."},"dialog_3":{"dwarf_say_1":"GET ME ${NUM} DIAMONDS MARY, THAT WAY I CAN CLEAR THE PATH."}},"level_11":{"dialog_1":{"mary_say_1":"DOC, ARE YOU OK? I SEE YOU EMOTIONAL, IS THIS SOMEHOW SPECIAL FOR YOU?","dwarf_say_1":"THIS WAS MY VILLAGE ONCE. THE DWARVES PROSPERED HERE FOR AGES BEFORE THE INFIGHTING OF THE MUSHROOM WAR TORE OUR HOMELAND APART","mary_say_2":"THE MUSHROOM WAR?","dwarf_say_2":"THE DAY OF THE GREAT QUAKES: MUSHROOMS STOPPED GROWING BENEATH THE SURFACE OF THE EARTH. WE WERE LEFT ONLY WITH WHAT WE HAD SAVED FROM THE PREVIOUS YEARS","dwarf_say_3":"WITH A LIMITED SUPPLY, IT WAS ONLY A MATTER OF TIME BEFORE VIOLENCE TAINTED OUR PEACEFUL LIFESTYLE.","mary_say_3":"OH! DOC, I REALLY SORRY.","dwarf_say_4":"IT\'S NO TIME TO REGRETS. GO AHEAD MARY AND BEWARE, MANY DANGEROUS ARTIFACTS STILL REMAINS AMONG THE RUINS, AS A REMINDER OF A TROUBLED TIME"},"dialog_2":{"mary_say_1":"WOW! THAT WAS DANGEROUS. I MUST BE CAREFUL WITH THOSE BARRELS, THEY CAN EVEN BREAK THE DEBRIS."},"dialog_3":{"dwarf_say_1":"I WAS A BABY WHEN THEY TAKE ME AWAY TO PROTECT ME FROM THE FIRE AND THE HORROR. I BARELY REMEMBER THESE PLACES.","mary_say_1":"DO NOT WORRY DOC, MAY TIAMAT GUIDE MY PATH, AND PROTECT ME FROM EVIL."},"dialog_4":{"dwarf_say_1":"GET ME ${NUM} DIAMONDS MARY, THAT WAY I CAN CLEAR THE PATH."}},"level_12_x":{"dialog_1":{"mary_say_1":"THERE YOU ARE MARDUK! I WAS WORRIED ABOUT YOU!","marduk_say_1":"THANK TIAMAT YOU\'RE HERE! I DON\'T FEEL WELL.","mary_say_2":" ARE YOU OKAY? HAVE YOU BEEN CRYING?","marduk_say_2":"MEN DON\'T CRY MARY... THOUGH I THINK I BROKE MY LEG FALLING FROM THE SURFACE.","mary_say_3":"CAN YOU WALK?","marduk_say_3":"I GUESS SO. WHAT ARE WE GOING TO DO?","mary_say_4":"JUST WAIT THERE FOR ME MARDUK, I\'M COMING TO HELP YOU. DON\'T BE AFRAID","marduk_say_4":"I CANT\'T BE AFRAID, I MUST GO ON.","mary_say_5":"JUST LISTEN TO ME THIS TIME, WAIT THERE, WE WILL SOLVE THIS OUT TOGETHER.","marduk_say_5":"FINE, I WON\'T BE FAR."},"dialog_2":{"mary_say_1":"DOC, I SAW MARDUK!, HE IS NEAR TO A WALL WITH THE WORD SHAMASH WRITTEN ON IT.","dwarf_say_1":"I KNOW THE WAY, FOLLOW ME."}},"maze_1":{"dialog_1":{"dwarf_say_1":"THIS IS A HUGH MESS, ONLY FOUNDATIONS WERE LEFT STANDING, IS HARD TO KNOW WHERE TO GO. SOME EXTRA POWER COULD HELP US. DO YOU HAVE ONE OF YOUR SHROOMS TO ME?","mary_say_1":"I DON\'T KNOW DOC, IS IT A GOOD IDEA KEEP SPENDING THE MUSHROOMS?","mary_say_2_yes":"HERE, TAKE IT AND HOPE YOU CAN FIND THE WAY OUT","mary_say_2_no":"NO, SHROOMS ARE NOT FOR YOU, THEY ARE FOR MARDUK, I\'M GOING TO MANGE MYSELF ON FIND THE WAY","mary_say_2_empty":"I\'M SURE I SAW SOME OF THEM IN PREVIOUS CHAMBERS, I\'LL GO BACK AND GET ONE FOR YOU","dwarf_say_2_empty":"GO BACK TO CHAMBER ${NUM}, MUST BE A SHROOM THERE"},"dialog_1_option":{"yes":"YES, GIVE A SHROOM","no":"NO, KEEP THE SHROOM"},"dialog_2":{"mary_say_1":"DOC!!! SLOW DOWN PLEASE, I CAN BARELY FOLLOW YOU","dwarf_say_1":"MY APOLOGIES, I THINK I GOT TOO EXCITED"}},"level_16":{"dialog_1":{"mary_say_1":"MARDUUUK!... MARDUUUK!... THESE BOULDERS PILED UP ARE NOT MOVING ANYWHERE.","mary_say_2":"I CAN SEE HIM BREATHING FROM HERE. MAYBE HE IS UNCONSCIOUS.","mary_say_3":"WHERE IS DOC WHEN I NEED HIM? I MUST MOVE FAST, FIND DOC AND GET TO THAT SANCTUARY TO ASSIST MARDUK."},"dialog_2":{"mary_say_1":"DOC, I FOUND MARDUK!!! HE IS IN A SACTUARY NOT FAR FROM HERE.","dwarf_say_1":"OF COURSE, A SACTUARY IS WHERE I SAW HIM. I KNOW WHERE IT IS.","mary_say_2":"GO AHEAD, I FOLLOW YOU.","dwarf_say_2_diamonds":"BUT BEFORE WE GO... I NEED TO GET RID OF THE ANGEL, GET ME ${NUM} DIAMONDS FOR THAT."},"dialog_2_repeat":{"mary_say_1":"TAKE YOUR DIAMONDS, NOW GO AHEAD, I FOLLOW YOU."},"dialog_2_repeat_no_diamonds":{"dwarf_say_1":"REMEMBER MARY, GET ME ${NUM} DIAMONDS THUS WE CAN CONTINUE."},"dialog_3":{"mary_say_1":"HE WAS RIGHT HERE DOC... BUT HE ISN\'T ANYMORE, I WONDER WHERE HE COULD HAVE GONE.","dwarf_say_1":"OR WHERE COULD HAVE BEEN TAKEN TO... EITHER WAY, THERE\'S ONLY ONE POSSIBLE DIRECTION... DOWN","dwarf_say_2":"FOLLOW ME MARY!"}},"level_17":{"dialog_1":{"mary_say_1":"DOC, CAN\'T SEE ANYTHIG AHEAD. THIS PLACE IS LUGUBRIOUS","dwarf_say_1":"I HAVE A GIFT FOR YOU, TAKE THE TORCH OF ASHELBROCK. SHALL SHED LIGHT ON YOUR DESTINY."},"dialog_2":{"mary_say_1":"ARE YOU COMING DOC?","dwarf_say_1":"CATCH YOU LATER, LET ME TAKE A LOOK AT THIS MARVELOUS FLAME..."}}}')},32:function(e){e.exports=JSON.parse('{"menu":{"main":{"loading_message":"cargando... por favor espera","option_new":"Nuevo Juego","option_continue":"Continuar","yes":"Si","no":"No","on":"Si","off":"No","english":"Ingl\xe9s","spanish":"Espa\xf1ol","heading_scrore":"nivel        gemas  hostil    setas     comp","score_gems":"gemas","score_enemies":"hostil","score_shrooms":"setas","score_comp":"comp","score_best":"mejor","score_op_next":"siguiente","score_op_repeat":"repetir","score_op_exit":"salir","chamber":"RECINTO"},"dialog_options":{"close":"cerrar","story":"historia","next":"m\xe1s","yes":"si","no":"no"}},"intro":{"story_page_1":{"line_1":"En un comienzo: no hubo nada m\xe1s","line_2":"que la diosa Tiamat"},"story_page_2":{"line_1":"ella hizo el mundo a su antojo","line_2":"creando al pueblo sumerio","line_3":"a su imagen y semejanza"},"story_page_3":{"line_1":"La ancestral tierra de Sumeria,","line_2":"para\xedso eterno de seres inmortales","line_3":"viviendo en infinita armon\xeda"},"dialog_1":{"tiamat_say_1":"MIS AMADOS: \xbfPOR QU\xc9 ME HAN INVOCADO?","mary_say_1":"NUESTRA SE\xd1ORA. UN MISTERIOSO COMETA SURCA EL CIELO. MONSTRUOSOS TERREMOTOS DEVASTAN LA TIERRA, MISTERIOSOS HOYOS APARECEN, LOS QUE CAEN EN ELLOS JAM\xc1S REGRESAN. POR FAVOR MI SE\xd1ORA, CALMA LA TIERRA. DANOS PAZ.","tiamat_say_2":"EL COMETA CATALIZADOR. APARECE CADA 2,533 A\xd1OS. YO NO CONTROLO SU PASO. CON SU LLEGADA, TAMBI\xc9N LLEGAN CALAMIDADES","mary_say_2":"NOSOTROS, TUS HIJOS, TE SUPLICAMOS. GU\xcdANOS HACIA UNA SALIDA QUE PUEDA SALVAR A NUESTRA GENTE.","tiamat_say_3":"NADA PUEDEN HACER M\xc1S QUE ACEPTAR SU DESTINO.","marduk_say_1":"SI, ACEPTEMOS NUESTRO DESTINO.","mary_say_3":"PERO MI SE\xd1ORA, DEBE HABER ALGO QUE PODAMOS OFRECERLE PARA QUE USTED NOS LIBERE DEL MAL.","tiamat_say_4":"MMMM... PRESETEN ATENCI\xd3N, S\xd3LO SER\xc1 DICHO UNA VEZ.","tiamat_say_5":"EL GUARDI\xc1N DEBE AVENTURARSE HACIA LOS AGUJEROS CREADOS EN LA TIERRA, DESCUBRIR EL PR\xd3SITO DE LOS HONGOS QUE AHORA PROLIFERAN LA SUPERFICIE. RECOLECTARLOS Y ENCONTRARME EN EL CENTRO DEL PLANETA.","tiamat_say_6":"QUIZ\xc1S EN ESTOS MISTERIOSOS OBJETOS YACE LA SOLUCI\xd3N AL TERROR DEL COMETA CATALIZADOR."},"dialog_2":{"marduk_say_1":"-UFF- ES LA OBLIGACI\xd3N DE UN HOMBRE SUPONGO.","mary_say_1":"ENTONCES TE HAR\xc9 COMPA\xd1\xcdA, M\xc1S ES MEJOR.","marduk_say_2":"TONTER\xcdAS. \xbfC\xd3MO PUEDE SER \xdaTIL UNA FR\xc1GIL SACERDOTISA?","mary_say_2":"NO SOY FR\xc1GIL. DE HECHO, SOY MUY H\xc1BIL CAVANDO. CONSERVAR LA CAPILLA ME MANTIENE ACTIVA EN CUERPO Y MENTE.","marduk_say_3":"PERO YO SOY UN HOMBRE, PONER EN RIESGO LA VIDA DE UNA MUJER ACEPTANDO SU AYUDA, EN UNA TAREA TAN PELIGROSA, ME DESHONRAR\xcdA.","mary_say_3":"\xa1RECAPACITA!. D\xc9JAME AYUDARTE. HAY COSAS M\xc1S GRANDES EN JUEGO QUE TU ORGULLO.","marduk_say_4":"NO NECESITO TU AYUDA..."},"story_page_4":{"line_1":"UNA FISURA SE ABRE BAJO MARDUK","line_2":"Y \xc9L CAE DENTRO"},"story_page_5":{"line_1":"MARY VOLTEA SUS OJOS...","line_2":"Y SALTA TRAS SU HERMANO"}},"stage_1":{"title":"ESCENA 1: KI"},"levels":{"goal_dialog":{"dwarf_say_1":"RECUERDA, PRECISO ${GOAL} DIAMANTES Y TU TIENES ${NUM}"}},"level_1":{"dialog_1":{"mary_say_1":"VAYA MISTERIOSO LUGAR. MARDUK NO PUEDE ESTAR MUY LEJOS. CAMINAR\xc9 UN POCO Y VER\xc9 SI LO ENCUENTRO."},"dialog_2":{"mary_say_1":"ESTO NO SE VE MUY NATURAL. TAL VEZ ALGUIEN DECIDI\xd3 PONERLO AQU\xcd."}},"level_2":{"dialog_1":{"mary_say_1":"MARDUUUUUK!!!! NO LO VEO. PERO SEGURO PUEDO EMPUJAR ESAS ROCAS Y SEGUIR BUSCANDO."},"dialog_2":{"mary_say_1":"QU\xc9 BELLA GEMA, ME LA QUEDAR\xc9."}},"level_3":{"dialog_1":{"mary_say_1":"ESOS ENGENDROS SE VEN PELIGROSOS, MEJOR SI NO LOS TOCO. LOS ESPANTAR\xc9 CON UNA PIEDRA."},"discarded_dialog_2":{"mary_say_1":"\xa1GUAU! ESO FUE PELIGROSO. TENDR\xc9 M\xc1S CUIDADO CON ESOS BARRILES."},"discarded_dialog_3":{"mary_say_1":"\xa1UPS! ESPERO NO HABER MOLESTADO A ALGUIEN CON ESO."},"dialog_4":{"mary_say_1":"\xa1Esta cosa es incre\xedble!, puedo cortar la tierra como una hogaza de pan."}},"level_4":{"dialog_1":{"mary_say_1":"\xa1GUAU! ESOS TERREMOTOS PUEDEN SER PELIGROSOS AQU\xcd ABAJO"}},"level_5":{"dialog_1":{"mary_say_1":"\xa1EY! \xbfQUI\xc9N ERES TU?.","dwarf_say_1":"ESE ES MI PICO, DEVU\xc9LVEMELO.","mary_say_2":"NO. LO ENCONTR\xc9 ALL\xc1 ATR\xc1S Y LO NECESITO","dwarf_say_2":"PERO ES MIO... MIRA, NI SIQUIERA DEBER\xcdA ESTAR HABLANDO CON LOS DE TU CLASE. MEJOR ME VOY.","mary_say_3":"\xa1ESPERA! VEN AQU\xcd UN MOMENTO."}},"level_6":{"dialog_1":{"mary_say_1":"\xa1TU DE NUEVO! MIRA, NO PUEDO DEVOLVERTE TU PICO.","dwarf_say_1":"HAY ASUNTOS M\xc1S SERIOS... ELLOS SABEN QUE USTEDES EST\xc1N AQU\xcd ABAJO.","mary_say_2":"\xbfQUI\xc9NES LO SABEN?","dwarf_say_2":"ENVIARON \xc1NGELES A BLOQUEAR LAS ENTRADAS A LAS C\xc1MARAS DE KI. NO PRODR\xc1S AVANZAR.","mary_say_3":"DEBO ENCONTRAR LA FORMA, DIME C\xd3MO LOS EVITO.","dwarf_say_3":"SER\xc1 DIF\xcdCIL EN SOLEDAD, PERO YO PUEDO AYUDARTE A CAMBIO DE...","mary_say_4":"NO EL PICO. PUNTO FINAL.","dwarf_say_4":"...TE PRESTAR\xc9 EL PICO Y QUITAR\xc9 LOS \xc1NGELES DEL CAMINO SI ME RECOLECTAS SUFICIENTES JOYAS.","dwarf_say_5":"CONS\xcdGUEME 10 JOYAS EN ESTA C\xc1MARA Y DESPEJAR\xc9 LA SALIDA PARA TI.","mary_say_5":"\xa1HECHO!"},"dialog_2":{"mary_say_1":"EL \xc1NGEL BLOQUEANDO MI PASO."},"dialog_3":{"mary_say_1":"EL \xc1NGEL SE HA IDO, EL CAMINO EST\xc1 LIBRE."}},"level_8":{"dialog_1":{"mary_say_1":"DOC, ME ALEGRA VERTE. ME PREGUNTO SI PODR\xcdAS GUIARME PARA ENCONTRAR A MARDUK. \xbfPUEDES?","dwarf_say_1":"CLARO QUE PUEDO, S\xd3LO NECESITO ALGO DE ENERG\xcdA EXTRA. ENTR\xc9GAME UN HONGO Y LIBERAR\xc9 MI POTENCIAL PARA AYUDARTE","mary_say_2":"NO LO SE DOC. ESTOS HONGOS SON PARA QUE MARDUK CUMPLA EL MANDATO DE TIAMAT. D\xc9JAME PENSARLO...","mary_say_3_yes":"BIEN, T\xd3MALO Y ESPERO QUE PUEDAS ENCONTRARLO","mary_say_3_no":"NO, LOS HONGOS NO SON PARA TI, SON PARA MARDUK, S\xd3LO DESCONOZCO C\xd3MO ENCONTRARLO"},"dialog_1_option":{"yes":"SI, ENTREGAR UNA SETA","no":"NO, CONSERVAR LAS SETAS"},"dialog_1_no_shrooms":{"mary_say_1":"DOC, ME ALEGRA VERTE. ME PREGUNTO SI PODR\xcdAS GUIARME PARA ENCONTRAR A MARDUK. PUEDES?","dwarf_say_1":"SI PUEDO, S\xd3LO NECESITO ALGO DE ENERG\xcdA EXTRA. SI TAN S\xd3LO TUVIERAS UN HONGO, PODR\xcdA LIBERAR MI POTENCIAL PARA AYUDARTE","mary_say_2":"CREO HABER VISTO ALGUNOS EN EL CAMINO, VOLVER\xc9 ALGUNASC C\xc1MARAS ATR\xc1S Y OBTENDR\xc9 UNO PARA TI","dwarf_say_2":"VUELVE A LA C\xc1MARA ${NUM}, DEBE HABER UN HONGO ALL\xcd"},"dialog_1_repeat":{"dwarf_say_1":"ENTOCES, \xbfHAS CAMBIADO DE IDEA?","mary_say_1":"MMM...","mary_say_2_yes":"BIEN, T\xd3MALO Y ESPERO QUE PUEDAS ENCONTRARLO","mary_say_2_no":"NO, LOS HONGOS NO SON PARA TI, SON PARA MARDUK, S\xd3LO DESCONOZCO C\xd3MO ENCONTRARLO"},"dialog_1_no_shrooms_repeat":{"dwarf_say_1":"ENTONCES, \xbfVAS A CONSEGUIR ESOS HONGOS?","mary_say_1":"CLARO, NECESITO ENCONTRAR A MARDUK","dwarf_say_2":"VUELVE A LA C\xc1MARA ${NUM}, DEBE HABER UN HONGO ALL\xcd"},"dialog_2":{"dwarf_say_1":"AQU\xcd EST\xc1S... HOLA MARDUK","marduk_say_1":"\xbf\xa1QUE DEMONIOS ES ESTO!? NO ME COMAS BESTIA ASQUEROSA","dwarf_say_2":"NO HAY NECESIDAD DE SER GROSERO PORQUE SEA DIFERENTE","marduk_say_2":"NO ME SERMONEES MONSTRUO Y REVELA TUS VERDADERAS INTENCIONES","dwarf_say_3":"HE VENIDO PARA AYUDAR A TU HERMANA A ENCONTRARTE, ELLA SE PREOCUPA POR TI","marduk_say_3":"ESTO NO PUEDE ESTAR PASANDO. \xbfC\xd3MO PUEDO CONFIAR EN TI? \xbfQU\xc9 ERES? \xbfDE DONDE VIENES?","dwarf_say_4":"TENGO MUCHOS NOMBRES. HE NACIDO DE LO PROFUNDO DE LA TIERRA, LLAMADO A LA VIDA POR EL FUEGO MISMO.","dwarf_say_5":"SI ERES UN POCO M\xc1S ABIERTO, PODR\xc9 AYUDAR A TU HERMANA Y TAMBI\xc9N A TI","marduk_say_4":"\xa1QU\xc9 CLASE DE PESADILLA ES ESTA! YO NO TRATO CON... LOS DE TU TIPO","dwarf_say_6":"PERO LO HAR\xc1S... CON EL TIEMPO... LAS COSAS CAMBIAN. LA GENTE CRECE. INCLUSO T\xda MARDUK. CREO QUE PODEMOS SER GRANDES AMIGOS. DE HECHO. ES LA PROFEC\xcdA","dwarf_say_7":"YA TENGO LO QUE VINE A BUSCAR, AHORA PUEDO AYUDAR A MARY A ENCONTRARTE. ADI\xd3S MARDUK..."},"dialog_3":{"mary_say_1":"\xbf\xa1ENTOCES!? \xbfLO HAS ENCONTRADO? \xbf\xc9L ESTA BIEN?","dwarf_say_1":"SI MARY, PERO NO ESPERABA UNA PERSONA TAN GROSERA Y DE POCO TEMPLE","mary_say_2":"-PFF- NECESITA APRENDER CU\xc1NDO CERRAR LA BOCA. HAS SIDO MUY AMABLE DOC, \xbfAHORA PUEDES DECIRME D\xd3NDE ENCONTRAR A MI HERMANO?","dwarf_say_2":"AS\xcd ES COMO DEBE SER MARY, SIGUE LA SALIDA CON FORMA DE CABEZA DE LE\xd3N, TE ESTAR\xc9 ESPERANDO EN LA PR\xd3XIMA C\xc1MARA. AHORA NECESITO DESCANSAR UN MOMENTO..."}},"level_10":{"dialog_1":{"mary_say_1":"\xbfQU\xc9 ES ESTE LUGAR, DOC?","dwarf_say_1":"ESTO SOL\xcdA SER UNA FORTALEZA, EL BASTI\xd3N DE UNA HERMOSA CIUDAD ENANA"},"dialog_2":{"mary_say_1":"\xbfSOL\xcdA SER? \xbfQU\xc9 SUCEDI\xd3?..."},"dialog_3":{"dwarf_say_1":"CONS\xcdGUEME ${NUM} DIAMANTES MARY, DE ESA FORMA DESPEJAR\xc9 EL CAMINO."}},"level_11":{"dialog_1":{"mary_say_1":"DOC \xbfTE ENCUENTRAS BIEN? TE VEO CONMOVIDO, \xbfACASO ESTO ES ESPECIAL PARA TI?","dwarf_say_1":"ESTA FUE MI VILLA ALGUNA VEZ. LOS ENANOS PROSPERAMOS AQU\xcd POR SIGLOS ANTES QUE LAS BATALLAS DE LA GUERRA DE LAS SETAS DESTRUYA NUESTROS HOGARES.","mary_say_2":"\xbfLA GUERRA DE LAS SETAS?","dwarf_say_2":"EL D\xcdA DEL GRAN SISMO: SETAS DEJARON DE CRECER BAJO LA SUPERFICIE. S\xd3LO NOS QUEDARON LAS RESERVAS DE A\xd1OS PREVIOS","dwarf_say_3":"CON SUMINISTROS LIMITADOS, S\xd3LO FUE CUESTI\xd3N DE TIEMPO ANTES QUE LA VIOLENCIA CONTAMIARA NUESTRA PAC\xcdFICA FORMA DE VIDA.","mary_say_3":"\xa1HO DOC!, DE VERDAD LO SIENTO.","dwarf_say_4":"NO ES TIEMPO DE LAMENTOS. SIGUE ADELANTE MARY PERO TEN CUIDADO, MUCHOS ARTEFACTOS PELIGROSOS A\xdaN YACEN ENTRE LAS RUINAS COMO RECUERDO DE UN TIEMPO TURBULENTO."},"dialog_2":{"mary_say_1":"\xa1VAYA! ESO FUE PELIGROSO. DEBO SER M\xc1S CUIDADOSA CON ESO BARRILES, ICLUSO PUEDEN DESTRUIR LOS ESCOMBROS."},"dialog_3":{"dwarf_say_1":"YO S\xd3LO ERA UN BEB\xc9 CUANDO ME ALEJARON PARA PROTEGERME DEL FUEGO Y EL HORROR. APENAS SI RECUERDO ESTOS LUGARES.","mary_say_1":"NO TE PREOCUPES DOC, TIAMAT ME GUIAR\xc1 Y PROTEJER\xc1 DE TODO MAL."},"dialog_4":{"dwarf_say_1":"CONS\xcdGUEME ${NUM} DIAMANTES MARY, DE ESA FORMA DESPEJAR\xc9 EL CAMINO."}},"maze_1":{"dialog_1":{"dwarf_say_1":"ESTO EST\xc1 DESASTROZO, S\xd3LO RESTOS HAN QUEDADO EN PI\xc9, ES DURO SABER POR D\xd3NDE IR. ALGO DE ENERG\xcdA EXTRA PODR\xcdA AYUDAR. \xbfTIENES UNO DE ESOS HONGOS PARA M\xcd?","mary_say_1":"NO LO SE DOC \xbfES UNA BUENA IDEA CONTINUAR GASTANDO LOS HONGOS?","mary_say_2_yes":"AQU\xcd EST\xc1, TOMA UNO Y ESPERO PUEDAS ENCONTRAR EL CAMINO.","mary_say_2_no":"NO, LOS HONGOS NO SON PARA TI, SON PARA MARDUK, ME LAS ARREGLAR\xc9 PARA ENCONTRAR EL CAMINO POR MI CUENTA."},"dialog_1_option":{"yes":"SI, ENTREGAR UNA SETA","no":"NO, CONSERVAR LAS SETAS"},"dialog_2":{"mary_say_1":"\xa1\xa1\xa1DOC!!! DESPACIO POR FAVOR, APENAS SI PUEDO SEGUIRTE EL PASO.","dwarf_say_1":"MIS DISCULPAS, CREO QUE ME ENTUSIASM\xc9 DE M\xc1S."}},"level_16":{"dialog_1":{"mary_say_1":"\xa1MARDUUUK!... \xa1MARDUUUK!... ESTAS ROCAS APILADAS NO SE MOVER\xc1N.","mary_say_2":"PUEDO VERLO RESPIRAR DESDE AQU\xcd. TAL VEZ EST\xc1 INCONCIENTE.","mary_say_3":"\xbfD\xd3NDE EST\xc1 DOC CUANDO LO NECESITO? DEBO MOVERME R\xc1PIDO, ENCONTRAR A DOC Y LLEGAR A ESE SANTUARIO PARA ASISTIR A MARDUK."},"dialog_2":{"mary_say_1":"\xa1DOC, ENCONTR\xc9 A MARDUK! EST\xc1 EN UN SANTUARIO NO LEJOS DE AQU\xcd.","dwarf_say_1":"POR SUPUESTO, UN SANTUARIO ES DONDE LO V\xcd. YA S\xc9 D\xd3NDE ES.","mary_say_2":"\xa1VAMOS!, TE SIGO.","dwarf_say_2_diamonds":"PERO ANTES DE PARTIR... NECESITO LIBRARME DEL \xc1NGEL, CONS\xcdGUEMME ${NUM} DIAMANTES PARA ESO."},"dialog_2_repeat":{"mary_say_1":"TOMA TUS DIAMANTES, AHORA \xa1VAMOS!, TE SIGO."},"dialog_2_repeat_no_diamonds":{"dwarf_say_1":"RECUERDA MARY, CONS\xcdGUEME ${NUM} DIAMANTES PARA PODER CONTINUAR."},"dialog_3":{"mary_say_1":"NO LO ENTIENDO DOC, \xc9L ESTABA JUSTO AQU\xcd... PERO YA NO EST\xc1, ME PREGUNTO A D\xd3NDE PUDE HABER IDO.","dwarf_say_1":"O A D\xd3NDE LO LLEVARON... DE CUALQUIER MANERA, HAY UNA SOLA DIRECCI\xd3N POSIBLE... HACIA ABAJO.","dwarf_say_2":"\xa1S\xcdGUEME MARY!"}},"level_17":{"dialog_1":{"mary_say_1":"DOC, NO PUEDO VER NADA HACIA ADELANTE. ESTE LUGAR ES L\xdaGUBRE","dwarf_say_1":"TENGO UN PRESENTE PARA TI, TEN LA ANTORCHA DE ASHELBROCK. ILUMINAR\xc1 TU DESTINO."},"dialog_2":{"mary_say_1":"\xbfVIENES DOC?","dwarf_say_1":"VOY EN SEGUIDA, D\xc9JAME APRECIAR ESTA MARAVILLOSA FLAMA..."}}}')},35:function(e){e.exports=JSON.parse('{"name":"lostcartridgejam3","version":"0.2.0","private":true,"homepage":"https://cosmitar.github.io/lostcartridgejam3Game","dependencies":{"@testing-library/jest-dom":"^5.11.4","@testing-library/react":"^11.1.0","@testing-library/user-event":"^12.1.10","easystarjs":"^0.4.4","generate-maze":"^1.1.0","gh-pages":"^3.2.3","i18n-js":"^3.9.2","lodash.memoize":"^4.1.2","lodash.template":"^4.5.0","phaser":"^3.55.2","phaser3-rex-plugins":"^1.1.70","react":"^17.0.2","react-dom":"^17.0.2","react-scripts":"4.0.3","web-vitals":"^1.0.1"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","predeploy":"npm run build","deploy":"gh-pages -b master -r https://github.com/Cosmitar/lostcartridgejam3Game.git -d build"},"eslintConfig":{"extends":["react-app","react-app/jest"]},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},42:function(e,t,i){},52:function(e,t,i){"use strict";i.r(t);var a=i(8),s=i.n(a),n=i(29),o=i.n(n),r=(i(42),i(14)),l=i(5),c=i.n(l),h=i(15),u=i(12),d=i(9),m=Object(a.createContext)(),y=function(e){var t=e.game,i=e.scene,s=e.sceneProps,n=e.children,o=Object(a.useState)(),l=Object(r.a)(o,2),c=l[0],h=l[1];return Object(a.useEffect)((function(){h(!!t&&!!i)}),[t,i]),Object(d.jsx)(m.Provider,{value:{game:t,scene:i,sceneProps:s},children:c?n:null})},p=i(0),f=i(1),v=i(2),_=i(3),g=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a,s){var n;return Object(p.a)(this,i),(n=t.call(this,e)).onCreate=s,n.config=a,n}return Object(f.a)(i,[{key:"preload",value:function(){var e;(null===(e=this.config)||void 0===e?void 0:e.preload)&&this.config.preload.bind(this)()}},{key:"create",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(null===(e=this.config)||void 0===e?void 0:e.create)&&this.config.create.bind(this)(),this.onCreate(t)}}]),i}(c.a.Scene),E=Object(a.forwardRef)((function(e,t){var i=e.args,n=e.children,o=Object(a.useRef)(),l=t||o,m=Object(a.useState)(),p=Object(r.a)(m,2),f=p[0],v=p[1],_=Object(a.useState)(),E=Object(r.a)(_,2),O=E[0],S=E[1],T=Object(a.useState)({}),A=Object(r.a)(T,2),b=A[0],x=A[1];Object(a.useEffect)((function(){var e=s.a.Children.map(n,(function(e){return new g(e.props.name,e.props.args,(function(t){x(Object(u.a)({},e.props.name,t))}))}));i.scene=[].concat(Object(h.a)(i.scene||[]),Object(h.a)(e)),i.callbacks={postBoot:function(e){v(e),S(!0),e.scene.scenes.forEach((function(e){e.events.off(c.a.Scenes.Events.READY),e.events.once(c.a.Scenes.Events.READY,(function(){e.events.off(c.a.Scenes.Events.RENDER),e.events.once(c.a.Scenes.Events.RENDER,(function(){}))})),e.events.once(c.a.Scenes.Events.WAKE,(function(){})),e.events.once(c.a.Scenes.Events.UPDATE,(function(){})),e.events.once(c.a.Scenes.Events.TRANSITION_WAKE,(function(){})),e.events.once(c.a.Scenes.Events.TRANSITION_START,(function(){})),e.events.once(c.a.Scenes.Events.TRANSITION_OUT,(function(){})),e.events.once(c.a.Scenes.Events.TRANSITION_INIT,(function(){})),e.events.once(c.a.Scenes.Events.TRANSITION_COMPLETE,(function(){})),e.events.once(c.a.Scenes.Events.START,(function(){})),e.events.once(c.a.Scenes.Events.SLEEP,(function(){})),e.events.once(c.a.Scenes.Events.SHUTDOWN,(function(){})),e.events.once(c.a.Scenes.Events.RESUME,(function(){})),e.events.once(c.a.Scenes.Events.RENDER,(function(){})),e.events.once(c.a.Scenes.Events.READY,(function(){})),e.events.once(c.a.Scenes.Events.PRE_RENDER,(function(){})),e.events.once(c.a.Scenes.Events.PAUSE,(function(){})),e.events.on(c.a.Scenes.Events.CREATE,(function(){x((function(t){return Object(u.a)({},e.scene.key,t[e.scene.key])}))})),e.events.once(c.a.Scenes.Events.BOOT,(function(){}))}))}};var t=new c.a.Game(i);l.current=t}),[]);var k=s.a.Children.toArray(n).find((function(e){return e.props.name===Object.keys(b)[0]}));return O?Object(d.jsx)(y,{scene:f.scene.getScene(Object.keys(b)[0]),sceneProps:Object.values(b)[0],game:f,children:k}):null}));E.displayName="Canvas";var O,S,T=E,A=i(6),b=i(4),x=250,k=20,w=(window.devicePixelRatio,function(){return document.querySelector("canvas").width/20/k});w.toString=w;var N="00ff00",R="000000",I="ffffff",D="00cc00",M="999999",U="0000cc",C="00ff00",L="009900",j="000099",P="0000ff",G="cc0000",H="660000",F="990000",W="ff0000",B={EMPTY:"000000",PLAYER:"ff00ff",GROUND:"663300",BOULDER:"999999",PILLAR:"545454",WALL:"0000ff",ENEMY:"ff0000",JEWEL:"ffff00",BARREL:"00ffff",EXPLOSION:"ffffff",INTERACTION:"00ff00",MUSHROOM:"9900ff",BRO:"22a5f6",DWARF:"f29900",EXIT:"00cc00",ART:"1d4ee1",ART2:"000099",HANGING_2:"d2fca8",HANGING_3:"7ea854",HANGING_4:"547e2a",HANGING_5:"2a5400",DEBRIS:"a82a2a",BLOCK:"dadaff",TORCH:"7e5400"},Y={DOWN:"ArrowDown",UP:"ArrowUp",LEFT:"ArrowLeft",RIGHT:"ArrowRight"},X=(O={},Object(u.a)(O,N,81),Object(u.a)(O,R,0),Object(u.a)(O,I,71),Object(u.a)(O,D,82),Object(u.a)(O,M,91),Object(u.a)(O,U,80),Object(u.a)(O,C,72),Object(u.a)(O,L,92),Object(u.a)(O,j,90),Object(u.a)(O,P,70),Object(u.a)(O,G,85),Object(u.a)(O,H,83),Object(u.a)(O,F,84),Object(u.a)(O,W,86),O),V=(S={},Object(u.a)(S,B.EMPTY,0),Object(u.a)(S,B.WALL,3),Object(u.a)(S,B.GROUND,2),Object(u.a)(S,B.ART,0),Object(u.a)(S,B.ART2,20),Object(u.a)(S,B.EXIT+"_1",18),Object(u.a)(S,B.EXIT+"_2",48),Object(u.a)(S,B.EXIT+"_3",88),Object(u.a)(S,B.DEBRIS,1),Object(u.a)(S,"calculateGroundTileWithNeighbours",(function(e,t,i){var a=(i[e]||[])[t-1]===B.GROUND?"W":"-",s=(i[e-1]||[])[t]===B.GROUND?"N":"-",n=(i[e]||[])[t+1]===B.GROUND?"E":"-",o=(i[e+1]||[])[t]===B.GROUND?"S":"-";switch("".concat(s).concat(n).concat(o).concat(a)){case"----":default:return 2;case"NESW":return 51;case"N---":return 63;case"-E--":return 44;case"--S-":return 43;case"---W":return 46;case"NE--":return 60;case"-ES-":return 40;case"--SW":return 42;case"N--W":return 62;case"NES-":return 50;case"-ESW":return 41;case"N-SW":return 52;case"NE-W":return 61;case"N-S-":return 53;case"-E-W":return 45}})),Object(u.a)(S,"calculateWallTileWithNeighbours",(function(e,t,i){var a=(i[e]||[])[t-1]===B.WALL||[B.ART,B.ART2].includes((i[e]||[])[t-1])||[B.HANGING_2,B.HANGING_3,B.HANGING_4,B.HANGING_5,B.TORCH].includes((i[e]||[])[t-1])?"W":"-",s=(i[e-1]||[])[t]===B.WALL||[B.ART,B.ART2].includes((i[e-1]||[])[t])||[B.HANGING_2,B.HANGING_3,B.HANGING_4,B.HANGING_5,B.TORCH].includes((i[e-1]||[])[t])?"N":"-",n=(i[e]||[])[t+1]===B.WALL||[B.ART,B.ART2].includes((i[e]||[])[t+1])||[B.HANGING_2,B.HANGING_3,B.HANGING_4,B.HANGING_5,B.TORCH].includes((i[e]||[])[t+1])?"E":"-",o=(i[e+1]||[])[t]===B.WALL||[B.ART,B.ART2].includes((i[e+1]||[])[t])||[B.HANGING_2,B.HANGING_3,B.HANGING_4,B.HANGING_5,B.TORCH].includes((i[e+1]||[])[t])?"S":"-";switch("".concat(s).concat(n).concat(o).concat(a)){case"----":default:return 3;case"NESW":return 21;case"N---":return 33;case"-E--":return 14;case"--S-":return 13;case"---W":return 16;case"NE--":return 30;case"-ES-":return 10;case"--SW":return 12;case"N--W":return 32;case"NES-":return 20;case"-ESW":return 11;case"N-SW":return 22;case"NE-W":return 31;case"N-S-":return 23;case"-E-W":return 15}})),Object(u.a)(S,"calculateWallTileWithNeighboursDirtEarth",(function(e,t,i){var a=(i[e]||[])[t-1]===B.WALL?"W":"-",s=(i[e-1]||[])[t]===B.WALL?"N":"-",n=(i[e]||[])[t+1]===B.WALL?"E":"-",o=(i[e+1]||[])[t]===B.WALL?"S":"-";switch("".concat(s).concat(n).concat(o).concat(a)){case"----":default:return 2;case"NESW":return 51;case"N---":return 63;case"-E--":return 44;case"--S-":return 43;case"---W":return 46;case"NE--":return 60;case"-ES-":return 40;case"--SW":return 42;case"N--W":return 62;case"NES-":return 50;case"-ESW":return 41;case"N-SW":return 52;case"NE-W":return 61;case"N-S-":return 53;case"-E-W":return 45}})),S),K=i(11),J=i(7),Q=i.n(J),q=i(10),z=i(30),Z=i.n(z),$=i(21),ee=i.n($),te=i(31),ie=i(32),ae=function(e){switch(e){case"en":default:return te;case"es":return ie}},se={en:function(){return ae("en")},es:function(){return ae("es")}},ne=Z()((function(e,t){return ee.a.t(e,t)}),(function(e,t){return t?e+JSON.stringify(t):e})),oe=function(){var e=Object(q.a)(Q.a.mark((function e(t){var i,a,s;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"en",i=navigator.language.substring(0,2),Object.keys(se).includes(i)||(i="en"),a="en",e.next=6,se[a]();case 6:s=e.sent,ee.a.translations=Object(u.a)({},a,s),ee.a.locale=a,t(!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){function e(){Object(p.a)(this,e),this.eventListeners=[],this.classes=[]}return Object(f.a)(e,[{key:"listClasses",value:function(){for(var e=this.__proto__,t=[];void 0!==e.constructor.className;)t.push(e.constructor.className),e=e.__proto__;return t}},{key:"isClass",value:function(e){return 0===this.classes.length&&(this.classes=this.listClasses()),this.classes.includes(e.className)}},{key:"addEventListener",value:function(e,t){var i=this;return this.eventListeners.push([e,t]),function(){i.eventListeners=i.eventListeners.filter((function(e){return e[1]!==t}))}}},{key:"dispatchEvent",value:function(e,t){var i=this;this.eventListeners.filter((function(t){return t[0]===e})).forEach((function(e){return e(t,i)}))}}]),e}(),le=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e){var a,s=e.id,n=e.isRigid,o=e.isBreakable,r=e.isFlat,l=e.isPickable,c=e.isCrushable,h=e.level;return Object(p.a)(this,i),(a=t.call(this)).id=s,a.isRigid=n,a.isBreakable=o,a.isFlat=r,a.isPickable=l,a.isCrushable=c,a.power=0,a.strength=0,a.force=0,a.weight=0,a.level=h,a.position=null,a.alien=null,a.isMoveable=!a.isRigid,a}return Object(f.a)(i,[{key:"setPosition",value:function(e){this.position=e}},{key:"canMove",value:function(){return this.isMoveable}},{key:"overrunBy",value:function(){}},{key:"runningOver",value:function(){}},{key:"canFallDown",value:function(){return!1}},{key:"canFallLeft",value:function(){return!1}},{key:"canFallRight",value:function(){return!1}},{key:"addedToScene",value:function(){}}]),i}(re);le.className="GameObject";var ce=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this)).id=e,s.level=a,s.isEmpty=!0,s}return Object(f.a)(i,[{key:"setPosition",value:function(e){this.position=e}}]),i}(re);ce.className="Empty";var he=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!1,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).power=10,s.strength=10,s}return Object(f.a)(i,[{key:"setPosition",value:function(e){var t=this;Object(A.a)(Object(b.a)(i.prototype),"setPosition",this).call(this,e);var a=e.x,s=e.y,n=this.level.scene.children.getByName("layer_1");if(!n)return!1;var o=n.tilemap,r=this.level.scene.add.sprite(48,16).setOrigin(.125,.125).play("explosion_explode");r.setScale(n.scaleX),r.x=o.tileToWorldX(a),r.y=o.tileToWorldY(s),r.on(c.a.Animations.Events.ANIMATION_COMPLETE,(function(){r.destroy()})),this.alien=r,this.level.replaceByEmpty(this),this.level.onNextTick((function(e){e.objects[s][a]=new ce(B.EMPTY,t.level)}))}}]),i}(le);he.className="Explosion";var ue=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e){var a;return Object(p.a)(this,i),(a=t.call(this,e)).inactive=!1,a}return Object(f.a)(i,[{key:"overrunBy",value:function(e){e.power>this.strength&&(this.inactive=!0,this.level.onDestroyElement(this))}}]),i}(le);ue.className="Destroyable";var de=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){return Object(p.a)(this,i),t.apply(this,arguments)}return Object(f.a)(i,[{key:"move",value:function(e){var t=e.x,a=e.y;Object(A.a)(Object(b.a)(i.prototype),"setPosition",this).call(this,{x:t,y:a})}}]),i}(ue);de.className="Moveable";var me=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e){var a;return Object(p.a)(this,i),(a=t.call(this,e)).isFalling=0,a}return Object(f.a)(i,[{key:"canFallDown",value:function(){var e={x:this.position.x,y:this.position.y+1},t=this.level.isDestinationInBounds(e.x,e.y)&&this.level.getObjectAt(e.x,e.y),i=this.level.isDestinationEmpty(e.x,e.y),a=t.isCrushable&&this.isFalling;return i||a}},{key:"canRollTo",value:function(e,t){var i={x:e,y:t},a=this.level.isDestinationInBounds(i.x,i.y),s=a&&this.level.getObjectAt(i.x,this.position.y),n=a&&this.level.objectIsEmpty(s),o=a&&this.level.getObjectAt(i.x,i.y),r=this.level.objectIsEmpty(o),l=a&&this.level.getObjectAt(this.position.x,this.position.y+1),c=!this.level.isDestinationEmpty(this.position.x,this.position.y+1)&&l.isFlat;return a&&r&&n&&!c&&l&&!l.isFalling}},{key:"canFallRight",value:function(){return!this.canFallDown()&&this.canRollTo(this.position.x+1,this.position.y+1)}},{key:"canFallLeft",value:function(){return!this.canFallDown()&&this.canRollTo(this.position.x-1,this.position.y+1)}}]),i}(de);me.className="Fallable";var ye=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!1,isPickable:!1,isCrushable:!1,level:a})).strength=5,s}return Object(f.a)(i,[{key:"overrunBy",value:function(e){e.isClass(he)&&(this.alien.visible=!1,this.alien.destroy(),this.inactive=!0)}}]),i}(me);ye.className="Boulder";var pe=i(17),fe=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!0,isBreakable:!0,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).strength=9,s}return Object(f.a)(i,[{key:"overrunBy",value:function(e){var t=this;e&&e.isClass(he)?this.level.scene.children.getByName("layer_1").tilemap.putTileAt(-1,this.position.x,this.position.y,!1,"layer_1"):(this.level.scene.children.getByName("layer_1").tilemap.putTileAt(-1,this.position.x,this.position.y,!1,"layer_1"),this.break_effect=this.level.scene.add.sprite(48,16).setOrigin(0,.25),this.break_effect.setScale(w),this.break_effect.depth=4,this.break_effect.x=dt.tileToScreen(this.position.x),this.break_effect.y=dt.tileToScreen(this.position.y),this.break_effect.play("ground_disolves"),this.break_effect.setFlipY(!0),this.break_effect.on(c.a.Animations.Events.ANIMATION_COMPLETE,(function(){t.break_effect.destroy()})))}}]),i}(le);fe.className="Debris";var ve=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).strength=5,s}return Object(f.a)(i,[{key:"overrunBy",value:function(e){e.constructor.className===he.className&&(this.alien.visible=!1,this.alien.destroy())}}]),i}(me);ve.className="Pillar";var _e=function(){function e(t){Object(p.a)(this,e),this.config=t,this.moveables=[],this.parallelMovables=[],this.objects=[],this.interactiveElements={},this.decorationElements={},this.scene=null,this.player=null,this.playerTimeoutId=0,this.timeoutIds=[],this.focusElement=null,this.isPaused=!1,this.queuedActions=[],this.countDiamonds=0,this.collectedDiamonds=0,this.countEnemies=0,this.killedEnemies=0,this.countShrooms=0,this.collectedShrooms=0,this.totalShroomsAmount=0,this.prevBest=0,this.preventDisplayDiamondsGoalAmount=!1,this.unfinished=!0,this.tickId=0}return Object(f.a)(e,[{key:"onNextTick",value:function(e){this.queuedActions.push(e)}},{key:"runScheduledActions",value:function(e){var t=this,i=this.queuedActions;this.queuedActions=[],i.forEach((function(e){return e(t)}))}},{key:"connectToScene",value:function(e){var t=this;this.scene=e;var i=this.scene.children.getByName("layer_1"),a=i.tilemap;this.objects.length&&(this.objects=[]),this.break_effect=this.scene.add.sprite(48,16).setOrigin(0,.25),this.break_effect.setScale(i.scaleX),this.break_effect.depth=4,this.pick_effect=this.scene.add.sprite(48,16).setOrigin(0,.25),this.pick_effect.setScale(i.scaleX),this.pick_effect.depth=4,this.enemy_die_effect=this.scene.add.sprite(48,16).setOrigin(0,.25),this.enemy_die_effect.setScale(i.scaleX),this.enemy_die_effect.depth=4;var s=0;this.objects=this.config.map((function(e,n){return e.map((function(e,o){var r;switch(e){case B.WALL:case B.BLOCK:(r=new gt(e,t)).setPosition({x:o,y:n});break;case B.TORCH:(r=new At(e,t)).setPosition({x:o,y:n}),r.order=Object.values(t.decorationElements).filter((function(e){return e.isClass(At)})).length,t.decorationElements["".concat(r.position.x,"-").concat(r.position.y)]=r;break;case B.DEBRIS:(r=new fe(e,t)).setPosition({x:o,y:n});break;case B.GROUND:(r=new mt(e,t)).setPosition({x:o,y:n});break;case B.BOULDER:var l=t.scene.add.sprite(48,16).setOrigin(0,.25).play("boulder_idle");l.setScale(i.scaleX),l.x=a.tileToWorldX(o),l.y=a.tileToWorldY(n),(r=new ye(e,t)).alien=l;break;case B.PILLAR:var h=t.scene.add.sprite(48,16).setOrigin(.05,.2).play("pillar_idle");h.setScale(i.scaleX),h.x=a.tileToWorldX(o),h.y=a.tileToWorldY(n),(r=new ve(e,t)).alien=h;break;case B.JEWEL:var u=t.scene.add.sprite(48,16).setOrigin(.05,.2).play("diamond_idle");u.setScale(i.scaleX),u.x=a.tileToWorldX(o),u.y=a.tileToWorldY(n),t.countDiamonds++,(r=new pt(e,t)).order=t.countDiamonds,r.alien=u,r.move({x:o,y:n});break;case B.MUSHROOM:if(K.a.get(t.constructor.key)&&0!==K.a.get(t.constructor.key).collectedShrooms)t.collectedShrooms=K.a.get(t.constructor.key).collectedShrooms,r=new ce(e,t);else{var d=t.scene.add.sprite(48,16).setOrigin(0,.25).play("mushroom_idle");d.setScale(i.scaleX),d.x=a.tileToWorldX(o),d.y=a.tileToWorldY(n),(r=new Tt(e,t)).alien=d}t.countShrooms++;break;case B.BARREL:var m=t.scene.add.sprite(48,16).setOrigin(0,.2).play("barrel_idle");m.setScale(i.scaleX),m.x=a.tileToWorldX(o),m.y=a.tileToWorldY(n),(r=new St(e,t)).alien=m;break;case B.PLAYER:var y=t.scene.add.sprite(48,16).setOrigin(0,.25);y.setScale(i.scaleX),y.x=a.tileToWorldX(o),y.y=a.tileToWorldY(n)+5,y.name="brave",y.on(c.a.Animations.Events.ANIMATION_COMPLETE,(function(){y.isMoving||y.inactive||y.play("brave_idle")})),(r=new _t(e,t)).alien=y,r.animIdle(),t.player=r;break;case B.BRO:var p=t.scene.add.sprite(48,16).setOrigin(0,.25);p.setScale(i.scaleX),p.x=a.tileToWorldX(o),p.y=a.tileToWorldY(n)+5,p.name="bro",p.on(c.a.Animations.Events.ANIMATION_COMPLETE,(function(){!p.isMoving&&p.isFollowing&&p.play("bro_idle")})),(r=new vt(e,t,"bro")).alien=p,r.isFollowing=!0,r.animIdle(),t.follower=r;break;case B.DWARF:var f=t.scene.add.sprite(48,16).setOrigin(0,.25);f.setScale(i.scaleX),f.x=a.tileToWorldX(o),f.y=a.tileToWorldY(n),f.name="dwarf",f.on(c.a.Animations.Events.ANIMATION_COMPLETE,(function(){f.isMoving||f.play("dwarf_idle")})),(r=new vt(e,t,"dwarf")).alien=f,r.isLeading=!0,r.animIdle(),t.leader=r;break;case B.ENEMY:var v=t.scene.add.sprite(48,16).setOrigin(.125,.125).play("bat_move");v.setScale(i.scaleX),v.x=a.tileToWorldX(o),v.y=a.tileToWorldY(n),t.countEnemies++,(r=new ft(e,t)).alien=v;break;case B.EXIT:case B.INTERACTION:var _=e===B.EXIT?new Ot(e,t):new Et(e,t);_.order=s++,t.interactiveElements["".concat(o,"-").concat(n)]=_,_.setPosition({x:o,y:n}),t.onAddElement(_),r=new ce(e,t),_.isClass(Ot)&&(t.exit=_);break;default:r=new ce(e,t)}return r.setPosition({x:o,y:n}),t.objectIsEmpty(r)||r.isRigid||t.moveables.push(r),t.onAddElement(r),r.isClass(ce)||r.addedToScene(),r}))})),this.focusElement=this.player;var n=K.a.get(this.constructor.key);if(this.unfinished=!n||n&&0===n.comp,console.log(this.unfinished),this.diamondsGoal>0){if(this.unfinished){var o=this.scene.add.sprite(48,16).setOrigin(0,.25).play("exit_block");o.setScale(i.scaleX),o.x=a.tileToWorldX(this.exit.position.x-2),o.y=a.tileToWorldY(this.exit.position.y);var r=new gt(B.WALL,this);r.setPosition({x:this.exit.position.x-2,y:this.exit.position.y}),r.alien=o,this.objects[this.exit.position.y][this.exit.position.x-2]=r,this.exit.block=r}this.preventDisplayDiamondsGoalAmount||setTimeout((function(){t.scene.events.emit("score:diamond_goal_set",t.diamondsGoal)}),1500)}this.onNextTick((function(){K.a.get(t.constructor.key)||K.a.set(t.constructor.key,{countDiamonds:t.countDiamonds,collectedDiamonds:t.collectedDiamonds,countEnemies:t.countEnemies,killedEnemies:t.killedEnemies,countShrooms:t.countShrooms,collectedShrooms:t.collectedShrooms,comp:0,prevBest:t.prevBest})})),this.totalShroomsAmount=K.a.get("totalShroomsAmount")||0}},{key:"jumpIntoParallelGravity",value:function(e){var t=this.moveables.findIndex((function(t){return t===e}));this.moveables.splice(t,1),e.inParallelGravity=!0,this.parallelMovables.push(e)}},{key:"goBackToMainGravity",value:function(e){if(e.inactive)return!1;var t=this.parallelMovables.findIndex((function(t){return t===e}));if(-1===t)return!1;this.parallelMovables.splice(t,1),e.inParallelGravity=!1,this.moveables.push(e)}},{key:"explodeLoop",value:function(e){e.forEach((function(e){!e.canFallDown()&&e.isFalling&&e.explode()}))}},{key:"gravityLoop",value:function(e){var t=this,i=e||this.moveables;this.isPaused||(e||this.runScheduledActions(),this.explodeLoop(i.filter((function(e){return e.isClass(St)}))),i.sort((function(e,t){return e.position.y-t.position.y})).forEach((function(e){var i,a=e.canFallDown(),s=e.canFallLeft(),n=e.canFallRight();if(a&&(i={x:e.position.x,y:e.position.y+1}),!a&&s&&(i={x:e.position.x-1,y:e.position.y},e.isFalling&&i.y++),a||s||!n||(i={x:e.position.x+1,y:e.position.y},e.isFalling&&i.y++),i)t.moveObject(e,i),e.isFalling&&(s||n)&&e.isClass(pt)&&t.scene.events.emit("sounds:gem_hit"),e.isFalling&&(s||n)&&(e.isClass(ye)||e.isClass(ve))&&t.scene.events.emit("sounds:rock_hit_hard"),e.isFalling++;else{if(e.isFalling&&(e.isClass(ye)||e.isClass(ve))){var o=t.getObjectAt(e.position.x,e.position.y+1);o&&o.isClass(mt)?t.scene.events.emit("sounds:rock_hit_soft"):t.scene.events.emit("sounds:rock_hit_hard")}e.isFalling&&e.isClass(pt)&&t.scene.events.emit("sounds:gem_hit"),e.isFalling=0}!e.isFalling&&e.inParallelGravity&&t.goBackToMainGravity(e)})),e||this.enemiesLoop())}},{key:"enemiesLoop",value:function(){var e=this;if(!this.isPaused){var t,i,a,s,n,o,r,l=function(t,n,o,r,l){if(i=e.getObjectAt(n.x,n.y),(a=e.objectIsEmpty(i)||i&&i.isClass(_t))&&i&&i.isClass(_t)&&e.moveObject(t,n),a){if(!t.anchorPosition)return void(t.moveIntentDir=o);(t.position.x===t.anchorPosition.x||t.position.y===t.anchorPosition.y)&&(s=e.getObjectAt(l.x,l.y),e.objectIsEmpty(s)||s.isFalling||s.isClass(_t)?t.moveIntentDir=r:t.anchorPosition=s.position),e.moveObject(t,n)}else t.anchorPosition=i.isFalling?null:i.position,t.moveIntentDir=o};this.moveables.filter((function(e){return e.isClass(ft)})).forEach((function(e){switch(e.moveIntentDir){case Y.UP:t={x:e.position.x,y:e.position.y-1},n="CW"===e.scanDirection?Y.RIGHT:Y.LEFT,o="CW"===e.scanDirection?Y.LEFT:Y.RIGHT,r="CW"===e.scanDirection?{x:t.x-1,y:t.y}:{x:t.x+1,y:t.y},l(e,t,n,o,r);break;case Y.RIGHT:t={x:e.position.x+1,y:e.position.y},n="CW"===e.scanDirection?Y.DOWN:Y.UP,o="CW"===e.scanDirection?Y.UP:Y.DOWN,r="CW"===e.scanDirection?{x:t.x,y:t.y-1}:{x:t.x,y:t.y+1},l(e,t,n,o,r);break;case Y.DOWN:t={x:e.position.x,y:e.position.y+1},n="CW"===e.scanDirection?Y.LEFT:Y.RIGHT,o="CW"===e.scanDirection?Y.RIGHT:Y.LEFT,r="CW"===e.scanDirection?{x:t.x+1,y:t.y}:{x:t.x-1,y:t.y},l(e,t,n,o,r);break;case Y.LEFT:t={x:e.position.x-1,y:e.position.y},n="CW"===e.scanDirection?Y.UP:Y.DOWN,o="CW"===e.scanDirection?Y.DOWN:Y.UP,r="CW"===e.scanDirection?{x:t.x,y:t.y+1}:{x:t.x,y:t.y-1},l(e,t,n,o,r)}e.loop()}))}}},{key:"playerLoop",value:function(){var e=this;if(!this.isPaused&&!this.player.inactive){clearTimeout(this.playerTimeoutId);var t=this.player,i=this.follower,a=this.leader,s={x:t.position.x,y:t.position.y};switch(t.moveIntentDir){case Y.UP:t.canMoveUp()&&(s.y-=1);break;case Y.DOWN:t.canMoveDown()&&(s.y+=1);break;case Y.LEFT:(t.canMoveLeft()||t.canPushLeft()&&t.pushLeft())&&(s.x-=1);break;case Y.RIGHT:(t.canMoveRight()||t.canPushRight()&&t.pushRight())&&(s.x+=1)}if((t.position.x!==s.x||t.position.y!==s.y)&&!t.isMoving){t.isMoving=!0,t.position.x<s.x&&t.animRunRight(),t.position.x>s.x&&t.animRunLeft(),this.scene.events.emit("player_moves",s);var n=t.position;this.moveObject(t,s),i&&i.isFollowing&&(i.moveIntentDir=i.position.y<n.y?Y.DOWN:i.moveIntentDir,i.moveIntentDir=i.position.y>n.y?Y.UP:i.moveIntentDir,i.position.x<n.x&&(i.moveIntentDir=Y.RIGHT,i.animRunRight()),i.position.x>n.x&&(i.moveIntentDir=Y.LEFT,i.animRunLeft()),this.moveObject(i,n),i.position.y<t.position.y?(i.alien.depth=0,t.alien.depth=2):(t.alien.depth=0,i.alien.depth=2))}this.playerTimeoutId=setTimeout((function(){if(!t.alien)return!1;t.isMoving=!1,t.animIdle();var s=e.interactiveElements["".concat(t.position.x,"-").concat(t.position.y)];s&&s.overrunBy(t),i&&t.alien.anims.currentAnim.key.includes("idle")&&i.isFollowing,(a||!(null===a||void 0===a?void 0:a.isCloseEnough(t.position))||(null===a||void 0===a?void 0:a.isCloseEnough(t.position))&&t.alien.anims.currentAnim.key.includes("idle")&&a.isLeading)&&(null===a||void 0===a||a.animIdle()),""!==t.moveIntentDir&&t.alien&&e.playerLoop()}),225)}}},{key:"moveObject",value:function(e,t){var i=this,a=this.scene.children.getByName("layer_1");if(!a)return!1;var s=a.tilemap,n={x:e.position.x,y:e.position.y},o=this.getObjectAt(t.x,t.y),r=[_t.className,vt.className].includes(e.constructor.className)&&[_t.className,vt.className].includes(o.constructor.className);if(this.objectIsEmpty(o)&&!o.isClass(Et)&&!o.isClass(Ot)||r||(o.overrunBy(e),e.runningOver(o)),!e.inactive){var l;if(r||this.setObjectAt(n.x,n.y,new ce(B.EMPTY,this)),this.setObjectAt(t.x,t.y,e),e.move(t),e.isClass(yt)&&e.alien&&(this.scene.tweens.add({targets:e.alien,x:{value:s.tileToWorldX(t.x),duration:e.isClass(ft)?x:225},y:{value:s.tileToWorldY(t.y)+(e.isClass(_t)?5:0),duration:e.isClass(ft)?x:225}}),e.animRun()),e.isClass(vt)&&"dwarf"===e.name)if(this.leader.position.x===this.exit.position.x&&this.leader.position.y===this.exit.position.y)null===(l=this.leader.alien)||void 0===l||l.destroy(),this.leader.alien=null,this.replaceByEmpty(this.leader);if(e.isClass(me)){if(this.scene.tweens.add({targets:e.alien,x:{value:s.tileToWorldX(t.x),duration:t.y!==n.y?125:x},y:{value:s.tileToWorldY(t.y),delay:t.x!==n.x?125:0,duration:t.x!==n.x?125:x},onComplete:function(){e.inParallelGravity&&i.gravityLoop([e])}}),t.x!==n.x&&e.isClass(ye)&&(e.alien.play(t.x>n.x?"boulder_roll_right":"boulder_roll_left"),null!==this.player.pushingDirection)){var h=this.getObjectAt(n.x,n.y+1);this.scene.events.emit("sounds:rock_slide_".concat(h.isClass(mt)?"soft":"hard"))}e.isClass(St)&&((t.x!==n.x&&this.isDestinationEmpty(t.x,n.y+1)||t.x!==n.x&&t.y!==n.y)&&setTimeout((function(){var i;return null===(i=e.alien)||void 0===i?void 0:i.play(t.x>n.x?"barrel_roll_right":"barrel_roll_left")}),125),t.x!==n.x&&this.scene.events.emit("sounds:rock_slide_soft")),e.isClass(ve)&&((t.x!==n.x&&this.isDestinationEmpty(t.x,n.y+1)||t.x!==n.x&&t.y!==n.y)&&setTimeout((function(){var i;return null===(i=e.alien)||void 0===i?void 0:i.play(t.x>n.x?"pillar_roll_right":"pillar_roll_left")}),125),t.x!==n.x&&this.scene.events.emit("sounds:rock_slide_hard")),t.x!==n.x&&e.isClass(pt)&&(e.alien.once(c.a.Animations.Events.ANIMATION_COMPLETE,(function(){e.alien.play("diamond_idle"),e.shine.play("diamond_shine")})),e.shine.stop(),e.alien.play(t.x>n.x?"diamond_roll_right":"diamond_roll_left"))}}}},{key:"pause",value:function(){this.isPaused=!0,this.player.moveIntentDir="",this.player.animIdle()}},{key:"resume",value:function(){this.isPaused=!1,this.gravityLoop(this.parallelMovables)}},{key:"destroy",value:function(){}},{key:"onCharacterDie",value:function(e){this.setObjectAt(e.position.x,e.position.y,new ce(B.EMPTY,this)),this.moveables=this.moveables.filter((function(t){return t!==e})),e.isClass(_t)&&(e.moveIntentDir="",this.scene.levels.restart())}},{key:"onJewelPick",value:function(e){this.setObjectAt(e.position.x,e.position.y,new ce(B.EMPTY,this)),this.moveables=this.moveables.filter((function(t){return t!==e})),this.collectedDiamonds++,this.scene.events.emit("score:diamond_set",this.collectedDiamonds),this.diamondsGoal>0&&this.diamondsGoal<=this.collectedDiamonds&&(this.destroyBlock(),this.scene.events.emit("score:diamond_goal"),this.scene.events.emit("sounds:coin"))}},{key:"destroyBlock",value:function(){var e=Object.values(this.interactiveElements).find((function(e){return null===e||void 0===e?void 0:e.isClass(Ot)}));(null===e||void 0===e?void 0:e.block)&&(this.onDestroyElement(e.block),e.block.alien.destroy())}},{key:"onMushroomPick",value:function(e){this.setObjectAt(e.position.x,e.position.y,new ce(B.EMPTY,this)),this.moveables=this.moveables.filter((function(t){return t!==e})),this.collectedShrooms=1}},{key:"onEnemyKill",value:function(e){this.killedEnemies++}},{key:"onDestroyElement",value:function(e){this.setObjectAt(e.position.x,e.position.y,new ce(B.EMPTY,this)),this.moveables=this.moveables.filter((function(t){return t!==e})),this.parallelMovables=this.parallelMovables.filter((function(t){return t!==e}))}},{key:"replaceByEmpty",value:function(e){var t=new ce(B.EMPTY,this);t.setPosition(e.position),this.getObjectAt(e.position.x,e.position.y)===e&&this.setObjectAt(e.position.x,e.position.y,t)}},{key:"onExplode",value:function(e){}},{key:"cleanLevel",value:function(){this.scene.events.off("player_moves"),this.scene.events.off("dialogue:hidden"),this.scene.events.off("dialogue:message_shown"),this.objects.forEach((function(e){return e.forEach((function(e){e.alien&&(e.alien.destroy(),e.alien=null)}))}))}},{key:"onComplete",value:function(){this.pause();var e=K.a.get(this.constructor.key);e&&(this.prevBest=null===e||void 0===e?void 0:e.comp);var t=this.scene.rules.calcCompletion(this.countDiamonds,this.collectedDiamonds,this.countEnemies,this.killedEnemies,this.countShrooms,Math.max(this.collectedShrooms,0)),i={countDiamonds:this.countDiamonds,collectedDiamonds:this.collectedDiamonds,countEnemies:this.countEnemies,killedEnemies:this.killedEnemies,countShrooms:this.countShrooms,collectedShrooms:Math.max(this.collectedShrooms,0),comp:t,prevBest:this.prevBest};(!e||e&&i.comp>=e.comp)&&K.a.set(this.constructor.key,i),K.a.set("totalShroomsAmount",this.totalShroomsAmount+this.collectedShrooms);var a=K.a.get(this.constructor.key);a.collectedShrooms=Math.max(0,this.collectedShrooms),K.a.set(this.constructor.key,a),this.scene.events.emit("levelcompleted",i)}},{key:"onInteractWith",value:function(e){e.ephemeral&&(this.interactiveElements["".concat(e.position.x,"-").concat(e.position.y)]=null)}},{key:"onAddElement",value:function(e){console.warn("implement element added ".concat(this.id))}},{key:"getPlayerPos",value:function(){return this.focusElement.position}},{key:"getConfigAt",value:function(e,t){return this.isDestinationInBounds(e,t)&&this.config[t][e]}},{key:"getCoords",value:function(e){for(var t=[],i=0;i<this.config.length;i++)for(var a=0;a<this.config[i].length;a++)this.config[i][a]===e&&t.push({x:a,y:i});return t}},{key:"getObjectAt",value:function(e,t){return this.isDestinationInBounds(e,t)&&this.objects[t][e]}},{key:"setObjectAt",value:function(e,t,i){this.objects[t][e]=i}},{key:"isPositionClear",value:function(e,t){return this.getObjectAt(e,t).isEmpty}},{key:"isDestinationInBounds",value:function(e,t){var i=e<this.config[0].length&&e>=0,a=t<this.config.length&&t>=0;return i&&a}},{key:"objectIsEmpty",value:function(e){return e&&e.isClass(ce)}},{key:"isDestinationEmpty",value:function(e,t){return this.getObjectAt(e,t).isEmpty}},{key:"playEarthquake",value:function(){var e=Object(q.a)(Q.a.mark((function e(t){var i,a,s=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>1&&void 0!==s[1]?s[1]:3,this.player.disconnect(),e.next=4,this.shakeCamera(i);case 4:a=4===i?1:3===i?.75:2===i?.5:.25,this.destroyObjectsInRange(t,a),this.player.reconnect();case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroyObjectsInRange",value:function(e,t){for(var i=e.y1;i<e.y2;i++)for(var a=e.x1;a<=e.x2;a++){this.interactiveElements["".concat(a,"-").concat(i)]&&(this.interactiveElements["".concat(a,"-").concat(i)]=null);var s=this.getObjectAt(a,i);Math.random()<t&&s&&(s.isClass(mt)||s.isClass(fe))&&(s.overrunBy(),this.onDestroyElement(s))}}},{key:"shakeCamera",value:function(e){var t=this.scene.cameras.main;this.fx=this.scene.sound.add("earthquake");var i=.005*e;return t.shake(2500,i),this.fx.play(),new Promise((function(e){setTimeout(e,2500)}))}},{key:"updatePositionsOnScale",value:function(){var e,t=this.scene.children.getByName("layer_1").tilemap;this.moveables.forEach((function(e){e.alien&&e.alien.setPosition(t.tileToWorldX(e.position.x),t.tileToWorldY(e.position.y))}));var i=Object.values(this.interactiveElements).find((function(e){return null===e||void 0===e?void 0:e.isClass(Ot)}));null===(e=i.block)||void 0===e||e.alien.setPosition(t.tileToWorldX(i.position.x-2),t.tileToWorldY(i.position.y)),Object.values(this.decorationElements).forEach((function(e){e.alien.x=dt.tileToScreen(e.position.x),e.alien.y=dt.tileToScreen(e.position.y)}))}},{key:"setTickTimeout",value:function(e,t){var i=t;!function t(a){0===i--?e(a):a.onNextTick((function(e){return t(e)}))}(this)}},{key:"awaitTicks",value:function(e){var t=this;return new Promise((function(i){return t.setTickTimeout(i,e)}))}},{key:"teleportObject",value:function(){var e=Object(q.a)(Q.a.mark((function e(t,i){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.alien.alpha=0,this.moveObject(t,i),t.setPosition(i),e.next=5,this.awaitTicks(3);case 5:t.alien.alpha=1;case 6:case"end":return e.stop()}}),e,this)})));return function(t,i){return e.apply(this,arguments)}}()}]),e}(),ge=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The test",e.diamondsGoal=9,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.scene.input.keyboard.addListener("keyup",this.onKeyUp.bind(this))}},{key:"onKeyUp",value:function(e){"1"===e.key&&this.showDialog1(),"2"===e.key&&this.showDialog2(),"3"===e.key&&this.showDialog3(),"4"===e.key&&this.showDialog4(),"5"===e.key&&this.scene.events.emit("dialogue:updateCharacterName")}},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_1.dialog_1.mary_say_1")],options:[]}]})}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_1.dialog_1.mary_say_1")],options:[]}]})}},{key:"showDialog3",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Marduk","closeUp_Dwarf"],participantNames:["Mary","Marduk","Doc"],conversation:[{who:"closeUp_Mary",text:[ne("level_1.dialog_1.mary_say_1")],options:[]}]})}},{key:"showDialog4",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Marduk","closeUp_Dwarf","closeUp_Tiamat"],participantNames:["Mary","Marduk","Doc","Tiamat"],conversation:[{who:"closeUp_Mary",text:[ne("level_1.dialog_1.mary_say_1")],options:[]}]})}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&this.onComplete(),e.isClass(Et)}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_e);ge.key="level_test";var Ee=ge,Oe=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The wise move",e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){var t=this;Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.unfinished&&e.events.once("levelstart",(function(){return t.showDialog1()}));var a=this.scene.add.image(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,"light_beam");a.x=dt.tileToScreen(14),a.y=dt.tileToScreen(0),a.setOrigin(0,0),a.setScale(2*w),a.scaleX=2.4*w,a.setScrollFactor(1),a.depth=4.5,a.alpha=.5;var s=e.add.particles("spark").setScale(w).createEmitter();s.setPosition({min:dt.tileToPixels(17),max:dt.tileToPixels(28)},{min:dt.tileToPixels(0),max:dt.tileToPixels(15)}),s.setQuantity(5),s.setFrequency(2e4),s.setAngle({min:0,max:360}),s.setSpeed(5),s.setGravityY(.1),s.setGravityX(0),s.setLifespan({min:1e4,max:5e4}),s.alpha.onChange(.5)}},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_2.dialog_1.mary_say_1")],options:[]}]})}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_2.dialog_2.mary_say_1")],options:[]}]})}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&this.onComplete()}},{key:"onJewelPick",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onJewelPick",this).call(this,e),e.isClass(pt)&&1===this.collectedDiamonds&&this.unfinished&&this.showDialog2()}}]),i}(_e);Oe.key="level_2";var Se=Oe,Te=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The tower",e.diamondsGoal=0,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e);var t=this.scene.add.image(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,"light_beam");t.x=dt.tileToScreen(20.5),t.y=dt.tileToScreen(10),t.setOrigin(0,0),t.setScale(2*w),t.scaleX=w,t.setScrollFactor(1),t.depth=4.5,t.alpha=.5;var a=e.add.particles("spark").setScale(w),s=a.createEmitter();s.setPosition({min:dt.tileToPixels(21),max:dt.tileToPixels(26)},{min:dt.tileToPixels(9),max:dt.tileToPixels(24)}),s.setQuantity(5),s.setFrequency(2e4),s.setAngle({min:0,max:360}),s.setSpeed(5),s.setGravityY(.1),s.setGravityX(0),s.setLifespan({min:1e4,max:5e4}),s.alpha.onChange(.5),(t=this.scene.add.image(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,"light_beam")).x=dt.tileToScreen(12.5),t.y=dt.tileToScreen(31),t.setOrigin(0,0),t.setScale(2*w),t.scaleX=2.25*w,t.setScrollFactor(1),t.depth=4.5,t.alpha=.5,(s=(a=e.add.particles("spark").setScale(w)).createEmitter()).setPosition({min:dt.tileToPixels(15),max:dt.tileToPixels(26)},{min:dt.tileToPixels(29),max:dt.tileToPixels(44)}),s.setQuantity(5),s.setFrequency(2e4),s.setAngle({min:0,max:360}),s.setSpeed(5),s.setGravityY(.1),s.setGravityX(0),s.setLifespan({min:1e4,max:5e4}),s.alpha.onChange(.5)}},{key:"onInteractWith",value:function(e){var t=this;if(Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&this.onComplete(),e.isClass(Et)&&[1,2].includes(e.order)&&this.unfinished&&(this.showDialog1(),Object.keys(this.interactiveElements).forEach((function(e){var i=t.interactiveElements[e];i&&!i.isClass(Ot)&&i.order<=2&&(t.interactiveElements[e]=null)}))),e.isClass(Et)&&3===e.order){var a=this.scene.children.getByName("layer_1").tilemap;this.player.power=1,this.player.hasPickaxe=!0,a.putTileAt(V[B.EMPTY],e.position.x,e.position.y,!1,"layer_1"),e.alien.destroy(),this.unfinished&&this.showDialog4()}}},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_3.dialog_1.mary_say_1")],options:[]}]})}},{key:"showDialog4",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_3.dialog_4.mary_say_1")]}]})}},{key:"onAddElement",value:function(e){if(e.isClass(Et)&&3===e.order){var t=this.scene.children.getByName("layer_1"),i=t.tilemap,a=this.scene.add.sprite(48,16).setOrigin(0,.25).play("pickaxe_idle");a.setScale(t.scaleX),a.x=i.tileToWorldX(e.position.x),a.y=i.tileToWorldY(e.position.y),e.alien=a}e.isClass(ft)&&1===this.enemiesCount&&(e.scanDirection="ACW")}}]),i}(_e);Te.key="level_3";var Ae=Te,be=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The round",e.enemiesCount=0,e.countDownAfterQuakeUntilMessage=null,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),[0,1,2,3,4,5,6,7].includes(e.order)&&(this.playEarthquake({x1:e.position.x-9,x2:e.position.x+9,y1:e.position.y-6,y2:e.position.y+6},1),this.unfinished&&(this.countDownAfterQuakeUntilMessage=4,this.scene.events.addListener("player_moves",this.onPlayerMoves,this))),e.isClass(Ot)&&this.onComplete()}},{key:"onPlayerMoves",value:function(){null!==this.countDownAfterQuakeUntilMessage&&(this.countDownAfterQuakeUntilMessage--,0===this.countDownAfterQuakeUntilMessage&&(this.showDialog1(),this.scene.events.removeListener("player_moves",this.onPlayerMove)))}},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_4.dialog_1.mary_say_1")]}]})}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0),e.isClass(ft)&&(this.enemiesCount++,this.enemiesCount%2===0&&(e.scanDirection="ACW"))}}]),i}(_e);be.key="level_4";var xe=be,ke=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The encounter",e.enemiesDeadCount=0,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.unfinished||(this.leader.alien.alpha=0,this.replaceByEmpty(this.leader))}},{key:"destroy",value:function(){}},{key:"updateLight",value:function(){var e=this.scene.children.getByName("layer_1");if(!e)return!0;var t=e.tilemap,i=this.player.position;this.moveables.forEach((function(e){var t,a=c.a.Math.Distance.Snake(i.x,i.y,e.position.x,e.position.y);null===(t=e.alien)||void 0===t||t.setAlpha(1-.1*a)})),t.forEachTile((function(e){var t=c.a.Math.Distance.Snake(i.x,i.y,e.x,e.y);e.setAlpha(1-.1*t)}))}},{key:"onInteractWith",value:function(e){0===e.order&&this.onComplete()}},{key:"onAddElement",value:function(e){var t=this;e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0),e.isClass(vt)&&(e.leadingPath=[{x:8,y:36},{x:9,y:36},{x:10,y:36},{x:11,y:36},{x:11,y:37},{x:11,y:38},{x:11,y:39},{x:11,y:40},{x:12,y:40},{x:13,y:40},{x:14,y:40},{x:14,y:39},{x:14,y:38},{x:15,y:38},{x:16,y:38},{x:17,y:38},{x:18,y:38},{x:19,y:38},{x:20,y:38},{x:21,y:38},{x:22,y:38},{x:23,y:38},{x:24,y:38},{x:25,y:38},{x:26,y:38},{x:27,y:38},{x:28,y:38},{x:29,y:38},{x:30,y:38}],e.isCloseEnough=function(){return t.dwarfRun})}},{key:"onCharacterDie",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onCharacterDie",this).call(this,e),e.isClass(ft)&&(this.enemiesDeadCount++,1===this.enemiesDeadCount&&this.unfinished&&this.player.disconnect(),2===this.enemiesDeadCount&&this.unfinished&&this.encounter())}},{key:"encounter",value:function(){this.dwarfRun=!0,this.onNextTick(this.moveDwarf.bind(this))}},{key:"moveDwarf",value:function(){if(this.dwarfRun)if(this.leader.position.x<11)this.leader.onPlayerMoves(this.player.position),this.onNextTick(this.moveDwarf.bind(this));else{var e;if(!this.leader.alien.anims.currentAnim.key.includes("idle"))null===(e=this.leader)||void 0===e||e.animIdle();this.player.reconnect(),this.showDialog1()}}},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","???"],conversation:[{who:"closeUp_Mary",text:[ne("level_5.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_5.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("level_5.dialog_1.mary_say_2")]},{who:"closeUp_Dwarf",text:[ne("level_5.dialog_1.dwarf_say_2")]},{who:"closeUp_Mary",text:[ne("level_5.dialog_1.mary_say_3")]}]})}}]),i}(_e);ke.key="level_5";var we=ke,Ne=i(16),Re=i.n(Ne),Ie=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The deal",e.diamondsGoal=10,e.dwarfRun=!1,e.preventDisplayDiamondsGoalAmount=!0,e.diamondIdTriggerDwarfMove=4,e.exit=null,e.interactiveTileCloseToExit=null,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.unfinished?this.destroyBlock=function(){return!1}:(this.leader.alien.alpha=0,this.replaceByEmpty(this.leader))}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&this.unfinished&&this.showDialog1(),1===e.order&&this.unfinished&&(this.interactiveTileCloseToExit.ephemeral?this.showDialog2():this.collectedDiamonds>=this.diamondsGoal?this.showDialog3():this.showDialog4()),e.isClass(Ot)&&this.onComplete()}},{key:"onAddElement",value:function(e){var t=this;e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0),e.isClass(Ot)&&(this.exit=e),1===e.order&&(this.interactiveTileCloseToExit=e),e.isClass(vt)&&(e.leadingPath=[{x:10,y:9},{x:11,y:9},{x:12,y:9},{x:12,y:10},{x:12,y:10},{x:12,y:10},{x:13,y:11},{x:13,y:11},{x:13,y:11},{x:14,y:12},{x:15,y:12},{x:16,y:12},{x:17,y:12},{x:18,y:12},{x:18,y:11},{x:19,y:11},{x:20,y:11},{x:21,y:11},{x:22,y:11},{x:23,y:11},{x:24,y:11},{x:25,y:11},{x:26,y:11},{x:27,y:11},{x:28,y:11},{x:29,y:11},{x:30,y:11}],e.isCloseEnough=function(){return t.dwarfRun})}},{key:"onJewelPick",value:function(e){if(Object(A.a)(Object(b.a)(i.prototype),"onJewelPick",this).call(this,e),e.order===this.diamondIdTriggerDwarfMove){var t={x:this.exit.position.x-3,y:this.exit.position.y};this.teleportObject(this.leader,t),this.interactiveElements["".concat(this.interactiveTileCloseToExit.position.x,"-").concat(this.interactiveTileCloseToExit.position.y)]?this.interactiveTileCloseToExit.ephemeral=!1:(this.interactiveTileCloseToExit.ephemeral=!1,this.interactiveElements["".concat(this.interactiveTileCloseToExit.position.x,"-").concat(this.interactiveTileCloseToExit.position.y)]=this.interactiveTileCloseToExit),console.log(this.interactiveTileCloseToExit)}}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.scene.events.emit("score:diamond_goal_set",e.diamondsGoal)})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","???"],conversation:[{who:"closeUp_Mary",text:[ne("level_6.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_6.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("level_6.dialog_1.mary_say_2")]},{who:"closeUp_Dwarf",text:[ne("level_6.dialog_1.dwarf_say_2")]},{who:"closeUp_Mary",text:[ne("level_6.dialog_1.mary_say_3")]},{who:"closeUp_Dwarf",text:[ne("level_6.dialog_1.dwarf_say_3")]},{who:"closeUp_Mary",text:[ne("level_6.dialog_1.mary_say_4")]},{who:"closeUp_Dwarf",text:[ne("level_6.dialog_1.dwarf_say_4")]},{who:"closeUp_Dwarf",text:[ne("level_6.dialog_1.dwarf_say_5")]},{who:"closeUp_Mary",text:[ne("level_6.dialog_1.mary_say_5")]}]}),this.scene.events.once("dialogue:hidden",(function(){e.player.disconnect(),e.dwarfRun=!0,e.moveDwarf()}))}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_6.dialog_2.mary_say_1")]}]})}},{key:"showDialog3",value:function(){var e=this;this.scene.events.on("dialogue:message_shown",(function(t){2===t&&e.scene.events.emit("dialogue:updateCharacterName",{key:"closeUp_Dwarf",name:"Doc"})})),this.scene.events.once("dialogue:hidden",(function(){e.interactiveElements["".concat(e.interactiveTileCloseToExit.position.x,"-").concat(e.interactiveTileCloseToExit.position.y)]=null,e.scene.tweens.add({targets:e.exit.block.alien,x:dt.tileToScreen(e.exit.position.x),duration:500,onComplete:function(){return e.exit.block.alien.destroy()}}),e.player.disconnect(),e.dwarfRun=!0,e.leader.leadingPath=[{x:e.leader.position.x+1,y:e.leader.position.y},{x:e.leader.position.x+1,y:e.leader.position.y},{x:e.leader.position.x+2,y:e.leader.position.y},{x:e.leader.position.x+2,y:e.leader.position.y},{x:e.leader.position.x+3,y:e.leader.position.y},{x:e.leader.position.x+3,y:e.leader.position.y}],e.moveDwarfToExit()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","???"],conversation:[{who:"closeUp_Mary",text:[ne("level_6.dialog_3.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_6.dialog_3.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("level_6.dialog_3.mary_say_2")]},{who:"closeUp_Dwarf",text:[ne("level_6.dialog_3.dwarf_say_2")]}]})}},{key:"showDialog4",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","???"],conversation:[{who:"closeUp_Dwarf",text:[Re()(ne("level_6.dialog_4.dwarf_say_1"))({NUM:this.collectedDiamonds})]}]})}},{key:"moveDwarf",value:function(){var e=this;if(this.dwarfRun)if(this.leader.position.x<16)this.leader.onPlayerMoves(this.player.position),this.onNextTick((function(){e.leader.animIdle(),e.moveDwarf()}));else{this.leader.animIdle(),this.player.reconnect();var t=function(){e.leader.position.x>=30&&(e.dwarfRun=!1,e.scene.events.removeListener("player_moves",t))}.bind(this);this.scene.events.addListener("player_moves",t)}}},{key:"moveDwarfToExit",value:function(){var e=this;this.dwarfRun&&(this.leader.position.x<this.exit.position.x?this.onNextTick((function(){e.leader.onPlayerMoves(e.player.position),e.moveDwarfToExit()})):(this.leader.animIdle(),this.player.reconnect()))}}]),i}(_e);Ie.key="level_6";var De=Ie,Me=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The dangerous chambers",e.diamondsGoal=12,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Et)&&!e.isClass(Ot)&&this.playEarthquake({x1:e.position.x-3,x2:e.position.x+6,y1:e.position.y-10,y2:e.position.y},2),e.isClass(Ot)&&this.onComplete()}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_e);Me.key="level_7";var Ue=Me,Ce=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The Sisyphean task",e.diamondsGoal=40,e.dwarf=null,e.broSprite=null,e.grayscalePipeline=null,e.tripMusic=null,e.firstVisit=!0,e.tookTheTrip=!1,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){var t=this;Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.focusElement=this.player,this.tookTheTrip=K.a.get("tripDone")||!1,this.tookTheTrip?(this.replaceByEmpty(this.leader),this.leader.alien.destroy(),this.leader=null,Object.keys(this.interactiveElements).forEach((function(e){t.interactiveElements[e].isClass(Ot)||(t.interactiveElements[e]=null)}))):(this.broSprite=this.scene.add.sprite(48,16).setOrigin(0,.25),this.broSprite.setScale(w),this.broSprite.play("bro_idle"),this.broSprite.x=this.dwarf.alien.x+dt.tileToScreen(12),this.broSprite.y=this.dwarf.alien.y,this.grayscalePipeline=this.scene.renderer.pipelines.get("Gray"),this.player.alien.setPipeline(this.grayscalePipeline),this.tripMusic=this.scene.sound.add("swarf_chat_music",{loop:!0,valume:0}))}},{key:"onComplete",value:function(){K.a.set("tripDone",this.tookTheTrip),Object(A.a)(Object(b.a)(i.prototype),"onComplete",this).call(this)}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&(this.firstVisit?this.totalShroomsAmount>0?this.showDialog1():this.showDialog1NoShroom():this.showDialog1Revisit(),this.firstVisit=!1),e.isClass(Ot)&&this.onComplete()}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0),e.isClass(Et)&&(e.ephemeral=!1),e.isClass(vt)&&(e.isCloseEnough=function(){return!1},this.dwarf=e)}},{key:"showDialog1NoShroom",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[ne("level_8.dialog_1_no_shrooms.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_8.dialog_1_no_shrooms.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("level_8.dialog_1_no_shrooms.mary_say_2")]},{who:"closeUp_Dwarf",text:[Re()(ne("level_8.dialog_1_no_shrooms.dwarf_say_2"))({NUM:5})]}]})}},{key:"showDialog1Revisit",value:function(){var e=this;this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[ne("level_8.dialog_1_repeat.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("level_8.dialog_1_repeat.mary_say_1")],options:{slot0:{label:ne("level_8.dialog_1_option.yes"),slot:0,onSelect:function(){return e.scene.events.emit("dialogue:nextPage")}},slot1:{label:ne("level_8.dialog_1_option.no"),slot:1,onSelect:function(){return e.scene.events.emit("dialogue:nextPage",1)}},slot2:null,slot3:null}},{who:"closeUp_Mary",text:[ne("level_8.dialog_1_repeat.mary_say_2_yes")],options:{slot2:null,slot3:{label:ne("menu.dialog_options.close"),slot:3,onSelect:function(){e.scene.events.emit("dialogue:hide"),e.scene.events.once("dialogue:hidden",(function(){e.playTheTrip(),e.scene.events.emit("score:mushroom_given"),e.collectedShrooms--,e.tookTheTrip=!0}))}}}},{who:"closeUp_Mary",text:[ne("level_8.dialog_1_repeat.mary_say_2_no")]}]})}},{key:"showDialog1",value:function(){var e=this;this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[ne("level_8.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_8.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("level_8.dialog_1.mary_say_2")],options:{slot0:{label:ne("level_8.dialog_1_option.yes"),slot:0,onSelect:function(){return e.scene.events.emit("dialogue:nextPage")}},slot1:{label:ne("level_8.dialog_1_option.no"),slot:1,onSelect:function(){return e.scene.events.emit("dialogue:nextPage",1)}},slot2:null,slot3:null}},{who:"closeUp_Mary",text:[ne("level_8.dialog_1.mary_say_3_yes")],options:{slot2:null,slot3:{label:ne("menu.dialog_options.close"),slot:3,onSelect:function(){e.scene.events.emit("dialogue:hide"),e.scene.events.once("dialogue:hidden",(function(){e.playTheTrip(),e.scene.events.emit("score:mushroom_given"),e.collectedShrooms--,e.tookTheTrip=!0}))}}}},{who:"closeUp_Mary",text:[ne("level_8.dialog_1.mary_say_3_no")]}]})}},{key:"showDialog2",value:function(){var e=this;return new Promise((function(t){e.scene.events.emit("dialogue:show",{participants:["closeUp_Dwarf","closeUp_Marduk"],participantNames:["Doc","Marduk"],conversation:[{who:"closeUp_Dwarf",text:[ne("level_8.dialog_2.dwarf_say_1")]},{who:"closeUp_Marduk",text:[ne("level_8.dialog_2.marduk_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_8.dialog_2.dwarf_say_2")]},{who:"closeUp_Marduk",text:[ne("level_8.dialog_2.marduk_say_2")]},{who:"closeUp_Dwarf",text:[ne("level_8.dialog_2.dwarf_say_3")]},{who:"closeUp_Marduk",text:[ne("level_8.dialog_2.marduk_say_3")]},{who:"closeUp_Dwarf",text:[ne("level_8.dialog_2.dwarf_say_4")]},{who:"closeUp_Dwarf",text:[ne("level_8.dialog_2.dwarf_say_5")]},{who:"closeUp_Marduk",text:[ne("level_8.dialog_2.marduk_say_4")]},{who:"closeUp_Dwarf",text:[ne("level_8.dialog_2.dwarf_say_6")]},{who:"closeUp_Dwarf",text:[ne("level_8.dialog_2.dwarf_say_7")]}]}),e.scene.events.once("dialogue:hidden",(function(){setTimeout(t,500)}))}))}},{key:"showDialog3",value:function(){var e=this;return new Promise((function(t){e.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[ne("level_8.dialog_3.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_8.dialog_3.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("level_8.dialog_3.mary_say_2")]},{who:"closeUp_Dwarf",text:[ne("level_8.dialog_3.dwarf_say_2")]}]}),e.scene.events.once("dialogue:hidden",(function(){setTimeout(t,500)}))}))}},{key:"playTheTrip",value:function(){var e=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.player.disconnect(),e.next=3,this.animFadeOutLevel();case 3:return e.next=5,this.moveCamera();case 5:return this.animPlayerAndDwarf(),e.next=8,this.animBroEntrance();case 8:return e.next=10,this.showDialog2();case 10:return e.next=12,this.vanishBro();case 12:return e.next=14,this.animDwarfMoveCloseToPlayer();case 14:return e.next=16,this.showDialog3();case 16:return e.next=18,this.vanishDwarf();case 18:return e.next=20,this.animFadeInLevel();case 20:this.restoreRegularGamePlay();case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"restoreRegularGamePlay",value:function(){this.interactiveElements["".concat(this.player.position.x,"-").concat(this.player.position.y)]=null,this.setObjectAt(this.dwarf.position.x,this.dwarf.position.y,new ce(B.EMPTY,this)),this.player.reconnect(),this.focusElement=this.player}},{key:"vanishDwarf",value:function(){var e=this;return new Promise((function(t){e.scene.tweens.add({targets:e.player.alien,x:e.player.alien.x+dt.tileToScreen(2),duration:3e3,ease:"Linear",onComplete:function(){}}),e.scene.tweens.add({targets:[e.dwarf.alien],duration:3e3,alpha:0,x:e.dwarf.alien.x+dt.tileToScreen(2),onComplete:t}),e.scene.tweens.add({targets:e.scene.rules.music,volume:1,delay:1500,ease:"Linear",duration:1e3}),e.scene.tweens.add({targets:e.tripMusic,volume:0,ease:"Linear",duration:1e3,onComplete:function(){return e.tripMusic.stop()}})}))}},{key:"vanishBro",value:function(){var e=this;return new Promise((function(t){e.scene.tweens.add({targets:e.broSprite,duration:2e3,alpha:0,onComplete:t})}))}},{key:"animBroEntrance",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.scene.tweens.add({targets:t.broSprite,x:t.broSprite.x-dt.tileToScreen(10),duration:2500,ease:"Linear",delay:2500,onComplete:function(){t.player.animIdle(),t.dwarf.animIdle(),t.dwarf.animRunRight(),e()}})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animDwarfMoveCloseToPlayer",value:function(){var e=this;return new Promise((function(t){e.dwarf.animRunLeft(),e.dwarf.animRun(),e.scene.tweens.add({targets:e.dwarf.alien,x:e.dwarf.alien.x-dt.tileToScreen(1),duration:x,ease:"Linear",onComplete:function(){e.dwarf.animIdle(),e.dwarf.animRunRight(),e.scene.tweens.add({targets:e.grayscalePipeline,duration:1e3,gray:0,completeDelay:1e3,onComplete:t})}})}))}},{key:"animPlayerAndDwarf",value:function(){var e=this;this.dwarf.animRunRight(),this.dwarf.animRun(),this.scene.tweens.add({targets:this.player.alien,x:this.player.alien.x-dt.tileToScreen(2),duration:500,ease:"Linear",onComplete:function(){e.player.animRun()}})}},{key:"moveCamera",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.focusElement={position:{x:this.player.position.x,y:this.player.position.y}},e.abrupt("return",new Promise((function(e){t.scene.tweens.add({targets:t.focusElement.position,x:t.dwarf.position.x+5,ease:"Linear",duration:1e3,onComplete:e})})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"animFadeInLevel",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.scene.tweens.add({targets:{alpha:0},alpha:1,ease:"Linear",duration:2e3,onUpdate:function(e,i){t.setLevelAlpha(i.alpha)},onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animFadeOutLevel",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.scene.tweens.add({targets:t.grayscalePipeline,delay:1e3,duration:1e3,gray:1}),t.scene.tweens.add({targets:{alpha:1},alpha:0,ease:"Linear",duration:1e3,onUpdate:function(e,i){t.setLevelAlpha(i.alpha)},onComplete:e}),t.scene.tweens.add({targets:t.scene.rules.music,volume:0,ease:"Linear",duration:1e3}),t.tripMusic.volume=0,t.tripMusic.play(),t.scene.tweens.add({targets:t.tripMusic,volume:1,delay:500,ease:"Linear",duration:1e3})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setLevelAlpha",value:function(e){var t=this.scene.children.getByName("layer_1"),i=this.scene.children.getByName("layer_1z2"),a=this.scene.children.getByName("layer_2"),s=this.scene.children.getByName("layer_0"),n=this.scene.children.getByName("level_background_art");t.setAlpha(e),i.setAlpha(e),a.setAlpha(e),s.setAlpha(e),n.setAlpha(e/4),this.objects.forEach((function(t){return t.forEach((function(t){!t.alien||t.isClass(_t)||t.isClass(vt)||t.alien.setAlpha(e)}))})),Object.values(this.decorationElements).forEach((function(t){return t.alien.setAlpha(e)}))}}]),i}(_e);Ce.key="level_8";var Le=Ce,je=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The floodgates",e.diamondsGoal=10,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&this.onComplete()}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_e);je.key="level_9";var Pe=je,Ge=i(19),He=i.n(Ge),Fe=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).easystar=new He.a.js,e.name="The castle",e.diamondsGoal=10,e.exit=null,e.dwarf=null,e.dwarfRun=!1,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){var t=this;if(Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.unfinished){this.destroyBlock=function(){return!1};var a=this.objects.map((function(e){return e.map((function(e){return e.isClass(vt)||e.isClass(ce)?0:1}))}));this.easystar.setGrid(a),this.easystar.setAcceptableTiles([0]),this.easystar.findPath(this.leader.position.x,this.leader.position.y,this.exit.position.x-3,this.exit.position.y,(function(e){t.leader.leadingPath=e.slice(1)})),this.easystar.calculate()}else this.leader.alien.alpha=0,this.replaceByEmpty(this.leader)}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&this.unfinished&&this.showDialog1(),1===e.order&&this.unfinished&&(this.diamondsGoal<=this.collectedDiamonds?this.clearPath():this.showDialog3()),e.isClass(Ot)&&this.onComplete()}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.player.disconnect(),e.dwarfRun=!0,e.moveDwarf()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[ne("level_10.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_10.dialog_1.dwarf_say_1")]}]})}},{key:"showDialog2",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.scene.events.off("player_moves"),e.player.reconnect()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_10.dialog_2.mary_say_1")]}]})}},{key:"showDialog3",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[Re()(ne("level_10.dialog_3.dwarf_say_1"))({NUM:this.diamondsGoal})]}]})}},{key:"moveDwarf",value:function(){var e=this;this.dwarfRun?(this.leader.leadingPath.length||(this.dwarfRun=!1),this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarf()}))):this.leader.animIdle(),10===this.leader.leadingPath.length&&(this.leader.animIdle(),this.showDialog2())}},{key:"clearPath",value:function(){var e=this;this.scene.tweens.add({targets:this.exit.block.alien,x:dt.tileToScreen(this.exit.position.x),duration:500,onComplete:function(){return e.exit.block.alien.destroy()}}),this.leader.leadingPath=[{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y}],this.player.disconnect(),this.dwarfRun=!0,this.moveDwarfToExit()}},{key:"moveDwarfToExit",value:function(){var e=this;this.dwarfRun&&(this.leader.position.x<this.exit.position.x?this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarfToExit()})):(this.onNextTick((function(){e.replaceByEmpty(e.leader)})),this.player.reconnect()))}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0),e.isClass(Ot)&&(this.exit=e),e.isClass(Et)&&1===e.order&&(e.ephemeral=!1,this.scene.events.once("score:diamond_goal",(function(){return e.ephemeral=!0})))}}]),i}(_e);Fe.key="level_10";var We=Fe,Be=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).easystar=new He.a.js,e.name="The fallen city",e.diamondsGoal=14,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){var t=this;Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.unfinished&&(this.destroyBlock=function(){return!1}),e.events.once("barre:explode",(function(e){t.setTickTimeout((function(e){return e.showDialog2()}),5)}))}},{key:"onInteractWith",value:function(e){var t=this;if(Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&this.unfinished&&this.showDialog1(),1===e.order&&this.unfinished&&this.showDialog3(),2===e.order&&this.unfinished){var a={x:this.exit.position.x-3,y:this.exit.position.y};this.leader.alien.alpha=0,this.moveObject(this.leader,a),setTimeout((function(){t.leader.alien.alpha=1,t.scene.events.on("player_moves",(function(e){t.leader.testProximity(e,1,!0)&&(t.diamondsGoal<=t.collectedDiamonds?(t.clearPath(),t.scene.events.off("player_moves")):t.showDialog4())}))}),500)}e.isClass(Ot)&&this.onComplete()}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){var t=e.objects.map((function(e){return e.map((function(e){return e.isClass(vt)||e.isClass(ce)?0:1}))}));e.easystar.setGrid(t),e.easystar.setAcceptableTiles([0]),e.scene.events.off("player_moves"),e.player.disconnect(),e.easystar.enableDiagonals(),e.easystar.findPath(e.leader.position.x,e.leader.position.y,1,10,(function(t){e.leader.leadingPath=t.slice(1),e.easystar.findPath(1,10,7,18,(function(t){e.leader.leadingPath=[].concat(Object(h.a)(e.leader.leadingPath),Object(h.a)(t.slice(1))).reduce((function(e,t,i,a){if(a[i-1]){var s=a[i-1];o=s,(n=t).x!==o.x&&n.y!==o.y&&e.push(s)}var n,o;return e.push(t),e}),[]),e.dwarfRun=!0,e.moveDwarf(),e.setTickTimeout((function(e){return e.player.reconnect()}),4)})),e.easystar.calculate()})),e.easystar.calculate()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[ne("level_11.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_11.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("level_11.dialog_1.mary_say_2")]},{who:"closeUp_Dwarf",text:[ne("level_11.dialog_1.dwarf_say_2")]},{who:"closeUp_Dwarf",text:[ne("level_11.dialog_1.dwarf_say_3")]},{who:"closeUp_Mary",text:[ne("level_11.dialog_1.mary_say_3")]},{who:"closeUp_Dwarf",text:[ne("level_11.dialog_1.dwarf_say_4")]}]})}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_11.dialog_2.mary_say_1")]}]})}},{key:"showDialog3",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[ne("level_11.dialog_3.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("level_11.dialog_3.mary_say_1")]}]})}},{key:"showDialog4",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[Re()(ne("level_11.dialog_4.dwarf_say_1"))({NUM:this.diamondsGoal})]}]})}},{key:"moveDwarf",value:function(){var e=this;this.dwarfRun?(this.leader.leadingPath.length||(this.dwarfRun=!1),this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarf()}))):this.leader.animIdle()}},{key:"clearPath",value:function(){var e=this;this.scene.tweens.add({targets:this.exit.block.alien,x:dt.tileToScreen(this.exit.position.x),duration:500,onComplete:function(){return e.exit.block.alien.destroy()}}),this.leader.leadingPath=[{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y}],this.player.disconnect(),this.dwarfRun=!0,this.moveDwarfToExit()}},{key:"moveDwarfToExit",value:function(){var e=this;this.dwarfRun&&(this.leader.position.x<this.exit.position.x?this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarfToExit()})):(this.onNextTick((function(){e.replaceByEmpty(e.leader)})),this.player.reconnect()))}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0),e.isClass(vt)&&(e.leadingPath=[]),e.isClass(Ot)&&(this.exit=e)}}]),i}(_e);Be.key="level_11";var Ye=Be,Xe=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="Time trial",e.diamondsGoal=7,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&this.onComplete()}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_e);Xe.key="level_12";var Ve=Xe,Ke=i(13),Je=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="Risky business",e.diamondsGoal=9,e.interactiveCounts=0,e.quakeTriggerIndex=Math.trunc(100*Math.random())%4,e.playerOriginPosition=null,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.playerOriginPosition=Object(Ke.a)({},this.player.position)}},{key:"onInteractWith",value:function(e){if(Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&this.onComplete(),e.isClass(Et)){if(this.interactiveCounts===this.quakeTriggerIndex){this.playEarthquake({x1:this.playerOriginPosition.x-17-1,x2:this.playerOriginPosition.x-1,y1:e.position.y-11,y2:this.playerOriginPosition.y},3)}this.interactiveCounts++}}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_e);Je.key="level_13";var Qe=Je,qe=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="Short fuse",e.diamondsGoal=10,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&this.onComplete()}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_e);qe.key="level_14";var ze=qe,Ze=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The catacomb",e.diamondsGoal=15,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&this.onComplete()}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_e);Ze.key="level_15";var $e=Ze,et=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The sanctuary",e.diamondsGoal=25,e.wasInSanctuary=!1,e.maryTalkedToDocAboutTheSactuary=!1,e.quakeTrigger=null,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){var t=this;if(Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.scene.add.text(dt.tileToScreen(this.follower.position.x-.3),dt.tileToScreen(this.follower.position.y+2.5),"\ud808\udc2d\ud808\udf13",{fontFamily:"GameGirl",fill:"#503F35",align:"right"}).setScale(w),this.scene.add.text(dt.tileToScreen(this.follower.position.x-.25),dt.tileToScreen(this.follower.position.y+2.55),"\ud808\udc2d\ud808\udf13",{fontFamily:"GameGirl",fill:"#947E6C",align:"right"}).setScale(w),this.unfinished)this.follower.isFollowing=!1,this.destroyBlock=function(){return!1},this.follower.animLayRight();else{var a=function(e,i){var a=t.getObjectAt(e,i);a.overrunBy(),t.replaceByEmpty(a)};a(this.quakeTrigger.position.x-1,this.quakeTrigger.position.y+1),a(this.quakeTrigger.position.x-2,this.quakeTrigger.position.y+1),a(this.quakeTrigger.position.x-3,this.quakeTrigger.position.y+1);var s=function(e,i){var a=t.getObjectAt(e,i);a.overrunBy(),t.replaceByEmpty(a)};s(this.quakeTrigger.position.x+1,this.quakeTrigger.position.y-1),s(this.quakeTrigger.position.x+2,this.quakeTrigger.position.y-1),this.follower.alien.destroy(),this.follower=null,this.replaceByEmpty(this.leader),this.leader.alien.destroy(),this.leader=null,Object.keys(this.interactiveElements).forEach((function(e){t.interactiveElements[e].isClass(Ot)||(t.interactiveElements[e]=null)}))}}},{key:"onInteractWith",value:function(e){(Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&(this.unfinished?this.goToSanctuary():this.onComplete()),e.isClass(Et)&&0===e.order&&this.playTheSighting(e),e.isClass(Et)&&2===e.order)&&(this.collectedDiamonds>=this.diamondsGoal&&(this.interactiveElements["".concat(e.position.x,"-").concat(e.position.y)]=null),this.maryTalkedToDocAboutTheSactuary?this.showDialog2_repeat():this.showDialog2());e===this.sanctuaryEntrance&&this.wasInSanctuary&&this.onComplete()}},{key:"onAddElement",value:function(e){if(e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0),e.isClass(ft)&&(e.scanDirection="CCW"),e.isClass(Et)&&2===e.order&&(e.ephemeral=!1),e.isClass(Et)&&0===e.order&&(this.quakeTrigger=e),e.isClass(Et)&&1===e.order&&(e.ephemeral=!1,this.sanctuaryEntrance=e),e.isClass(Ot)&&this.unfinished){var t=this.scene.children.getByName("layer_1z2");this.scene.children.getByName("layer_2").copy(e.position.x-2,e.position.y-2,5,5,this.sanctuaryEntrance.position.x-2,this.sanctuaryEntrance.position.y-2),t.copy(e.position.x-2,e.position.y-2,5,5,this.sanctuaryEntrance.position.x-2,this.sanctuaryEntrance.position.y-2)}}},{key:"playTheSighting",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.playEarthquake({x1:this.player.position.x-3,x2:this.player.position.x+3,y1:this.player.position.y-1,y2:this.player.position.y+2},4);case 2:return this.player.disconnect(),e.next=5,this.awaitTicks(10);case 5:return this.player.animPushRight(),e.next=8,this.awaitTicks(4);case 8:return this.player.animPushRight(),this.onNextTick((function(){return t.player.animPushRight()})),e.next=12,this.awaitTicks(4);case 12:return e.next=14,this.showDialog1();case 14:this.player.reconnect();case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showDialog1",value:function(){var e=this;return new Promise((function(t){e.scene.events.once("dialogue:hidden",t),e.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_16.dialog_1.mary_say_1")]},{who:"closeUp_Mary",text:[ne("level_16.dialog_1.mary_say_2")]},{who:"closeUp_Mary",text:[ne("level_16.dialog_1.mary_say_3")]}]})}))}},{key:"showDialog2",value:function(){var e=this;this.maryTalkedToDocAboutTheSactuary=!0;var t=this.collectedDiamonds>=this.diamondsGoal;this.scene.events.once("dialogue:hidden",(function(){t&&e.moveToExit()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[ne("level_16.dialog_2.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_16.dialog_2.dwarf_say_1")],options:{slot2:{label:ne("menu.dialog_options.next"),slot:2,onSelect:function(){e.collectedDiamonds<e.diamondsGoal?e.scene.events.emit("dialogue:nextPage"):e.scene.events.emit("dialogue:nextPage",1)}}}},{who:"closeUp_Dwarf",text:[Re()(ne("level_16.dialog_2.dwarf_say_2_diamonds"))({NUM:this.diamondsGoal})],options:{slot2:null}},{who:"closeUp_Mary",text:[ne("level_16.dialog_2.mary_say_2")]}]})}},{key:"showDialog2_repeat",value:function(){var e=this,t=this.collectedDiamonds>=this.diamondsGoal;this.scene.events.once("dialogue:hidden",(function(){t&&e.moveToExit()}));var i={who:"closeUp_Mary",text:[ne("level_16.dialog_2_repeat.mary_say_1")]},a={who:"closeUp_Dwarf",text:[Re()(ne("level_16.dialog_2_repeat_no_diamonds.dwarf_say_1"))({NUM:this.diamondsGoal})]};this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[t?i:a]})}},{key:"moveToExit",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dwarfRun=!0,this.leader.leadingPath=[{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y}],this.scene.tweens.add({targets:this.exit.block.alien,x:dt.tileToScreen(this.exit.position.x),duration:500,onComplete:function(){t.exit.block.alien.destroy()}}),this.interactiveElements["".concat(this.exit.position.x,"-").concat(this.exit.position.y)]=null,this.exit.setPosition({x:this.exit.position.x+1,y:this.exit.position.y}),this.moveDwarf(),e.next=8,this.awaitTicks(this.leader.leadingPath.length);case 8:return e.next=10,this.teleportObject(this.leader,this.sanctuaryEntrance.position);case 10:this.exit.setPosition({x:this.exit.position.x-1,y:this.exit.position.y}),this.interactiveElements["".concat(this.exit.position.x,"-").concat(this.exit.position.y)]=this.exit;case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"moveDwarf",value:function(){var e=this;this.dwarfRun&&(this.leader.leadingPath.length?this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarf()})):(this.dwarfRun=!1,this.leader.animIdle()))}},{key:"movePlayer",value:function(){var e=this;this.playerRun&&this.onNextTick((function(){e.player.moveToNextPosition()?e.movePlayer():e.playerRun=!1}))}},{key:"goToSanctuary",value:function(){var e=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.player.disconnect(),this.focusElement={position:this.sanctuaryEntrance.position},e.next=4,this.awaitTicks(7);case 4:return this.follower.alien.alpha=0,e.next=7,this.teleportObject(this.player,this.sanctuaryEntrance.position);case 7:return this.player.mandatoryPath=[{x:this.sanctuaryEntrance.position.x-1,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-2,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-3,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-4,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-5,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-6,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-7,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-8,y:this.sanctuaryEntrance.position.y}],this.playerRun=!0,this.movePlayer(),e.next=12,this.awaitTicks(1);case 12:return this.leader.leadingPath=[{x:this.sanctuaryEntrance.position.x-1,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-2,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-3,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-4,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-5,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-6,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-7,y:this.sanctuaryEntrance.position.y}],this.dwarfRun=!0,this.moveDwarf(),e.next=17,this.awaitTicks(this.leader.leadingPath.length);case 17:return e.next=19,this.awaitTicks(3);case 19:this.showDialog3();case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"moveDocToFinalExit",value:function(){var e=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.leader.leadingPath=[{x:this.sanctuaryEntrance.position.x,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-1,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-2,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-3,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-4,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-5,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-6,y:this.sanctuaryEntrance.position.y},{x:this.sanctuaryEntrance.position.x-7,y:this.sanctuaryEntrance.position.y}].reverse(),this.dwarfRun=!0,this.moveDwarf(),e.next=5,this.awaitTicks(this.leader.leadingPath.length+2);case 5:this.leader.alien.destroy(),this.leader.alien=null,this.replaceByEmpty(this.leader);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showDialog3",value:function(){var e=this;this.scene.events.once("dialogue:hidden",Object(q.a)(Q.a.mark((function t(){return Q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.wasInSanctuary=!0,t.next=3,e.moveDocToFinalExit();case 3:e.player.reconnect();case 4:case"end":return t.stop()}}),t)})))),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[ne("level_16.dialog_3.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_16.dialog_3.dwarf_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_16.dialog_3.dwarf_say_2")]}]})}}]),i}(_e);et.key="level_16";var tt=et,it=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="Into the dark",e.diamondsGoal=10,e.quakePlayed=!1,e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){var t=this;Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.destroyBlock=function(){return null},e.lights.enable().setAmbientColor(0),this.unfinished?(this.staticlight=e.lights.addLight(dt.tileToScreen(this.exit.position.x),dt.tileToScreen(this.exit.position.y),1e3).setColor(15395562).setIntensity(1.5),e.time.addEvent({delay:100,callback:function(){!this.exit.block.alien.active&&this.staticlight.intensity>0&&this.staticlight.setIntensity(this.staticlight.intensity-.5),c.a.Geom.Ellipse.Random(this.exit.block.alien,this.staticlight)},callbackScope:this,repeat:-1})):(this.replaceByEmpty(this.leader),this.leader.alien.destroy(),this.leader=null,Object.keys(this.interactiveElements).forEach((function(e){t.interactiveElements[e].isClass(Ot)||(t.interactiveElements[e]=null)}))),e.children.getByName("layer_0").setPipeline("Light2D"),e.children.getByName("layer_1").setPipeline("Light2D"),e.children.getByName("layer_2").setPipeline("Light2D"),e.children.getByName("layer_1z2").setPipeline("Light2D"),this.moveables.forEach((function(e){return!e.isClass(_t)&&e.alien.active&&e.alien.setPipeline("Light2D")})),Object.values(this.decorationElements).forEach((function(e){var t;return null===(t=e.alien)||void 0===t?void 0:t.setPipeline("Light2D")})),this.scene.events.on("player_moves",(function(e){t.updateLight(e),t.unfinished&&t.detectDocTeleporting(e)}))}},{key:"detectDocTeleporting",value:function(e){e.y>45&&this.leader.position.y<10&&this.teleportObject(this.leader,{x:this.exit.position.x-3,y:this.exit.position.y})}},{key:"updateLight",value:function(e){var t,i,a;if(!this.exit)return!1;if(e.x===this.exit.position.x-3&&e.y===this.exit.position.y)null===(i=this.player.light)||void 0===i||i.setRadius(500),null===(a=this.player.light)||void 0===a||a.setIntensity(1.3),this.eyeAnimation&&(this.exitEye.alpha=0,this.eyeAnimation.remove());else if(e.x===this.exit.position.x-2&&e.y===this.exit.position.y){var s,n;null===(s=this.player.light)||void 0===s||s.setRadius(250),null===(n=this.player.light)||void 0===n||n.setIntensity(.8),this.eyeAnimation&&this.eyeAnimation.remove(),this.exitEye.alpha=.1,this.eyeAnimation=this.scene.tweens.add({targets:this.exitEye,alpha:.2,duration:100,yoyo:!0,repeat:-1})}else if(e.x===this.exit.position.x-1&&e.y===this.exit.position.y){var o,r;null===(o=this.player.light)||void 0===o||o.setIntensity(.3),null===(r=this.player.light)||void 0===r||r.setRadius(125),this.eyeAnimation&&this.eyeAnimation.remove(),this.exitEye.alpha=.3,this.eyeAnimation=this.scene.tweens.add({targets:this.exitEye,alpha:.5,duration:100,yoyo:!0,repeat:-1})}else if(e.x===this.exit.position.x&&e.y===this.exit.position.y){var l;null===(l=this.player.light)||void 0===l||l.setIntensity(.1)}else if(1.5!==(null===(t=this.player.light)||void 0===t?void 0:t.intensity)){var c,h;null===(c=this.player.light)||void 0===c||c.setIntensity(1.5),null===(h=this.player.light)||void 0===h||h.setRadius(1e3)}}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&this.onComplete(),e.isClass(Et)&&0===e.order&&this.unfinished&&this.showDialog1(),e.isClass(Et)&&1===e.order&&this.unfinished&&(this.collectedDiamonds<this.diamondsGoal?this.showDialogGoal():(this.moveToExit(),this.interactiveElements["".concat(e.position.x,"-").concat(e.position.y)]=null))}},{key:"onAddElement",value:function(e){if(e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0,e.alien.alpha=.5,this.onNextTick((function(t){t.unfinished||e.ligthTorch()}))),e.isClass(Ot)){var t=this.scene.children.getByName("layer_2"),i=t.tilemap;this.exitEye=this.scene.add.sprite(48,16,"spark").setOrigin(.5,.5),this.exitEye.setTintFill(13784064),this.exitEye.setScale(2*t.scaleX,4*t.scaleX),this.exitEye.x=i.tileToWorldX(e.position.x-.5),this.exitEye.y=i.tileToWorldY(e.position.y-.4),this.exitEye.depth=100,this.exitEye.alpha=0}e.isClass(At)&&0===e.order&&e.ignite(),e.isClass(Et)&&1===e.order&&(e.ephemeral=!1)}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.player.ligthTorch(),e.setTickTimeout((function(){e.showDialog2()}),10)})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Dwarf","closeUp_Mary"],participantNames:["Doc","Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_17.dialog_1.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_17.dialog_1.dwarf_say_1")]}]})}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Dwarf","closeUp_Mary"],participantNames:["Doc","Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_17.dialog_2.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("level_17.dialog_2.dwarf_say_1")]}]})}},{key:"showDialogGoal",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[Re()(ne("levels.goal_dialog.dwarf_say_1"))({GOAL:this.diamondsGoal,NUM:this.collectedDiamonds})]}]})}},{key:"moveToExit",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.player.disconnect(),this.dwarfRun=!0,this.leader.leadingPath=[{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+1,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+2,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y},{x:this.leader.position.x+3,y:this.leader.position.y}],this.moveDwarf(),this.scene.tweens.add({targets:this.exit.block.alien,x:dt.tileToScreen(this.exit.position.x),duration:500,onComplete:function(){Object(A.a)(Object(b.a)(i.prototype),"destroyBlock",t).call(t),t.player.reconnect()}});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"moveDwarf",value:function(){var e=this;this.dwarfRun&&(0!==this.leader.leadingPath.length?this.onNextTick((function(){e.leader.onPlayerMoves(e.leader.position),e.moveDwarf()})):(this.dwarfRun=!1,this.replaceByEmpty(this.leader),this.leader=null))}}]),i}(_e);it.key="level_17";var at=it,st=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The escape",e.winningLoopRef=e.winningLoop.bind(Object(pe.a)(e)),e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.voidLevel=e.children.getByName("layer_1").tilemap.height-1,this.fx=this.scene.sound.add("earthquake"),e.events.on("update",this.winningLoopRef),this.startVoid(e)}},{key:"startVoid",value:function(e){var t=this,i=e.cameras.main;setTimeout((function(){i.shake(2e3,.005),t.fx.play()}),1500)}},{key:"playerLoop",value:function(){Object(A.a)(Object(b.a)(i.prototype),"playerLoop",this).call(this),this.voidLoop()}},{key:"resetAutoVoidTimer",value:function(){clearTimeout(this.autoDestroyTID),this.autoDestroyTID=setTimeout(this.destroyMap.bind(this),5e3)}},{key:"destroyMap",value:function(){var e=this;this.resetAutoVoidTimer();var t=this.scene.children.getByName("layer_1");if(!t)return!1;var i=t.tilemap,a=this.scene.cameras.main,s=this.voidLevel;t.fill(100,0,s,i.width,1),this.objects[s].forEach((function(t,i){(t.isClass(gt)||t.isClass(mt))&&(e.objects[s][i]=new ce(B.EMPTY,e))})),this.moveables=this.moveables.filter((function(t){var i;return!(t.position.y>e.voidLevel)||(null===(i=t.alien)||void 0===i||i.destroy(),!1)})),a.shake(1e3,.001),this.fx.play(),this.voidLevel--,this.player.position.y>this.voidLevel&&(this.player.die(),this.onCharacterDie(this.player))}},{key:"voidLoop",value:function(){this.player.isMoving&&this.player.nextMoveDir===Y.UP?(this.resetAutoVoidTimer(),this.voidLevel-this.player.position.y>8&&this.destroyMap()):this.player.isMoving&&""!==this.player.nextMoveDir&&this.destroyMap()}},{key:"destroy",value:function(){this.scene.events.off("update",this.winningLoopRef),this.fx.stop(),clearTimeout(this.autoDestroyTID)}},{key:"winningLoop",value:function(){this.player.position.y<5&&(clearTimeout(this.autoDestroyTID),this.scene.events.off("update",this.winningLoopRef),this.onComplete())}},{key:"onAddElement",value:function(e){e.isClass(_t)&&(e.power=1,e.hasPickaxe=!0)}}]),i}(_e);st.key="level_finale";var nt=st,ot=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The Maze",e.easystar=new He.a.js,e.solvingPath=[],e.isMaze=!0,e.exitEye=null,e.dwarfRun=!1,e.buyLeadingWithShrooms=!1,e}return Object(f.a)(i,[{key:"connectToScene",value:function(e){var t=this;Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),e.lights.enable().setAmbientColor(0),this.exit=Object.values(this.interactiveElements).find((function(e){return e.isClass(Ot)}));var a=this.objects.map((function(e){return e.map((function(e){return e.isClass(vt)||e.isClass(ce)?0:1}))}));if(this.easystar.setGrid(a),this.easystar.setAcceptableTiles([0]),this.easystar.findPath(this.leader.position.x,this.leader.position.y,this.exit.position.x,this.exit.position.y,(function(e){null===e?t.shouldRestart=!0:(t.solvingPath=e.slice(1),t.leader.personalSpace=10)})),this.easystar.calculate(),e.events.once("levelstart",(function(){if(t.shouldRestart)e.levels.restart();else if(t.unfinished){t.totalShroomsAmount>0?t.showDialog1():t.showDialog1_no_shrooms();e.events.once("player_moves",(function i(){if(t.leader.leadingPath.length<t.solvingPath.length/3){t.leader.personalSpace=2;var a=t.solvingPath.at(-t.leader.leadingPath.length-4),s=new Et(B.INTERACTION,t);s.order=9;var n=a.x,o=a.y;t.interactiveElements["".concat(n,"-").concat(o)]=s,s.setPosition({x:n,y:o})}else e.events.once("player_moves",i)}))}})),!this.unfinished){var s=this.scene.children.getByName("layer_1"),n=new fe(B.DEBRIS,this);n.setPosition({x:this.leader.position.x-1,y:this.leader.position.y}),s.copy(0,4,1,1,2,5),this.setObjectAt(this.leader.position.x+1,this.leader.position.y,n),this.replaceByEmpty(this.leader),this.leader.alien.destroy(),this.leader.alien=null}}},{key:"id",get:function(){return this.constructor.key}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),0===e.order&&this.onComplete(),9===e.order&&this.showDialog2()}},{key:"onAddElement",value:function(e){if(e.isClass(_t)&&(e.power=1,e.hasPickaxe=!1),e.isClass(Ot)){var t=this.scene.children.getByName("layer_2"),i=t.tilemap;this.exitEye=this.scene.add.sprite(48,16,"spark").setOrigin(.5,.5),this.exitEye.setTintFill(13784064),this.exitEye.setScale(2*t.scaleX,4*t.scaleX),this.exitEye.x=i.tileToWorldX(e.position.x-.5),this.exitEye.y=i.tileToWorldY(e.position.y-.4),this.exitEye.depth=100,this.exitEye.alpha=0}}},{key:"showDialog1_no_shrooms",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.leader.leadingPath=[{x:e.leader.position.x+1,y:e.leader.position.y}],e.setUpLeader()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[ne("maze_1.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("maze_1.dialog_1.mary_say_2_empty")]},{who:"closeUp_Dwarf",text:[Re()(ne("maze_1.dialog_1.dwarf_say_2_empty"))({NUM:9})]}]})}},{key:"showDialog1",value:function(){var e=this;this.scene.events.once("dialogue:hidden",(function(){e.buyLeadingWithShrooms?(e.scene.events.emit("score:mushroom_given"),e.collectedShrooms--,e.leader.leadingPath=Object(h.a)(e.solvingPath)):e.leader.leadingPath=[{x:e.leader.position.x+1,y:e.leader.position.y}],e.setUpLeader()})),this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Dwarf",text:[ne("maze_1.dialog_1.dwarf_say_1")]},{who:"closeUp_Mary",text:[ne("maze_1.dialog_1.mary_say_1")],options:{slot0:{label:ne("maze_1.dialog_1_option.yes"),slot:0,onSelect:function(){e.buyLeadingWithShrooms=!0,e.scene.events.emit("dialogue:nextPage")}},slot1:{label:ne("maze_1.dialog_1_option.no"),slot:1,onSelect:function(){return e.scene.events.emit("dialogue:nextPage",1)}},slot2:null,slot3:null}},{who:"closeUp_Mary",text:[ne("maze_1.dialog_1.mary_say_2_yes")],options:{slot2:null}},{who:"closeUp_Mary",text:[ne("maze_1.dialog_1.mary_say_2_no")]}]})}},{key:"setUpLeader",value:function(){this.player.disconnect(),this.dwarfRun=!0,this.moveDwarf()}},{key:"moveDwarf",value:function(){var e=this;this.dwarfRun?(this.leader.isCloseEnough(this.player.position)&&0!==this.leader.leadingPath.length||(this.dwarfRun=!1),this.onNextTick((function(){e.leader.onPlayerMoves(e.player.position),e.moveDwarf()}))):(this.leader.animIdle(),this.player.reconnect())}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Dwarf"],participantNames:["Mary","Doc"],conversation:[{who:"closeUp_Mary",text:[ne("maze_1.dialog_2.mary_say_1")]},{who:"closeUp_Dwarf",text:[ne("maze_1.dialog_2.dwarf_say_1")]}]})}}]),i}(_e);ot.key="maze_1";var rt=ot,lt=function(){function e(t){Object(p.a)(this,e),this.scene=t,this.map=this.scene.make.tilemap({tileWidth:20,tileHeight:20,width:3,height:1})}return Object(f.a)(e,[{key:"getArrow",value:function(){var e=this.map,t=e.addTilesetImage("arrows","hud-tiles",20,20,1,2),i=e.createBlankLayer("layer_arrow",t);return i.name="layer_arrow",i.depth=15,i.setScrollFactor(0),i.setScale(w),e.putTileAt(30,0,0)}},{key:"getArrowDown",value:function(){return this.getArrow()}},{key:"getArrowRight",value:function(){var e=this.getArrow();return e.rotation=-Math.PI/2,e}},{key:"getArrowUp",value:function(){var e=this.getArrow();return e.rotation=Math.PI,e}},{key:"getArrowLeft",value:function(){var e=this.getArrow();return e.rotation=Math.PI/2,e}}]),e}(),ct=function(){function e(t){Object(p.a)(this,e),this.scene=t,this.ROW_HEIGHT=0,this.MARGIN_LEFT=0,this.MARGIN_TOP=0,this.options=[],this.optionsByPage=[],this.scrollIndex=0,this.isVisible=!0,window.scene=this.scene}return Object(f.a)(e,[{key:"showConfirmNewGameMenu",value:function(){var e=this,t=[{label:ne("menu.main.yes"),disabled:!1,selectable:!0,onSelect:function(){e.scene.navigateToScene("IntroScene")}},{label:ne("menu.main.no"),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("LandingScene")}}];this.drawSelectableOptions({label:"Start a new game and lost\n\nyour current progress?",disabled:!1,selectable:!1},t,0,1,2)}},{key:"showInitialMenu",value:function(){var e=this,t=[{label:ne("menu.main.option_new"),disabled:!1,selectable:!0,onSelect:function(){K.a.get(Nt.key)?e.scene.navigateToScene("ConfirmNewGameScene"):e.scene.navigateToScene("IntroScene")}},{label:ne("menu.main.option_continue"),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("MenuScene")}}];this.drawSelectableOptions(null,t)}},{key:"showMainMenu",value:function(){var e=this,t=function(e){return e.toLocaleString("en-US",{minimumIntegerDigits:2})},i=function(e){var i=K.a.get(e);return i?"".concat(t(i.collectedDiamonds),"/").concat(t(i.countDiamonds)):"__/__"},a=function(e){var i=K.a.get(e);return i?"".concat(t(i.killedEnemies),"/").concat(t(i.countEnemies)):"__/__"},s=function(e){var i=K.a.get(e);return i?"".concat(t(i.collectedShrooms),"/").concat(t(i.countShrooms)):"__/__"},n=function(e){var t=K.a.get(e),i=(100*(null===t||void 0===t?void 0:t.comp)).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return t?"".concat(i<=9?"  ":i<=99?" ":"").concat(i,"%"):"  0%"},o=[{label:"Ki     1     ".concat(i(Nt.key),"     ").concat(a(Nt.key),"     ").concat(s(Nt.key),"   ").concat(n(Nt.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:Nt.key})}},{label:"Ki     2     ".concat(i(Se.key),"     ").concat(a(Se.key),"     ").concat(s(Se.key),"   ").concat(n(Se.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:Se.key})}},{label:"Ki     3     ".concat(i(Ae.key),"     ").concat(a(Ae.key),"     ").concat(s(Ae.key),"   ").concat(n(Ae.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:Ae.key})}},{label:"Ki     4     ".concat(i(xe.key),"     ").concat(a(xe.key),"     ").concat(s(xe.key),"   ").concat(n(xe.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:xe.key})}},{label:"Ki     5     ".concat(i(we.key),"     ").concat(a(we.key),"     ").concat(s(we.key),"   ").concat(n(we.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:we.key})}},{label:"Ki     6     ".concat(i(De.key),"     ").concat(a(De.key),"     ").concat(s(De.key),"   ").concat(n(De.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:De.key})}},{label:"Ki     7     ".concat(i(Ue.key),"     ").concat(a(Ue.key),"     ").concat(s(Ue.key),"   ").concat(n(Ue.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:Ue.key})}},{label:"Ki     8     ".concat(i(Le.key),"     ").concat(a(Le.key),"     ").concat(s(Le.key),"   ").concat(n(Le.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:Le.key})}},{label:"Ki     9     ".concat(i(Pe.key),"     ").concat(a(Pe.key),"     ").concat(s(Pe.key),"   ").concat(n(Pe.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:Pe.key})}},{label:"Ki    10     ".concat(i(We.key),"     ").concat(a(We.key),"     ").concat(s(We.key),"   ").concat(n(We.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:We.key})}},{label:"Ki    11     ".concat(i(Ye.key),"     ").concat(a(Ye.key),"     ").concat(s(Ye.key),"   ").concat(n(Ye.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:Ye.key})}},{label:"Ki    12     ".concat(i(Ve.key),"     ").concat(a(Ve.key),"     ").concat(s(Ve.key),"   ").concat(n(Ve.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:Ve.key})}},{label:"".concat(ne("menu.main.ruins").padEnd(6," ")," 1"),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:rt.key})}},{label:"Ki    13     ".concat(i(Qe.key),"     ").concat(a(Qe.key),"     ").concat(s(Qe.key),"   ").concat(n(Qe.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:Qe.key})}},{label:"Ki    14     ".concat(i(ze.key),"     ").concat(a(ze.key),"     ").concat(s(ze.key),"   ").concat(n(ze.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:ze.key})}},{label:"Ki    15     ".concat(i($e.key),"     ").concat(a($e.key),"     ").concat(s($e.key),"   ").concat(n($e.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:$e.key})}},{label:"Ki    16     ".concat(i(tt.key),"     ").concat(a(tt.key),"     ").concat(s(tt.key),"   ").concat(n(tt.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:tt.key})}},{label:"Ki    17     ".concat(i(at.key),"     ").concat(a(at.key),"     ").concat(s(at.key),"   ").concat(n(at.key)),disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:at.key})}},{label:"Test  x     __/__     __/__     __/__   100%",disabled:!1,selectable:!0,onSelect:function(){return e.scene.navigateToScene("GameScene",{levelName:Ee.key})}}],r={label:ne("menu.main.heading_scrore"),disabled:!1,selectable:!1};this.drawSelectableOptions(r,o,o.length-1,null,null,11)}},{key:"showInGameMenu",value:function(){var e=this,t=[{label:"Restart level",disabled:!1,selectable:!0,onSelect:function(){return e.scene.levels.restart()}},{label:"Exit to menu",disabled:!1,selectable:!0,onSelect:function(){return e.scene.scene.start("MenuScene")}}];this.drawSelectableOptions(null,t,0,4,1)}},{key:"drawSelectableOptions",value:function(e,t,i,a,s){var n=this,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5;this.options=t;var r=t.findIndex((function(e){return e.selectable})),l=r;if(i>=o-1)if(i<this.options.length){this.scrollIndex=i-o+1;var c=this.scrollIndex+o<this.options.length;c?(this.scrollIndex=i-o+2,l=o-2):l=o-1}else l=o,this.scrollIndex=i-o;else isNaN(i)||(l=i);var u=Math.floor(l/o)+1,d=l-Math.floor((u-1)*o),m=l;this.ROW_HEIGHT=dt.pixelToScreen(15),this.MARGIN_LEFT=dt.tileToScreen(a||1);var y=dt.pixelToScreen(20),p=this.MARGIN_LEFT-y;this.MARGIN_TOP=dt.tileToScreen(s||2);var f=new lt(this.scene).getArrowRight();f.tilemapLayer.setPosition(p,this.MARGIN_TOP+this.ROW_HEIGHT*m-this.ROW_HEIGHT/2);var v=new lt(this.scene).getArrowUp();v.tilemapLayer.setPosition(dt.tileToScreen(19),this.MARGIN_TOP-this.ROW_HEIGHT),v.setAlpha(0===this.scrollIndex?.5:1),v.setVisible(o<this.options.length);var _=new lt(this.scene).getArrowDown();if(_.tilemapLayer.setPosition(dt.tileToScreen(19),this.MARGIN_TOP+this.ROW_HEIGHT*o-this.ROW_HEIGHT),_.setAlpha(this.scrollIndex+o<this.options.length?1:.5),_.setVisible(o<this.options.length),e){var g=[].concat(Object(h.a)(e.label.split("")),Object(h.a)(Array(Math.max(0,20-e.label.length)).fill(""))).join(""),E=Math.round(g.length/20),O=this.scene.add.text(this.MARGIN_LEFT,this.ROW_HEIGHT*-E+this.MARGIN_TOP,g,{fontFamily:"Emulogic",fontSize:"8px",fill:"#aee0c8",fontWeight:"regular"}).setVisible(!e.disabled);O.displayHeight=10*w,O.alpha=1,O.depth=16,O.name="header_text",O.setScale(w),O.setScrollFactor(0),O.setShadow(-1,1)}this.drawOptionsPage(this.scrollIndex,o,d),this.scene.input.keyboard.on("keydown",(function(e){if(!n.isVisible)return!1;var t=n.optionsByPage,i=!1;"ArrowUp"===e.key&&(1===d&&n.scrollIndex>0?(n.scrollIndex--,n.drawOptionsPage(n.scrollIndex,o,d)):d>0&&(i=d-1));"ArrowDown"===e.key&&(d===o-2&&n.scrollIndex+o<n.options.length?(n.scrollIndex++,n.drawOptionsPage(n.scrollIndex,o,d)):d<t.length-1&&(i=d+1));if(("ArrowDown"===e.key||"ArrowUp"===e.key)&&!1!==i){f.tilemapLayer.setPosition(p,n.MARGIN_TOP+n.ROW_HEIGHT*i-n.ROW_HEIGHT/2);var a=n.scene.children.getByName("menu_text_".concat(d));a.alpha="100%"===a.text.slice(-4)?1:.5,a.setColor("#aee0c8");var s=n.scene.children.getByName("menu_text_".concat(i));s.alpha=1,s.setColor("#fff"),d=i}v.setAlpha(0===n.scrollIndex?.5:1),_.setAlpha(n.scrollIndex+o<n.options.length?1:.5),"Enter"===e.key&&(t[d].disabled||t[d].onSelect())}))}},{key:"drawOptionsPage",value:function(e,t,i){var a=this;this.scene.children.list.filter((function(e){return e.name.includes("menu_text")})).forEach((function(e){return e.destroy()})),this.optionsByPage=this.options.slice(e,e+t),this.optionsByPage.forEach((function(e,t){var s=[].concat(Object(h.a)(e.label.split("")),Object(h.a)(Array(Math.max(0,20-e.label.length)).fill(""))).join(""),n=a.scene.add.text(a.MARGIN_LEFT,a.ROW_HEIGHT*t+a.MARGIN_TOP,s,{fontFamily:"Emulogic",fontSize:"8px",fill:"#aee0c8",fontWeight:"regular"}).setVisible(!e.disabled);n.alpha="100%"===s.slice(-4)||t===i?1:.5,n.setColor(t===i?"#fff":"#aee0c8"),n.displayHeight=10*w,n.depth=16,n.name="menu_text_".concat(t),n.setScale(w),n.setScrollFactor(0),n.setShadow(-1,1)}))}}]),e}(),ht=function(){function e(t){Object(p.a)(this,e),this.scene=t,this.options=[],this.menuOptionsContainer=null,this.keyDownHandler=this.keyDownHandler.bind(this)}return Object(f.a)(e,[{key:"mount",value:function(){this.menuOptionsContainer=this.scene.add.container(0,0),this.menuOptionsContainer.setScrollFactor(0),this.currentSlot=0,this.scene.input.keyboard.on("keydown",this.keyDownHandler)}},{key:"unmount",value:function(){var e;this.scene.input.keyboard.off("keydown",this.keyDownHandler),this.menuOptionsContainer.destroy(),null===(e=this.arrow)||void 0===e||e.setVisible(!1),this.arrow=null}},{key:"visible",get:function(){return this.menuOptionsContainer.visible}},{key:"show",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.menuOptionsContainer.setVisible(!0),this.options=Object.keys(t).reduce((function(e,i){return null!==t[i]&&(e[i]=t[i]),e}),{});var i=Object.keys(this.options).sort()[0];this.currentSlot=this.options[i].slot,this.menuOptionsContainer.depth=20,this.menuOptionsContainer.setPosition(dt.tileToScreen(4.5),dt.tileToScreen(9));var a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=dt.tileToScreen(0===i||1===i?0:9),s=dt.tileToScreen(0===i||2===i?.25:1),n=e.scene.add.text(a,s,t,{fontFamily:"GameGirl",fontSize:"8px",fill:"#ffffff",lineSpacing:2});n.setScale(w),n.displayHeight=dt.pixelToScreen(8),n.displayWidth=dt.pixelToScreen(8*t.length),n.setShadow(-1,1),e.menuOptionsContainer.add(n)};Object.values(this.options).forEach((function(e){return a(e.label,e.slot)})),this.arrow||(this.arrow=new lt(this.scene).getArrowRight(),this.arrow.name="menu_arrow",this.arrow.setSize(dt.tileToPixels(.66),dt.tileToPixels(.66))),this.setArrowPositionBySlot(this.currentSlot),this.arrow.setVisible(0!==this.options.length)}},{key:"hide",value:function(){for(var e;null===(t=this.menuOptionsContainer)||void 0===t?void 0:t.list.length;){var t,i,a;null===(i=this.menuOptionsContainer)||void 0===i||null===(a=i.list)||void 0===a||a.forEach((function(e){return e.destroy()}))}this.menuOptionsContainer.setVisible(!1),null===(e=this.arrow)||void 0===e||e.setVisible(!1)}},{key:"keyDownHandler",value:function(e){var t=this;if(this.menuOptionsContainer.visible){var i=this.currentSlot;if("ArrowUp"===e.key&&(1===i||3===i)){var a=i-1;this.options["slot".concat(a)]&&(this.currentSlot=a)}if("ArrowLeft"===e.key){var s=i-2;this.options["slot".concat(s)]?this.currentSlot=s:this.options["slot".concat(s-1)]&&(this.currentSlot=s-1)}if("ArrowRight"===e.key){var n=i+2;this.options["slot".concat(n)]?this.currentSlot=n:this.options["slot".concat(n+1)]&&(this.currentSlot=n+1)}if("ArrowDown"===e.key&&(0===i||2===i)){var o=i+1;this.options["slot".concat(o)]&&(this.currentSlot=o)}if("Enter"===e.key){var r=Object.values(this.options).find((function(e){return e.slot===t.currentSlot}));null===r||void 0===r||r.onSelect()}else this.setArrowPositionBySlot(this.currentSlot)}}},{key:"setArrowPositionBySlot",value:function(e){var t=-dt.tileToScreen(.5),i=-dt.tileToScreen(.4),a=dt.tileToScreen(0===e||1===e?0:9),s=dt.tileToScreen(0===e||2===e?.25:1);this.arrow.tilemapLayer.setPosition(a+t+this.menuOptionsContainer.x,s+i+this.menuOptionsContainer.y)}}]),e}(),ut=function(){function e(t){Object(p.a)(this,e),this.scene=t,this.tnContainer=null,this.participantSprites={},this.conversation={},this.currentDialogIndex=0,this.isShowing=!1,this.isFullTextDisplayed=!1,this.dialogOptions=new ht(this.scene),this.showDialog=this.showDialog.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this),this.updateCharacterName=this.updateCharacterName.bind(this),this.tIDs=[]}return Object(f.a)(e,[{key:"mount",value:function(){var e=this;this.tIDs.push(setTimeout((function(){return e.scene.input.keyboard.addListener("keydown",e.handleKeyDown)}),500))}},{key:"unmount",value:function(){this.tIDs.forEach((function(e){return clearTimeout(e)}));var e=this.scene.children.getByName("layer_hud");e&&e.destroy();var t=this.scene.children.getByName("dialog_tn_container");t&&t.destroy();var i=this.scene.children.getByName("placeholder_text");i&&i.destroy()}},{key:"handleKeyDown",value:function(e){"Enter"===e.key&&this.isFullTextDisplayed&&!this.dialogOptions.visible&&(this.currentDialogIndex<this.conversation.length-1||this.scene.events.emit("dialogue:hide"))}},{key:"hideDialog",value:function(){var e=this;return this.scene.input.keyboard.removeListener("keydown",this.handleKeyDown),new Promise((function(t){var i=e.scene.children.list.find((function(e){return"layer_hud"===e.name})).tilemap;e.clearText(),e.dialogOptions.unmount(),e.scene.tweens.add({targets:[i.layers[0].tilemapLayer,e.tnContainer],y:dt.tileToScreen(-7),duration:500,ease:"Back.In",onComplete:function(){e.isShowing=!1,t()}})}))}},{key:"showDialog",value:function(e){var t=this,i=e.participants,a=e.participantNames,s=void 0===a?[]:a,n=e.conversation;this.isShowing=!0,this.conversation=n,this.currentDialogIndex=0,this.prepareHUD(i,s),this.prepareText();var o=this.scene.children.list.find((function(e){return"layer_hud"===e.name})).tilemap;o.layers[0].tilemapLayer.y=this.tnContainer.y=dt.tileToScreen(-8),this.scene.tweens.add({targets:[o.layers[0].tilemapLayer,this.tnContainer],y:dt.tileToScreen(4),duration:500,ease:"Cubic.Out",onComplete:function(){t.dialogOptions.mount(),t.showMessage(t.conversation[t.currentDialogIndex])}})}},{key:"fullTextDisplayed",value:function(){var e=this;this.isFullTextDisplayed=!0,this.scene.events.emit("dialogue:message_shown",this.currentDialogIndex);var t={slot1:{label:ne("menu.dialog_options.close"),slot:1,onSelect:function(){return e.scene.events.emit("dialogue:hide")}}},i={slot1:{label:ne("menu.dialog_options.story"),slot:1,onSelect:function(){return e.showMessage(e.conversation[++e.currentDialogIndex])}},slot3:{label:ne("menu.dialog_options.close"),slot:3,onSelect:function(){return e.scene.events.emit("dialogue:hide")}}},a={slot2:{label:ne("menu.dialog_options.next"),slot:2,onSelect:function(){return e.showMessage(e.conversation[++e.currentDialogIndex])}},slot3:{label:ne("menu.dialog_options.close"),slot:3,onSelect:function(){return e.scene.events.emit("dialogue:hide")}}},s={slot3:{label:ne("menu.dialog_options.close"),slot:3,onSelect:function(){return e.scene.events.emit("dialogue:hide")}}},n=Object(Ke.a)(Object(Ke.a)(Object(Ke.a)(Object(Ke.a)(Object(Ke.a)({},1===this.conversation.length?t:{}),this.conversation.length>1&&0===this.currentDialogIndex?i:{}),this.currentDialogIndex>0&&this.currentDialogIndex<this.conversation.length-1?a:{}),this.currentDialogIndex===this.conversation.length-1&&this.conversation.length>1?s:{}),this.conversation[this.currentDialogIndex].options||{});this.dialogOptions.show(n)}},{key:"showMessage",value:function(e){var t=this;this.clearText(),this.dialogOptions.hide(),this.writeText(e.text);var i=this.scene.children.getByName("dialog_tn_container");Object.keys(this.participantSprites).forEach((function(a){if(a===e.who)t.participantSprites[a].clearTint(),i.list.find((function(e){return e.name==="char_".concat(a,"_text_to_remove")})).clearTint();else{t.participantSprites[a].setTint(3355443);var s=i.list.find((function(e){return e.name==="char_".concat(a,"_text_to_remove")}));null===s||void 0===s||s.setTint(10066329)}}))}},{key:"prepareHUD",value:function(t,i){var a,s,n,o=this.scene.make.tilemap({tileWidth:20,tileHeight:20,width:20,height:20}),r=o.addTilesetImage("hud-tiles","hud-tiles",20,20,1,2),l=o.createBlankLayer("layer_hud",r);switch(l.name="layer_hud",l.depth=5,l.setScrollFactor(0),l.setScale(w),this.tnContainer=this.scene.add.container(0,0),this.tnContainer.depth=10,this.tnContainer.name="dialog_tn_container",t.length){case 2:t[1]&&(a=t[1],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(w)).name="".concat(a,"_tn_to_remove"),s.x=dt.tileToScreen(17)+dt.pixelToScreen(10),s.y=dt.tileToScreen(3)+dt.pixelToScreen(2),s.setScrollFactor(0),s.setFlipX(!0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:17,y:3}),(n=this.scene.add.text(s.x-.25*dt.tileToScreen(2),s.y+.8*dt.tileToScreen(2),i[1]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(w/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n);case 1:t[0]&&(a=t[0],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(w)).name="".concat(a,"_tn_to_remove"),s.x=dt.tileToScreen(0)+dt.pixelToScreen(12),s.y=dt.tileToScreen(3)+dt.pixelToScreen(2),s.setScrollFactor(0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:0,y:3}),(n=this.scene.add.text(s.x-.25*dt.tileToScreen(2),s.y+.8*dt.tileToScreen(2),i[0]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(w/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n);break;case 4:t[3]&&(a=t[3],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(w)).name="".concat(a,"_tn_to_remove"),s.x=dt.tileToScreen(17)+dt.pixelToScreen(10),s.y=dt.tileToScreen(4)+dt.pixelToScreen(2),s.setScrollFactor(0),s.setFlipX(!0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:17,y:4}),(n=this.scene.add.text(s.x-.25*dt.tileToScreen(2),s.y+.8*dt.tileToScreen(2),i[3]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(w/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n);case 3:t[0]&&(a=t[0],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(w)).name="".concat(a,"_tn_to_remove"),s.x=dt.tileToScreen(0)+dt.pixelToScreen(12),s.y=dt.tileToScreen(0)+dt.pixelToScreen(2),s.setScrollFactor(0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:0,y:0}),(n=this.scene.add.text(s.x-.25*dt.tileToScreen(2),s.y+.8*dt.tileToScreen(2),i[0]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(w/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n),t[2]&&(a=t[2],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(w)).name="".concat(a,"_tn_to_remove"),s.x=dt.tileToScreen(0)+dt.pixelToScreen(12),s.y=dt.tileToScreen(4)+dt.pixelToScreen(2),s.setScrollFactor(0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:0,y:4}),(n=this.scene.add.text(s.x-.25*dt.tileToScreen(2),s.y+.8*dt.tileToScreen(2),i[2]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(w/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n),t[1]&&(a=t[1],(s=this.scene.add.sprite(0,0).play(a).setOrigin(0,.25).setScale(w)).name="".concat(a,"_tn_to_remove"),s.x=dt.tileToScreen(17)+dt.pixelToScreen(10),s.y=dt.tileToScreen(0)+dt.pixelToScreen(2),s.setScrollFactor(0),s.setFlipX(!0),this.tnContainer.add(s),this.participantSprites[a]=s),e.drawWindow(o,{w:3,h:2,x:17,y:0}),(n=this.scene.add.text(s.x-.25*dt.tileToScreen(2),s.y+.8*dt.tileToScreen(2),i[1]||"???",{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}).setScale(w/2).setScrollFactor(0)).name="char_".concat(a,"_text_to_remove"),this.tnContainer.add(n)}e.drawWindow(o,{w:14,h:7,x:3,y:0})}},{key:"updateCharacterName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"closeUp_Mary",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"???",i=this.scene.children.getByName("dialog_tn_container"),a=i.list.find((function(t){return t.name==="char_".concat(e,"_text_to_remove")}));a.setText(t)}},{key:"prepareText",value:function(){var e=this.scene.add.text(dt.tileToScreen(3.5),dt.tileToScreen(4.5)," ",{fontFamily:"GameGirl",fill:"#ffffff",lineSpacing:2});e.setScrollFactor(0),e.displayHeight=10*w,e.displayWidth=10*w,e.name="placeholder_text",e.depth=10,e.setShadow(-1,1)}},{key:"writeText",value:function(e){var t=this,i=this.scene.children.getByName("placeholder_text");this.isFullTextDisplayed=!1;for(var a=e.join("").split("\n"),s=[];a.length;){for(var n="",o=a.shift().split(" ");o.length;){var r=n,l=o.shift();(n+=l+" ").trim().length>26&&(s.push(r),o.unshift(l),n="")}s.push(n)}var c,h=s.join("\n"),u=function(){clearTimeout(c),h.length&&d(h.length)},d=function e(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=h.substring(0,a);h=h.substring(a),i.setText(i.text+s),h.length?(c=setTimeout((function(){return e(1)}),[".","!","?"].includes(s)?500:50),t.tIDs.push(c)):(t.scene.input.keyboard.off("keyup",u),t.fullTextDisplayed())};d(),this.tIDs.push(setTimeout((function(){return t.scene.input.keyboard.once("keyup",(function(e){["Enter","Escape","Spacebar"].includes(e.key)&&u()}))}),500))}},{key:"clearText",value:function(){this.scene.children.getByName("placeholder_text").setText("")}}],[{key:"drawWindow",value:function(e,t){for(var i=t.w,a=t.h,s=t.x,n=t.y,o={TOP_LEFT:6,TOP_MIDDLE:7,TOP_RIGHT:8,LEFT:16,MIDDLE:17,RIGHT:18,BOTTOM_LEFT:26,BOTTOM_MIDDLE:27,BOTTOM_RIGHT:28},r=0;r<a;r++)for(var l=0;l<i;l++){var c=void 0;0===l&&0===r&&(c=o.TOP_LEFT),l>0&&l<i-1&&0===r&&(c=o.TOP_MIDDLE),l===i-1&&0===r&&(c=o.TOP_RIGHT),0===l&&r>0&&r<a-1&&(c=o.LEFT),l>0&&l<i-1&&r>0&&r<a-1&&(c=o.MIDDLE),l===i-1&&r>0&&r<a-1&&(c=o.RIGHT),0===l&&r===a-1&&(c=o.BOTTOM_LEFT),l>0&&l<i-1&&r===a-1&&(c=o.BOTTOM_MIDDLE),l===i-1&&r===a-1&&(c=o.BOTTOM_RIGHT),e.putTileAt(c,l+s,r+n)}}}]),e}(),dt=function(){function e(t,i){var a=this;Object(p.a)(this,e),this.scene=t,this.inGameMenu=null,this.setUpPuseResumeGame(),this.mushroomsIcon=null,this.diamondsIcon=null,this.scene.events.off("game_paused"),this.scene.events.on("game_paused",(function(){return a.showPauseMenu()})),this.scene.events.off("game_resumed"),this.scene.events.on("game_resumed",(function(){return a.hidePauseMenu()}));var s=[this.scene.sound.add("rock_hit"),this.scene.sound.add("rock_hit2"),this.scene.sound.add("rock_hit3")];this.scene.events.off("sounds:rock_hit_hard"),this.scene.events.on("sounds:rock_hit_hard",(function(){return s[Math.trunc(10*Math.random())%3].play()}));var n=[this.scene.sound.add("rock_slide_hard1"),this.scene.sound.add("rock_slide_hard2"),this.scene.sound.add("rock_slide_hard3")];this.scene.events.off("sounds:rock_slide_hard"),this.scene.events.on("sounds:rock_slide_hard",(function(){return n[Math.trunc(10*Math.random())%3].play()}));var o=[this.scene.sound.add("rock_slide_soft1"),this.scene.sound.add("rock_slide_soft2"),this.scene.sound.add("rock_slide_soft3")];this.scene.events.off("sounds:rock_slide_soft"),this.scene.events.on("sounds:rock_slide_soft",(function(){return o[Math.trunc(10*Math.random())%3].play()}));var r=this.scene.sound.add("rock_hit_soft");this.scene.events.off("sounds:rock_hit_soft"),this.scene.events.on("sounds:rock_hit_soft",(function(){return r.play()}));var l=this.scene.sound.add("gem_hit");this.scene.events.off("sounds:gem_hit"),this.scene.events.on("sounds:gem_hit",(function(){return l.play()}));var c=this.scene.sound.add("explosion");this.scene.events.off("sounds:explosion"),this.scene.events.on("sounds:explosion",(function(){return c.play()}));var h=this.scene.sound.add("shroom_pick");this.scene.events.off("sounds:shroom_pick"),this.scene.events.on("sounds:shroom_pick",(function(){return h.play()}));var u=this.scene.sound.add("gem_pick");this.scene.events.off("sounds:gem_pick"),this.scene.events.on("sounds:gem_pick",(function(){return u.play()}));var d=this.scene.sound.add("coin");this.scene.events.off("sounds:coin"),this.scene.events.once("sounds:coin",(function(){return d.play()}));var m=[this.scene.sound.add("clear_hit1"),this.scene.sound.add("clear_hit2"),this.scene.sound.add("clear_hit3")];this.scene.events.off("sounds:clear_hit"),this.scene.events.on("sounds:clear_hit",(function(){return m[Math.trunc(10*Math.random())%3].play()}));var y=this.scene.sound.add("death_by_rock");this.scene.events.off("sounds:death_by_rock_hit"),this.scene.events.on("sounds:death_by_rock_hit",(function(){return y.play()}));var f=this.scene.sound.add("level_complete");this.scene.events.off("sounds:level_complete"),this.scene.events.on("sounds:level_complete",(function(){return f.play()})),i||this.drawScores(),this.dialogs=new ut(this.scene),this.scene.events.off("dialogue:show"),this.scene.events.on("dialogue:show",(function(e){var t,i;null===(t=a.scene.levels)||void 0===t||null===(i=t.current)||void 0===i||i.pause(),a.dialogs.mount(),a.dialogs.showDialog(e)})),this.scene.events.off("dialogue:updateCharacterName"),this.scene.events.on("dialogue:updateCharacterName",function(){var e=Object(q.a)(Q.a.mark((function e(t){var i,s;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.key,s=t.name,a.dialogs.updateCharacterName(i,s);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.scene.events.off("dialogue:nextPage"),this.scene.events.on("dialogue:nextPage",Object(q.a)(Q.a.mark((function e(){var t,i=arguments;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i.length>0&&void 0!==i[0]?i[0]:0,console.log(a.dialogs.currentDialogIndex,a.dialogs.conversation),a.dialogs.currentDialogIndex+=t,console.log(a.dialogs.currentDialogIndex),a.dialogs.showMessage(a.dialogs.conversation[++a.dialogs.currentDialogIndex]);case 5:case"end":return e.stop()}}),e)})))),this.scene.events.off("dialogue:hide"),this.scene.events.on("dialogue:hide",Object(q.a)(Q.a.mark((function e(){var t,i;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.dialogs.hideDialog();case 2:a.scene.events.emit("dialogue:hidden"),a.dialogs.unmount(),null===(t=a.scene.levels)||void 0===t||null===(i=t.current)||void 0===i||i.resume();case 5:case"end":return e.stop()}}),e)}))))}return Object(f.a)(e,[{key:"destroy",value:function(){this.mushroomsIcon.destroy(),this.diamondsIcon.destroy(),this.mushroomsScore.destroy(),this.diamondsScore.destroy(),this.diamondsScoreGoal.destroy(),this.scene.events.off("score:diamond_goal"),this.scene.events.off("score:diamond_set"),this.scene.events.off("score:diamond_goal_set"),this.scene.events.off("score:mushroom_collected"),this.scene.events.off("score:mushroom_given")}},{key:"onResize",value:function(){if(!this.scene.children.getByName("layer_scores"))return!1;this.mushroomsIcon.setPosition(e.tileToScreen(18),e.tileToScreen(1)).setScale(1.5*w);var t=window.localStorage.getItem("shrooms")||"0";this.mushroomsScore.setPosition(e.tileToScreen(20)-this.MT_MARGIN_RIGHT,e.tileToScreen(1)),this.mushroomsScore.setScrollFactor(0),this.mushroomsScore.displayHeight=10*w,this.mushroomsScore.displayWidth=10*t.length*w,this.diamondsIcon.setPosition(e.tileToScreen(1)+this.D_MARGIN_LEFT,e.tileToScreen(1)).setScale(1.5*w),this.diamondsScoreGoal.setPosition(e.tileToScreen(3)-this.DT_MARGIN_RIGHT,e.tileToScreen(1)),this.diamondsScoreGoal.displayHeight=8*w,this.diamondsScoreGoal.displayWidth=16*w,this.diamondsScore.setPosition(e.tileToScreen(3)-this.DT_MARGIN_RIGHT,e.tileToScreen(1)-this.diamondsScoreGoal.test!=="00"?e.tileToScreen(.5):0),this.diamondsScore.displayHeight=10*w,this.diamondsScore.displayWidth=10*this.diamondsAmount.length*w}},{key:"hidePauseMenu",value:function(){var e=this.scene.children.list.find((function(e){return"layer_pause_nenu"===e.name}));e&&(e.setVisible(!1),this.inGameMenu.isVisible=!1),this.scene.children.list.filter((function(e){return e.name.includes("menu_text")})).forEach((function(e){return e.destroy()})),this.scene.children.list.filter((function(e){return e.name.includes("_tn_to_remove")})).forEach((function(e){return e.destroy()})),this.scene.children.list.filter((function(e){return e.name.includes("layer_arrow")})).forEach((function(e){return e.destroy()}))}},{key:"drawScores",value:function(){var t=this,i=this.scene.make.tilemap({tileWidth:20,tileHeight:20,width:20,height:20});i.addTilesetImage("hud-tiles","hud-tiles",20,20,1,2);var a=i.addTilesetImage("hud-tiles","hud-tiles",20,20,1,2),s=i.createBlankLayer("layer_scores",a);s.name="layer_scores",s.depth=5,s.setScrollFactor(0),s.setScale(w),ut.drawWindow(i,{w:3,h:2,x:0,y:0}),ut.drawWindow(i,{w:3,h:2,x:17,y:0});var n=this.scene.add.sprite(i.tileToWorldX(18),i.tileToWorldY(1)).play("closeUp_Mushroom").setOrigin(.5,.5).setScale(1.5*w);n.depth=6,n.name="score_img",n.setScrollFactor(0),this.mushroomsIcon=n;this.MT_MARGIN_RIGHT=9*w;var o=Math.max(K.a.get("totalShroomsAmount"),0);this.mushroomsScore=this.scene.add.text(i.tileToWorldX(20)-this.MT_MARGIN_RIGHT,i.tileToWorldY(1),String(o),{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}),this.mushroomsScore.setData("amount",o),this.mushroomsScore.setOrigin(1,0),this.mushroomsScore.displayHeight=10*w,this.mushroomsScore.displayWidth=10*String(o).length*w,this.mushroomsScore.name="score_text_to_remove",this.mushroomsScore.depth=6,this.mushroomsScore.setScrollFactor(0),this.mushroomsScore.setShadow(-1,1);this.D_MARGIN_LEFT=.5*w;var r=this.scene.add.sprite(i.tileToWorldX(1)+this.D_MARGIN_LEFT,i.tileToWorldY(1)).play("closeUp_Diamond").setOrigin(.5,.5).setScale(1.5*w);r.depth=6,r.name="score_img",r.setScrollFactor(0),this.diamondsIcon=r,this.scene.events.once("score:diamond_goal",(function(){t.scene.tweens.add({targets:r,scale:2*w,ease:"Linear",duration:250,yoyo:!0})}));this.DT_MARGIN_RIGHT=9*w,this.diamondsAmount="0",this.diamondsScore=this.scene.add.text(i.tileToWorldX(3)-this.DT_MARGIN_RIGHT,i.tileToWorldY(1),this.diamondsAmount,{fontFamily:"GameGirl",fill:"#ffffff",align:"right"}),this.diamondsScore.setOrigin(1,0),this.diamondsScore.displayHeight=10*w,this.diamondsScore.displayWidth=10*this.diamondsAmount.length*w,this.diamondsScore.name="score_text_to_remove",this.diamondsScore.depth=6,this.diamondsScore.setScrollFactor(0),this.diamondsScore.setShadow(-1,1),this.diamondsScoreGoal=this.scene.add.text(i.tileToWorldX(3)-this.DT_MARGIN_RIGHT,i.tileToWorldY(1),"00",{fontFamily:"GameGirl",fill:"gold",align:"right"}),this.diamondsScoreGoal.alpha=0,this.diamondsScoreGoal.setOrigin(1,0),this.diamondsScoreGoal.displayHeight=8*w,this.diamondsScoreGoal.displayWidth=16*w,this.diamondsScoreGoal.name="score_text_to_remove",this.diamondsScoreGoal.depth=6,this.diamondsScoreGoal.setScrollFactor(0),this.diamondsScoreGoal.setShadow(-1,1),this.scene.events.on("score:mushroom_collected",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=t.mushroomsScore.getData("amount")+e;t.mushroomsScore.setText(i)})),this.scene.events.on("score:mushroom_given",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=Number(t.mushroomsScore.getData("amount"))-e;t.mushroomsScore.setText(String(i))})),window.scene=this.scene,this.scene.events.on("score:diamond_set",(function(e){t.diamondsAmount=e,t.diamondsScore.setText(e)})),this.scene.events.once("score:diamond_goal_set",(function(i){t.scene.tweens.add({targets:t.diamondsScore,y:e.tileToScreen(.5),ease:"Linear",duration:250,onComplete:function(){}});var a=t.diamondsScoreGoal.x;t.diamondsScoreGoal.x+=e.tileToScreen(.5),t.diamondsScoreGoal.alpha=0,t.diamondsScoreGoal.setText(i),t.scene.tweens.add({targets:t.diamondsScoreGoal,x:a,alpha:1,ease:"Linear",duration:250,delay:200})}))}},{key:"drawMenuOptions",value:function(e){this.inGameMenu=new ct(this.scene),this.inGameMenu.showInGameMenu()}},{key:"showPauseMenu",value:function(){var e=this.scene.children.list.find((function(e){return"layer_pause_nenu"===e.name}));if(e)return e.setVisible(!0),this.drawMenuOptions(),this.inGameMenu.isVisible=!0,!0;var t=this.scene.make.tilemap({tileWidth:20,tileHeight:20,width:20,height:20}),i=t.addTilesetImage("hud-tiles","hud-tiles",20,20,1,2),a=t.createBlankLayer("layer_pause_nenu",i);a.name="layer_pause_nenu",a.depth=15,a.setScrollFactor(0),a.setScale(w),ut.drawWindow(t,{w:14,h:3,x:3,y:0}),this.drawMenuOptions(t),this.inGameMenu.isVisible=!0}},{key:"setUpPuseResumeGame",value:function(){this.scene.input.keyboard.removeListener("keydown",this.onKeyDown.bind(this)),this.scene.input.keyboard.addListener("keydown",this.onKeyDown.bind(this))}},{key:"onKeyDown",value:function(e){var t=this;"Escape"===e.key&&!this.dialogs.isShowing&&this.scene.levels.current.player.connected&&(this.scene.levels.current.isPaused?function(){t.scene.levels.current.resume(),t.scene.events.emit("game_resumed")}:function(){t.scene.levels.current.pause(),t.scene.events.emit("game_paused")})()}}],[{key:"tileToScreen",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e.pixelToScreen(t*k)}},{key:"tileToPixels",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e*k}},{key:"pixelToScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e*w}}]),e}(),mt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!0,isBreakable:!0,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).strength=1,s}return Object(f.a)(i,[{key:"overrunBy",value:function(e){var t=this,i=this.level.scene.children.getByName("layer_1");if(!i)return!1;var a=i.tilemap;a.putTileAt(-1,this.position.x,this.position.y,!1,"layer_1"),e&&e.isClass(_t)?this.level.scene.events.emit("sounds:clear_hit"):(this.break_effect=this.level.scene.add.sprite(48,16).setOrigin(0,.25),this.break_effect.setScale(w),this.break_effect.depth=4,this.break_effect.x=dt.tileToScreen(this.position.x),this.break_effect.y=dt.tileToScreen(this.position.y),this.break_effect.play("ground_disolves"),this.break_effect.setFlipY(!0),this.break_effect.on(c.a.Animations.Events.ANIMATION_COMPLETE,(function(){t.break_effect.destroy()}))),this.level.onNextTick((function(e){[[0,-1],[1,0],[0,1],[-1,0]].forEach((function(i){var s=Array(3).fill(0).map((function(){return Array(3).fill(0)})),n=t.position.x+i[0],o=t.position.y+i[1],r=e.getObjectAt(n,o);if(r&&r.constructor.className===t.constructor.className){var l,c,h,u;s[0][1]=(null===(l=e.getObjectAt(n,o-1))||void 0===l?void 0:l.constructor.className)===t.constructor.className?B.GROUND:0,s[1][0]=(null===(c=e.getObjectAt(n-1,o))||void 0===c?void 0:c.constructor.className)===t.constructor.className?B.GROUND:0,s[2][1]=(null===(h=e.getObjectAt(n,o+1))||void 0===h?void 0:h.constructor.className)===t.constructor.className?B.GROUND:0,s[1][2]=(null===(u=e.getObjectAt(n+1,o))||void 0===u?void 0:u.constructor.className)===t.constructor.className?B.GROUND:0;var d=V.calculateGroundTileWithNeighbours(1,1,s);a.putTileAt(d,n,o,!1,"layer_1")}}))}))}}]),i}(ue);mt.className="Ground";var yt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!0,isPickable:!1,isCrushable:!0,level:a})).pushingDirection=null,s}return Object(f.a)(i,[{key:"animRun",value:function(){}},{key:"canMove",value:function(e,t){var a=this.level.getObjectAt(e,t),s=this.level.objectIsEmpty(a),n=(null===a||void 0===a?void 0:a.isBreakable)&&this.power>=a.strength&&!a.isClass(i),o=a.isClass&&a.isClass(i)&&"dwarf"!==a.name;return this.isBrakingGround=n&&a.isClass(mt),!!(s||o||n||a.isPickable)&&a}},{key:"canMoveDir",value:function(e){switch(e){case Y.UP:return this.canMoveUp();case Y.DOWN:return this.canMoveDown();case Y.LEFT:return this.canMoveLeft();case Y.RIGHT:return this.canMoveRight();default:return!1}}},{key:"canMoveUp",value:function(){return this.canMove(this.position.x,this.position.y-1)}},{key:"canMoveDown",value:function(){return this.canMove(this.position.x,this.position.y+1)}},{key:"animPushRight",value:function(){}},{key:"animPushLeft",value:function(){}},{key:"canMoveLeft",value:function(){return this.canMove(this.position.x-1,this.position.y)}},{key:"canPushLeft",value:function(){var e=this.level.getObjectAt(this.position.x-1,this.position.y),t=this.level.isPositionClear(this.position.x-2,this.position.y),i=this.level.isPositionClear(this.position.x-1,this.position.y+1);return(null===e||void 0===e?void 0:e.isMoveable)&&t&&!i}},{key:"pushLeft",value:function(){var e=this.level.getObjectAt(this.position.x-1,this.position.y),t=this.canMoveLeft(),i=this.canPushLeft(),a=!1;return!t&&i&&(this.pushingDirection===Y.LEFT?(this.animPushLeft(),a=!0,this.level.moveObject(e,{x:this.position.x-2,y:this.position.y}),this.level.jumpIntoParallelGravity(e),this.pushingDirection=null):(this.pushingDirection=Y.LEFT,this.animPushLeft())),a}},{key:"canMoveRight",value:function(){return this.canMove(this.position.x+1,this.position.y)}},{key:"canPushRight",value:function(){var e=this.level.getObjectAt(this.position.x+1,this.position.y),t=this.level.isPositionClear(this.position.x+2,this.position.y),i=this.level.isPositionClear(this.position.x+1,this.position.y+1);return(null===e||void 0===e?void 0:e.isMoveable)&&t&&!i}},{key:"pushRight",value:function(){var e=this.level.getObjectAt(this.position.x+1,this.position.y),t=this.canMoveRight(),i=this.canPushRight(),a=!1;return!t&&i&&(this.pushingDirection===Y.RIGHT?(this.animPushRight(),this.level.moveObject(e,{x:this.position.x+2,y:this.position.y}),this.level.jumpIntoParallelGravity(e),this.pushingDirection=null,a=!0):(this.pushingDirection=Y.RIGHT,this.animPushRight())),a}},{key:"testProximity",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,a=this.position.y-t,s=this.position.y+t,n=this.position.x-t,o=this.position.x+t,r=!1,l=e.x>=n&&e.x<=o&&e.y>=a&&e.y<=s,c=e.x===this.position.x||e.y===this.position.y;return l&&(!i||i&&c)&&(r=!0),r}}]),i}(de);yt.className="Character";var pt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!1,isPickable:!0,isCrushable:!1,level:a})).strength=4,s}return Object(f.a)(i,[{key:"overrunBy",value:function(e){e.isClass(_t)&&(this.alien.destroy(),this.shine.destroy(),this.level.onJewelPick(this),this.level.scene.events.emit("sounds:gem_pick")),e.isClass(he)&&(this.alien.destroy(),this.shine.destroy(),this.alien.destroy())}},{key:"move",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"move",this).call(this,e),this.shine||(this.shine=this.level.scene.add.sprite(48,16).setOrigin(.05,.2).play("diamond_shine"),this.shine.setScale(w()),this.shine.depth=4.5),this.shine.x=dt.tileToScreen(e.x),this.shine.y=dt.tileToScreen(e.y),this.isFalling?this.shine.stop():this.shine.play("diamond_shine")}}]),i}(me);pt.className="Jewel";var ft=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,e,a)).moveIntentDir=Y.UP,s.scanDirection="CW",s.anchorPosition=null,s.line1=null,s.debug=!1,s}return Object(f.a)(i,[{key:"addedToScene",value:function(){this.debug&&(this.directionLine=this.level.scene.add.line(dt.tileToScreen(this.position.x)+dt.tileToScreen(1)/2,dt.tileToScreen(this.position.y)+dt.tileToScreen(1)/2,0,0,0,-dt.tileToScreen(1),255),this.directionLine.setRotation(Math.PI/2),this.directionLine.width=1,this.directionLine.height=1,this.directionLine.setOrigin(.5,.5),this.anchorLine=this.level.scene.add.line(dt.tileToScreen(this.position.x)+dt.tileToScreen(1)/2,dt.tileToScreen(this.position.y)+dt.tileToScreen(1)/2,0,0,0,-dt.tileToScreen(1),65280),this.anchorLine.setRotation(Math.PI/2),this.anchorLine.width=1,this.anchorLine.height=1,this.anchorLine.setOrigin(.5,.5))}},{key:"overrunBy",value:function(e){var t,i;e.constructor.className!==_t.className&&(null===(t=this.alien)||void 0===t||t.destroy(),null===(i=this.line1)||void 0===i||i.destroy(),this.level.onCharacterDie(this),this.level.onEnemyKill(this));(e.isClass(ye)||e.isClass(pt))&&this.level.scene.events.emit("sounds:death_by_rock_hit"),this.level.enemy_die_effect.x=this.alien.x,this.level.enemy_die_effect.y=this.alien.y,this.level.enemy_die_effect.play("enemy_dies")}},{key:"loop",value:function(){this.moveIntentDir===Y.RIGHT&&this.alien.flipX&&this.alien.setFlipX(!1),this.moveIntentDir!==Y.LEFT||this.alien.flipX||this.alien.setFlipX(!0),this.debug&&(this.directionLine.setPosition(dt.tileToScreen(this.position.x)+dt.tileToScreen(1)/2,dt.tileToScreen(this.position.y)+dt.tileToScreen(1)/2),this.directionLine.setRotation(this.moveIntentDir===Y.UP?0:this.moveIntentDir===Y.RIGHT?Math.PI/2:this.moveIntentDir===Y.DOWN?Math.PI:3*Math.PI/2),this.anchorPosition&&(this.anchorLine.setPosition(dt.tileToScreen(this.position.x)+dt.tileToScreen(1)/2,dt.tileToScreen(this.position.y)+dt.tileToScreen(1)/2),this.anchorLine.setRotation(this.anchorPosition.y<this.position.y?0:this.anchorPosition.x>this.position.x?Math.PI/2:this.anchorPosition.y>this.position.y?Math.PI:3*Math.PI/2)))}}]),i}(yt);ft.className="Enemy";var vt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a,s){var n;return Object(p.a)(this,i),(n=t.call(this,e,a)).name=s,n.moveIntentDir="",n.isFollowing=!1,n.isLeading=!1,n.leadingPath=[],a.scene.events.on("player_moves",n.onPlayerMoves.bind(Object(pe.a)(n))),n.personalSpace=3,n}return Object(f.a)(i,[{key:"onPlayerMoves",value:function(e){if(this.isCloseEnough(e)&&this.isLeading&&this.leadingPath.length){var t=this.leadingPath.shift();this.calcMoveIntentForLeader(t),this.level.moveObject(this,t)}}},{key:"isCloseEnough",value:function(e){var t=Math.abs(this.position.x-e.x),i=Math.abs(this.position.y-e.y);return t<this.personalSpace&&i<this.personalSpace}},{key:"calcMoveIntentForLeader",value:function(e){this.moveIntentDir=this.position.y<e.y?Y.DOWN:this.moveIntentDir,this.moveIntentDir=this.position.y>e.y?Y.UP:this.moveIntentDir,this.position.x<e.x&&(this.moveIntentDir=Y.LEFT,this.animRunRight()),this.position.x>e.x&&(this.moveIntentDir=Y.RIGHT,this.animRunLeft())}},{key:"destroy",value:function(){}},{key:"animIdle",value:function(){var e;null===(e=this.alien)||void 0===e||e.play("".concat(this.name,"_idle"))}},{key:"animRun",value:function(){var e="";this.moveIntentDir===Y.UP&&(e="_up"),this.moveIntentDir===Y.DOWN&&(e="_down");var t="".concat(this.name,"_run").concat(e);this.alien.anims.currentAnim.key!==t&&this.alien.play(t)}},{key:"animRunLeft",value:function(){this.alien.setFlipX(!0),this.alien.setOrigin(.25,.25)}},{key:"animRunRight",value:function(){this.alien.setFlipX(!1),this.alien.setOrigin(0,.25)}},{key:"animLayRight",value:function(){var e,t;null===(e=this.alien)||void 0===e||e.setFlipX(!1),null===(t=this.alien)||void 0===t||t.play("".concat(this.name,"_laying"))}},{key:"animLayLeft",value:function(){var e,t;null===(e=this.alien)||void 0===e||e.setFlipX(!0),null===(t=this.alien)||void 0===t||t.play("".concat(this.name,"_laying"))}},{key:"die",value:function(){this.inactive=!0,this.alien.alpha=0,this.level.scene.events.off("player_moves",this.onPlayerMoves),this.destroy()}},{key:"overrunBy",value:function(e){e.constructor.className===ye.className&&this.level.scene.events.emit("sounds:death_by_rock_hit"),e.constructor.className!==_t.className&&this.die()}},{key:"runningOver",value:function(e){e.constructor.className===ft.className&&this.die()}}]),i}(yt);vt.className="NPCharacter";var _t=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;Object(p.a)(this,i),(s=t.call(this,e,a)).power=.5,s.moveIntentDir="",s.connected=!0,s.torch=null,s.mandatoryPath=[],s.ligth=null;var n=a.scene;return n.input.keyboard.removeListener("keydown",s.onKeyDown),n.input.keyboard.addListener("keydown",s.onKeyDown.bind(Object(pe.a)(s))),n.input.keyboard.removeListener("keyup",s.onKeyUp),n.input.keyboard.addListener("keyup",s.onKeyUp.bind(Object(pe.a)(s))),s}return Object(f.a)(i,[{key:"disconnect",value:function(){this.connected=!1,this.moveIntentDir="",this.inactive||this.animIdle()}},{key:"reconnect",value:function(){this.connected=!0}},{key:"onKeyUp",value:function(e){this.moveIntentDir===e.key&&this.connected&&(this.moveIntentDir="",this.pushingDirection=null)}},{key:"onKeyDown",value:function(e){!e.repeat&&[Y.UP,Y.DOWN,Y.LEFT,Y.RIGHT].includes(e.key)&&this.connected&&(this.moveIntentDir=e.key,this.isMoving||this.level.playerLoop())}},{key:"destroy",value:function(){}},{key:"moveToNextPosition",value:function(){if(!this.mandatoryPath.length)return this.moveIntentDir="",this.animIdle(),!1;var e=this.mandatoryPath.shift();return this.calcMoveIntent(e),this.level.moveObject(this,e),!0}},{key:"calcMoveIntent",value:function(e){this.moveIntentDir=this.position.y<e.y?Y.DOWN:this.moveIntentDir,this.moveIntentDir=this.position.y>e.y?Y.UP:this.moveIntentDir,this.position.x<e.x&&(this.moveIntentDir=Y.LEFT,this.animRunRight()),this.position.x>e.x&&(this.moveIntentDir=Y.RIGHT,this.animRunLeft())}},{key:"animIdle",value:function(){var e,t,i,a,s,n,o=this.hasPickaxe?"brave_idle_pickaxe":"brave_idle";""!==this.moveIntentDir&&this.canMoveDir(this.moveIntentDir)||this.inactive||(null===(e=this.alien)||void 0===e||e.play(o),null===(t=this.alien)||void 0===t||t.setFlipX(!1),null===(i=this.alien)||void 0===i||i.setOrigin(0,.25),null===(a=this.torch)||void 0===a||a.play("torch_idle"),null===(s=this.torch)||void 0===s||s.setFlipX(!1),null===(n=this.torch)||void 0===n||n.setOrigin(0,.25))}},{key:"animPushRight",value:function(){var e,t,i,a;null===(e=this.alien)||void 0===e||e.play("brave_push"),this.alien.setFlipX(!1),this.alien.setOrigin(0,.25),null===(t=this.torch)||void 0===t||t.play("torch_push"),null===(i=this.torch)||void 0===i||i.setFlipX(!1),null===(a=this.torch)||void 0===a||a.setOrigin(0,.25)}},{key:"animPushLeft",value:function(){var e,t,i,a;null===(e=this.alien)||void 0===e||e.play("brave_push"),this.alien.setFlipX(!0),this.alien.setOrigin(.25,.25),null===(t=this.torch)||void 0===t||t.play("torch_push"),null===(i=this.torch)||void 0===i||i.setFlipX(!0),null===(a=this.torch)||void 0===a||a.setOrigin(.25,.25)}},{key:"animRun",value:function(){var e="",t="",i="_run";this.moveIntentDir===Y.UP&&(e="_up"),this.moveIntentDir===Y.DOWN&&(e="_down"),this.isBrakingGround&&(i="_break"),this.hasPickaxe&&(t="_pickaxe",""===e&&this.isBrakingGround&&Math.random()>.5&&(t+="_alt"));var a,s="brave"+i+t+e;this.alien.anims.currentAnim.key===s||this.inactive||(this.alien.play(s),null===(a=this.torch)||void 0===a||a.play("torch_run"+e))}},{key:"animRunRight",value:function(){var e,t;this.alien.setFlipX(!1),this.alien.setOrigin(0,.25),null===(e=this.torch)||void 0===e||e.setFlipX(!1),null===(t=this.torch)||void 0===t||t.setOrigin(0,.25)}},{key:"animRunLeft",value:function(){var e,t;this.alien.setFlipX(!0),this.alien.setOrigin(.25,.25),null===(e=this.torch)||void 0===e||e.setFlipX(!0),null===(t=this.torch)||void 0===t||t.setOrigin(.25,.25)}},{key:"die",value:function(){var e=this;this.inactive=!0;var t=this.level.scene;t.input.keyboard.off("keydown"),t.input.keyboard.off("keyup"),this.level.onCharacterDie(this),this.alien.play("brave_dies"),this.alien.on(c.a.Animations.Events.ANIMATION_COMPLETE,(function(){e.destroy(),e.alien.alpha=0}))}},{key:"overrunBy",value:function(e){e.constructor.className===ye.className&&this.level.scene.events.emit("sounds:death_by_rock_hit"),e.constructor.className!==vt.className&&this.die()}},{key:"runningOver",value:function(e){if(e.isClass(ft)&&this.die(),e.isClass(mt)){var t=this.level.scene.children.getByName("layer_1").tilemap;this.level.break_effect.x=t.tileToWorldX(e.position.x),this.level.break_effect.y=t.tileToWorldY(e.position.y),this.level.break_effect.play("ground_breaks")}if(e.isClass(pt)){var i=this.level.scene.children.getByName("layer_1").tilemap;this.level.pick_effect.x=i.tileToWorldX(e.position.x),this.level.pick_effect.y=i.tileToWorldY(e.position.y),this.level.pick_effect.play("jewel_pick")}}},{key:"setupLight",value:function(){this.light=this.level.scene.lights.addLight(this.alien.x,this.alien.y,1e3).setColor(15395562).setIntensity(1.5)}},{key:"ligthTorch",value:function(){this.light||this.setupLight(),this.alien.alpha=1,this.torch=this.level.scene.add.sprite(48,16).setOrigin(0,.25),this.torch.setScale(this.alien.scaleX),this.torch.depth=4.5,this.torch.play("torch_idle"),this.level.scene.time.addEvent({delay:10,callback:function(){var e,t;this.torch.x=null===(e=this.alien)||void 0===e?void 0:e.x,this.torch.y=null===(t=this.alien)||void 0===t?void 0:t.y},callbackScope:this,repeat:-1}),this.level.scene.time.addEvent({delay:100,callback:function(){this.light.x=this.alien.x,this.light.y=this.alien.y,c.a.Geom.Ellipse.Random(this.alien,this.light)},callbackScope:this,repeat:-1})}}]),i}(yt);_t.className="Player";var gt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!0,isBreakable:!1,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).strength=20,s}return i}(le);gt.className="Wall";var Et=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,e,a)).ephemeral=!0,s}return Object(f.a)(i,[{key:"overrunBy",value:function(e){e.isClass(_t)&&this.level.onInteractWith(this)}}]),i}(ce);Et.className="Interactive";var Ot=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){return Object(p.a)(this,i),t.apply(this,arguments)}return i}(Et);Ot.className="Exit";var St=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!0,isPickable:!1,isCrushable:!0,level:a})).reach=1,s.strength=5,s.objectsToDestroyByExplostion=[],s}return Object(f.a)(i,[{key:"addedToScene",value:function(){var e=this.level.scene.add.particles("spark").setScale(w);this.emitter=e.createEmitter(),this.emitter.setQuantity(15),this.emitter.setFrequency(1e3),this.emitter.setAngle({min:-180,max:90}),this.emitter.setSpeed({min:5,max:7}),this.emitter.setGravityY(1),this.emitter.setGravityX(.01),this.emitter.setLifespan({min:1e3,max:5e3}),this.emitter.alpha.onChange(.5),this.emitter.tint.onChange(13784064),this.emitter.stop()}},{key:"explode",value:function(){var e,t=this;null===(e=this.alien)||void 0===e||e.destroy(),this.level.moveables=this.level.moveables.filter((function(e){return e!==t})),this.level.parallelMovables=this.level.parallelMovables.filter((function(e){return e!==t})),this.level.replaceByEmpty(this);for(var i=this.position.x-this.reach;i<=this.position.x+this.reach;i++)for(var a=function(e){var a=t.level.getObjectAt(i,e),s=a.isBreakable&&(a.strength||0)<10;if(s&&!t.level.objectIsEmpty(a)&&(t.objectsToDestroyByExplostion.push(a),a.isClass(me)&&(t.level.moveables=t.level.moveables.filter((function(e){return e!==a})),t.level.parallelMovables=t.level.parallelMovables.filter((function(e){return e!==a})))),s||t.level.objectIsEmpty(a)){var n=new he(B.EXPLOSION,t.level);n.setPosition({x:i,y:e}),t.level.setObjectAt(i,e,n),t.objectsToDestroyByExplostion.push(n)}},s=this.position.y-this.reach;s<=this.position.y+this.reach;s++)a(s);setTimeout((function(){return t.onExplode()}),125),this.level.scene.events.emit("sounds:explosion"),this.level.scene.events.emit("barre:explode",this),this.level.scene.cameras.main.shake(500,.003)}},{key:"onExplode",value:function(){var e=this,t=this.level;this.objectsToDestroyByExplostion.forEach((function(e){var i=new he(B.EXPLOSION,t);e.isClass(he)||(e.overrunBy(i),t.onDestroyElement(e))})),this.emitter.setPosition({min:dt.tileToPixels(this.position.x),max:dt.tileToPixels(this.position.x+1)},{min:dt.tileToPixels(this.position.y),max:dt.tileToPixels(this.position.y+1)}),this.level.onNextTick((function(t){e.emitter.stop()}))}},{key:"overrunBy",value:function(){this.explode()}}]),i}(me);St.className="Barrel";var Tt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!1,isBreakable:!0,isFlat:!1,isPickable:!0,isCrushable:!1,level:a})).strength=4,s}return Object(f.a)(i,[{key:"overrunBy",value:function(e){e.isClass(_t)&&(this.alien.visible=!1,this.level.onMushroomPick(this),this.level.scene.events.emit("sounds:shroom_pick"),this.level.scene.events.emit("score:mushroom_collected")),e.isClass(he)&&(this.alien.visible=!1,this.alien.destroy())}}]),i}(me);Tt.className="Mushroom";var At=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e,a){var s;return Object(p.a)(this,i),(s=t.call(this,{id:e,isRigid:!0,isBreakable:!1,isFlat:!0,isPickable:!1,isCrushable:!1,level:a})).isLit=!1,s.light=null,s.alien=a.scene.add.sprite(48,16).setOrigin(0,.5).play("wall_torch_idle"),s.alien.on(c.a.Animations.Events.ANIMATION_COMPLETE,(function(){s.isLit&&(s.alien.flipX?s.alien.setOrigin(0,.5):s.alien.setOrigin(.15,.5),s.alien.setFlipX(!s.alien.flipX),s.alien.play("wall_torch_lit"))})),s.alien.setScale(w()),s.strength=20,s.leftTrigger=null,s.rightTrigger=null,s}return Object(f.a)(i,[{key:"ignite",value:function(){this.alien.play("wall_torch_lighting"),this.isLit=!0,this.setUpLights()}},{key:"setPosition",value:function(){var e=Object(q.a)(Q.a.mark((function e(t){var a=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(A.a)(Object(b.a)(i.prototype),"setPosition",this).call(this,t),this.alien.x=dt.tileToScreen(t.x),this.alien.y=dt.tileToScreen(t.y),this.level.onNextTick((function(){a.setIgniteTriggers()}));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setUpLights",value:function(){this.light=this.level.scene.lights.addLight(dt.tileToScreen(this.position.x),dt.tileToScreen(this.position.y),1e3).setColor(15395562).setIntensity(0),this.level.scene.time.addEvent({delay:100,callback:function(){this.light.intensity<1.5&&this.light.setIntensity(this.light.intensity+.3),c.a.Geom.Ellipse.Random({x:this.alien.x+dt.tileToPixels(1),y:this.alien.y,width:this.alien.width,height:this.alien.height},this.light)},callbackScope:this,repeat:-1})}},{key:"setIgniteTriggers",value:function(){var e=this,t=this.level.getObjectAt(this.position.x-1,this.position.y),i=this.level.getObjectAt(this.position.x+1,this.position.y),a=function(t){t.isClass(_t)&&t.torch&&!e.isLit&&e.ignite()};if(t){var s=new Et(B.INTERACTION,this);s.setPosition(t.position),s.overrunBy=a,this.level.interactiveElements["".concat(s.position.x,"-").concat(s.position.y)]=s,this.leftTrigger=s}if(i){var n=new Et(B.INTERACTION,this);n.setPosition(i.position),n.overrunBy=a,this.level.interactiveElements["".concat(n.position.x,"-").concat(n.position.y)]=n,this.rightTrigger=n}}}]),i}(le);At.className="Torch";var bt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this)).name="The beginning",e}return Object(f.a)(i,[{key:"id",get:function(){return this.constructor.key}},{key:"connectToScene",value:function(e){var t=this;Object(A.a)(Object(b.a)(i.prototype),"connectToScene",this).call(this,e),this.unfinished&&e.events.once("levelstart",(function(){return t.showDialog1()}));var a=this.scene.add.image(this.scene.cameras.main.width/2,this.scene.cameras.main.height/2,"light_beam");a.x=dt.tileToScreen(14),a.y=dt.tileToScreen(1),a.setOrigin(0,0),a.setScale(2*w),a.scaleX=2.4*w,a.setScrollFactor(1),a.depth=4.5,a.alpha=.5;var s=e.add.particles("spark").setScale(w).createEmitter();s.setPosition({min:dt.tileToPixels(17),max:dt.tileToPixels(28)},{min:dt.tileToPixels(0),max:dt.tileToPixels(10)}),s.setQuantity(5),s.setFrequency(2e4),s.setAngle({min:0,max:360}),s.setSpeed(5),s.setGravityY(.1),s.setGravityX(0),s.setLifespan({min:1e4,max:5e4}),s.alpha.onChange(.5)}},{key:"showDialog1",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_1.dialog_1.mary_say_1")],options:[]}]})}},{key:"showDialog2",value:function(){this.scene.events.emit("dialogue:show",{participants:["closeUp_Mary"],participantNames:["Mary"],conversation:[{who:"closeUp_Mary",text:[ne("level_1.dialog_2.mary_say_1")],options:[]}]})}},{key:"onInteractWith",value:function(e){Object(A.a)(Object(b.a)(i.prototype),"onInteractWith",this).call(this,e),e.isClass(Ot)&&this.onComplete(),e.isClass(Et)&&0===e.order&&this.unfinished&&this.showDialog2()}}]),i}(_e);bt.key="level_1";var xt,kt,wt,Nt=bt,Rt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e){var a;return Object(p.a)(this,i),(a=t.call(this,{game:e,renderTarget:!0,fragShader:"\n  #ifdef GL_ES\n      precision highp float;\n  #endif\n\n  #define PI 3.1415926538\n\n  // Samplers\n  varying vec2 outTexCoord;\n  uniform sampler2D uMainSampler;\n\n  // Parameters\n  uniform vec2 curvature;\n  uniform vec2 screenResolution;\n  uniform vec2 scanLineOpacity;\n  uniform float vignetteOpacity;\n  uniform float brightness;\n  uniform float vignetteRoundness;\n\n\n  vec2 curveRemapUV(vec2 uv)\n  {\n      // as we near the edge of our screen apply greater distortion using a sinusoid.\n\n      uv = uv * 2.0 - 1.0;\n  vec2 offset = abs(uv.yx) / vec2(curvature.x, curvature.y);\n  uv = uv + uv * offset * offset;\n  uv = uv * 0.5 + 0.5;\n      return uv;\n  }\n\n  vec4 scanLineIntensity(float uv, float resolution, float opacity)\n  {\n      float intensity = sin(uv * resolution * PI * 2.0);\n      intensity = ((0.5 * intensity) + 0.5) * 0.9 + 0.1;\n      return vec4(vec3(pow(intensity, opacity)), 1.0);\n  }\n\n  vec4 vignetteIntensity(vec2 uv, vec2 resolution, float opacity, float roundness)\n  {\n      float intensity = uv.x * uv.y * (1.0 - uv.x) * (1.0 - uv.y);\n      return vec4(vec3(clamp(pow((resolution.x / roundness) * intensity, opacity), 0.0, 1.0)), 1.0);\n  }\n\n  void main(void) \n  {\n      vec2 remappedUV = curveRemapUV(vec2(outTexCoord.x, outTexCoord.y));\n      vec4 baseColor = texture2D(uMainSampler, remappedUV);\n\n      baseColor *= vignetteIntensity(remappedUV, screenResolution, vignetteOpacity, vignetteRoundness);\n\n      baseColor *= scanLineIntensity(remappedUV.x, screenResolution.y, scanLineOpacity.x);\n      baseColor *= scanLineIntensity(remappedUV.y, screenResolution.x, scanLineOpacity.y);\n\n      baseColor *= vec4(vec3(brightness), 1.0);\n\n      if (remappedUV.x < 0.0 || remappedUV.y < 0.0 || remappedUV.x > 1.0 || remappedUV.y > 1.0){\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      } else {\n          gl_FragColor = baseColor;\n      }\n  }\n",uniforms:["uMainSampler","curvature","screenResolution","scanLineOpacity","vignetteOpacity","brightness","vignetteRoundness"]})).set2f("curvature",6,100),a.set2f("scanLineOpacity",.25,.25),a.set1f("vignetteOpacity",.5),a.set1f("vignetteRoundness",1),a.set1f("brightness",1.25),a}return Object(f.a)(i,[{key:"onPreRender",value:function(){document.querySelector("canvas").width,document.querySelector("canvas").height;this.set2f("screenResolution",640,480)}}]),i}(c.a.Renderer.WebGL.Pipelines.PostFXPipeline),It=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){return Object(p.a)(this,i),t.call(this,"LandingScene")}return Object(f.a)(i,[{key:"preload",value:function(){this.add.text(80*w(),121*w()+20*w(),ne("menu.main.loading_message"),{fontFamily:"GameGirl",fontSize:"40px",fill:"#ffffff"}).setShadow(-1,1).setScale(w()/5),this.load.script("webfont","https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"),this.load.image("main-tiles","/lostcartridgejam3Game/assets/tilemaps/world1_tiles_20x20.png"),this.load.image("gates-tiles","/lostcartridgejam3Game/assets/tilemaps/gates_tilemap_20x20.png"),this.load.image("hud-tiles","/lostcartridgejam3Game/assets/tilemaps/hud_tilemap_20x20.png"),this.load.image("_level_2","/lostcartridgejam3Game/assets/maps/test.png"),this.load.image(Ee.key,"/lostcartridgejam3Game/assets/maps/level_test.png"),this.load.image("".concat(Ee.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_test_bg.png"),this.load.image(Nt.key,"/lostcartridgejam3Game/assets/maps/level_1.png"),this.load.image("".concat(Nt.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_1_bg.png"),this.load.image(Se.key,"/lostcartridgejam3Game/assets/maps/level_2.png"),this.load.image("".concat(Se.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_2_bg.png"),this.load.image(Ae.key,"/lostcartridgejam3Game/assets/maps/level_3.png"),this.load.image("".concat(Ae.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_3_bg.png"),this.load.image(xe.key,"/lostcartridgejam3Game/assets/maps/level_4.png"),this.load.image("".concat(xe.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(we.key,"/lostcartridgejam3Game/assets/maps/level_5.png"),this.load.image("".concat(we.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(De.key,"/lostcartridgejam3Game/assets/maps/level_6.png"),this.load.image("".concat(De.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(Ue.key,"/lostcartridgejam3Game/assets/maps/level_7.png"),this.load.image("".concat(Ue.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(Le.key,"/lostcartridgejam3Game/assets/maps/level_8.png"),this.load.image("".concat(Le.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(Pe.key,"/lostcartridgejam3Game/assets/maps/level_9.png"),this.load.image("".concat(Pe.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(We.key,"/lostcartridgejam3Game/assets/maps/level_10.png"),this.load.image("".concat(We.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(Ye.key,"/lostcartridgejam3Game/assets/maps/level_11.png"),this.load.image("".concat(Ye.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(Ve.key,"/lostcartridgejam3Game/assets/maps/level_12.png"),this.load.image("".concat(Ve.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(Qe.key,"/lostcartridgejam3Game/assets/maps/level_13.png"),this.load.image("".concat(Qe.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(ze.key,"/lostcartridgejam3Game/assets/maps/level_14.png"),this.load.image("".concat(ze.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image($e.key,"/lostcartridgejam3Game/assets/maps/level_15.png"),this.load.image("".concat($e.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(tt.key,"/lostcartridgejam3Game/assets/maps/level_16.png"),this.load.image("".concat(tt.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(at.key,"/lostcartridgejam3Game/assets/maps/level_17.png"),this.load.image("".concat(at.key,"_bg"),"/lostcartridgejam3Game/assets/maps/level_default_bg.png"),this.load.image(nt.key,"/lostcartridgejam3Game/assets/maps/level_finale.png"),this.load.image("Stage1_bg","/lostcartridgejam3Game/assets/images/stage_1_bg_art.png"),this.load.image("IntroTiamat","/lostcartridgejam3Game/assets/images/intro_tiamat.png"),this.load.image("IntroSky","/lostcartridgejam3Game/assets/images/intro_sky.png"),this.load.image("IntroClouds","/lostcartridgejam3Game/assets/images/intro_clouds.png"),this.load.image("IntroGround","/lostcartridgejam3Game/assets/images/intro_ground.png"),this.load.image("IntroGroundHigh","/lostcartridgejam3Game/assets/images/intro_ground_high.png"),this.load.image("IntroGroundBreak","/lostcartridgejam3Game/assets/images/intro_ground_break.png"),this.load.image("IntroComet","/lostcartridgejam3Game/assets/images/intro_comet.png"),this.load.image("IntroPeopleClimbing","/lostcartridgejam3Game/assets/images/intro_people_climbing.png"),this.load.image("IntroPeoplePraying","/lostcartridgejam3Game/assets/images/intro_people_praying.png"),this.load.image("IntroPeoplePrayingHigh","/lostcartridgejam3Game/assets/images/intro_people_praying_high.png"),this.load.image("IntroPeopleDescending","/lostcartridgejam3Game/assets/images/intro_people_descending.png"),this.load.image("IntroPeopleFalling","/lostcartridgejam3Game/assets/images/intro_people_falling.png"),this.load.image("IntroPeopleJumping","/lostcartridgejam3Game/assets/images/intro_people_jumping.png"),this.load.image("IntroStorm","/lostcartridgejam3Game/assets/images/intro_storm.png"),this.load.image("Prologue","/lostcartridgejam3Game/assets/images/Prologue.png"),this.load.image("thechild","/lostcartridgejam3Game/assets/images/thechild.png"),this.load.image("theworld","/lostcartridgejam3Game/assets/images/theworld.png"),this.load.image("Tiamat","/lostcartridgejam3Game/assets/images/Tiamat.png"),this.load.image("Cover","/lostcartridgejam3Game/assets/images/cover.png"),this.load.image("Bossfight","/lostcartridgejam3Game/assets/images/Bossfight.png"),this.load.image("Bossfighthands","/lostcartridgejam3Game/assets/images/Bossfighthands.png"),this.load.image("spark","/lostcartridgejam3Game/assets/sprites/flare_blue.png"),this.load.image("light_beam","/lostcartridgejam3Game/assets/sprites/light_beam.png"),this.load.spritesheet("boulder","/lostcartridgejam3Game/assets/sprites/boulder_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("explosion","/lostcartridgejam3Game/assets/sprites/explosion_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("torch","/lostcartridgejam3Game/assets/sprites/torch_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("brave","/lostcartridgejam3Game/assets/sprites/brave_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("bro","/lostcartridgejam3Game/assets/sprites/bro_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("dwarf","/lostcartridgejam3Game/assets/sprites/dwarf_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("gate","/lostcartridgejam3Game/assets/sprites/gate_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("bat","/lostcartridgejam3Game/assets/sprites/bat_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("pickables","/lostcartridgejam3Game/assets/sprites/pickables_sprite.png",{frameWidth:26,frameHeight:26}),this.load.spritesheet("closeUp","/lostcartridgejam3Game/assets/sprites/close_up_sprite.png",{frameWidth:40,frameHeight:40}),this.load.spritesheet("closeUpItems","/lostcartridgejam3Game/assets/sprites/close_up_sprite.png",{frameWidth:20,frameHeight:20}),this.load.audio("credits","/lostcartridgejam3Game/assets/audio/Score/Opening Credits_.mp3"),this.load.audio("opening_peace","/lostcartridgejam3Game/assets/audio/Score/NormalDay.mp3"),this.load.audio("opening_quakes","/lostcartridgejam3Game/assets/audio/Score/Earthquakes+Tiamat.mp3"),this.load.audio("credits","/lostcartridgejam3Game/assets/audio/Score/NormalDay.mp3"),this.load.audio("levels_surface","/lostcartridgejam3Game/assets/audio/Score/1st 7 Levels.mp3"),this.load.audio("swarf_chat_music","/lostcartridgejam3Game/assets/audio/Score/MushroomDwarfDialogue(loop).mp3"),this.load.audio("generic_chat_music","/lostcartridgejam3Game/assets/audio/Score/GenericDialogue(loop).mp3"),this.load.audio("escape_music","/lostcartridgejam3Game/assets/audio/Score/BossBattle_EscapeTheVoid!(loop).mp3"),this.load.audio("rock_hit","/lostcartridgejam3Game/assets/audio/SFX/RockHit.mp3"),this.load.audio("rock_hit2","/lostcartridgejam3Game/assets/audio/SFX/RockHit2.mp3"),this.load.audio("rock_hit3","/lostcartridgejam3Game/assets/audio/SFX/RockHit3.wav"),this.load.audio("rock_hit_soft","/lostcartridgejam3Game/assets/audio/SFX/RockHitSoft.mp3"),this.load.audio("explosion","/lostcartridgejam3Game/assets/audio/SFX/MidSizeExplosion.mp3"),this.load.audio("clear_hit1","/lostcartridgejam3Game/assets/audio/SFX/PickaxeClearingGround1.mp3"),this.load.audio("clear_hit2","/lostcartridgejam3Game/assets/audio/SFX/PickaxeClearingGround2.mp3"),this.load.audio("clear_hit3","/lostcartridgejam3Game/assets/audio/SFX/PickaxeClearingGround3.mp3"),this.load.audio("rock_slide_hard1","/lostcartridgejam3Game/assets/audio/SFX/RockSlideHard1.mp3"),this.load.audio("rock_slide_hard2","/lostcartridgejam3Game/assets/audio/SFX/RockSlideHard2.mp3"),this.load.audio("rock_slide_hard3","/lostcartridgejam3Game/assets/audio/SFX/RockSlideHard3.mp3"),this.load.audio("rock_slide_soft1","/lostcartridgejam3Game/assets/audio/SFX/RockSlideSoft1.mp3"),this.load.audio("rock_slide_soft2","/lostcartridgejam3Game/assets/audio/SFX/RockSlideSoft2.mp3"),this.load.audio("rock_slide_soft3","/lostcartridgejam3Game/assets/audio/SFX/RockSlideSoft3.mp3"),this.load.audio("coin","/lostcartridgejam3Game/assets/audio/SFX/CoinSound.mp3"),this.load.audio("gem_hit","/lostcartridgejam3Game/assets/audio/SFX/GemHitRock.mp3"),this.load.audio("shroom_pick","/lostcartridgejam3Game/assets/audio/SFX/MushroomPickUp.mp3"),this.load.audio("gem_pick","/lostcartridgejam3Game/assets/audio/SFX/DiamondPickUp.mp3"),this.load.audio("death_by_rock","/lostcartridgejam3Game/assets/audio/SFX/DeathByRock.mp3"),this.load.audio("level_complete","/lostcartridgejam3Game/assets/audio/SFX/Level Finish.mp3"),this.load.audio("earthquake","/lostcartridgejam3Game/assets/audio/SFX/Earthquake.mp3")}},{key:"navigateToScene",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.cameras.main.fade(500,0,0,0),this.tweens.add({targets:xt,volume:0,ease:"Linear",duration:500,onComplete:function(){xt.pause(),console.log(e),t.scene.start(e,i)}})}},{key:"create",value:function(){var e=this;this.cameras.main.setPostPipeline(Rt),this.cameras.main.setBackgroundColor("#000");var t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"Cover"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.min(i,a);t.setOrigin(.5,.5),t.setScale(s).setScrollFactor(0),t.name="background_art",xt=this.sound.add("credits",{loop:!0}),window.WebFont.load({custom:{families:["GameGirl","Emulogic"]},active:function(){e.cameras.main.fadeIn(500,0,0,0),e.events.emit("scene_ready",e.sys.config),xt=e.sound.add("credits",{loop:!0}),new ct(e).showInitialMenu()}})}}]),i}(c.a.Scene),Dt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){return Object(p.a)(this,i),t.call(this,"MenuScene")}return Object(f.a)(i,[{key:"preload",value:function(){}},{key:"navigateToScene",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.cameras.main.fade(500,0,0,0),this.tweens.add({targets:kt,volume:0,ease:"Linear",duration:500,onComplete:function(){kt.pause(),t.scene.start(e,i)}})}},{key:"create",value:function(){var e=this;this.cameras.main.setPostPipeline(Rt),this.cameras.main.setBackgroundColor("#486859");var t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"Stage1_bg"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.max(i,a);t.setScale(1.5*s).setScrollFactor(0),t.name="background_art",kt=this.sound.add("credits",{loop:!0}),window.WebFont.load({custom:{families:["GameGirl"]},active:function(){e.cameras.main.fadeIn(500,0,0,0),e.events.emit("scene_ready",e.sys.config),kt=e.sound.add("credits",{loop:!0}),e.input.keyboard.off("keydown"),e.input.keyboard.on("keydown",(function(t){"Escape"===t.key&&e.navigateToScene("LandingScene")})),new ct(e).showMainMenu()}})}}]),i}(c.a.Scene),Mt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){var e;return Object(p.a)(this,i),(e=t.call(this,"IntroScene")).images={tiamat:null,sky:null,clouds:null,storm:null,ground:null,ground_high:null,ground_break:null,comet:null,people_climbing:null,people_paying:null,people_paying_high:null,people_descending:null,people_falling:null,people_jumping:null},e.texts={line1:null,line2:null,line3:null,level_title:null},e.sounds={background_music:null,dramatic_music:null,earthquake:null},e}return Object(f.a)(i,[{key:"preload",value:function(){K.a.reset()}},{key:"createAnimations",value:function(){this.anims.create({key:"closeUp_Mary",frames:this.anims.generateFrameNumbers("closeUp",{frames:[0]}),repeat:0}),this.anims.create({key:"closeUp_Marduk",frames:this.anims.generateFrameNumbers("closeUp",{frames:[1]}),repeat:0}),this.anims.create({key:"closeUp_Dwarf",frames:this.anims.generateFrameNumbers("closeUp",{frames:[2]}),repeat:0}),this.anims.create({key:"closeUp_Tiamat",frames:this.anims.generateFrameNumbers("closeUp",{frames:[5]}),repeat:0})}},{key:"createSounds",value:function(){this.sounds.background_music=this.sound.add("opening_peace",{loop:!0}),this.sounds.dramatic_music=this.sound.add("opening_quakes",{loop:!0}),this.sounds.earthquake=this.sound.add("earthquake")}},{key:"createTextPlaceholders",value:function(){this.texts.line1=this.createTextLine(-4),this.texts.line2=this.createTextLine(-3),this.texts.line3=this.createTextLine(-2),this.texts.level_title=this.createTextLine(0),this.texts.level_title.setPosition(this.cameras.main.width/2,this.cameras.main.height/2),this.texts.level_title._shadow.setPosition(this.cameras.main.width/2,this.cameras.main.height/2),this.texts.level_title.setOrigin(.5,.5),this.texts.level_title._shadow.setOrigin(.5,.5),this.texts.level_title.alpha=0,this.texts.level_title._shadow.alpha=0,this.texts.level_title.setText(ne("stage_1.title"))}},{key:"createTextLine",value:function(e){var t=10*w,i=e<0?this.cameras.main.height:0,a=e<0?-1:1,s=2*w,n=i+Math.abs(t*e)*a,o=this.add.text(80,10,"",{fontFamily:"GameGirl",fontSize:"10px",fill:"#ffffff"}).setScale(w).setPosition(s,n);o.displayHeight=t;var r=this.add.text(o.x+5,o.y-5,"",o.style).setScale(w);return r.displayHeight=o.displayHeight,o.setTint(3355443),r._setText=r.setText,r._shadow=o,r.setText=function(e){r._shadow.setText(e),r._setText(e)},r}},{key:"createImages",value:function(){this.images.sky=this.createFullscreenImage("IntroSky"),this.images.clouds=this.createFullscreenImage("IntroClouds"),this.images.tiamat=this.createFullscreenImage("IntroTiamat"),this.images.ground=this.createFullscreenImage("IntroGround"),this.images.comet=this.createFullscreenImage("IntroComet"),this.images.storm=this.createFullscreenImage("IntroStorm"),this.images.ground_high=this.createFullscreenImage("IntroGroundHigh"),this.images.ground_break=this.createFullscreenImage("IntroGroundBreak"),this.images.people_climbing=this.createFullscreenImage("IntroPeopleClimbing"),this.images.people_falling=this.createFullscreenImage("IntroPeopleFalling"),this.images.people_paying=this.createFullscreenImage("IntroPeoplePraying"),this.images.people_paying_high=this.createFullscreenImage("IntroPeoplePrayingHigh"),this.images.people_descending=this.createFullscreenImage("IntroPeopleDescending"),this.images.people_jumping=this.createFullscreenImage("IntroPeopleJumping")}},{key:"createFullscreenImage",value:function(e){var t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,e);return t.setScale(w).setScrollFactor(0),t.alpha=0,t}},{key:"animEnterTiamat",value:function(){var e=Object(q.a)(Q.a.mark((function e(t){var i=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){i.tweens.add({targets:i.images.tiamat,alpha:1,duration:t,ease:"Linear",onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"animExitTiamat",value:function(){var e=Object(q.a)(Q.a.mark((function e(t){var i=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){i.tweens.add({targets:i.images.tiamat,alpha:0,duration:t,ease:"Linear",onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"animEnterWorld",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:t.images.sky,alpha:1,duration:2500,ease:"Linear"}),t.tweens.add({targets:t.images.clouds,alpha:1,delay:3e3,duration:2500,ease:"Linear"}),t.tweens.add({targets:t.images.comet,alpha:1,delay:6e3,duration:2500,ease:"Linear"}),t.tweens.add({targets:t.images.ground,alpha:1,delay:9e3,duration:2500,ease:"Linear",onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animEnterPeople",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 3e3,e.abrupt("return",new Promise((function(e){t.tweens.add({targets:t.images.people_climbing,delay:3e3,alpha:1,duration:1e3,yoyo:!0,hold:1e3,ease:"Linear"}),t.tweens.add({targets:t.images.people_paying,alpha:1,delay:5e3,duration:1e3,ease:"Linear",onComplete:e})})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animGroundTransition",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:[t.images.people_paying,t.images.ground],alpha:0,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.images.people_paying_high,t.images.ground_high],alpha:1,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.images.people_paying_high],alpha:0,delay:2e3,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.images.people_descending],alpha:1,delay:2e3,duration:1e3,ease:"Linear",completeDelay:2e3,onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animPage",value:function(){var e=Object(q.a)(Q.a.mark((function e(t){var i=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){i.texts.line1.alpha=i.texts.line2.alpha=i.texts.line3.alpha=0,i.tweens.add({targets:[i.texts.line1,i.texts.line1._shadow,i.texts.line2,i.texts.line2._shadow,i.texts.line3,i.texts.line3._shadow],alpha:1,duration:1e3,completeDelay:t,onComplete:function(){i.tweens.add({targets:[i.texts.line1,i.texts.line1._shadow,i.texts.line2,i.texts.line2._shadow,i.texts.line3,i.texts.line3._shadow],alpha:0,duration:1e3,onComplete:e})}})})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"animPage1",value:function(){var e=Object(q.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.texts.line1.setText(ne("intro.story_page_1.line_1")),this.texts.line2.setText(ne("intro.story_page_1.line_2")),e.abrupt("return",this.animPage(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animPage2",value:function(){var e=Object(q.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.texts.line1.setText(ne("intro.story_page_2.line_1")),this.texts.line2.setText(ne("intro.story_page_2.line_2")),this.texts.line3.setText(ne("intro.story_page_2.line_3")),e.abrupt("return",this.animPage(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animPage3",value:function(){var e=Object(q.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.texts.line1.setText(ne("intro.story_page_3.line_1")),this.texts.line2.setText(ne("intro.story_page_3.line_2")),this.texts.line3.setText(ne("intro.story_page_3.line_3")),e.abrupt("return",this.animPage(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animPage4",value:function(){var e=Object(q.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.texts.line1.setText(ne("intro.story_page_4.line_1")),this.texts.line2.setText(ne("intro.story_page_4.line_2")),this.texts.line3.setText(""),e.abrupt("return",this.animPage(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animPage5",value:function(){var e=Object(q.a)(Q.a.mark((function e(t){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.texts.line1.setText(ne("intro.story_page_5.line_1")),this.texts.line2.setText(ne("intro.story_page_5.line_2")),this.texts.line3.setText(""),e.abrupt("return",this.animPage(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"animEarthquake",value:function(){var e=Object(q.a)(Q.a.mark((function e(){return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.cameras.main.shake(2e3,.005),this.sounds.earthquake.play();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"animStormEnter",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:[t.images.storm],alpha:1,duration:2e3,ease:"Linear",completeDelay:2e3,onComplete:function(){t.images.clouds.alpha=0,t.images.comet.alpha=0,t.images.ground.alpha=0,t.images.sky.alpha=0,e()}})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animEnterFalling",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:[t.images.ground_high,t.images.people_descending],alpha:0,delay:1e3,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.images.ground_break,t.images.people_falling],alpha:1,delay:1e3,duration:1e3,ease:"Linear",completeDelay:2e3,onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animEnterJumping",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:[t.images.people_falling],alpha:0,delay:1e3,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.images.people_jumping],alpha:1,delay:1e3,duration:1e3,ease:"Linear",completeDelay:5e3,onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"animLevelTitle",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.tweens.add({targets:[t.images.people_jumping,t.images.ground_break,t.images.storm],alpha:0,delay:1e3,duration:1e3,ease:"Linear"}),t.tweens.add({targets:[t.texts.level_title,t.texts.level_title._shoadow],alpha:1,delay:1e3,duration:1e3,ease:"Linear",completeDelay:5e3,onComplete:e})})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"playMusic",value:function(){this.sounds.background_music.play()}},{key:"playDramaticMusic",value:function(){var e=this;this.tweens.add({targets:this.sounds.background_music,volume:0,duration:500,completeDelay:1e3,onComplete:function(){e.sounds.background_music.stop(),e.sounds.dramatic_music.play()}})}},{key:"exitMusic",value:function(){var e=this;this.tweens.add({targets:this.sounds.dramatic_music,volume:0,duration:1500,onComplete:function(){e.sounds.dramatic_music.stop()}})}},{key:"create",value:function(){var e=Object(q.a)(Q.a.mark((function e(){var t=this;return Q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cameras.main.setPostPipeline(Rt),new dt(this,!0),this.createAnimations(),this.createSounds(),this.createImages(),this.createTextPlaceholders(),this.playMusic(),this.animEnterTiamat(5e3),e.next=10,this.animPage1(8e3);case 10:return this.animEnterWorld(),e.next=13,this.animPage2(8e3);case 13:return this.animEnterPeople(),e.next=16,this.animPage3(8e3);case 16:return e.next=18,this.showFirstDialogs();case 18:return e.next=20,this.animExitTiamat(5e3);case 20:return e.next=22,this.animGroundTransition();case 22:return e.next=24,this.showSecondDialogs();case 24:return this.playDramaticMusic(),e.next=27,this.animStormEnter();case 27:return this.animEarthquake(),this.animEnterFalling(),e.next=31,this.animPage4(4e3);case 31:return this.animPage5(6e3),e.next=34,this.animEnterJumping();case 34:return this.exitMusic(),e.next=37,this.animLevelTitle();case 37:this.cameras.main.fade(1e3,0,0,0),this.cameras.main.once("camerafadeoutcomplete",(function(){return t.scene.start("GameScene",{levelName:Nt.key})}));case 39:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"showFirstDialogs",value:function(){var e=this;return this.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Tiamat","closeUp_Marduk"],participantNames:["Mary","Tiamat","Marduk"],conversation:[{who:"closeUp_Tiamat",text:[ne("intro.dialog_1.tiamat_say_1")]},{who:"closeUp_Mary",text:[ne("intro.dialog_1.mary_say_1")]},{who:"closeUp_Tiamat",text:[ne("intro.dialog_1.tiamat_say_2")]},{who:"closeUp_Mary",text:[ne("intro.dialog_1.mary_say_2")]},{who:"closeUp_Tiamat",text:[ne("intro.dialog_1.tiamat_say_3")]},{who:"closeUp_Marduk",text:[ne("intro.dialog_1.marduk_say_1")]},{who:"closeUp_Mary",text:[ne("intro.dialog_1.mary_say_3")]},{who:"closeUp_Tiamat",text:[ne("intro.dialog_1.tiamat_say_4")]},{who:"closeUp_Tiamat",text:[ne("intro.dialog_1.tiamat_say_5")]},{who:"closeUp_Tiamat",text:[ne("intro.dialog_1.tiamat_say_6")]}]}),new Promise((function(t){e.levels={current:{pause:function(){return!1},resume:function(){setTimeout(t,1e3)}}}}))}},{key:"showSecondDialogs",value:function(){var e=this;return this.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Marduk"],participantNames:["Mary","Marduk"],conversation:[{who:"closeUp_Marduk",text:[ne("intro.dialog_2.marduk_say_1")]},{who:"closeUp_Mary",text:[ne("intro.dialog_2.mary_say_1")]},{who:"closeUp_Marduk",text:[ne("intro.dialog_2.marduk_say_2")]},{who:"closeUp_Mary",text:[ne("intro.dialog_2.mary_say_2")]},{who:"closeUp_Marduk",text:[ne("intro.dialog_2.marduk_say_3")]},{who:"closeUp_Mary",text:[ne("intro.dialog_2.mary_say_3")]},{who:"closeUp_Marduk",text:[ne("intro.dialog_2.marduk_say_4")]}]}),new Promise((function(t){e.levels={current:{pause:function(){return!1},resume:function(){setTimeout(t,1e3)}}}}))}},{key:"showThirdDialogs",value:function(){var e=this;this.levels={current:{pause:function(){return!1},resume:function(){e.tweens.add({targets:e.quakesMusic,volume:0,duration:500,completeDelay:500,onComplete:function(){e.scene.start("GameScene",{level:1})}})}}},this.events.emit("dialogue:show",{participants:[],conversation:[{who:"",text:["- A fissure opens up","beneath Marduk and he","falls into"]},{who:"",text:["- Mary rolls her eyes","and jumps in after"]}]})}},{key:"animateIntro",value:function(){var e=this;this.cameras.main.pan(this.renderer.width,this.renderer.height/2,2e3,"Sine.easeInOut"),this.cameras.main.once(c.a.Cameras.Scene2D.Events.PAN_COMPLETE,(function(){e.cameras.main.shake(2e3,.02),e.tweens.add({targets:e.children.getByName("dark"),y:.3*-e.renderer.height,duration:2e3}),e.tweens.add({targets:e.children.getByName("partner"),y:e.renderer.height,delay:2e3,duration:2e3,ease:"Sine.in"}),e.tweens.add({targets:e.children.getByName("player"),y:e.renderer.height,x:{value:e.children.getByName("player").x+150,duration:1e3,ease:"Cubic.easeOut"},delay:4e3,duration:2e3,ease:"Back.easeInOut",onComplete:function(){e.cameras.main.fade(1e3,0,0,0),e.cameras.main.once("camerafadeoutcomplete",(function(){e.scene.start("GameScene",{level:1})}))}})}))}}]),i}(c.a.Scene),Ut=i(33),Ct=function(e,t){for(var i=e.get(t).getSourceImage(),a=Array(i.height).fill("000000").map((function(){return Array(i.width).fill("000000")})),s=0;s<i.width;s++)for(var n=0;n<i.height;n++){var o=e.getPixel(s,n,t),r="".concat(c.a.Display.Color.ComponentToHex(o.r)).concat(c.a.Display.Color.ComponentToHex(o.g)).concat(c.a.Display.Color.ComponentToHex(o.b));a[n][s]=r}return a},Lt=function(e){return e.toLocaleString("en-US",{minimumIntegerDigits:2})},jt=function(e,t){return"number"==typeof t?"".concat(Lt(e),"/").concat(Lt(t)):"__/__"},Pt=function(e){var t=(100*e).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return e?" ".concat(t<=9?"  ":t<=99?" ":"").concat(t,"%"):"   -"},Gt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){return Object(p.a)(this,i),t.apply(this,arguments)}return i}(ue),Ht=["",Ee,Nt,"cinematic_1",Se,Ae,xe,we,"cinematic_escape",De,Ue,Le,Pe,We,Ye,Ve,rt,Qe,ze,$e,tt,at,nt,"cinematic_last"],Ft=function(e){var t,i=Ht.findIndex((function(t){return t.key===e}));do{i++,t=Ht[i]}while("string"===typeof t||i>Ht.length);return t.key},Wt=function(){function e(t){var i=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(p.a)(this,e),this.currentName=a,this.currentIndex=Ht.findIndex((function(e){return e.id===i.currentName})),this.scene=t,this.start()}return Object(f.a)(e,[{key:"start",value:function(){var e=this;console.log("START");var t=Ht.find((function(t){return t.key===e.currentName}));this.current=new t;var i=this.generateConfig(),a=Object(r.a)(i,2),s=a[0],n=a[1];this.current.config=s,this.current.bgConfig=n,this.map=this.createMap(),this.createBackground(),this.current.connectToScene(this.scene),this.current.pause(),this.scene.cameras.main.once("camerafadeincomplete",(function(){e.current.resume(),e.scene.events.emit("levelstart")}))}},{key:"restart",value:function(){var e=this;this.scene.cameras.main.fade(500,0,0,0),this.scene.cameras.main.once("camerafadeoutcomplete",(function(){e.scene.events.off("player_moves"),e.current.destroy(),e.scene.children.list.forEach((function(e){e.destroy()})),e.scene.rules.destroy(),e.scene.ui.destroy(),e.scene.scene.restart({levelName:e.currentName})}))}},{key:"next",value:function(){this.currentIndex+=1,"string"===typeof Ht[this.currentIndex]&&Ht[this.currentIndex].includes("cinematic")?this.scene.scene.start("ConnectorScene",{id:this.currentIndex,name:Ht[this.currentIndex]}):Ht[this.currentIndex]?this.start():this.scene.scene.start("MenuScene")}},{key:"generateConfig",value:function(){var e,t,i=this.scene,a=this.current.constructor.key;if(this.current.isMaze){e=Array(24).fill("000000").map((function(e){return Array(81).fill("000000")})),Object(Ut.a)(40,10,!0,Math.round(Math.random()*Math.pow(10,8))).forEach((function(t){t.forEach((function(t){var i=2*t.x+1,a=2*t.y+1+3;e[a-1][i]=t.top?B.WALL:B.EMPTY,t.top&&(e[a-1][i+1]=B.WALL,e[a-1][i-1]=B.WALL),e[a][i+1]=t.right?B.WALL:B.EMPTY,t.right&&(e[a+1][i+1]=B.WALL,e[a-1][i+1]=B.WALL),e[a+1][i]=t.bottom?B.WALL:B.EMPTY,t.bottom&&(e[a+1][i+1]=B.WALL,e[a+1][i-1]=B.WALL),e[a][i-1]=t.left?B.WALL:B.EMPTY,t.left&&(e[a+1][i-1]=B.WALL,e[a-1][i-1]=B.WALL),e[a][i]=B.EMPTY}))})),e[4][1]=B.PLAYER,e[5][1]=B.DWARF,e[5][2]=B.EMPTY;var s=e.findIndex((function(e){var t=e.slice(-1).pop()!==B.EMPTY,i=e.slice(-4,-1).every((function(e){return e===B.EMPTY}));return t&&i}));e[s][e[0].length-1]=B.EXIT,this.buildWallsAroundGate(e)}else e=Ct(i.textures,a),t=Ct(i.textures,"".concat(a,"_bg"));return[e,t]}},{key:"buildWallsAroundGate",value:function(e){e.forEach((function(t,i){t.forEach((function(t,a){t===B.EXIT&&(e[i-1][a]=B.DEBRIS,e[i-1][a-1]=B.DEBRIS,e[i-1][a-2]=B.DEBRIS,e[i+1][a]=B.DEBRIS,e[i+1][a-1]=B.DEBRIS,e[i+1][a-2]=B.DEBRIS)}))}))}},{key:"createBackground",value:function(){var e=this.scene.add.image(0,0,"Stage1_bg"),t=this.scene.cameras.main.width/e.width,i=this.scene.cameras.main.height/e.height,a=Math.max(t,i);e.setOrigin(0,0),e.setScale(1.5*a).setScrollFactor(.1),e.name="level_background_art",e.depth=-2}},{key:"createMap",value:function(){var e=this,t=this.scene,i=this.current,a=t.data.get("custom_scale"),s=this.scene.cameras.main,n=this.map,o=this.mapZ2,r=this.underlayMap;n&&n.scene&&(n.destroy(),o.destroy(),r.destroy()),n=t.make.tilemap({tileWidth:20,tileHeight:20,width:i.config[0].length,height:i.config.length}),o=t.make.tilemap({tileWidth:20,tileHeight:20,width:i.config[0].length,height:i.config.length}),r=t.make.tilemap({tileWidth:20,tileHeight:20,width:i.config[0].length,height:i.config.length}),window.map=n;var l=n.addTilesetImage("tiles","main-tiles",20,20,1,2),c=n.addTilesetImage("tiles-gates","gates-tiles",20,20,1,2),h=o.addTilesetImage("tiles-z2","gates-tiles",20,20,1,2),u=r.addTilesetImage("under-tiles","main-tiles",20,20,1,2),d=n.createBlankLayer("layer_1",l);d.name="layer_1",d.depth=0;var m=n.createBlankLayer("layer_2",c);m.name="layer_2",m.depth=0;var y=o.createBlankLayer("layer_1z2",h);y.name="layer_1z2",y.depth=5;var p=r.createBlankLayer("layer_0",u);return p.name="layer_0",p.depth=-1,d.setScale(a),m.setScale(a),y.setScale(a),p.setScale(1.01*a),p.setScrollFactor(.95),i.config.forEach((function(t,a){t.forEach((function(t,s){var l=t;if(i.bgConfig){var c=i.bgConfig[a][s];r.putTileAt(X[c],s,a)}if([B.WALL,B.DEBRIS,B.GROUND,B.ART,B.ART2,B.EXIT,B.TORCH].includes(l)){if(l===B.WALL||l===B.TORCH)l=e.current.isMaze?1:V.calculateWallTileWithNeighbours(a,s,i.config),n.putTileAt(l,s,a,!1,"layer_1");else if(l===B.DEBRIS)n.putTileAt(V[l],s,a,!1,"layer_1");else if(l===B.GROUND)l=V.calculateGroundTileWithNeighbours(a,s,i.config),n.putTileAt(l,s,a,!1,"layer_1");else if([B.ART,B.ART2].includes(l)){n.putTileAt(21,s,a,!1,"layer_1");var h=[B.ART,B.ART2].includes(i.config[a][s+1]);if([B.ART,B.ART2].includes(i.config[a][s-1]))return!1;h?(n.putTileAt(21,s+1,a,!1,"layer_1"),n.putTileAt(V[l]+3,s-1,a,!1,"layer_2").setFlipX(!0),n.putTileAt(V[l]+2,s,a,!1,"layer_2").setFlipX(!0),n.putTileAt(V[l]+1,s+1,a,!1,"layer_2").setFlipX(!0),n.putTileAt(V[l],s+2,a,!1,"layer_2").setFlipX(!0),n.putTileAt(V[l]+10+3,s-1,a+1,!1,"layer_2").setFlipX(!0),n.putTileAt(V[l]+10+2,s,a+1,!1,"layer_2").setFlipX(!0),n.putTileAt(V[l]+10+1,s+1,a+1,!1,"layer_2").setFlipX(!0),n.putTileAt(V[l]+10,s+2,a+1,!1,"layer_2").setFlipX(!0)):(n.putTileAt(V[l],s,a,!1,"layer_2"),n.putTileAt(V[l]+1,s+1,a,!1,"layer_2"),n.putTileAt(V[l]+2,s+2,a,!1,"layer_2"),n.putTileAt(V[l]+3,s+3,a,!1,"layer_2"),n.putTileAt(V[l]+10,s,a+1,!1,"layer_2"),n.putTileAt(V[l]+10+1,s+1,a+1,!1,"layer_2"),n.putTileAt(V[l]+10+2,s+2,a+1,!1,"layer_2"),n.putTileAt(V[l]+10+3,s+3,a+1,!1,"layer_2"))}else if(l===B.EXIT){var u=V[l+"_1"];n.putTileAt(u-3,s-1,a,!1,"layer_2"),n.putTileAt(u-10-4,s-2,a-1,!1,"layer_2"),n.putTileAt(u-4,s-2,a,!1,"layer_2"),o.putTileAt(u-10-2,s-2,a-1),o.putTileAt(u-10-1,s-1,a-1),o.putTileAt(u-10,s,a-1),o.putTileAt(u-2,s-2,a),o.putTileAt(u-1,s-1,a),o.putTileAt(u,s,a),o.putTileAt(u+10-2,s-2,a+1),o.putTileAt(u+10-1,s-1,a+1),o.putTileAt(u+10,s,a+1)}}else if([B.HANGING_2,B.HANGING_3,B.HANGING_4,B.HANGING_5].includes(l)){var m=V.calculateWallTileWithNeighbours(a,s,i.config);n.putTileAt(m,s,a,!1,"layer_1"),i.config[a][s]=B.WALL;var y={x:s,y:a},p="liana_start",f=e.scene.add.sprite(48,16).setOrigin(0,.2).play(p);f.setScale(d.scaleX),f.x=n.tileToWorldX(y.x),f.y=n.tileToWorldY(y.y),f.depth=5;var v=new Gt(l,e.current);v.position=Object(Ke.a)({},y),v.alien=f,i.decorationElements["".concat(y.x,"-").concat(y.y)]=v,y.y++,p=[B.HANGING_3,B.HANGING_4,B.HANGING_5].includes(l)?"liana_middle":"liana_end",(f=e.scene.add.sprite(48,16).setOrigin(0,.2).play(p)).setScale(d.scaleX),f.x=n.tileToWorldX(y.x),f.y=n.tileToWorldY(y.y),f.depth=5,(v=new Gt(l,e.current)).position=Object(Ke.a)({},y),v.alien=f,i.decorationElements["".concat(y.x,"-").concat(y.y)]=v,[B.HANGING_3,B.HANGING_4,B.HANGING_5].includes(l)&&(y.y++,p=B.HANGING_3===l?"liana_end":"liana_middle",(f=e.scene.add.sprite(48,16).setOrigin(0,.2).play(p)).setScale(d.scaleX),f.x=n.tileToWorldX(y.x),f.y=n.tileToWorldY(y.y),f.depth=5,(v=new Gt(l,e.current)).position=Object(Ke.a)({},y),v.alien=f,i.decorationElements["".concat(y.x,"-").concat(y.y)]=v),[B.HANGING_4,B.HANGING_5].includes(l)&&(y.y++,p=B.HANGING_4===l?"liana_end":"liana_middle",(f=e.scene.add.sprite(48,16).setOrigin(0,.2).play(p)).setScale(d.scaleX),f.x=n.tileToWorldX(y.x),f.y=n.tileToWorldY(y.y),f.depth=5,(v=new Gt(l,e.current)).position=Object(Ke.a)({},y),v.alien=f,i.decorationElements["".concat(y.x,"-").concat(y.y)]=v),[B.HANGING_5].includes(l)&&(y.y++,p="liana_end",(f=e.scene.add.sprite(48,16).setOrigin(0,.2).play(p)).setScale(d.scaleX),f.x=n.tileToWorldX(y.x),f.y=n.tileToWorldY(y.y),f.depth=5,(v=new Gt(l,e.current)).position=Object(Ke.a)({},y),v.alien=f,i.decorationElements["".concat(y.x,"-").concat(y.y)]=v)}else i.bgConfig||n.putTileAt(V[B.EMPTY],s,a,!1,"layer_1")}))})),s.setBounds(0,0,d.width*d.scaleX,d.height*d.scaleY),s.zoom=1,this.underlayMap=r,this.mapZ2=o,n}}]),e}(),Bt=function(){function e(t){var i=this;Object(p.a)(this,e),this.scene=t,this.timer=0,this.worldTickFreq=x,t.events.on(c.a.Scenes.Events.UPDATE,this.onSceneUpdate.bind(this)),this.setUpCameraFollowPlayer(),t.events.off("levelcompleted"),t.events.on("levelcompleted",(function(e){t.events.emit("sounds:level_complete"),t.tweens.add({targets:i.music,volume:1,ease:"Linear",duration:500,onComplete:function(){i.music.stop()}}),t.cameras.main.fade(3e3,0,0),t.cameras.main.once("camerafadeoutcomplete",(function(){t.scene.start("LevelResumeScene",Object(Ke.a)({level:t.levels.current.constructor.key},e))}))})),t.events.removeListener("levelstart",this.onLevelStart.bind(this)),t.events.addListener("levelstart",this.onLevelStart.bind(this))}return Object(f.a)(e,[{key:"destroy",value:function(){var e;null===(e=this.music)||void 0===e||e.stop(),this.scene.events.off(c.a.Scenes.Events.UPDATE),this.scene.events.off("levelstart")}},{key:"onLevelStart",value:function(){this.scene.levels.current.id===nt.key?this.music=this.scene.sound.add("escape_music",{loop:!0,valume:0}):this.music=this.scene.sound.add("levels_surface",{loop:!0,valume:0}),this.music.play(),this.scene.tweens.add({targets:this.music,volume:1,ease:"Linear",duration:500,onComplete:function(){}})}},{key:"setUpCameraFollowPlayer",value:function(){var e=this;this.scene.events.addListener(c.a.Scenes.Events.UPDATE,(function(){var t=e.scene.cameras.main,i=e.scene.children.getByName("layer_1");if(!i)return!1;var a=i.tilemap,s=e.scene.levels.current.getPlayerPos(),n=s.x,o=s.y;if(t&&a){var r=.99,l=r*t.scrollX+(1-r)*(a.tileToWorldX(n)-.5*t.width),c=r*t.scrollY+(1-r)*(a.tileToWorldY(o)-.5*t.height);t.scrollX=Math.round(l),t.scrollY=Math.round(c)}}))}},{key:"onSceneUpdate",value:function(e,t){if(this.timer+=t,this.timer>=this.worldTickFreq){for(;this.timer>this.worldTickFreq;)this.timer-=this.worldTickFreq;this.scene.levels.current.gravityLoop()}}},{key:"calcCompletion",value:function(e,t,i,a,s,n){var o=(t+a+n+1)/(e+i+s+1);return Math.round(100*o)/100}}]),e}(),Yt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){return Object(p.a)(this,i),t.call(this,"GameScene")}return Object(f.a)(i,[{key:"create",value:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("CREATES GAME SCENE",i),this.cameras.main.setPostPipeline(Rt),this.data.set("custom_scale",w),this.game.scale.scaleMode=c.a.Scale.RESIZE,this.handleScales(),this.createAnimations(),(null===(e=this.levels)||void 0===e?void 0:e.current)&&this.levels.current.cleanLevel(),this.levels=new Wt(this,i.levelName,i.levelIndex),this.cameras.main.fadeIn(1e3,0,0,0),this.rules=new Bt(this),this.ui=new dt(this),this.events.on(c.a.Scenes.Events.SHUTDOWN,(function(){t.rules.destroy(),t.ui.destroy()}))}},{key:"handleScales",value:function(){var e=this;window.addEventListener("resize",(function(){var t;e.children.list.forEach((function(e){e.setScale(w,document.querySelector("canvas").height/11/k)})),e.ui.onResize();var i=e.children.getByName("layer_1");if(!i)return!1;null===(t=e.levels)||void 0===t||t.current.updatePositionsOnScale(),e.cameras.main.setBounds(0,0,i.width*i.scaleX,i.height*i.scaleY)}))}},{key:"createAnimations",value:function(){this.anims.create({key:"boulder_roll_right",frames:this.anims.generateFrameNumbers("boulder",{frames:[7,10,8,7]}),frameRate:16,repeat:0}),this.anims.create({key:"boulder_roll_left",frames:this.anims.generateFrameNumbers("boulder",{frames:[7,8,10,7]}),frameRate:16,repeat:0}),this.anims.create({key:"diamond_roll_right",frames:this.anims.generateFrameNumbers("boulder",{frames:[55,56,57,60,61,62,63,54]}),frameRate:32,repeat:0}),this.anims.create({key:"diamond_roll_left",frames:this.anims.generateFrameNumbers("boulder",{frames:[63,62,61,60,57,56,55,54]}),frameRate:32,repeat:0}),this.anims.create({key:"boulder_idle",frames:this.anims.generateFrameNumbers("boulder",{frames:[7]}),frameRate:1,repeat:0}),this.anims.create({key:"wall_torch_lit",frames:this.anims.generateFrameNumbers("boulder",{frames:[12,13,14,15,16,17]}),frameRate:10,repeat:0}),this.anims.create({key:"wall_torch_lighting",frames:this.anims.generateFrameNumbers("boulder",{frames:[26,27,28,29]}),frameRate:10,repeat:0}),this.anims.create({key:"wall_torch_idle",frames:this.anims.generateFrameNumbers("boulder",{frames:[25]}),frameRate:10,repeat:0}),this.anims.create({key:"barrel_idle",frames:this.anims.generateFrameNumbers("boulder",{frames:[70]}),repeat:0}),this.anims.create({key:"barrel_roll_right",frames:this.anims.generateFrameNumbers("boulder",{frames:[71,76,77,70]}),frameRate:12,repeat:0}),this.anims.create({key:"barrel_roll_left",frames:this.anims.generateFrameNumbers("boulder",{frames:[77,76,71,70]}),frameRate:12,repeat:0}),this.anims.create({key:"pillar_idle",frames:this.anims.generateFrameNumbers("boulder",{frames:[66]}),frameRate:1,repeat:0}),this.anims.create({key:"pillar_roll_right",frames:this.anims.generateFrameNumbers("boulder",{frames:[67,68,69,66]}),frameRate:12,repeat:0}),this.anims.create({key:"pillar_roll_left",frames:this.anims.generateFrameNumbers("boulder",{frames:[69,68,67,66]}),frameRate:12,repeat:0}),this.anims.create({key:"liana_start",frames:this.anims.generateFrameNumbers("boulder",{frames:[72]}),frameRate:12,repeat:0}),this.anims.create({key:"liana_middle",frames:this.anims.generateFrameNumbers("boulder",{frames:[78]}),frameRate:12,repeat:0}),this.anims.create({key:"liana_end",frames:this.anims.generateFrameNumbers("boulder",{frames:[84]}),frameRate:12,repeat:0}),this.anims.create({key:"explosion_explode",frames:this.anims.generateFrameNumbers("explosion",{frames:[0,1,2,3,4,5,6,7]}),frameRate:16,repeat:0}),this.anims.create({key:"diamond_idle",frames:this.anims.generateFrameNumbers("boulder",{frames:[54]}),frameRate:16,repeat:-1}),this.anims.create({key:"diamond_shine",frames:this.anims.generateFrameNumbers("boulder",{frames:[53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,58,59,64,65,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53]}),frameRate:16,repeat:-1}),this.anims.create({key:"mushroom_idle",frames:this.anims.generateFrameNumbers("pickables",{frames:[3]}),frameRate:1,repeat:0}),this.anims.create({key:"pickaxe_idle",frames:this.anims.generateFrameNumbers("pickables",{frames:[6]}),frameRate:1,repeat:0}),this.anims.create({key:"brave_idle",frames:this.anims.generateFrameNumbers("brave",{frames:[0,0,0,0,0,0,0,0,0,0,1,1,1,0,2,2,2,2,2,2,2,0]}),frameRate:4,repeat:-1}),this.anims.create({key:"brave_idle_pickaxe",frames:this.anims.generateFrameNumbers("brave",{frames:[32,32,32,32,32,32,32,32,32,32,33,33,33,32,34,34,34,34,34,34,34,32]}),frameRate:4,repeat:-1}),this.anims.create({key:"brave_run",frames:this.anims.generateFrameNumbers("brave",{frames:[8,9,10,11,12,13,14,15]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_run_up",frames:this.anims.generateFrameNumbers("brave",{frames:[56,57,58,59,60,61,62,63]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_run_pickaxe_up",frames:this.anims.generateFrameNumbers("brave",{frames:[56,57,58,59,60,61,62,63]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_run_down",frames:this.anims.generateFrameNumbers("brave",{frames:[64,65,66,67,68,69,70,71]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_run_pickaxe_down",frames:this.anims.generateFrameNumbers("brave",{frames:[72,73,74,75,76,77,78,79]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_run_pickaxe",frames:this.anims.generateFrameNumbers("brave",{frames:[16,17,18,19,20,21,22,23]}),frameRate:10,repeat:-1}),this.anims.create({key:"brave_break_pickaxe",frames:this.anims.generateFrameNumbers("brave",{frames:[40,41,41,42,43]}),frameRate:20,repeat:-1}),this.anims.create({key:"brave_break_pickaxe_up",frames:this.anims.generateFrameNumbers("brave",{frames:[44,45,45,46,47]}),frameRate:20,repeat:-1}),this.anims.create({key:"brave_break_pickaxe_down",frames:this.anims.generateFrameNumbers("brave",{frames:[52,53,53,54,55]}),frameRate:20,repeat:-1}),this.anims.create({key:"brave_break_pickaxe_alt",frames:this.anims.generateFrameNumbers("brave",{frames:[48,49,49,50,51]}),frameRate:20,repeat:-1}),this.anims.create({key:"brave_push",frames:this.anims.generateFrameNumbers("brave",{frames:[24,24,24,24,25,26,27]}),frameRate:16,repeat:0}),this.anims.create({key:"brave_dies",frames:this.anims.generateFrameNumbers("brave",{frames:[28,29,30,31,30,31]}),frameRate:14,repeat:0}),this.anims.create({key:"torch_idle",frames:this.anims.generateFrameNumbers("torch",{frames:[0,1,2,3]}),frameRate:10,repeat:-1}),this.anims.create({key:"torch_run",frames:this.anims.generateFrameNumbers("torch",{frames:[8,9,10,11,12,13,14,15]}),frameRate:10,repeat:-1}),this.anims.create({key:"torch_run_up",frames:this.anims.generateFrameNumbers("torch",{frames:[56,57,58,59,60,61,62,63]}),frameRate:10,repeat:-1}),this.anims.create({key:"torch_run_down",frames:this.anims.generateFrameNumbers("torch",{frames:[64,65,66,67,68,69,70,71]}),frameRate:10,repeat:-1}),this.anims.create({key:"torch_push",frames:this.anims.generateFrameNumbers("torch",{frames:[24,25,26,27,24,25,26]}),frameRate:10,repeat:-1}),this.anims.create({key:"torch_break_pickaxe",frames:this.anims.generateFrameNumbers("torch",{frames:[40,41,41,42,43]}),frameRate:20,repeat:-1}),this.anims.create({key:"bat_move",frames:this.anims.generateFrameNumbers("boulder",{frames:[18,19,20,21,22,23,24]}),frameRate:12,repeat:-1}),this.anims.create({key:"ground_breaks",frames:this.anims.generateFrameNumbers("boulder",{frames:[30,31,32,33,34,35,36,37,38,39,40]}),frameRate:12,repeat:0}),this.anims.create({key:"ground_disolves",frames:this.anims.generateFrameNumbers("boulder",{frames:[32,33,34,35,36,37,38,39,40]}),frameRate:12,repeat:0}),this.anims.create({key:"jewel_pick",frames:this.anims.generateFrameNumbers("boulder",{frames:[42,43,44,45,46,40]}),frameRate:12,repeat:0}),this.anims.create({key:"enemy_dies",frames:this.anims.generateFrameNumbers("boulder",{frames:[47,48,49,50,51,52,40]}),frameRate:12,repeat:0}),this.anims.create({key:"closeUp_Mary",frames:this.anims.generateFrameNumbers("closeUp",{frames:[0]}),repeat:0}),this.anims.create({key:"closeUp_Marduk",frames:this.anims.generateFrameNumbers("closeUp",{frames:[1]}),repeat:0}),this.anims.create({key:"closeUp_Dwarf",frames:this.anims.generateFrameNumbers("closeUp",{frames:[2]}),repeat:0}),this.anims.create({key:"closeUp_Tiamat",frames:this.anims.generateFrameNumbers("closeUp",{frames:[5]}),repeat:0}),this.anims.create({key:"closeUp_Pickaxe",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[6]}),repeat:0}),this.anims.create({key:"closeUp_Mushroom",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[8]}),repeat:0}),this.anims.create({key:"closeUp_Diamond",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[7]}),repeat:0}),this.anims.create({key:"bro_idle",frames:this.anims.generateFrameNumbers("bro",{frames:[0,0,0,0,0,0,0,1,1,1,0,2,2,2,2,2,2,2,0,0,0,1,1,1,1,1,1,0,0,0,2,2,2,0,0,1,1,1,0]}),frameRate:4,repeat:-1}),this.anims.create({key:"bro_run",frames:this.anims.generateFrameNumbers("bro",{frames:[8,9,10,11,12,13,14,15]}),frameRate:10,repeat:-1}),this.anims.create({key:"bro_run_up",frames:this.anims.generateFrameNumbers("bro",{frames:[56,57,58,59,60,61,62,63]}),frameRate:10,repeat:-1}),this.anims.create({key:"bro_run_down",frames:this.anims.generateFrameNumbers("bro",{frames:[64,65,66,67]}),frameRate:16,repeat:-1}),this.anims.create({key:"bro_laying",frames:this.anims.generateFrameNumbers("bro",{frames:[31]}),frameRate:14,repeat:0}),this.anims.create({key:"dwarf_idle",frames:this.anims.generateFrameNumbers("dwarf",{frames:[0,0,0,0,0,0,0,0,0,0,1,1,1,0,2,2,2,2,2,2,2,0]}),frameRate:4,repeat:-1}),this.anims.create({key:"dwarf_run",frames:this.anims.generateFrameNumbers("dwarf",{frames:[8,9,10,11,12,13,14,15]}),frameRate:10,repeat:-1}),this.anims.create({key:"dwarf_run_up",frames:this.anims.generateFrameNumbers("dwarf",{frames:[56,57,58,59,60,61,62,63]}),frameRate:10,repeat:-1}),this.anims.create({key:"dwarf_run_down",frames:this.anims.generateFrameNumbers("dwarf",{frames:[64,65,66,67]}),frameRate:16,repeat:-1}),this.anims.create({key:"exit_block",frames:this.anims.generateFrameNumbers("boulder",{frames:[0,1,2,3,4,5]}),frameRate:10,repeat:-1}),this.anims.create({key:"moonAltarTop",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[26]}),repeat:0}),this.anims.create({key:"moonAltarBottom",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[37]}),repeat:0}),this.anims.create({key:"sunAltarTop",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[27]}),repeat:0}),this.anims.create({key:"sunAltarBottom",frames:this.anims.generateFrameNumbers("closeUpItems",{frames:[38]}),repeat:0})}}]),i}(c.a.Scene),Xt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){return Object(p.a)(this,i),t.call(this,"ConnectorScene")}return Object(f.a)(i,[{key:"preload",value:function(){}},{key:"createAnimations",value:function(){this.anims.create({key:"closeUp_Mary",frames:this.anims.generateFrameNumbers("closeUp",{frames:[0]}),repeat:0}),this.anims.create({key:"closeUp_Marduk",frames:this.anims.generateFrameNumbers("closeUp",{frames:[1]}),repeat:0}),this.anims.create({key:"closeUp_Dwarf",frames:this.anims.generateFrameNumbers("closeUp",{frames:[2]}),repeat:0}),this.anims.create({key:"closeUp_Tiamat",frames:this.anims.generateFrameNumbers("closeUp",{frames:[3]}),repeat:0})}},{key:"getMusicFromName",value:function(e){switch(e){case"cinematic_1":return"swarf_chat_music";default:return"generic_chat_music"}}},{key:"getImageByName",value:function(e){var t,i,a,s;switch(e){default:case"cinematic_1":t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/1.5,"Tiamat"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.max(i,a),t.setScale(4*s).setScrollFactor(0);break;case"cinematic_last":t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"Tiamat"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.max(i,a),t.setScale(s).setScrollFactor(0);break;case"cinematic_last_2":t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"thechild"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.max(i,a),t.setScale(s).setScrollFactor(0)}return t}},{key:"create",value:function(e){var t=e.id,i=e.name;this.currentLevel=t,this.createAnimations();var a=this.getMusicFromName(i);this.environmentMusic=this.sound.add(a,{loop:!0}),this.environmentMusic.play(),new dt(this,!0),this.cameras.main.setPostPipeline(Rt),this.getImageByName(i).name="background_art",this["showDialogLevel_".concat(i)]()}},{key:"showDialogLevel_cinematic_escape",value:function(){var e=this;this.levels={current:{pause:function(){return!1},resume:function(){setTimeout((function(){e.environmentMusic.stop(),e.cameras.main.fade(1e3,0,0,0),e.cameras.main.once("camerafadeoutcomplete",(function(){e.scene.start("GameScene",{level:e.currentLevel+1})}))}),1e3)}}},this.events.emit("dialogue:show",{participants:["closeUp_Marduk","closeUp_Mary"],conversation:[{who:"closeUp_Marduk",text:["Do you feel it Mary?","Do you feel her presence","below?"]},{who:"closeUp_Mary",text:["I do... But what","does it mean?"]},{who:"closeUp_Marduk",text:["That I do not know... But","it does not portend well.","I have learned so much in","so little time. Mary...I","can\u2019t recognize the man","I once was. I felt","bound by obligation,","I was trapped, Mary."]},{who:"closeUp_Mary",text:["It is time, Marduk","we have to escape","from here before","Tiamat stops us"," ","go!!!"]}]})}},{key:"showDialogLevel_cinematic_last_2",value:function(){var e=this;this.levels={current:{pause:function(){e.tweens.add({targets:e.children.getByName("background_art"),alpha:0,duration:500,onComplete:function(){var t=e.getImageByName("cinematic_last_2");t.alpha=0,e.tweens.add({targets:t,alpha:1,duration:500})}})},resume:function(){setTimeout((function(){e.tweens.add({targets:e.environmentMusic,valume:0,duration:500}),e.cameras.main.fade(1e3,0,0,0),e.cameras.main.once("camerafadeoutcomplete",(function(){e.scene.start("CreditsScene")}))}),1e3)}}},this.events.emit("dialogue:show",{participants:["closeUp_Marduk","closeUp_Dwarf"],conversation:[{who:"closeUp_Dwarf",text:["That's not how things work","where I come from. Marduk,","You have been preparing","for this moment since","your life began. Do you","have the courage to","forge your own destiny?"]}]})}},{key:"showDialogLevel_cinematic_last",value:function(){var e=this;this.levels={current:{pause:function(){return!1},resume:function(){setTimeout((function(){e.showDialogLevel_cinematic_last_2()}),1e3)}}},this.events.emit("dialogue:show",{participants:["closeUp_Marduk","closeUp_Tiamat"],conversation:[{who:"closeUp_Marduk",text:["How could you do this? We","are your creations. This","is your land. How could","you lie to us!?","Why have you forsaken us?"]},{who:"closeUp_Tiamat",text:["Life is a cycle. The","catalyst comet is a part","of this cycle: I did not","lie when I said the Comet","was the source of the","earthquakes."]},{who:"closeUp_Tiamat",text:["However: I am a force of","this world. It is through","my actions that things","occur. I am bound to the","will of the comet: for","truly we are one. I am","nature: and this...is","within my nature."]},{who:"closeUp_Tiamat",text:["I may have created","everything, yet still:","there was a natural order","to life that preceded me."]},{who:"closeUp_Tiamat",text:["You are finite in your","perspective Marduk.","Death signifies new","beginnings."," ","This is Destiny."]},{who:"closeUp_Marduk",text:["Who would accept a fate","such as this? We have done","no wrong. We worship and","revere you. We are your","children! Would you","really destroy us?"]},{who:"closeUp_Tiamat",text:["The end was written","in the beginning.","Fate cannot be rewritten."]}]})}},{key:"showDialogLevel_cinematic_1",value:function(){var e=this;this.levels={current:{pause:function(){return!1},resume:function(){setTimeout((function(){e.tweens.add({targets:e.environmentMusic,volume:0,duration:500}),e.cameras.main.fade(1e3,0,0,0),e.cameras.main.once("camerafadeoutcomplete",(function(){e.scene.start("GameScene",{level:e.currentLevel+1})}))}),1e3)}}},this.events.emit("dialogue:show",{participants:["closeUp_Mary","closeUp_Marduk","closeUp_Dwarf"],conversation:[{who:"closeUp_Mary",text:["There you are! I was","worried about you!","Are you okay?"]},{who:"closeUp_Marduk",text:["- marduk has been crying -","Thank Tiamat You\u2019re here!","I made a mistake. I ate","one of the mushrooms. I","don\u2019t feel well\u2026I think I","broke my leg falling from","the surface."]},{who:"closeUp_Mary",text:["Are you going to","throw up!?","Can you stand?"]},{who:"closeUp_Marduk",text:["No\u2026.I don\u2019t think so."]},{who:"closeUp_Mary",text:["What are we going to do","with you."]},{who:"closeUp_Dwarf",text:["You know\u2026..there's","nothing wrong with being","sad or afraid. It\u2019s","nature's way of guiding","us towards a brighter","future."]},{who:"closeUp_Marduk",text:["WHAT ON EARTH IS THAT!?","Don\u2019t patronize me foul","beast."]},{who:"closeUp_Mary",text:["You really need to learn","when to shut your mouth.","Marduk. You have become","rude & foul tempered."]},{who:"closeUp_Dwarf",text:["I mean he\u2019s right.","I am a monster.","I'm... different."]},{who:"closeUp_Mary",text:["You don\u2019t seem like","a monster to me."]},{who:"closeUp_Dwarf",text:["That\u2019s because we're","going to make a deal"]},{who:"closeUp_Marduk",text:["I don\u2019t make deals with...","your kind..."]},{who:"closeUp_Dwarf",text:["But You Will...in time...","things change. People grow.","Even you Marduk. I think","we could be great friends.","In Fact. It Is Prophecy"]}]})}}]),i}(c.a.Scene),Vt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){return Object(p.a)(this,i),t.call(this,"CreditsScene")}return Object(f.a)(i,[{key:"create",value:function(){this.normalDayMusic=this.sound.add("opening_peace",{loop:!0}),this.normalDayMusic.play(),this.cameras.main.setPostPipeline(Rt);var e=this.add.image(this.cameras.main.width/2,this.cameras.main.height/2,"theworld"),t=this.cameras.main.width/e.width,i=this.cameras.main.height/e.height,a=Math.max(t,i);e.setScale(a).setScrollFactor(0),e.name="background_art",e.alpha=0,this.tweens.add({targets:e,alpha:1,duration:5e3}),this.add.text(80,10,"THE END",{fontFamily:"GameGirl",fontSize:"10px",fill:"#ffffff"}).setScale(2*t).setPosition(2*t,this.cameras.main.height-80*i).setShadow(-1,1).displayHeight=10*i,this.add.text(80,10,"Thanks for playing",{fontFamily:"GameGirl",fontSize:"10px",fill:"#ffffff"}).setScale(.9*t).setPosition(2*t,this.cameras.main.height-30*i).setShadow(-1,1).displayHeight=10*i}}]),i}(c.a.Scene),Kt=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(){return Object(p.a)(this,i),t.call(this,"ConfirmNewGameScene")}return Object(f.a)(i,[{key:"preload",value:function(){}},{key:"navigateToScene",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.cameras.main.fade(500,0,0,0),this.tweens.add({targets:wt,volume:0,ease:"Linear",duration:500,onComplete:function(){wt.pause(),t.scene.start(e,i)}})}},{key:"create",value:function(){var e=this;this.cameras.main.setPostPipeline(Rt),this.cameras.main.setBackgroundColor("#486859");var t=this.add.image(this.cameras.main.width/2,this.cameras.main.height/3,"Bossfight"),i=this.cameras.main.width/t.width,a=this.cameras.main.height/t.height,s=Math.max(i,a);t.setScale(1.5*s).setScrollFactor(0),t.name="background_art",wt=this.sound.add("credits",{loop:!0}),window.WebFont.load({custom:{families:["GameGirl"]},active:function(){e.cameras.main.fadeIn(500,0,0,0),e.events.emit("scene_ready",e.sys.config),wt=e.sound.add("credits",{loop:!0}),e.input.keyboard.off("keydown"),e.input.keyboard.on("keydown",(function(t){"Escape"===t.key&&e.navigateToScene("LandingScene")})),new ct(e).showConfirmNewGameMenu()}})}}]),i}(c.a.Scene),Jt=i(18),Qt=i(34),qt=function(){var e=Object(a.useContext)(m),t=e.game,i=e.scene,s=e.sceneProps,n=Object(a.useState)({}),o=Object(r.a)(n,2),l=o[0],h=o[1];return Object(a.useLayoutEffect)((function(){i&&h(function(e,t){return e.scene.scenes.forEach((function(e){e.events.off(c.a.Scenes.Events.READY),e.events.once(c.a.Scenes.Events.READY,(function(){e.events.off(c.a.Scenes.Events.RENDER),e.events.once(c.a.Scenes.Events.RENDER,(function(){h(Object(Ke.a)(Object(Ke.a)({},e),{},{camera:e.cameras.main,cameras:e.cameras,scene:e}))}))}))})),{game:e,scene:t,sceneProps:s,camera:t.cameras.main,cameras:t.cameras,scenes:e.scene.scenes,scenesManager:e.scene}}(t,i))}),[t,i]),l},zt=Object(a.forwardRef)((function(e,t){var i=e.args,s=e.type,n=void 0===s?"Shape":s,o=e.addedToScene,r=void 0===o?function(){}:o,l=e.addedToSceneForParent,u=void 0===l?function(){}:l,m=e.children,y=(e.dataParentRef,Object(Jt.a)(e,["args","type","addedToScene","addedToSceneForParent","children","dataParentRef"])),p=qt().scene,f=Object(a.useRef)(),v=Object(a.useRef)(),_=t||f,g=Object(a.useCallback)((function(e,t){Object.keys(t).forEach((function(i){((null===e||void 0===e?void 0:e.hasOwnProperty(i))||(null===e||void 0===e?void 0:e.__proto__.hasOwnProperty(i)))&&("function"===typeof e[i]?e[i](t[i]):e[i]=t[i])}))}),[y]);return Object(a.useLayoutEffect)((function(){return g(_.current,y)}),[y]),Object(a.useEffect)((function(){if(p){var e=Object(Qt.a)(c.a.GameObjects[n],[p].concat(Object(h.a)(i)));_.current=e,e.once(c.a.GameObjects.Events.ADDED_TO_SCENE,(function(){r(e),u(e),g(e,y)})),v.current=setTimeout((function(){p.add.existing(e)}))}return function(){var e;null===_||void 0===_||null===(e=_.current)||void 0===e||e.destroy()}}),[p]),Object(a.useEffect)((function(){return function(){clearTimeout(v.current)}}),[]),Object(d.jsx)(d.Fragment,{children:m})}));zt.displayName="GameObject";var Zt=zt,$t=Object(a.forwardRef)((function(e,t){var i,s,n,o,r=e.args,l=e.children,c=Object(Jt.a)(e,["args","children"]),h=Object(a.useRef)(),u=t||h;return Object(a.useEffect)((function(){var e;"string"===typeof l&&(null===(e=u.current)||void 0===e||e.setText(l))}),[l]),Object(d.jsx)(Zt,Object(Ke.a)({ref:u,type:"Text",args:[null!==(i=null===r||void 0===r?void 0:r[0])&&void 0!==i?i:c.x,null!==(s=null===r||void 0===r?void 0:r[1])&&void 0!==s?s:c.y,"string"===typeof l?l:null!==(n=null===r||void 0===r?void 0:r[2])&&void 0!==n?n:"",null!==(o=null===r||void 0===r?void 0:r[3])&&void 0!==o?o:c.style]},c))}));$t.displayName="Text";var ei=$t,ti=Object(a.forwardRef)((function(e,t){var i=e.args,s=void 0===i?[0,0]:i,n=(e.addedToScene,e.children),o=Object(Jt.a)(e,["args","addedToScene","children"]),r=Object(a.useRef)(),l=t||r,c=function(e){l.current.add(e)};return Object(d.jsx)(Zt,Object(Ke.a)(Object(Ke.a)({ref:l,type:"Container",args:s},o),{},{children:function e(t){return a.Children.toArray(t).map((function(t){return String(t.type).includes("react.fragment")?Object(a.cloneElement)(t,{children:e(t.props.children)}):Object(a.cloneElement)(t,{addedToSceneForParent:c})}))}(n)}))}));ti.displayName="Container";var ii=ti,ai=Object(a.forwardRef)((function(e,t){var i=e.args,s=(e.children,Object(Jt.a)(e,["args","children"])),n=Object(a.useRef)(),o=t||n;return Object(d.jsx)(Zt,Object(Ke.a)({ref:o,type:"Sprite",args:i},s))}));ai.displayName="Sprite";var si=ai,ni=function(){var e=qt(),t=e.game,i=e.scene,s=e.sceneProps,n=Object(a.useState)(0),o=Object(r.a)(n,2),l=o[0],c=o[1],h=Object(a.useState)(0),u=Object(r.a)(h,2),m=u[0],y=u[1],p=Object(a.useState)([ne("menu.main.score_op_next"),ne("menu.main.score_op_repeat"),ne("menu.main.score_op_exit")]),f=Object(r.a)(p,1)[0],v=Object(a.useRef)(),_=Object(a.useRef)(),g=Object(a.useCallback)((function(e){if("Escape"===e.key&&t.scene.start("LandingScene"),"ArrowDown"===e.key&&l<f.length-1&&c((function(e){return e+1})),"ArrowUp"===e.key&&l>0&&c((function(e){return e-1})),"Enter"===e.key)switch(l){default:case 0:i.scene.start("GameScene",{levelName:Ft(null===s||void 0===s?void 0:s.level)});break;case 1:i.scene.start("GameScene",{levelName:null===s||void 0===s?void 0:s.level});break;case 2:i.scene.start("MenuScene")}}),[t,i,l,f,s]);Object(a.useEffect)((function(){return null===i||void 0===i||i.input.keyboard.addListener("keydown",g),function(){return null===i||void 0===i?void 0:i.input.keyboard.removeListener("keydown",g)}}),[i,g]),Object(a.useEffect)((function(){_.current=i,null===i||void 0===i||i.anims.create({key:"arrow_menu",frames:i.anims.generateFrameNumbers("hud",{frames:[30]}),repeat:0})}),[i]),Object(a.useEffect)((function(){return m<5&&(v.current=setTimeout((function(){return y((function(e){return e+1}))}),800)),function(){return clearTimeout(v.current)}}),[m]),Object(a.useEffect)((function(){return function(){clearTimeout(v.current),_.current.input.keyboard.off("keydown")}}),[]);var E=function(e){e.displayHeight=10*w,e.depth=16,e.name="header_text",e.setScale(w),e.setScrollFactor(0),e.setShadow(-1,1)},O={fontFamily:"Emulogic",fontSize:"8px",fill:"#aee0c8",fontWeight:"regular"},S=dt.tileToScreen(1),T=dt.tileToScreen(5),A=dt.tileToScreen(1),b=dt.tileToScreen(.75),x=dt.tileToScreen(7);return Object(d.jsxs)(ii,{x:T,y:S,children:[Object(d.jsx)(ei,{x:A,y:0,setStyle:O,addedToScene:E,children:"KI - ".concat(ne("menu.main.chamber")," ").concat(null===s||void 0===s?void 0:s.level.replace("level_","")," -")}),m>0&&Object(d.jsxs)(a.Fragment,{children:[Object(d.jsx)(ei,{x:A,y:2*b,setStyle:O,alpha:(null===s||void 0===s?void 0:s.collectedDiamonds)<(null===s||void 0===s?void 0:s.countDiamonds)?.8:1,addedToScene:E,children:ne("menu.main.score_gems")}),Object(d.jsx)(ei,{x:A+dt.tileToScreen(6),y:2*b,setStyle:O,alpha:(null===s||void 0===s?void 0:s.collectedDiamonds)<(null===s||void 0===s?void 0:s.countDiamonds)?.8:1,addedToScene:E,children:jt(null===s||void 0===s?void 0:s.collectedDiamonds,null===s||void 0===s?void 0:s.countDiamonds)})]},"gems_score"),m>1&&Object(d.jsxs)(a.Fragment,{children:[Object(d.jsx)(ei,{x:A,y:3*b,setStyle:O,alpha:(null===s||void 0===s?void 0:s.killedEnemies)<(null===s||void 0===s?void 0:s.countEnemies)?.8:1,addedToScene:E,children:ne("menu.main.score_enemies")}),Object(d.jsx)(ei,{x:A+dt.tileToScreen(6),y:3*b,setStyle:O,alpha:(null===s||void 0===s?void 0:s.killedEnemies)<(null===s||void 0===s?void 0:s.countEnemies)?.8:1,addedToScene:E,children:jt(null===s||void 0===s?void 0:s.killedEnemies,null===s||void 0===s?void 0:s.countEnemies)})]},"enemies_score"),m>2&&Object(d.jsxs)(a.Fragment,{children:[Object(d.jsx)(ei,{x:A,y:4*b,setStyle:O,alpha:(null===s||void 0===s?void 0:s.collectedShrooms)<(null===s||void 0===s?void 0:s.countShrooms)?.8:1,addedToScene:E,children:ne("menu.main.score_shrooms")}),Object(d.jsx)(ei,{x:A+dt.tileToScreen(6),y:4*b,setStyle:O,alpha:(null===s||void 0===s?void 0:s.collectedShrooms)<(null===s||void 0===s?void 0:s.countShrooms)?.8:1,addedToScene:E,children:jt(null===s||void 0===s?void 0:s.collectedShrooms,null===s||void 0===s?void 0:s.countShrooms)})]},"shrooms_score"),Object(d.jsx)(ei,{x:A,y:4.75*b,setStyle:O,addedToScene:E,children:"--------------------"}),m>3&&Object(d.jsxs)(a.Fragment,{children:[Object(d.jsx)(ei,{x:A,y:5.5*b,setStyle:O,alpha:(null===s||void 0===s?void 0:s.comp)<=(null===s||void 0===s?void 0:s.prevBest)?.8:1,addedToScene:E,children:ne("menu.main.score_comp")}),Object(d.jsx)(ei,{x:A+dt.tileToScreen(6),y:5.5*b,setStyle:O,alpha:(null===s||void 0===s?void 0:s.comp)<=(null===s||void 0===s?void 0:s.prevBest)?.8:1,addedToScene:E,children:Pt(null===s||void 0===s?void 0:s.comp)})]},"total_score"),m>4&&Object(d.jsxs)(a.Fragment,{children:[Object(d.jsx)(ei,{x:A,y:6.5*b,setStyle:Object(Ke.a)(Object(Ke.a)({},O),{},{fill:(null===s||void 0===s?void 0:s.prevBest)>=(null===s||void 0===s?void 0:s.comp)?"#aee0c8":"#ffd700"}),addedToScene:E,children:ne("menu.main.score_best")}),Object(d.jsx)(ei,{x:A+dt.tileToScreen(6),y:6.5*b,setStyle:Object(Ke.a)(Object(Ke.a)({},O),{},{fill:(null===s||void 0===s?void 0:s.prevBest)>=(null===s||void 0===s?void 0:s.comp)?"#aee0c8":"#ffd700"}),addedToScene:E,children:Pt(Math.max(null===s||void 0===s?void 0:s.prevBest,null===s||void 0===s?void 0:s.comp))})]},"best_score"),f.map((function(e,t){return Object(d.jsxs)(a.Fragment,{children:[l===t&&Object(d.jsx)(si,{args:[100,100,"arrow"],x:A-dt.tileToScreen(1.3),y:x+b*t+dt.tileToScreen(.15),addedToScene:function(e){return e.play("arrow_menu").setRotation(-Math.PI/2).setScale(w).setOrigin(.5,0)}}),Object(d.jsx)(ei,{alpha:l===t?1:.5,args:[A,x+b*t,e,{fontFamily:"Emulogic",fontSize:"8px",fill:"#aee0c8",fontWeight:"regular"}],addedToScene:E})]},"row_".concat(t))}))]})},oi={preload:function(){this.load.spritesheet("hud","/lostcartridgejam3Game/assets/tilemaps/hud_tilemap_20x20.png",{frameWidth:20,frameHeight:20,margin:1,sapcing:2})},create:function(){this.cameras.main.setPostPipeline(Rt)}},ri=function(e){Object(v.a)(i,e);var t=Object(_.a)(i);function i(e){var a;return Object(p.a)(this,i),(a=t.call(this,{game:e,fragShader:"\nprecision mediump float;\n\nuniform sampler2D uMainSampler[%count%];\nuniform float gray;\n\nvarying vec2 outTexCoord;\nvarying float outTexId;\nvarying vec4 outTint;\nvarying vec2 fragCoord;\n\nvoid main()\n{\n    vec4 texture;\n\n    %forloop%\n\n    gl_FragColor = texture;\n    gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126 * gl_FragColor.r + 0.7152 * gl_FragColor.g + 0.0722 * gl_FragColor.b), gray);\n}\n",uniforms:["uProjectionMatrix","uMainSampler","gray"]}))._gray=0,a}return Object(f.a)(i,[{key:"onPreRender",value:function(){this.set1f("gray",this._gray)}},{key:"gray",get:function(){return this._gray},set:function(e){this._gray=e}}]),i}(c.a.Renderer.WebGL.Pipelines.MultiPipeline),li=i(36),ci=i(37),hi=function(e){var t=e.name,i=e.children,s=Object(a.useState)(!1),n=Object(r.a)(s,2),o=n[0],l=n[1],c=qt(),h=c.game,u=c.scene;return Object(a.useEffect)((function(){(null===h||void 0===h?void 0:h.scene.isActive(t))&&u&&l(!0)}),[h,t,u]),o?i:null},ui={width:"100%",height:"100%",type:c.a.WEBGL,scale:{mode:c.a.Scale.RESIZE,autoCenter:c.a.Scale.CENTER_BOTH},backgroundColor:"#000000",disableContextMenu:!0,pixelArt:!0,roundPixels:!1,scene:[It,Dt,Mt,Yt,Xt,Vt,Kt],pipeline:{CRTFilter:Rt,Gray:ri,GrayAlt:ri},plugins:{global:[{key:"rexFade",plugin:li.a,start:!0},{key:"rexFlash",plugin:ci.a,start:!0}]}};var di=function(){var e=Object(a.useState)(),t=Object(r.a)(e,2),i=t[0],s=t[1];return Object(a.useEffect)((function(){oe((function(){return s(!0)}))}),[]),i?Object(d.jsx)(T,{args:ui,children:Object(d.jsx)(hi,{name:"LevelResumeScene",args:oi,children:Object(d.jsx)(ni,{})})}):null},mi=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,53)).then((function(t){var i=t.getCLS,a=t.getFID,s=t.getFCP,n=t.getLCP,o=t.getTTFB;i(e),a(e),s(e),n(e),o(e)}))},yi=i(35);o.a.render(Object(d.jsxs)(s.a.StrictMode,{children:[Object(d.jsx)(di,{}),Object(d.jsxs)("div",{style:{position:"absolute",bottom:0,right:0,fontSize:10,color:"gray"},children:["v",yi.version]})]}),document.getElementById("root")),mi()}},[[52,1,2]]]);
//# sourceMappingURL=main.020e7ed8.chunk.js.map