{"version":3,"sources":["utils/dbManager.js","libs/react-phaser-fiber/PhaserProvider.js","libs/react-phaser-fiber/components/RPFScene.js","libs/react-phaser-fiber/components/Canvas.js","utils/constants.js","utils/localization.js","components/objects/BaseObject.js","components/objects/GameObject.js","components/objects/Empty.js","components/objects/Explosion.js","components/objects/Destroyable.js","components/objects/Moveable.js","components/objects/Fallable.js","components/objects/Boulder.js","components/objects/Debris.js","components/objects/Pillar.js","components/levels/levelBase.js","components/levels/level_test.js","components/levels/level_2.js","components/levels/level_3.js","components/levels/level_4.js","components/levels/level_5.js","components/levels/level_6.js","components/levels/level_7.js","components/levels/level_8.js","components/levels/level_9.js","components/levels/level_10.js","components/levels/level_11.js","components/levels/level_12.js","components/levels/level_13.js","components/levels/level_14.js","components/levels/level_15.js","components/levels/level_16.js","components/levels/level_17.js","components/levels/level_finale.js","components/levels/Maze_1.js","components/DialogArrow/index.js","components/UIMenus.js","components/DialogOptions/index.js","components/Dialogs/index.js","components/UI.js","components/objects/Ground.js","components/objects/Character.js","components/objects/Jewel.js","components/objects/Enemy.js","components/objects/NPCharacter.js","components/objects/Player.js","components/objects/Wall.js","components/objects/Interactive.js","components/objects/Exit.js","components/objects/Barrel.js","components/objects/Mushroom.js","components/objects/Torch.js","components/levels/level_1.js","scenes/LandingScene.js","scenes/MenuScene.js","scenes/ConfirmNewGameScene.js","utils/CRTShaderFX.js","scenes/IntroScene.js","utils/helpers.js","components/objects/Deco.js","components/LevelManager.js","components/Rules.js","scenes/GameScene.js","scenes/ConnectorScene.js","scenes/CreditsScene.js","libs/react-phaser-fiber/hooks/usePhaser.js","libs/react-phaser-fiber/components/GameObject.js","libs/react-phaser-fiber/components/Text.js","libs/react-phaser-fiber/components/Container.js","libs/react-phaser-fiber/components/Sprite.js","scenes/LevelResumeScene/LevelResumeMenu.js","scenes/LevelResumeScene/config.js","utils/GrayScalePipeline.js","libs/react-phaser-fiber/components/Scene.js","Game.js","reportWebVitals.js","index.js"],"names":["DB_NAME","DB_INITIAL_STATE","totalShroomsAmount","tripDone","memDB","bootUp","stored","window","localStorage","getItem","JSON","parse","persist","setItem","stringify","get","key","eval","set","value","safeSet","reset","getLevels","Object","keys","map","k","includes","filter","Boolean","context","createContext","PhaserProvider","game","scene","sceneProps","children","useState","ready","setReady","useEffect","Provider","RPFScene","name","args","onCreate","config","this","preload","bind","data","create","Phaser","Scene","Canvas","forwardRef","canvasRef","fallbackRef","useRef","ref","setGame","activeScene","setActiveScene","scenes","React","Children","ch","props","callbacks","postBoot","forEach","sc","events","off","Scenes","Events","READY","once","RENDER","WAKE","UPDATE","TRANSITION_WAKE","TRANSITION_START","TRANSITION_OUT","TRANSITION_INIT","TRANSITION_COMPLETE","START","SLEEP","SHUTDOWN","RESUME","PRE_RENDER","PAUSE","on","CREATE","state","BOOT","Game","current","activeChildren","toArray","find","getScene","values","displayName","TICK_TIME","TILE_SIZE","SCALE","devicePixelRatio","document","querySelector","width","toString","PIXEL_NAME_BG","PIXEL_NAME","EMPTY","PLAYER","GROUND","BOULDER","PILLAR","WALL","ENEMY","JEWEL","BARREL","EXPLOSION","INTERACTION","MUSHROOM","BRO","DWARF","EXIT","ART","ART2","HANGING_2","HANGING_3","HANGING_4","HANGING_5","DEBRIS","BLOCK","TORCH","DIRS","DOWN","UP","LEFT","RIGHT","BG_PIXEL_TO_TILEMAP_POSITION","PIXEL_TO_TILEMAP_POSITION","x","y","W","N","E","S","getDictionary","lang","dictionary_en","dictionary_es","translationGetters","en","es","translate","memoize","i18n","t","setI18nConfig","callback","a","locale","navigator","language","substring","languageTag","dictionary","translations","BaseObject","eventListeners","classes","proto","__proto__","undefined","constructor","className","push","givenClass","length","listClasses","eventName","listener","l","payload","GameObject","id","isRigid","isBreakable","isFlat","isPickable","isCrushable","level","power","strength","force","weight","position","alien","isMoveable","coords","Empty","isEmpty","Explosion","layer","getByName","tilemap","explosion","add","sprite","setOrigin","play","setScale","scaleX","tileToWorldX","tileToWorldY","Animations","ANIMATION_COMPLETE","destroy","replaceByEmpty","onNextTick","lvl","objects","Destroyable","inactive","el","onDestroyElement","Moveable","Fallable","isFalling","nextPos","destinationElement","isDestinationInBounds","getObjectAt","destinationIsEmpty","isDestinationEmpty","destinationIsCrushable","destinationInBounds","pathElement","pathClear","objectIsEmpty","restingElement","canRest","canFallDown","canRollTo","Boulder","isClass","visible","Debris","putTileAt","break_effect","depth","UI","tileToScreen","setFlipY","Pillar","Level","moveables","parallelMovables","interactiveElements","decorationElements","player","playerTimeoutId","timeoutIds","focusElement","isPaused","queuedActions","countDiamonds","collectedDiamonds","countEnemies","killedEnemies","countShrooms","collectedShrooms","prevBest","preventDisplayDiamondsGoalAmount","unfinished","tickId","toRun","cb","phaserScene","pick_effect","enemy_die_effect","intOrder","r","c","element","Wall","setPosition","Torch","order","Ground","boulder","pillar","diamond","Jewel","move","dbManager","mushroom","Mushroom","barrel","Barrel","isMoving","Player","animIdle","follower","isFollowing","NPCharacter","leader","isLeading","enemy","Enemy","intElement","Exit","Interactive","onAddElement","exit","addedToScene","dbData","comp","console","log","diamondsGoal","block","exitBlock","setTimeout","emit","idx","findIndex","e","splice","inParallelGravity","barrels","explode","parallelWorld","runScheduledActions","explodeLoop","o","sort","b","canFallLeft","canFallRight","moveObject","objectBelow","goBackToMainGravity","enemiesLoop","neighbour","newAnchor","nextDir","backToTrackDir","nextAnchorPos","helperDirCalc","anchorPosition","moveIntentDir","scanDirection","loop","clearTimeout","canMoveUp","canMoveDown","canMoveLeft","canPushLeft","pushLeft","canMoveRight","canPushRight","pushRight","animRunRight","animRunLeft","followerNextPos","isInteractivePosition","overrunBy","anims","currentAnim","isCloseEnough","playerLoop","pos","origin","isSwitch","runningOver","setObjectAt","Character","tweens","targets","duration","animRun","delay","onComplete","gravityLoop","pushingDirection","base","shine","stop","levels","restart","destroyBlock","emptyPlace","row","pause","levelData","rules","calcCompletion","Math","max","newLevelData","storedData","ephemeral","warn","found","i","j","obj","xInBounds","yInBounds","range","intensity","disconnect","shakeCamera","probability","destroyObjectsInRange","reconnect","y1","y2","x1","x2","toDestroy","random","camera","cameras","main","fx","sound","shake","Promise","res","mv","ticks","tickDelayToTrigger","onTick","amountOfTicks","setTickTimeout","alpha","awaitTicks","LevelTest","input","keyboard","addListener","onKeyUp","event","showDialog1","showDialog2","showDialog3","showDialog4","participants","participantNames","conversation","who","text","options","hasPickaxe","LevelBase","Level2","light_beam","image","height","setScrollFactor","emitter","particles","createEmitter","min","tileToPixels","setQuantity","setFrequency","setAngle","setSpeed","setGravityY","setGravityX","setLifespan","onChange","Level3","spot","pickaxe","enemiesCount","Level4","countDownAfterQuakeUntilMessage","playEarthquake","onPlayerMoves","removeListener","onPlayerMove","Level5","enemiesDeadCount","dist","Distance","Snake","setAlpha","forEachTile","tile","leadingPath","dwarfRun","encounter","moveDwarf","Level6","diamondIdTriggerDwarfMove","interactiveTileCloseToExit","teleportObject","pageId","moveDwarfToExit","template","NUM","Level7","Level8","dwarf","broSprite","grayscalePipeline","tripMusic","firstVisit","tookTheTrip","renderer","pipelines","setPipeline","valume","showDialog1NoShroom","showDialog1Revisit","slot0","label","slot","onSelect","slot1","slot2","slot3","playTheTrip","animFadeOutLevel","moveCamera","animPlayerAndDwarf","animBroEntrance","vanishBro","animDwarfMoveCloseToPlayer","vanishDwarf","animFadeInLevel","restoreRegularGamePlay","ease","music","volume","gray","completeDelay","onUpdate","tween","target","setLevelAlpha","layer_1","layer_1z2","layer_2","layer_0","level_background_art","Level9","Level10","easystar","EasyStar","js","objectsAsKeys","setGrid","setAcceptableTiles","findPath","path","slice","calculate","clearPath","Level11","testProximity","enableDiagonals","reduce","src","prevEl","n","Level12","Level13","interactiveCounts","quakeTriggerIndex","trunc","playerOriginPosition","Level14","Level15","Level16","wasInSanctuary","maryTalkedToDocAboutTheSactuary","quakeTrigger","fontFamily","fill","align","animLayRight","removeDebris","debris","removeGround","ground","goToSanctuary","playTheSighting","showDialog2_repeat","sanctuaryEntrance","layer1z2","copy","animPushRight","goalAchieved","moveToExit","goalAchievedConversation","goalMissingConversation","playerRun","moveToNextPosition","movePlayer","mandatoryPath","reverse","moveDocToFinalExit","Level17","quakePlayed","lights","enable","setAmbientColor","staticlight","addLight","setColor","setIntensity","time","addEvent","active","Geom","Ellipse","Random","callbackScope","repeat","m","updateLight","detectDocTeleporting","light","setRadius","eyeAnimation","exitEye","remove","yoyo","showDialogGoal","ligthTorch","setTintFill","ignite","GOAL","LevelFinale","winningLoopRef","winningLoop","voidLevel","startVoid","voidLoop","autoDestroyTID","destroyMap","resetAutoVoidTimer","die","onCharacterDie","nextMoveDir","LevelMaze1","solvingPath","isMaze","buyLeadingWithShrooms","shouldRestart","personalSpace","showDialog1_no_shrooms","checkProgress","threePositionsBackInPath","at","setUpLeader","Arrow","make","tileWidth","tileHeight","tileset","addTilesetImage","createBlankLayer","getArrow","rotation","PI","UIMenus","ROW_HEIGHT","MARGIN_LEFT","MARGIN_TOP","optionsByPage","scrollIndex","isVisible","menuOptions","disabled","selectable","navigateToScene","drawSelectableOptions","Level1","_","toLocaleString","minimumIntegerDigits","_gems","lKey","DB","_threats","_shrooms","_comp","perc","minimumFractionDigits","maximumFractionDigits","levelName","padEnd","header","start","initOption","offsetX","offsetY","maxRows","FIRST_SELECTABLE_OPTION","currentOption","haveMorePages","isNaN","currentPage","floor","currentIndex","INIT_POS","pixelToScreen","ARROW_WIDTH","OFFSET_X","arrow","getArrowRight","tilemapLayer","arrowUp","getArrowUp","setVisible","arrowDown","getArrowDown","split","Array","join","lines","round","txt","fontSize","fontWeight","displayHeight","setShadow","drawOptionsPage","reducedOptions","newIndex","prevSelectedOpt","nextSelectedOpt","from","list","textToPrint","DialogOptions","menuOptionsContainer","keyDownHandler","container","currentSlot","firstNonEmptySlotKey","drawOption","textObj","lineSpacing","displayWidth","setSize","setArrowPositionBySlot","newSlotIdx","selectedOption","ARROW_OFFSET_X","ARROW_OFFSET_Y","Dialogs","tnContainer","participantSprites","currentDialogIndex","isShowing","isFullTextDisplayed","dialogOptions","showDialog","handleKeyDown","updateCharacterName","tIDs","p","clearText","unmount","layers","prepareHUD","prepareText","mount","showMessage","onlyOnePageOption","moreThanOnePageOption","defaultPageOption","lastPageOption","show","message","hide","writeText","clearTint","setTint","tn","charName","setFlipX","drawWindow","w","h","setText","charPlaceholder","paragraphs","line","paragraphWords","shift","prevLine","nextWord","trim","unshift","timerId","letters","fastForward","putLetter","len","char","fullTextDisplayed","TILES","TOP_LEFT","TOP_MIDDLE","TOP_RIGHT","MIDDLE","BOTTOM_LEFT","BOTTOM_MIDDLE","BOTTOM_RIGHT","noScores","inGameMenu","setUpPuseResumeGame","mushroomsIcon","diamondsIcon","showPauseMenu","hidePauseMenu","rockHit","rockSlideHard","rockSlideSoft","rockHitSoft","gemHit","shroomPick","gemPick","coinPick","clearHit","deathByRockHit","levelComplete","drawScores","dialogs","skipAmount","hideDialog","resume","mushroomsScore","diamondsScore","diamondsScoreGoal","shroomsAmount","MT_MARGIN_RIGHT","D_MARGIN_LEFT","DT_MARGIN_RIGHT","test","diamondsAmount","scoreTileset","scoresLayer","msh","String","setData","scale","howMany","amount","getData","Number","targetPosX","showInGameMenu","existingLayer","drawMenuOptions","onKeyDown","connected","val","calculateGroundTileWithNeighbours","canBrakeNeighbour","canWalkThrough","isBrakingGround","DIR","canMove","nothingBesides","isPositionClear","isAboutToFall","canPush","pushed","animPushLeft","jumpIntoParallelGravity","targetPos","proximity","onlyRightAngles","topLimit","bottomLimit","leftLimit","rightLimit","retVal","isInArea","isInRightAngle","onJewelPick","line1","debug","directionLine","setRotation","anchorLine","onEnemyKill","flipX","calcMoveIntentForLeader","xDist","abs","yDist","animRunVariant","animName","torch","ligth","calcMoveIntent","canMoveDir","dirVariant","pickaxeVariant","actionVariant","setupLight","onInteractWith","reach","objectsToDestroyByExplostion","tint","burntEl","burntWillBreak","explosionPlaceholder","onExplode","onMushroomPick","isLit","leftTrigger","rightTrigger","setUpLights","setIgniteTriggers","leftNeighbour","rightNeighbour","onInteract","titlesMusic","BlurPostFX","renderTarget","fragShader","uniforms","set2f","set1f","Renderer","WebGL","Pipelines","PostFXPipeline","LandingScene","load","script","process","spritesheet","frameWidth","frameHeight","audio","sceneId","fade","setPostPipeline","CRTFilter","setBackgroundColor","scaleY","WebFont","custom","families","fadeIn","sys","showInitialMenu","MenuScene","showMainMenu","IntroScene","images","tiamat","sky","clouds","storm","ground_high","ground_break","comet","people_climbing","people_paying","people_paying_high","people_descending","people_falling","people_jumping","texts","line2","line3","level_title","sounds","background_music","dramatic_music","earthquake","frames","generateFrameNumbers","createTextLine","_shadow","lineNumber","LINE_HEIGHT","LINE_REF","LINE_REF_FACTOR","XPOS","YPOS","lineShadow","style","_setText","createFullscreenImage","hold","DELAY_TO_START","animPage","_shoadow","createAnimations","createSounds","createImages","createTextPlaceholders","playMusic","animEnterTiamat","animPage1","animEnterWorld","animPage2","animEnterPeople","animPage3","showFirstDialogs","animExitTiamat","animGroundTransition","showSecondDialogs","playDramaticMusic","animStormEnter","animEarthquake","animEnterFalling","animPage4","animPage5","animEnterJumping","exitMusic","animLevelTitle","quakesMusic","pan","Cameras","Scene2D","PAN_COMPLETE","textureToMapConfig","textures","getSourceImage","levelConfig","pixColor","getPixel","Display","Color","ComponentToHex","g","formatScore","total","formatComp","Deco","LEVELS","Maze1","getNextLevel","levelKey","nextLevel","LevelManager","currentLevelName","currentName","generateConfig","mapConfig","bgConfig","createMap","createBackground","connectToScene","ui","levelId","mazegenerator","pow","cell","top","right","bottom","left","STARTING_ROW","rowIdx","isNotTopBufferSpace","pop","threeEmptyInARow","every","buildWallsAroundGate","mapZ2","underlayMap","tilesetGates","tilesetZ2","underlaytileset","layer2","layerZ2","underlayer","bgTile","calculateWallTileWithNeighbours","isFlipX","POSITION_EXIT","tileKind","nextSprite","hanging","setBounds","zoom","Rules","timer","worldTickFreq","onSceneUpdate","setUpCameraFollowPlayer","result","onLevelStart","cam","getPlayerPos","smoothFactor","scrollX","scrollY","delta","gems","collectedGems","enemies","shrooms","colectedShrooms","GameScene","scaleMode","Scale","RESIZE","handleScales","cleanLevel","levelIndex","addEventListener","onResize","updatePositionsOnScale","frameRate","ConnectorScene","currentLevel","musicName","getMusicFromName","environmentMusic","getImageByName","img","showDialogLevel_cinematic_last_2","normalDayMusic","ConfirmNewGameScene","showConfirmNewGameMenu","usePhaser","useContext","setState","useLayoutEffect","s","scenesManager","getState","externalRef","type","addedToSceneForParent","dataParentRef","localRef","tId","applyProps","useCallback","_this","hasOwnProperty","GameObjects","ADDED_TO_SCENE","existing","Text","Container","onObjectAddedToScene","extractPhaserChildren","_children","cloneElement","Sprite","OptionsScene","selIndex","setSelIndex","showRowScore","setShowRowScore","refScene","v","formatFont","fontStyle","CONTAINER_TOP","CONTAINER_LEFT","MENU_OPTIONS_TOP","setStyle","replace","margin","sapcing","GrayScalePipeline","_gray","MultiPipeline","isActive","setActive","gameConfig","WEBGL","mode","autoCenter","CENTER_BOTH","backgroundColor","disableContextMenu","pixelArt","roundPixels","CreditsScene","pipeline","Gray","GrayAlt","plugins","global","plugin","FadePlugin","FlashPlugin","LevelResumeSceneConfig","LevelResumeMenu","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","color","version","getElementById"],"mappings":"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","file":"static/js/main.020e7ed8.chunk.js","sourcesContent":["const DB_NAME = 'data'\nconst DB_INITIAL_STATE = {\n  totalShroomsAmount: 0,\n  tripDone: false,\n  // maxProgress: 0\n  // level_1: {\n  //   diamonds: 5,\n  //   diamonds_picked: 0,\n  //   diamonds_to_complete: 4,\n  //   enemies: 0,\n  //   enemies_killed: 0,\n  //   comp: 0,\n  // },\n}\n\nlet memDB = DB_INITIAL_STATE\nconst bootUp = () => {\n  const stored = window.localStorage.getItem(DB_NAME) || ''\n  memDB = stored !== '' ? JSON.parse(stored) : DB_INITIAL_STATE\n  return memDB\n}\nconst persist = () => window.localStorage.setItem(DB_NAME, JSON.stringify(memDB))\n\nconst get = key => eval(`memDB.${key}`)\nconst set = (key, value) => {\n  switch(typeof value) {\n    case 'string':\n      safeSet(key, `\\`${value}\\``)\n      break\n    case 'number':\n    case 'boolean':\n      safeSet(key, value)\n      break\n    default:\n    case 'object':\n      safeSet(key, `JSON.parse(\\`${JSON.stringify(value)}\\`)`)\n      break\n  }\n  persist()\n}\nconst reset = () => {\n  memDB = DB_INITIAL_STATE\n  persist()\n}\n\nconst safeSet = (key, value) => eval(`memDB.${key} = ${value}`)\nconst getLevels = () => {\n  return Object.keys(memDB).map(k => k.includes('level_') ? memDB[k] : null).filter(Boolean)\n}\nbootUp()\nexport default {\n  get,\n  set,\n  reset,\n  getLevels,\n}\n","import { useState, createContext, useEffect } from 'react'\n\nexport const context = createContext()\n\nconst PhaserProvider = ({ game, scene, sceneProps, children }) => {\n  const [ready, setReady] = useState()\n  \n  // delay to let the context value to propagate before rendering children.\n  // this way children can implement usePhaser confident that objects returned are not null\n  useEffect(() => {\n    setReady(!!game && !!scene)\n  }, [game, scene])\n\n  return (\n    <context.Provider value={{ game, scene, sceneProps }}>\n      {\n        ready ? children : null\n      }\n    </context.Provider>\n  )\n}\n\nexport default PhaserProvider\n","import Phaser from \"phaser\";\n\nclass RPFScene extends Phaser.Scene {\n  constructor(name, args, onCreate) {\n    super(name);\n    this.onCreate = onCreate;\n    this.config = args\n  }\n  preload() {\n    if(this.config?.preload) {\n      this.config.preload.bind(this)()\n    }\n  }\n  create(data = {}) {\n    if(this.config?.create) {\n      this.config.create.bind(this)()\n    }\n    this.onCreate(data);\n  }\n}\n\nexport default RPFScene;\n","import Phaser from \"phaser\";\nimport React from \"react\";\nimport { useEffect, forwardRef, useRef, useState } from \"react\";\nimport PhaserProvider from \"../PhaserProvider\";\nimport RPFScene from \"./RPFScene\";\n\n/**\n * Creates a new Phaser.Game with given arguments.\n * triggers functions to store game into context\n */\nconst Canvas = forwardRef(({ args, children }, canvasRef) => {\n  const fallbackRef = useRef();\n  const ref = canvasRef || fallbackRef;\n  const [game, setGame] = useState();\n  const [ready, setReady] = useState();\n  const [activeScene, setActiveScene] = useState({});\n  // const [activeSceneProps, setActiveSceneProps] = useState(null);\n\n  useEffect(() => {\n    const scenes = React.Children.map(\n      children,\n      (ch) =>\n        new RPFScene(ch.props.name, ch.props.args, data => {\n          // setActiveSceneProps(data)\n          setActiveScene({ [ch.props.name]: data });\n        })\n    );\n    // args.scene = [...scenes, ...(args.scene || [])];\n    args.scene = [...(args.scene || []), ...scenes];\n    args.callbacks = {\n      postBoot: (game) => {\n        setGame(game);\n        setReady(true);\n        game.scene.scenes.forEach((sc) => {\n          sc.events.off(Phaser.Scenes.Events.READY);\n          sc.events.once(Phaser.Scenes.Events.READY, () => {\n            sc.events.off(Phaser.Scenes.Events.RENDER);\n            sc.events.once(Phaser.Scenes.Events.RENDER, () => {\n              // setActiveSceneKey(sc.scene.key);\n            });\n          });\n          sc.events.once(Phaser.Scenes.Events.WAKE, () => {\n            // console.log(Phaser.Scenes.Events.WAKE, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.UPDATE, () => {\n            // console.log(Phaser.Scenes.Events.UPDATE, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.TRANSITION_WAKE, () => {\n            // console.log(Phaser.Scenes.Events.TRANSITION_WAKE, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.TRANSITION_START, () => {\n            // console.log(Phaser.Scenes.Events.TRANSITION_START, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.TRANSITION_OUT, () => {\n            // console.log(Phaser.Scenes.Events.TRANSITION_OUT, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.TRANSITION_INIT, () => {\n            // console.log(Phaser.Scenes.Events.TRANSITION_INIT, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.TRANSITION_COMPLETE, () => {\n            // console.log(Phaser.Scenes.Events.TRANSITION_COMPLETE, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.START, () => {\n            // console.log(Phaser.Scenes.Events.START, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.SLEEP, () => {\n            // console.log(Phaser.Scenes.Events.SLEEP, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.SHUTDOWN, () => {\n            // console.log(Phaser.Scenes.Events.SHUTDOWN, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.RESUME, () => {\n            // console.log(Phaser.Scenes.Events.RESUME, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.RENDER, () => {\n            // console.log(Phaser.Scenes.Events.RENDER, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.READY, () => {\n            // console.log(Phaser.Scenes.Events.READY, sc.scene.key)\n          });\n          sc.events.once(Phaser.Scenes.Events.PRE_RENDER, () => {\n            // setActiveSceneKey(sc.scene.key);\n            // console.log(Phaser.Scenes.Events.PRE_RENDER, sc.scene.key);\n          });\n          sc.events.once(Phaser.Scenes.Events.PAUSE, () => {\n            // console.log(Phaser.Scenes.Events.PAUSE, sc.scene.key)\n          });\n          sc.events.on(Phaser.Scenes.Events.CREATE, () => {\n            setActiveScene(state => ({ [sc.scene.key]: state[sc.scene.key] }));\n            // setActiveSceneKey(sc.scene.key);\n          });\n          sc.events.once(Phaser.Scenes.Events.BOOT, () => {\n            // console.log(Phaser.Scenes.Events.BOOT, sc.scene.key)\n          });\n        });\n        // game.scene.scenes[0].events.once(Phaser.Scenes.Events.PRE_RENDER, (s) => {\n        //   game.scene.scenes[0].load.on(Phaser.Loader.Events.COMPLETE, () =>\n        //   setReady(true)\n        //   );\n        // });\n      },\n    };\n    const game = new Phaser.Game(args);\n    ref.current = game;\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const activeChildren = React.Children.toArray(children).find((ch) => {\n    return ch.props.name === Object.keys(activeScene)[0];\n  });\n  \n  return ready ? (\n    <PhaserProvider scene={game.scene.getScene(Object.keys(activeScene)[0])} sceneProps={Object.values(activeScene)[0]} game={game}>{activeChildren}</PhaserProvider>\n  ) : null;\n});\n\nCanvas.displayName = \"Canvas\";\nexport default Canvas;\n","export const TICK_TIME = 250\nexport const PLAYER_TICK_TIME = TICK_TIME - 25\nexport const TILE_SIZE = 20\n// export const TILES_BY_SCREEN = 13\nexport const TILES_BY_SCREEN = 20\n\n// incorrectly, I set SCALE as a constant which is set at the moment this const is imported into modules.\n// since SCALE is dynamic based on screen size, I need to make it a functions to get called every time we need it.\n// it turns out that constant is used in 117 lines by 22 files. To avoid replacing all those occurence, I came out with this hack:\n// convert SCALE into a functions and overcharche it method toString so all the places where is used lik num + SCALE invokes\n// the calculation of scale each time.\n/* proof:\n  const SCALE = () => 25\n  SCALE() // outputs 25\n  SCALE // outputs function\n  SCALE.toString = SCALE\n  5 + SCALE // outputs 30\n*/\nexport const SCALE_RATIO = window.devicePixelRatio\n// export const SCALE = () => SCALE_RATIO\n\n// export const SCALE = () => 1\nexport const SCALE = () => document.querySelector('canvas').width/TILES_BY_SCREEN/TILE_SIZE\nexport const SCALE_V = () => document.querySelector('canvas').height/11/TILE_SIZE\n\n// export const SCALE = () => Math.round((document.querySelector('canvas').width/TILES_BY_SCREEN * 100 / TILE_SIZE/100)*100)/100\nSCALE.toString = SCALE\n\n\nexport const PIXEL_NAME_BG = {\n  TRANSPARENT: '00ff00',\n  BACKGROUND: '000000',\n  BG_TOP: 'ffffff',\n  BG_RIGHT: '00cc00',\n  BG_BOTTOM: '999999',\n  BG_LEFT: '0000cc',\n  BG_TOP_RIGHT: '00ff00',\n  BG_BOTTOM_RIGHT: '009900',\n  BG_BOTTOM_LEFT: '000099',\n  BG_TOP_LEFT: '0000ff',\n  BG_INSET_TOP_RIGHT: 'cc0000',\n  BG_INSET_BOTTOM_RIGHT: '660000',\n  BG_INSET_BOTTOM_LEFT: '990000',\n  BG_INSET_TOP_LEFT: 'ff0000',\n}\nexport const PIXEL_NAME = {\n  EMPTY: '000000',\n  PLAYER: 'ff00ff',\n  GROUND: '663300',\n  BOULDER: '999999',\n  PILLAR: '545454',\n  WALL: '0000ff',\n  ENEMY: 'ff0000',\n  JEWEL: 'ffff00',\n  BARREL: '00ffff',\n  EXPLOSION: 'ffffff',\n  INTERACTION: '00ff00',\n  MUSHROOM: '9900ff',\n  BRO: '22a5f6',\n  DWARF: 'f29900',\n  EXIT: '00cc00',\n  ART: '1d4ee1',\n  ART2: '000099',\n  HANGING_2: 'd2fca8',\n  HANGING_3: '7ea854',\n  HANGING_4: '547e2a',\n  HANGING_5: '2a5400',\n  DEBRIS: 'a82a2a',\n  BLOCK: 'dadaff',// fake pixel to create a invisible wall, not\n  TORCH: '7e5400'\n}\n\nexport const DIRS = {\n  DOWN: 'ArrowDown',\n  UP: 'ArrowUp',\n  LEFT: 'ArrowLeft',\n  RIGHT: 'ArrowRight',\n}\nexport const BG_PIXEL_TO_TILEMAP_POSITION = {\n  [PIXEL_NAME_BG.TRANSPARENT]: 81,\n  [PIXEL_NAME_BG.BACKGROUND]: 0,\n  [PIXEL_NAME_BG.BG_TOP]: 71,\n  [PIXEL_NAME_BG.BG_RIGHT]: 82,\n  [PIXEL_NAME_BG.BG_BOTTOM]: 91,\n  [PIXEL_NAME_BG.BG_LEFT]: 80,\n  [PIXEL_NAME_BG.BG_TOP_RIGHT]: 72,\n  [PIXEL_NAME_BG.BG_BOTTOM_RIGHT]: 92,\n  [PIXEL_NAME_BG.BG_BOTTOM_LEFT]: 90,\n  [PIXEL_NAME_BG.BG_TOP_LEFT]: 70,\n  [PIXEL_NAME_BG.BG_INSET_TOP_RIGHT]: 85,\n  [PIXEL_NAME_BG.BG_INSET_BOTTOM_RIGHT]: 83,\n  [PIXEL_NAME_BG.BG_INSET_BOTTOM_LEFT]: 84,\n  [PIXEL_NAME_BG.BG_INSET_TOP_LEFT]: 86,\n}\nexport const PIXEL_TO_TILEMAP_POSITION = {\n  [PIXEL_NAME.EMPTY]: 0,\n  [PIXEL_NAME.WALL]: 3,\n  [PIXEL_NAME.GROUND]: 2,\n  [PIXEL_NAME.ART]: 0,\n  [PIXEL_NAME.ART2]: 20,\n  [PIXEL_NAME.EXIT+'_1']: 18,\n  [PIXEL_NAME.EXIT+'_2']: 48,\n  [PIXEL_NAME.EXIT+'_3']: 88,\n  [PIXEL_NAME.DEBRIS]: 1,\n  calculateGroundTileWithNeighbours: (x, y, data) => {\n    const W = (data[x]||[])[y-1] === PIXEL_NAME.GROUND ? 'W' : '-'\n    const N = (data[x-1]||[])[y] === PIXEL_NAME.GROUND ? 'N' : '-'\n    const E = (data[x]||[])[y+1] === PIXEL_NAME.GROUND ? 'E' : '-'\n    const S = (data[x+1]||[])[y] === PIXEL_NAME.GROUND ? 'S' : '-'\n    switch(`${N}${E}${S}${W}`) {\n      case '----':\n        default:\n        return 2\n      case 'NESW':\n        return 51\n      case 'N---':\n        return 63\n      case '-E--':\n        return 44\n      case '--S-':\n        return 43\n      case '---W':\n        return 46\n      case 'NE--':\n        return 60\n      case '-ES-':\n        return 40\n      case '--SW':\n        return 42\n      case 'N--W':\n        return 62\n      case 'NES-':\n        return 50\n      case '-ESW':\n        return 41\n      case 'N-SW':\n        return 52\n      case 'NE-W':\n        return 61\n      case 'N-S-':\n        return 53\n      case '-E-W':\n        return 45\n    }\n  },\n  calculateWallTileWithNeighbours: (x, y, data) => {\n    const W = (data[x]||[])[y-1] === PIXEL_NAME.WALL || [PIXEL_NAME.ART, PIXEL_NAME.ART2].includes((data[x]||[])[y-1]) || [PIXEL_NAME.HANGING_2, PIXEL_NAME.HANGING_3, PIXEL_NAME.HANGING_4, PIXEL_NAME.HANGING_5, PIXEL_NAME.TORCH].includes((data[x]||[])[y-1]) ? 'W' : '-'\n    const N = (data[x-1]||[])[y] === PIXEL_NAME.WALL || [PIXEL_NAME.ART, PIXEL_NAME.ART2].includes((data[x-1]||[])[y]) || [PIXEL_NAME.HANGING_2, PIXEL_NAME.HANGING_3, PIXEL_NAME.HANGING_4, PIXEL_NAME.HANGING_5, PIXEL_NAME.TORCH].includes((data[x-1]||[])[y]) ? 'N' : '-'\n    const E = (data[x]||[])[y+1] === PIXEL_NAME.WALL || [PIXEL_NAME.ART, PIXEL_NAME.ART2].includes((data[x]||[])[y+1]) || [PIXEL_NAME.HANGING_2, PIXEL_NAME.HANGING_3, PIXEL_NAME.HANGING_4, PIXEL_NAME.HANGING_5, PIXEL_NAME.TORCH].includes((data[x]||[])[y+1]) ? 'E' : '-'\n    const S = (data[x+1]||[])[y] === PIXEL_NAME.WALL || [PIXEL_NAME.ART, PIXEL_NAME.ART2].includes((data[x+1]||[])[y]) || [PIXEL_NAME.HANGING_2, PIXEL_NAME.HANGING_3, PIXEL_NAME.HANGING_4, PIXEL_NAME.HANGING_5, PIXEL_NAME.TORCH].includes((data[x+1]||[])[y]) ? 'S' : '-'\n    switch(`${N}${E}${S}${W}`) {\n      case '----':\n        default:\n        return 3\n      case 'NESW':\n        return 21\n      case 'N---':\n        return 33\n      case '-E--':\n        return 14\n      case '--S-':\n        return 13\n      case '---W':\n        return 16\n      case 'NE--':\n        return 30\n      case '-ES-':\n        return 10\n      case '--SW':\n        return 12\n      case 'N--W':\n        return 32\n      case 'NES-':\n        return 20\n      case '-ESW':\n        return 11\n      case 'N-SW':\n        return 22\n      case 'NE-W':\n        return 31\n      case 'N-S-':\n        return 23\n      case '-E-W':\n        return 15\n    }\n  },\n  // Dirt earth\n  calculateWallTileWithNeighboursDirtEarth: (x, y, data) => {\n    const W = (data[x]||[])[y-1] === PIXEL_NAME.WALL ? 'W' : '-'\n    const N = (data[x-1]||[])[y] === PIXEL_NAME.WALL ? 'N' : '-'\n    const E = (data[x]||[])[y+1] === PIXEL_NAME.WALL ? 'E' : '-'\n    const S = (data[x+1]||[])[y] === PIXEL_NAME.WALL ? 'S' : '-'\n    switch(`${N}${E}${S}${W}`) {\n      case '----':\n        default:\n        return 2\n      case 'NESW':\n        return 51\n      case 'N---':\n        return 63\n      case '-E--':\n        return 44\n      case '--S-':\n        return 43\n      case '---W':\n        return 46\n      case 'NE--':\n        return 60\n      case '-ES-':\n        return 40\n      case '--SW':\n        return 42\n      case 'N--W':\n        return 62\n      case 'NES-':\n        return 50\n      case '-ESW':\n        return 41\n      case 'N-SW':\n        return 52\n      case 'NE-W':\n        return 61\n      case 'N-S-':\n        return 53\n      case '-E-W':\n        return 45\n    }\n  }\n}","// import * as Localization from 'expo-localization'\nimport memoize from 'lodash.memoize'\nimport i18n from 'i18n-js'\nimport dictionary_en from './dictionary_en.json'\nimport dictionary_es from './dictionary_es.json'\n\nconst getDictionary = (lang) => {\n  switch(lang) {\n    case 'en':\n    default:\n      return dictionary_en\n    case 'es':\n      return dictionary_es\n  }\n}\n\nconst translationGetters = {\n  en: () => getDictionary('en'),\n  es: () => getDictionary('es'),\n}\n\nexport const translate = memoize(\n  (key, config) => i18n.t(key, config),\n  (key, config) => (config ? key + JSON.stringify(config) : key),\n)\n\nexport const getLocale = () => i18n.locale\nexport const getDayRefFormat = (locale = getLocale()) => {\n  switch (locale) {\n    case 'es':\n      return 'DD [de] MMMM'\n    default:\n      return 'MMMM Do'\n  }\n}\n\n// in Spanish verbs in past participle are pluralizable meanwhile in English they aren't.\n// currently only en is not pluralizeble.\nexport const isPastParticiplePluralizable = (locale = getLocale()) =>\n  ({\n    en: false,\n    es: true,\n  }[locale])\n\nexport const setI18nConfig = async (callback) => {\n  // fallback if no available language fits\n  const fallback = 'en'\n\n  // const { locale: localeComplete } = await Localization.getLocalizationAsync()\n  let locale = navigator.language.substring(0, 2)\n\n  if (!Object.keys(translationGetters).includes(locale)) locale = fallback\n\n  const languageTag = 'en'// locale\n\n  const dictionary = await translationGetters[languageTag]()\n  // set i18n-js config\n  // clear translation cache\n  // if (translate.cache.clear) translate.cache.clear()\n  i18n.translations = { [languageTag]: dictionary }\n  i18n.locale = languageTag\n  callback(true)\n}\n","export default class BaseObject {\n  constructor() {\n    this.eventListeners = []\n    this.classes = [] // helper fot isClass matching\n  }\n\n  listClasses() {\n    let proto = this.__proto__\n    const classes = []\n    while(proto.constructor.className !== undefined) {\n      classes.push(proto.constructor.className)\n      proto = proto.__proto__\n    }\n    return classes\n  }\n\n  isClass(givenClass) {\n    if(this.classes.length === 0) {\n      this.classes = this.listClasses()\n    }\n    \n    return this.classes.includes(givenClass.className)\n    \n    // if(Class.className === 'Player') {\n    //   window.test = this\n    // }\n    // return this.constructor.className === Class.className\n  }\n  addEventListener(eventName, listener) {\n    this.eventListeners.push([eventName, listener])\n    return () => {\n      this.eventListeners = this.eventListeners.filter(l => l[1] !== listener)\n    }\n  }\n  dispatchEvent(eventName, payload) {\n    this.eventListeners.filter(l => l[0] === eventName).forEach(l => l(payload, this))\n  }\n}","import BaseObject from \"./BaseObject\"\n\nexport default class GameObject extends BaseObject {\n  constructor({ id, isRigid, isBreakable, isFlat, isPickable, isCrushable, level }) {\n    super()\n    this.id = id\n    // can't be moved nor affected by gravity\n    // wall, ground\n    this.isRigid = isRigid\n\n    // destroyable under circumstances like explosions\n    // ground, boulder, diamond\n    this.isBreakable = isBreakable\n\n    // rounded objects (like boulders and diamonds) above remain still\n    // character, ground, wall\n    this.isFlat = isFlat\n\n    // can be collected by characters\n    // diamond\n    this.isPickable = isPickable\n\n    // crush under pression\n    // character, enemies, dynamite, barrel\n    this.isCrushable = isCrushable\n\n    // energy to break things\n    this.power = 0\n\n    // how resistant to brake it is\n    this.strength = 0\n\n    // how hard can push\n    this.force = 0\n\n    // how much force can resist before move\n    this.weight = 0\n\n    this.level = level\n\n    this.position = null\n    this.alien = null\n    this.isMoveable = !this.isRigid\n  }\n\n  setPosition(coords) {\n    this.position = coords\n  }\n\n  canMove() {\n    return this.isMoveable\n  }\n  overrunBy(){}\n  runningOver(){}\n  canFallDown() { return false }\n  canFallLeft() { return false }\n  canFallRight() { return false }\n  addedToScene() {}\n  \n}\n\nGameObject.className = 'GameObject'\n","import BaseObject from \"./BaseObject\"\n\nexport default class Empty extends BaseObject {\n  constructor(id, level) {\n    super()\n    this.id = id\n    this.level = level\n    this.isEmpty = true\n  }\n  setPosition(coords) {\n    this.position = coords\n  }\n}\n\nEmpty.className = 'Empty'\n","import Phaser from 'phaser'\nimport GameObject from './GameObject'\nimport Empty from './Empty'\nimport { PIXEL_NAME, TICK_TIME } from '../../utils/constants'\n\nexport default class Explosion extends GameObject {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: false,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: false,\n      level\n    })\n    this.power = 10\n    this.strength = 10\n  }\n  setPosition(coords) {\n    super.setPosition(coords)\n    const { x, y } = coords\n    \n    const layer = this.level.scene.children.getByName('layer_1')\n    // when player dies and level is restarting but explosions still occuring, layer is null\n    if(!layer) return false\n\n    const { tilemap: map } = layer\n    \n    const explosion = this.level.scene.add.sprite(48, 16).setOrigin(0.125, 0.125).play('explosion_explode')\n    explosion.setScale(layer.scaleX)\n    explosion.x = map.tileToWorldX(x)\n    explosion.y = map.tileToWorldY(y)\n\n    // this.level.pause()\n    explosion.on(Phaser.Animations.Events.ANIMATION_COMPLETE, () => {\n      explosion.destroy()\n    })\n          \n    \n    this.alien = explosion\n\n    this.level.replaceByEmpty(this)\n    this.level.onNextTick((lvl) => {\n      // destroy explosion in the next tick or it will prevent the objects above it to wait for a 2nd tick to start falling\n      // this is bcs barrels explode with an offset of tick/2 but explosion places are reserved when barrel cruashes\n      // therefore the explosions takes 1 tick from half to half causing the object above to wait an extra tick\n\n      lvl.objects[y][x] = new Empty(PIXEL_NAME.EMPTY, this.level)\n      // lvl.replaceByEmpty(this)\n    })\n    \n  }\n}\n\nExplosion.className = 'Explosion'\n","import GameObject from './GameObject'\n\nexport default class Destroyable extends GameObject {\n  constructor(props) {\n    super(props)\n    this.inactive = false\n  }\n  overrunBy(el) {\n    if(el.power > this.strength) {\n      this.inactive = true\n      this.level.onDestroyElement(this)\n    }\n  }\n}\n\nDestroyable.className = 'Destroyable'\n","import Destroyable from './Destroyable'\n\nexport default class Moveable extends Destroyable {\n  move({ x, y }) {\n    super.setPosition({ x, y})\n    // this.isMoving = false\n  }\n}\n\nMoveable.className = 'Moveable'\n","import Moveable from './Moveable'\n\nexport default class Fallable extends Moveable {\n  constructor(props) {\n    super(props)\n    this.isFalling = 0 // increment on each loop that the element is falling\n  }\n\n  canFallDown() {\n    const nextPos = { x: this.position.x, y: this.position.y + 1 }\n    const destinationInBounds = this.level.isDestinationInBounds(nextPos.x, nextPos.y)\n    const destinationElement = destinationInBounds && this.level.getObjectAt(nextPos.x, nextPos.y)\n    const destinationIsEmpty = this.level.isDestinationEmpty(nextPos.x, nextPos.y)\n    const destinationIsCrushable = destinationElement.isCrushable && this.isFalling\n    const canFall = destinationIsEmpty || destinationIsCrushable\n\n    return canFall\n  }\n  canRollTo(x, y) {\n    const nextPos = { x, y }\n    const destinationInBounds = this.level.isDestinationInBounds(nextPos.x, nextPos.y)\n    const pathElement = destinationInBounds && this.level.getObjectAt(nextPos.x, this.position.y)\n    const pathClear = destinationInBounds && this.level.objectIsEmpty(pathElement)\n    const destinationElement = destinationInBounds && this.level.getObjectAt(nextPos.x, nextPos.y)\n    const destinationIsEmpty = this.level.objectIsEmpty(destinationElement)\n    const restingElement = destinationInBounds && this.level.getObjectAt(this.position.x, this.position.y + 1)\n    const canRest = !this.level.isDestinationEmpty(this.position.x, this.position.y + 1) && restingElement.isFlat\n    const canRoll = destinationInBounds && destinationIsEmpty && pathClear && !canRest && restingElement && !restingElement.isFalling\n\n    return canRoll\n  }\n  canFallRight() {\n    return !this.canFallDown() && this.canRollTo(this.position.x + 1, this.position.y + 1)\n  }\n  canFallLeft() {\n    return !this.canFallDown() && this.canRollTo(this.position.x - 1, this.position.y + 1)\n  }\n}\n\nFallable.className = 'Fallable'\n","import Explosion from './Explosion'\nimport Fallable from './Fallable'\n\nexport default class Boulder extends Fallable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: false,\n      isPickable: false,\n      isCrushable: false,\n      level\n    })\n    this.strength = 5\n  }\n\n  overrunBy(el) {\n    if(el.isClass(Explosion)) {\n      this.alien.visible = false\n      this.alien.destroy()\n      this.inactive = true\n    }\n  }\n}\nBoulder.className = 'Boulder'\n","import {\n  SCALE,\n} from \"../../utils/constants\";\nimport Explosion from \"./Explosion\";\nimport GameObject from \"./GameObject\";\nimport Phaser from \"phaser\";\nimport UI from \"../UI\";\n\nexport default class Debris extends GameObject {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: true,\n      isBreakable: true,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: false,\n      level,\n    });\n    this.strength = 9; // one less than explosion\n  }\n  overrunBy(el) {\n    if (el && el.isClass(Explosion)) {\n      const layer = this.level.scene.children.getByName(\"layer_1\");\n      const { tilemap: map } = layer;\n\n      map.putTileAt(\n        -1, // leave space really empty and display tile from layer_0 (underlayer)\n        this.position.x,\n        this.position.y,\n        false,\n        \"layer_1\"\n      );\n    } else {\n      const layer = this.level.scene.children.getByName(\"layer_1\");\n      const { tilemap: map } = layer;\n\n      map.putTileAt(\n        -1, // leave space really empty and display tile from layer_0 (underlayer)\n        this.position.x,\n        this.position.y,\n        false,\n        \"layer_1\"\n      );\n      // destroyed by earthquake\n      this.break_effect = this.level.scene.add\n        .sprite(48, 16)\n        .setOrigin(0, 0.25);\n      this.break_effect.setScale(SCALE);\n      this.break_effect.depth = 4;\n      this.break_effect.x = UI.tileToScreen(this.position.x);\n      this.break_effect.y = UI.tileToScreen(this.position.y);\n      this.break_effect.play(\"ground_disolves\");\n      this.break_effect.setFlipY(true);\n      this.break_effect.on(Phaser.Animations.Events.ANIMATION_COMPLETE, () => {\n        this.break_effect.destroy();\n      });\n    }\n  }\n}\n\nDebris.className = \"Debris\";\n","import Explosion from './Explosion'\nimport Fallable from './Fallable'\n\nexport default class Pillar extends Fallable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: false,\n      level\n    })\n    this.strength = 5\n  }\n\n  overrunBy(el) {\n    if(el.constructor.className === Explosion.className) {\n      this.alien.visible = false\n      this.alien.destroy()\n      // this.alien = null\n      // this.level.onDestroyElement(this)\n    }\n  }\n}\nPillar.className = 'Pillar'\n","import Phaser from \"phaser\";\nimport {\n  TICK_TIME,\n  PLAYER_TICK_TIME,\n  PIXEL_NAME,\n  DIRS,\n} from \"../../utils/constants\";\nimport {\n  Player,\n  Boulder,\n  Wall,\n  Empty,\n  Ground,\n  Barrel,\n  Enemy,\n  Interactive,\n  Jewel,\n  Mushroom,\n  NPCharacter,\n  Exit,\n  Torch,\n} from \"../objects\";\nimport Character from \"../objects/Character\";\nimport Debris from \"../objects/Debris\";\nimport Fallable from \"../objects/Fallable\";\nimport Pillar from \"../objects/Pillar\";\nimport UI from \"../UI\";\nimport dbManager from \"../../utils/dbManager\";\n\nclass Level {\n  constructor(config) {\n    this.config = config;\n    this.moveables = [];\n    this.parallelMovables = []; // used for gravity loop on falling objects until they rest\n    this.objects = [];\n    this.interactiveElements = {};\n    this.decorationElements = {};\n    this.scene = null;\n    this.player = null;\n    this.playerTimeoutId = 0;\n    this.timeoutIds = [];\n    this.focusElement = null; // what camera focus on\n    this.isPaused = false;\n    this.queuedActions = [];\n    // stats\n    this.countDiamonds = 0;\n    this.collectedDiamonds = 0;\n    this.countEnemies = 0;\n    this.killedEnemies = 0;\n    this.countShrooms = 0;\n    this.collectedShrooms = 0;\n    this.totalShroomsAmount = 0;\n    this.prevBest = 0;\n    // flags\n    this.preventDisplayDiamondsGoalAmount = false;\n    // unfinish flag\n    this.unfinished = true;\n    // loop identifier\n    this.tickId = 0;\n  }\n\n  onNextTick(listener) {\n    this.queuedActions.push(listener);\n  }\n  runScheduledActions(id) {\n    const toRun = this.queuedActions;\n    this.queuedActions = [];\n    toRun.forEach((cb) => cb(this));\n  }\n\n  connectToScene(phaserScene) {\n    this.scene = phaserScene;\n    const layer = this.scene.children.getByName(\"layer_1\");\n    const { tilemap: map } = layer;\n    if (this.objects.length) {\n      this.objects = [];\n    }\n\n    this.break_effect = this.scene.add.sprite(48, 16).setOrigin(0, 0.25);\n    this.break_effect.setScale(layer.scaleX);\n    this.break_effect.depth = 4;\n\n    this.pick_effect = this.scene.add.sprite(48, 16).setOrigin(0, 0.25);\n    this.pick_effect.setScale(layer.scaleX);\n    this.pick_effect.depth = 4;\n\n    this.enemy_die_effect = this.scene.add.sprite(48, 16).setOrigin(0, 0.25);\n    this.enemy_die_effect.setScale(layer.scaleX);\n    this.enemy_die_effect.depth = 4;\n\n    let intOrder = 0;\n    this.objects = this.config.map((r, y) =>\n      r.map((c, x) => {\n        // factory\n        let element;\n        switch (c) {\n          case PIXEL_NAME.WALL:\n          case PIXEL_NAME.BLOCK:\n            element = new Wall(c, this);\n            element.setPosition({ x, y });\n            break;\n          case PIXEL_NAME.TORCH:\n            element = new Torch(c, this);\n            element.setPosition({ x, y });\n            element.order = Object.values(this.decorationElements).filter(el => el.isClass(Torch)).length\n            this.decorationElements[`${element.position.x}-${element.position.y}`] = element\n            break;\n          case PIXEL_NAME.DEBRIS:\n            element = new Debris(c, this);\n            element.setPosition({ x, y });\n            break;\n          case PIXEL_NAME.GROUND:\n            element = new Ground(c, this);\n            element.setPosition({ x, y });\n            break;\n          case PIXEL_NAME.BOULDER:\n            const boulder = this.scene.add\n              .sprite(48, 16)\n              .setOrigin(0, 0.25)\n              .play(\"boulder_idle\");\n            boulder.setScale(layer.scaleX);\n            boulder.x = map.tileToWorldX(x);\n            boulder.y = map.tileToWorldY(y);\n\n            element = new Boulder(c, this);\n            element.alien = boulder;\n            break;\n          case PIXEL_NAME.PILLAR:\n            const pillar = this.scene.add\n              .sprite(48, 16)\n              .setOrigin(0.05, 0.2)\n              .play(\"pillar_idle\");\n            pillar.setScale(layer.scaleX);\n            pillar.x = map.tileToWorldX(x);\n            pillar.y = map.tileToWorldY(y);\n\n            element = new Pillar(c, this);\n            element.alien = pillar;\n            break;\n          case PIXEL_NAME.JEWEL:\n            const diamond = this.scene.add\n              .sprite(48, 16)\n              .setOrigin(0.05, 0.2)\n              .play(\"diamond_idle\");\n            diamond.setScale(layer.scaleX);\n            diamond.x = map.tileToWorldX(x);\n            diamond.y = map.tileToWorldY(y);\n            \n            this.countDiamonds++;\n            \n            element = new Jewel(c, this);\n            element.order = this.countDiamonds;\n            element.alien = diamond;\n            element.move({ x, y })\n            break;\n          case PIXEL_NAME.MUSHROOM:\n            if (\n              dbManager.get(this.constructor.key) &&\n              dbManager.get(this.constructor.key).collectedShrooms !== 0\n            ) {\n              this.collectedShrooms = dbManager.get(\n                this.constructor.key\n              ).collectedShrooms;\n              element = new Empty(c, this);\n            } else {\n              const mushroom = this.scene.add\n                .sprite(48, 16)\n                .setOrigin(0, 0.25)\n                .play(\"mushroom_idle\");\n              mushroom.setScale(layer.scaleX);\n              mushroom.x = map.tileToWorldX(x);\n              mushroom.y = map.tileToWorldY(y);\n\n              element = new Mushroom(c, this);\n              element.alien = mushroom;\n            }\n            this.countShrooms++;\n            break;\n          case PIXEL_NAME.BARREL:\n            const barrel = this.scene.add\n              .sprite(48, 16)\n              .setOrigin(0, 0.2)\n              .play(\"barrel_idle\");\n            barrel.setScale(layer.scaleX);\n\n            barrel.x = map.tileToWorldX(x);\n            barrel.y = map.tileToWorldY(y);\n\n            element = new Barrel(c, this);\n            element.alien = barrel;\n            break;\n          case PIXEL_NAME.PLAYER:\n            const player = this.scene.add.sprite(48, 16).setOrigin(0, 0.25);\n            player.setScale(layer.scaleX);\n            player.x = map.tileToWorldX(x);\n            player.y = map.tileToWorldY(y) + 5;\n\n            player.name = \"brave\";\n            player.on(Phaser.Animations.Events.ANIMATION_COMPLETE, () => {\n              if (!player.isMoving && !player.inactive) {\n                player.play(\"brave_idle\");\n              }\n            });\n\n            element = new Player(c, this);\n            element.alien = player;\n            element.animIdle();\n\n            // add shortcut reference\n            this.player = element;\n            break;\n          case PIXEL_NAME.BRO:\n            const follower = this.scene.add.sprite(48, 16).setOrigin(0, 0.25);\n            follower.setScale(layer.scaleX);\n            follower.x = map.tileToWorldX(x);\n            follower.y = map.tileToWorldY(y) + 5;\n\n            follower.name = \"bro\";\n            follower.on(Phaser.Animations.Events.ANIMATION_COMPLETE, () => {\n              if (!follower.isMoving && follower.isFollowing) {\n                follower.play(\"bro_idle\");\n              }\n            });\n\n            element = new NPCharacter(c, this, \"bro\");\n            element.alien = follower;\n            element.isFollowing = true;\n            element.animIdle();\n\n            // add shortcut reference\n            this.follower = element;\n            break;\n          case PIXEL_NAME.DWARF:\n            const leader = this.scene.add.sprite(48, 16).setOrigin(0, 0.25);\n            leader.setScale(layer.scaleX);\n            leader.x = map.tileToWorldX(x);\n            leader.y = map.tileToWorldY(y);\n\n            leader.name = \"dwarf\";\n            leader.on(Phaser.Animations.Events.ANIMATION_COMPLETE, () => {\n              if (!leader.isMoving) {\n                leader.play(\"dwarf_idle\");\n              }\n            });\n\n            element = new NPCharacter(c, this, \"dwarf\");\n            element.alien = leader;\n            // element.isFollowing = true\n            element.isLeading = true;\n            element.animIdle();\n\n            // add shortcut reference\n            this.leader = element;\n            break;\n          case PIXEL_NAME.ENEMY:\n            const enemy = this.scene.add\n              .sprite(48, 16)\n              .setOrigin(0.125, 0.125)\n              .play(\"bat_move\");\n            enemy.setScale(layer.scaleX);\n            enemy.x = map.tileToWorldX(x);\n            enemy.y = map.tileToWorldY(y);\n\n            this.countEnemies++;\n\n            element = new Enemy(c, this);\n            element.alien = enemy;\n            break;\n\n          case PIXEL_NAME.EXIT:\n          case PIXEL_NAME.INTERACTION:\n            const intElement =\n              c === PIXEL_NAME.EXIT\n                ? new Exit(c, this)\n                : new Interactive(c, this);\n            intElement.order = intOrder++;\n            this.interactiveElements[`${x}-${y}`] = intElement;\n            intElement.setPosition({ x, y });\n\n            // keep old hook when interactive element is added\n            this.onAddElement(intElement);\n            // instead of interactive element, add an empty element to the current position\n            element = new Empty(c, this);\n\n            if (intElement.isClass(Exit)) {\n              this.exit = intElement;\n            }\n            break;\n          default:\n            element = new Empty(c, this);\n        }\n        element.setPosition({ x, y });\n        if (!this.objectIsEmpty(element) && !element.isRigid) {\n          this.moveables.push(element);\n        }\n        this.onAddElement(element);\n        if (!element.isClass(Empty)) {\n          element.addedToScene();\n        }\n        return element;\n      })\n    );\n\n    this.focusElement = this.player;\n\n    // unfinish flag\n    const dbData = dbManager.get(this.constructor.key);\n    this.unfinished = !dbData || (dbData && dbData.comp === 0);\n    console.log(this.unfinished);\n\n    if (this.diamondsGoal > 0) {\n      // draw exit block only on unfinished levels\n      if (this.unfinished) {\n        // const exit = Object.values(this.interactiveElements).find((el) =>\n        //   el.isClass(Exit)\n        // );\n        const block = this.scene.add\n          .sprite(48, 16)\n          .setOrigin(0, 0.25)\n          .play(\"exit_block\");\n        block.setScale(layer.scaleX);\n        block.x = map.tileToWorldX(this.exit.position.x - 2);\n        block.y = map.tileToWorldY(this.exit.position.y);\n\n        const exitBlock = new Wall(PIXEL_NAME.WALL, this);\n        exitBlock.setPosition({ x: this.exit.position.x - 2, y: this.exit.position.y });\n        exitBlock.alien = block;\n        this.objects[this.exit.position.y][this.exit.position.x - 2] = exitBlock;\n        this.exit.block = exitBlock;\n      }\n\n      // only level 6 needs to have diamonds goal but do not display it until a dialog happens\n      if (!this.preventDisplayDiamondsGoalAmount) {\n        setTimeout(() => {\n          this.scene.events.emit(\"score:diamond_goal_set\", this.diamondsGoal);\n        }, 1500);\n      }\n    }\n\n    // awaits for child level object set goals\n    this.onNextTick(() => {\n      if (!dbManager.get(this.constructor.key)) {\n        dbManager.set(this.constructor.key, {\n          countDiamonds: this.countDiamonds,\n          collectedDiamonds: this.collectedDiamonds,\n          countEnemies: this.countEnemies,\n          killedEnemies: this.killedEnemies,\n          countShrooms: this.countShrooms,\n          collectedShrooms: this.collectedShrooms,\n          comp: 0,\n          prevBest: this.prevBest,\n        });\n      }\n    });\n\n    // this.totalShroomsAmount = dbManager.getLevels().reduce((r, l) => r + l.collectedShrooms, 0);\n    this.totalShroomsAmount = dbManager.get(\"totalShroomsAmount\") || 0;\n  }\n\n  jumpIntoParallelGravity(el) {\n    const idx = this.moveables.findIndex((e) => e === el);\n    this.moveables.splice(idx, 1);\n    el.inParallelGravity = true;\n    this.parallelMovables.push(el);\n  }\n  goBackToMainGravity(el) {\n    // no way back when incative (like after explosion)\n    if (el.inactive) return false;\n\n    const idx = this.parallelMovables.findIndex((e) => e === el);\n    // nothing to move from parallel movables\n    if (idx === -1) return false;\n\n    this.parallelMovables.splice(idx, 1);\n    el.inParallelGravity = false;\n    this.moveables.push(el);\n  }\n  explodeLoop(barrels) {\n    barrels.forEach((el) => {\n      const canFallDown = el.canFallDown();\n      if (!canFallDown && el.isFalling) {\n        el.explode();\n      }\n    });\n  }\n  gravityLoop(parallelWorld) {\n    const moveables = parallelWorld || this.moveables;\n    if (this.isPaused) {\n      return;\n    }\n\n    if (!parallelWorld) {\n      this.runScheduledActions();\n    }\n\n    this.explodeLoop(moveables.filter((o) => o.isClass(Barrel)));\n    moveables\n      .sort((a, b) => a.position.y - b.position.y)\n\n      // .sort((a, b) => {\n      //   // move Barrels at the beginning of the movables list.\n      //   // if more than 1 Barrel, sort them by bottom to top: move first those in the bottom of the screen (higher y value)\n      //   if(a.isClass(Barrel) && b.isClass(Barrel)) {\n      //     // from bottom to top\n      //     return b.position.y - a.position.y\n      //   } else if(!a.isClass(Barrel) || b.isClass(Barrel)) {\n      //     return 1\n      //   } else if(a.isClass(Barrel) || !b.isClass(Barrel)) {\n      //     return -1\n      //   } else {\n      //     // from top to bottom\n      //     return a.position.y - b.position.y\n      //   }\n      // })\n      .forEach((el) => {\n        // if (el.beingPusehd) {\n        //   el.beingPusehd = false\n        //   return\n        // }\n        const canFallDown = el.canFallDown();\n        const canFallLeft = el.canFallLeft();\n        const canFallRight = el.canFallRight();\n        let nextPos;\n        if (canFallDown) {\n          nextPos = { x: el.position.x, y: el.position.y + 1 };\n        }\n        if (!canFallDown && canFallLeft) {\n          nextPos = { x: el.position.x - 1, y: el.position.y };\n          if (el.isFalling) {\n            nextPos.y++;\n          }\n        }\n        if (!canFallDown && !canFallLeft && canFallRight) {\n          nextPos = { x: el.position.x + 1, y: el.position.y };\n          if (el.isFalling) {\n            nextPos.y++;\n          }\n        }\n\n        if (nextPos) {\n          this.moveObject(el, nextPos);\n          if (\n            el.isFalling &&\n            (canFallLeft || canFallRight) &&\n            el.isClass(Jewel)\n          ) {\n            this.scene.events.emit(\"sounds:gem_hit\");\n          }\n          if (\n            el.isFalling &&\n            (canFallLeft || canFallRight) &&\n            (el.isClass(Boulder) || el.isClass(Pillar))\n          ) {\n            this.scene.events.emit(\"sounds:rock_hit_hard\");\n          }\n\n          el.isFalling++;\n        } else {\n          if (el.isFalling && (el.isClass(Boulder) || el.isClass(Pillar))) {\n            const objectBelow = this.getObjectAt(\n              el.position.x,\n              el.position.y + 1\n            );\n            if (objectBelow && objectBelow.isClass(Ground)) {\n              this.scene.events.emit(\"sounds:rock_hit_soft\");\n            } else {\n              this.scene.events.emit(\"sounds:rock_hit_hard\");\n            }\n          }\n          if (el.isFalling && el.isClass(Jewel)) {\n            this.scene.events.emit(\"sounds:gem_hit\");\n          }\n          // if (el.isFalling && el.isClass(Barrel)) {\n          //   el.explode();\n          // }\n\n          el.isFalling = 0;\n        }\n\n        if (!el.isFalling && el.inParallelGravity) {\n          this.goBackToMainGravity(el);\n        }\n      });\n\n    if (!parallelWorld) {\n      this.enemiesLoop();\n      // this.runScheduledActions();\n    }\n  }\n  enemiesLoop() {\n    if (this.isPaused) {\n      return;\n    }\n    let nextPos,\n      neighbour,\n      isDestinationEmpty,\n      isPerpToAnchor,\n      newAnchor,\n      nextDir,\n      backToTrackDir,\n      nextAnchorPos;\n\n    const helperDirCalc = (\n      enemy,\n      nextPos,\n      nextDir,\n      backToTrackDir,\n      nextAnchorPos\n    ) => {\n      neighbour = this.getObjectAt(nextPos.x, nextPos.y);\n      isDestinationEmpty =\n        this.objectIsEmpty(neighbour) ||\n        (neighbour && neighbour.isClass(Player)); // this.isDestinationEmpty(nextPos.x, nextPos.y)\n      // if (!isDestinationEmpty && !enemy.anchorPosition) {\n      //   enemy.anchorPosition = neighbour.position\n      //   enemy.moveIntentDir = nextDir\n      // }\n      if (isDestinationEmpty && neighbour && neighbour.isClass(Player)) {\n        this.moveObject(enemy, nextPos);\n      }\n      if (isDestinationEmpty) {\n        if (!enemy.anchorPosition) {\n          enemy.moveIntentDir = nextDir;\n          return;\n        }\n        isPerpToAnchor =\n          enemy.position.x === enemy.anchorPosition.x ||\n          enemy.position.y === enemy.anchorPosition.y;\n        // scenario 1: enemy is perpendicular to anchor\n        if (isPerpToAnchor) {\n          // updates anchor counter clockwise\n          newAnchor = this.getObjectAt(nextAnchorPos.x, nextAnchorPos.y);\n          if (\n            !this.objectIsEmpty(newAnchor) &&\n            !newAnchor.isFalling &&\n            !newAnchor.isClass(Player)\n          ) {\n            enemy.anchorPosition = newAnchor.position;\n          } else {\n            enemy.moveIntentDir = backToTrackDir;\n          }\n        }\n        this.moveObject(enemy, nextPos);\n      } else {\n        enemy.anchorPosition = !neighbour.isFalling ? neighbour.position : null;\n        enemy.moveIntentDir = nextDir;\n      }\n    };\n    this.moveables\n      .filter((el) => el.isClass(Enemy))\n      .forEach((enemy) => {\n        // potential path finding mechanism @see https://github.com/qiao/PathFinding.js\n        // if(!enemy.path) {\n        //   const grid = new window.PF.Grid(this.objects.map(row => row.map(el => el.isEmpty ? 0 : 1)));\n        //   enemy.pathfinder = new window.PF.AStarFinder();\n        //   const path = enemy.pathfinder.findPath(enemy.position.x, enemy.position.y, thi.player.position.x, this.player.position.y, grid);\n        // }\n        switch (enemy.moveIntentDir) {\n          case DIRS.UP:\n            nextPos = { x: enemy.position.x, y: enemy.position.y - 1 };\n            nextDir = enemy.scanDirection === \"CW\" ? DIRS.RIGHT : DIRS.LEFT;\n            backToTrackDir =\n              enemy.scanDirection === \"CW\" ? DIRS.LEFT : DIRS.RIGHT;\n            nextAnchorPos =\n              enemy.scanDirection === \"CW\"\n                ? { x: nextPos.x - 1, y: nextPos.y }\n                : { x: nextPos.x + 1, y: nextPos.y };\n            // nextAnchorPos = { x: nextPos.x + 1, y: nextPos.y }\n            helperDirCalc(\n              enemy,\n              nextPos,\n              nextDir,\n              backToTrackDir,\n              nextAnchorPos\n            );\n\n            break;\n          case DIRS.RIGHT:\n            nextPos = { x: enemy.position.x + 1, y: enemy.position.y };\n            nextDir = enemy.scanDirection === \"CW\" ? DIRS.DOWN : DIRS.UP;\n            backToTrackDir = enemy.scanDirection === \"CW\" ? DIRS.UP : DIRS.DOWN;\n            // nextDir = DIRS.UP\n            // backToTrackDir = DIRS.DOWN\n            nextAnchorPos =\n              enemy.scanDirection === \"CW\"\n                ? { x: nextPos.x, y: nextPos.y - 1 }\n                : { x: nextPos.x, y: nextPos.y + 1 };\n            // nextAnchorPos = { x: nextPos.x, y: nextPos.y + 1 }\n            helperDirCalc(\n              enemy,\n              nextPos,\n              nextDir,\n              backToTrackDir,\n              nextAnchorPos\n            );\n\n            break;\n          case DIRS.DOWN:\n            nextPos = { x: enemy.position.x, y: enemy.position.y + 1 };\n            nextDir = enemy.scanDirection === \"CW\" ? DIRS.LEFT : DIRS.RIGHT;\n            backToTrackDir =\n              enemy.scanDirection === \"CW\" ? DIRS.RIGHT : DIRS.LEFT;\n            // nextDir = DIRS.RIGHT\n            // backToTrackDir = DIRS.LEFT\n            nextAnchorPos =\n              enemy.scanDirection === \"CW\"\n                ? { x: nextPos.x + 1, y: nextPos.y }\n                : { x: nextPos.x - 1, y: nextPos.y };\n            // nextAnchorPos = { x: nextPos.x - 1, y: nextPos.y }\n            helperDirCalc(\n              enemy,\n              nextPos,\n              nextDir,\n              backToTrackDir,\n              nextAnchorPos\n            );\n\n            break;\n          case DIRS.LEFT:\n            nextPos = { x: enemy.position.x - 1, y: enemy.position.y };\n            nextDir = enemy.scanDirection === \"CW\" ? DIRS.UP : DIRS.DOWN;\n            backToTrackDir = enemy.scanDirection === \"CW\" ? DIRS.DOWN : DIRS.UP;\n            // nextDir = DIRS.DOWN\n            // backToTrackDir = DIRS.UP\n            nextAnchorPos =\n              enemy.scanDirection === \"CW\"\n                ? { x: nextPos.x, y: nextPos.y + 1 }\n                : { x: nextPos.x, y: nextPos.y - 1 };\n            // nextAnchorPos = { x: nextPos.x, y: nextPos.y - 1 }\n            helperDirCalc(\n              enemy,\n              nextPos,\n              nextDir,\n              backToTrackDir,\n              nextAnchorPos\n            );\n\n            break;\n\n          default:\n            break;\n        }\n        enemy.loop();\n      });\n  }\n  playerLoop() {\n    if (this.isPaused || this.player.inactive) {\n      return;\n    }\n    clearTimeout(this.playerTimeoutId);\n    const player = this.player;\n    const follower = this.follower;\n    const leader = this.leader;\n\n    const nextPos = { x: player.position.x, y: player.position.y };\n    switch (player.moveIntentDir) {\n      case DIRS.UP:\n        if (player.canMoveUp()) {\n          nextPos.y -= 1;\n        }\n        break;\n      case DIRS.DOWN:\n        if (player.canMoveDown()) {\n          nextPos.y += 1;\n        }\n        break;\n      case DIRS.LEFT:\n        if (\n          player.canMoveLeft() ||\n          (player.canPushLeft() && player.pushLeft())\n        ) {\n          nextPos.x -= 1;\n        }\n        break;\n      case DIRS.RIGHT:\n        if (\n          player.canMoveRight() ||\n          (player.canPushRight() && player.pushRight())\n        ) {\n          nextPos.x += 1;\n        }\n        break;\n      default:\n        break;\n    }\n    // if ((player.position.x !== nextPos.x || player.position.y !== nextPos.y)) {\n    if (\n      (player.position.x !== nextPos.x || player.position.y !== nextPos.y) &&\n      !player.isMoving\n    ) {\n      player.isMoving = true;\n      if (player.position.x < nextPos.x) {\n        player.animRunRight();\n        // player.animRunLeft();\n      }\n      if (player.position.x > nextPos.x) {\n        player.animRunLeft();\n        // player.animRunRight();\n      }\n\n      // const isSwitch = nextPos.x === follower.position.x && nextPos.y === follower.position.y\n\n      this.scene.events.emit(\"player_moves\", nextPos);\n      // save last player position\n      const followerNextPos = player.position;\n      // move player\n      this.moveObject(player, nextPos);\n      // updates follower\n      if (follower && follower.isFollowing) {\n        follower.moveIntentDir =\n          follower.position.y < followerNextPos.y\n            ? DIRS.DOWN\n            : follower.moveIntentDir;\n        follower.moveIntentDir =\n          follower.position.y > followerNextPos.y\n            ? DIRS.UP\n            : follower.moveIntentDir;\n        if (follower.position.x < followerNextPos.x) {\n          follower.moveIntentDir = DIRS.RIGHT;\n          follower.animRunRight();\n        }\n        if (follower.position.x > followerNextPos.x) {\n          follower.moveIntentDir = DIRS.LEFT;\n          follower.animRunLeft();\n        }\n\n        this.moveObject(follower, followerNextPos);\n\n        if (follower.position.y < player.position.y) {\n          follower.alien.depth = 0;\n          player.alien.depth = 2;\n        } else {\n          player.alien.depth = 0;\n          follower.alien.depth = 2;\n        }\n      }\n    }\n\n    this.playerTimeoutId = setTimeout(() => {\n      if (!player.alien) {\n        return false;\n      }\n      player.isMoving = false;\n      player.animIdle();\n\n      // interactive detection\n      const isInteractivePosition =\n        this.interactiveElements[`${player.position.x}-${player.position.y}`];\n      if (isInteractivePosition) {\n        isInteractivePosition.overrunBy(player);\n      }\n\n      // follower animations\n      if (\n        follower &&\n        player.alien.anims.currentAnim.key.includes(\"idle\") &&\n        follower.isFollowing\n      ) {\n        // follower.animIdle();\n      }\n\n      // leader animations\n      if (\n        leader ||\n        !leader?.isCloseEnough(player.position) ||\n        (leader?.isCloseEnough(player.position) &&\n          player.alien.anims.currentAnim.key.includes(\"idle\") &&\n          leader.isLeading)\n      ) {\n        leader?.animIdle();\n      }\n\n      // next loop\n      if (player.moveIntentDir !== \"\" && player.alien) {\n        this.playerLoop();\n      }\n    }, PLAYER_TICK_TIME);\n  }\n  // afterPlayerLoop(cb) {\n  //   this.afterPlayerLoopCallbacks.push(cb)\n  // }\n  moveObject(el, pos) {\n    const layer = this.scene.children.getByName(\"layer_1\");\n    if (!layer) {\n      return false;\n    }\n    const { tilemap: map } = layer;\n    const origin = { x: el.position.x, y: el.position.y };\n    // assume destination is occupeable\n    const destinationElement = this.getObjectAt(pos.x, pos.y);\n\n    const isSwitch =\n      [Player.className, NPCharacter.className].includes(\n        el.constructor.className\n      ) &&\n      [Player.className, NPCharacter.className].includes(\n        destinationElement.constructor.className\n      );\n\n    if (\n      (!this.objectIsEmpty(destinationElement) ||\n        destinationElement.isClass(Interactive) ||\n        destinationElement.isClass(Exit)) &&\n      !isSwitch\n    ) {\n      destinationElement.overrunBy(el);\n      el.runningOver(destinationElement);\n    }\n\n    if (el.inactive) return;\n\n    // verify not overriding Player when switch with follower\n    if (!isSwitch) {\n      // clear origin position\n      this.setObjectAt(origin.x, origin.y, new Empty(PIXEL_NAME.EMPTY, this));\n    }\n    // fill destination position\n    this.setObjectAt(pos.x, pos.y, el);\n\n    // updates element position\n    el.move(pos);\n    if (el.isClass(Character) && el.alien) {\n      // alien anim\n      this.scene.tweens.add({\n        targets: el.alien,\n        x: {\n          value: map.tileToWorldX(pos.x),\n          duration: el.isClass(Enemy) ? TICK_TIME : PLAYER_TICK_TIME,\n        },\n        y: {\n          value: map.tileToWorldY(pos.y) + (el.isClass(Player) ? 5 : 0), // offset 5 pixels for player to step a little lower\n          duration: el.isClass(Enemy) ? TICK_TIME : PLAYER_TICK_TIME,\n        },\n      });\n\n      el.animRun();\n      // el.alien?.play('brave_run')\n    }\n\n    // REMOVE LEADER SO PLAYER CAN INTERACT WITH EXIT\n    if (el.isClass(NPCharacter) && el.name === \"dwarf\") {\n      if (\n        this.leader.position.x === this.exit.position.x &&\n        this.leader.position.y === this.exit.position.y\n      ) {\n        this.leader.alien?.destroy();\n        this.leader.alien = null;\n        this.replaceByEmpty(this.leader);\n      }\n    }\n\n    // if(el.isClass(Jewel) || el.isClass(Mushroom)) {\n    //   // alien anim\n    //   this.scene.tweens.add({\n    //     targets: el.alien,\n    //     x: {\n    //       value: map.tileToWorldX(pos.x),\n    //       duration: TICK_TIME * 0.5,\n    //     },\n    //     y: {\n    //       value: map.tileToWorldY(pos.y),\n    //       delay: pos.x !== origin.x ? TICK_TIME * 0.5 : 0,\n    //       duration: pos.x !== origin.x ? TICK_TIME * 0.5 : TICK_TIME,\n    //     },\n    //     // duration: TICK_TIME,\n    //   });\n    // }\n    // if(el.isClass(Barrel)) {\n    //   // alien anim\n    //   this.scene.tweens.add({\n    //     targets: el.alien,\n    //     x: {\n    //       value: map.tileToWorldX(pos.x),\n    //       duration: TICK_TIME * 0.5,\n    //     },\n    //     y: {\n    //       value: map.tileToWorldY(pos.y),\n    //       delay: pos.x !== origin.x ? TICK_TIME * 0.5 : 0,\n    //       duration: pos.x !== origin.x ? TICK_TIME * 0.5 : TICK_TIME,\n    //     },\n    //     // duration: TICK_TIME,\n    //   });\n    // }\n    if (el.isClass(Fallable)) {\n      // alien anim\n      this.scene.tweens.add({\n        targets: el.alien,\n        x: {\n          value: map.tileToWorldX(pos.x),\n          duration: pos.y !== origin.y ? TICK_TIME * 0.5 : TICK_TIME,\n        },\n        y: {\n          value: map.tileToWorldY(pos.y),\n          delay: pos.x !== origin.x ? TICK_TIME * 0.5 : 0,\n          duration: pos.x !== origin.x ? TICK_TIME * 0.5 : TICK_TIME,\n        },\n        onComplete: () => {\n          if (el.inParallelGravity) {\n            this.gravityLoop([el]);\n          }\n        },\n        // duration: TICK_TIME,\n      });\n      // Slide sound and visual for Boulder\n      if (pos.x !== origin.x && el.isClass(Boulder)) {\n        el.alien.play(\n          pos.x > origin.x ? \"boulder_roll_right\" : \"boulder_roll_left\"\n        );\n        if (this.player.pushingDirection !== null) {\n          const base = this.getObjectAt(origin.x, origin.y + 1);\n          this.scene.events.emit(\n            `sounds:rock_slide_${base.isClass(Ground) ? \"soft\" : \"hard\"}`\n          );\n        }\n      }\n      // Slide sound and visual for Barrel\n      if (el.isClass(Barrel)) {\n        // is horizontal push and goes to a place with empty bottom neighbour (which means is going to fall)\n        // or is falling to sides (falling over a non flat object) in which case x and y are differents\n        if (\n          (pos.x !== origin.x &&\n            this.isDestinationEmpty(pos.x, origin.y + 1)) ||\n          (pos.x !== origin.x && pos.y !== origin.y)\n        ) {\n          setTimeout(\n            () =>\n              el.alien?.play(\n                pos.x > origin.x ? \"barrel_roll_right\" : \"barrel_roll_left\"\n              ),\n            TICK_TIME / 2\n          );\n        }\n        if (pos.x !== origin.x) {\n          this.scene.events.emit(\"sounds:rock_slide_soft\");\n        }\n      }\n      // Slide sound and visual for Pillar\n      if (el.isClass(Pillar)) {\n        // is horizontal push and goes to a place with empty bottom neighbour (which means is going to fall)\n        // or is falling to sides (falling over a non flat object) in which case x and y are differents\n        if (\n          (pos.x !== origin.x &&\n            this.isDestinationEmpty(pos.x, origin.y + 1)) ||\n          (pos.x !== origin.x && pos.y !== origin.y)\n        ) {\n          setTimeout(\n            () =>\n              el.alien?.play(\n                pos.x > origin.x ? \"pillar_roll_right\" : \"pillar_roll_left\"\n              ),\n            TICK_TIME / 2\n          );\n        }\n        if (pos.x !== origin.x) {\n          this.scene.events.emit(\"sounds:rock_slide_hard\");\n        }\n      }\n      // roll visual for Jewel\n      if (pos.x !== origin.x && el.isClass(Jewel)) {\n        el.alien.once(Phaser.Animations.Events.ANIMATION_COMPLETE, () => {\n          el.alien.play(\"diamond_idle\");\n          el.shine.play(\"diamond_shine\");\n        });\n        el.shine.stop()\n        el.alien.play(\n          pos.x > origin.x ? \"diamond_roll_right\" : \"diamond_roll_left\"\n        );\n      }\n    }\n\n    // this.runScheduledActions()\n  }\n  pause() {\n    this.isPaused = true;\n    this.player.moveIntentDir = \"\";\n    this.player.animIdle();\n  }\n  resume() {\n    this.isPaused = false;\n    // resume parallel gravity\n    this.gravityLoop(this.parallelMovables);\n  }\n  destroy() {}\n  onCharacterDie(el) {\n    this.setObjectAt(\n      el.position.x,\n      el.position.y,\n      new Empty(PIXEL_NAME.EMPTY, this)\n    );\n    this.moveables = this.moveables.filter((e) => e !== el);\n    if (el.isClass(Player)) {\n      el.moveIntentDir = \"\";\n      // this.player = null\n      this.scene.levels.restart();\n    }\n  }\n  onJewelPick(el) {\n    this.setObjectAt(\n      el.position.x,\n      el.position.y,\n      new Empty(PIXEL_NAME.EMPTY, this)\n    );\n    this.moveables = this.moveables.filter((e) => e !== el);\n    this.collectedDiamonds++;\n    this.scene.events.emit(\"score:diamond_set\", this.collectedDiamonds);\n    if (this.diamondsGoal > 0 && this.diamondsGoal <= this.collectedDiamonds) {\n      this.destroyBlock();\n      // UI update\n      this.scene.events.emit(\"score:diamond_goal\");\n      this.scene.events.emit(\"sounds:coin\");\n    }\n  }\n  destroyBlock() {\n    // on goal reached\n    // remove exit block\n    const exit = Object.values(this.interactiveElements).find((el) =>\n      el?.isClass(Exit)\n    );\n    if (exit?.block) {\n      this.onDestroyElement(exit.block);\n      exit.block.alien.destroy();\n    }\n  }\n  onMushroomPick(el) {\n    this.setObjectAt(\n      el.position.x,\n      el.position.y,\n      new Empty(PIXEL_NAME.EMPTY, this)\n    );\n    this.moveables = this.moveables.filter((e) => e !== el);\n    this.collectedShrooms = +1;\n  }\n  onEnemyKill(el) {\n    this.killedEnemies++;\n  }\n  onDestroyElement(el) {\n    this.setObjectAt(\n      el.position.x,\n      el.position.y,\n      new Empty(PIXEL_NAME.EMPTY, this)\n    );\n    this.moveables = this.moveables.filter((e) => e !== el);\n    this.parallelMovables = this.parallelMovables.filter((e) => e !== el);\n  }\n  replaceByEmpty(el) {\n    const emptyPlace = new Empty(PIXEL_NAME.EMPTY, this);\n    emptyPlace.setPosition(el.position);\n    const objectInDestination = this.getObjectAt(el.position.x, el.position.y);\n    // validation to prevent emptying another object that take place before this method is called.\n    // happens in case of barrels exploding by fallable. Barrel has a half tick delay from overrun to explode.\n    // that half tick offset makes the place in the grid to get filled with the overruner object\n    if (objectInDestination === el) {\n      this.setObjectAt(el.position.x, el.position.y, emptyPlace);\n      // this.moveables = this.moveables.filter(e => e === el)\n    }\n  }\n  onExplode(el) {\n    // moved into Barrel class\n  }\n  cleanLevel() {\n    this.scene.events.off(\"player_moves\");\n    this.scene.events.off(\"dialogue:hidden\");\n    this.scene.events.off(\"dialogue:message_shown\");\n    this.objects.forEach((row) =>\n      row.forEach((el) => {\n        if (el.alien) {\n          el.alien.destroy();\n          el.alien = null;\n        }\n      })\n    );\n  }\n  onComplete() {\n    this.pause();\n\n    const levelData = dbManager.get(this.constructor.key);\n\n    if (levelData) {\n      this.prevBest = levelData?.comp;\n    }\n    const comp = this.scene.rules.calcCompletion(\n      this.countDiamonds,\n      this.collectedDiamonds,\n      this.countEnemies,\n      this.killedEnemies,\n      this.countShrooms,\n      Math.max(this.collectedShrooms, 0)\n    );\n    const newLevelData = {\n      countDiamonds: this.countDiamonds,\n      collectedDiamonds: this.collectedDiamonds,\n      countEnemies: this.countEnemies,\n      killedEnemies: this.killedEnemies,\n      countShrooms: this.countShrooms,\n      collectedShrooms: Math.max(this.collectedShrooms, 0),\n      comp,\n      prevBest: this.prevBest,\n    };\n    if (!levelData || (levelData && newLevelData.comp >= levelData.comp)) {\n      dbManager.set(this.constructor.key, newLevelData);\n    }\n    // updates global shroom counter\n    dbManager.set(\n      \"totalShroomsAmount\",\n      this.totalShroomsAmount + this.collectedShrooms\n    );\n    // updates level shroom counts even if is not the best completion score\n    const storedData = dbManager.get(this.constructor.key);\n    // in case of shroom given the counter could be lower than 0\n    storedData.collectedShrooms = Math.max(0, this.collectedShrooms);\n    dbManager.set(this.constructor.key, storedData);\n\n    this.scene.events.emit(\"levelcompleted\", newLevelData);\n  }\n  onInteractWith(el) {\n    if (el.ephemeral) {\n      this.interactiveElements[`${el.position.x}-${el.position.y}`] = null;\n    }\n  }\n  onAddElement(el) {\n    console.warn(`implement element added ${this.id}`);\n  }\n  getPlayerPos() {\n    return this.focusElement.position;\n  }\n  getConfigAt(x, y) {\n    return this.isDestinationInBounds(x, y) && this.config[y][x];\n  }\n  getCoords(id) {\n    const found = [];\n    for (let i = 0; i < this.config.length; i++) {\n      for (let j = 0; j < this.config[i].length; j++) {\n        if (this.config[i][j] === id) {\n          found.push({ x: j, y: i });\n        }\n      }\n    }\n    return found;\n  }\n  getObjectAt(x, y) {\n    return this.isDestinationInBounds(x, y) && this.objects[y][x];\n  }\n  setObjectAt(x, y, obj) {\n    this.objects[y][x] = obj;\n  }\n  isPositionClear(x, y) {\n    return this.getObjectAt(x, y).isEmpty;\n  }\n  isDestinationInBounds(x, y) {\n    const xInBounds = x < this.config[0].length && x >= 0;\n    const yInBounds = y < this.config.length && y >= 0;\n    return xInBounds && yInBounds;\n  }\n  objectIsEmpty(el) {\n    return el && el.isClass(Empty);\n  }\n  isDestinationEmpty(x, y) {\n    return this.getObjectAt(x, y).isEmpty;\n  }\n\n  async playEarthquake(range, intensity = 3) {\n    this.player.disconnect();\n    await this.shakeCamera(intensity);\n    const probability =\n      intensity === 4\n        ? 1\n        : intensity === 3\n        ? 0.75\n        : intensity === 2\n        ? 0.5\n        : 0.25;\n    this.destroyObjectsInRange(range, probability);\n    this.player.reconnect();\n  }\n\n  destroyObjectsInRange(range, probability) {\n    for (let y = range.y1; y < range.y2; y++) {\n      for (let x = range.x1; x <= range.x2; x++) {\n        // remove interactive in zone\n        if (this.interactiveElements[`${x}-${y}`]) {\n          this.interactiveElements[`${x}-${y}`] = null;\n        }\n        const toDestroy = this.getObjectAt(x, y);\n        const strengthEnough = Math.random() < probability;\n        if (\n          strengthEnough &&\n          toDestroy &&\n          (toDestroy.isClass(Ground) || toDestroy.isClass(Debris))\n        ) {\n          toDestroy.overrunBy();\n          this.onDestroyElement(toDestroy);\n        }\n      }\n    }\n  }\n\n  shakeCamera(intensity) {\n    const camera = this.scene.cameras.main;\n    this.fx = this.scene.sound.add(\"earthquake\");\n    const length = 2500;\n    const strength = 0.005 * intensity;\n    camera.shake(length, strength);\n    this.fx.play();\n\n    return new Promise((res) => {\n      setTimeout(res, length);\n    });\n  }\n\n  updatePositionsOnScale() {\n    const layer = this.scene.children.getByName(\"layer_1\");\n    const { tilemap: map } = layer;\n    this.moveables.forEach((mv) => {\n      if (mv.alien) {\n        mv.alien.setPosition(\n          map.tileToWorldX(mv.position.x),\n          map.tileToWorldY(mv.position.y)\n        );\n      }\n    });\n    // fix angel position\n    const exit = Object.values(this.interactiveElements).find((el) =>\n      el?.isClass(Exit)\n    );\n    exit.block?.alien.setPosition(\n      map.tileToWorldX(exit.position.x - 2),\n      map.tileToWorldY(exit.position.y)\n    );\n\n    Object.values(this.decorationElements).forEach((el) => {\n      el.alien.x = UI.tileToScreen(el.position.x);\n      el.alien.y = UI.tileToScreen(el.position.y);\n    });\n  }\n  setTickTimeout(callback, ticks) {\n    let tickDelayToTrigger = ticks;\n    const onTick = (lvl) => {\n      if (tickDelayToTrigger-- === 0) {\n        callback(lvl);\n      } else {\n        lvl.onNextTick((level) => onTick(level));\n      }\n    };\n    onTick(this);\n  }\n  awaitTicks(amountOfTicks) {\n    return new Promise((res) => this.setTickTimeout(res, amountOfTicks));\n  }\n  async teleportObject(el, position) {\n    el.alien.alpha = 0\n    this.moveObject(el, position)\n    el.setPosition(position)\n    await this.awaitTicks(3)\n    el.alien.alpha = 1\n  }\n}\n\nexport default Level;\n","import LevelBase from \"./levelBase\";\nimport { Enemy, Exit, Ground, Interactive, NPCharacter, Player, Wall } from \"../objects\";\nimport { translate } from \"../../utils/localization\";\nimport { PIXEL_NAME, PIXEL_TO_TILEMAP_POSITION } from \"../../utils/constants\";\nimport Debris from \"../objects/Debris\";\n\nclass LevelTest extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The test\";\n    this.diamondsGoal = 9;\n  }\n\n  get id() {\n    return this.constructor.key;\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n    this.scene.input.keyboard.addListener(\"keyup\", this.onKeyUp.bind(this));\n\n  }\n\n  onKeyUp(event) {\n    if (event.key === \"1\") {\n      this.showDialog1();\n    }\n    if (event.key === \"2\") {\n      this.showDialog2();\n    }\n    if (event.key === \"3\") {\n      this.showDialog3();\n    }\n    if (event.key === \"4\") {\n      this.showDialog4();\n    }\n    if (event.key === \"5\") {\n      this.scene.events.emit(\"dialogue:updateCharacterName\");\n    }\n  }\n\n  showDialog1() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\"],\n      participantNames: [\"Mary\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_1.dialog_1.mary_say_1\")],\n          options: [],\n        },\n      ],\n    });\n  }\n\n  showDialog2() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_1.dialog_1.mary_say_1\")],\n          options: [],\n        },\n      ],\n    });\n  }\n\n  showDialog3() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Marduk\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Marduk\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_1.dialog_1.mary_say_1\")],\n          options: [],\n        },\n      ],\n    });\n  }\n\n  showDialog4() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\n        \"closeUp_Mary\",\n        \"closeUp_Marduk\",\n        \"closeUp_Dwarf\",\n        \"closeUp_Tiamat\",\n      ],\n      participantNames: [\"Mary\", \"Marduk\", \"Doc\", \"Tiamat\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_1.dialog_1.mary_say_1\")],\n          options: [],\n        },\n      ],\n    });\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n\n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n    if (el.isClass(Interactive)) {\n      // if(this.interactiveCounts === this.quakeTriggerIndex) {\n      //   const areaWidth = 17\n      //   const areaHeight = 11\n      //   this.playEarthquake({\n      //     x1: this.playerOriginPosition.x - areaWidth - 1,\n      //     x2: this.playerOriginPosition.x - 1,\n      //     y1: el.position.y - areaHeight,\n      //     y2: this.playerOriginPosition.y\n      //   }, 3);\n      // }\n      // this.interactiveCounts++\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n  }\n\n  // showDialog1() {\n  //   this.scene.events.emit('dialogue:show', {\n  //     participants: ['closeUp_Mary', 'closeUp_Dwarf'],\n  //     conversation: [\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_1.mary_say_1')],\n  //       },\n  //       {\n  //         who: 'closeUp_Dwarf',\n  //         text: [translate('level_6.dialog_1.dwarf_say_1')],\n  //       },\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_1.mary_say_2')],\n  //       },\n  //       {\n  //         who: 'closeUp_Dwarf',\n  //         text: [translate('level_6.dialog_1.dwarf_say_2')],\n  //       },\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_1.mary_say_3')],\n  //       },\n  //       {\n  //         who: 'closeUp_Dwarf',\n  //         text: [translate('level_6.dialog_1.dwarf_say_3')],\n  //       },\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_1.mary_say_4')],\n  //       },\n  //       {\n  //         who: 'closeUp_Dwarf',\n  //         text: [translate('level_6.dialog_1.dwarf_say_4')],\n  //       },\n  //       {\n  //         who: 'closeUp_Dwarf',\n  //         text: [translate('level_6.dialog_1.dwarf_say_5')],\n  //       },\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_1.mary_say_5')],\n  //       },\n  //     ]\n  //   })\n\n  //   this.scene.events.once('dialogue:hidden', () => {\n  //     this.player.disconnect()\n  //     this.dwarfRun = true\n  //     this.moveDwarf()\n  //   })\n  // }\n  // showDialog2() {\n  //   this.scene.events.emit('dialogue:show', {\n  //     participants: ['closeUp_Mary'],\n  //     conversation: [\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_2.mary_say_1')],\n  //       },\n  //     ],\n  //   })\n  // }\n\n  // moveDwarf() {\n  //   // hack to auto move dwarf until pos x is 10\n  //   if (this.dwarfRun) {\n  //     if (this.leader.position.x < 16) {\n  //       this.leader.onPlayerMoves(this.player.position);\n  //       this.onNextTick(() => {\n  //         this.leader.animIdle()\n  //         this.moveDwarf()\n  //       });\n  //     } else {\n  //       this.leader.animIdle()\n  //       // auto pilot off\n  //       this.player.reconnect()\n\n  //       // listen for player move until dwarf reach last position of path, then\n  //       // remove fix of dwarfRun and remove listener\n  //       const onPlayerMove = (() => {\n  //         if (this.leader.position.x >= 30) {\n  //           this.dwarfRun = false\n  //           this.scene.events.removeListener('player_moves', onPlayerMove)\n  //         }\n  //       }).bind(this)\n  //       this.scene.events.addListener('player_moves', onPlayerMove )\n  //     }\n  //   }\n  // }\n\n}\n\nLevelTest.key = 'level_test'\nexport default LevelTest;\n","import LevelBase from './levelBase'\nimport { Interactive, Exit, Jewel } from '../objects'\n// import { PIXEL_TO_TILEMAP_POSITION, PIXEL_NAME } from '../../utils/constants'\nimport { translate } from '../../utils/localization'\nimport { SCALE } from '../../utils/constants'\nimport UI from '../UI'\n\nclass Level2 extends LevelBase {\n  constructor() {\n    super()\n    this.name = 'The wise move'\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene)\n    \n    if(this.unfinished) {\n      scene.events.once('levelstart', () => this.showDialog1())\n    }\n\n    let light_beam = this.scene.add.image(\n      this.scene.cameras.main.width / 2,\n      this.scene.cameras.main.height / 2,\n      \"light_beam\"\n    );\n    light_beam.x = UI.tileToScreen(14);\n    light_beam.y = UI.tileToScreen(0);\n    light_beam.setOrigin(0, 0);\n    light_beam.setScale(SCALE * 2);\n    light_beam.scaleX = SCALE * 2.4;\n    light_beam.setScrollFactor(1);\n    light_beam.depth = 4.5;\n    light_beam.alpha = 0.5;\n\n    var particles = scene.add.particles(\"spark\").setScale(SCALE);\n    var emitter = particles.createEmitter();\n    emitter.setPosition(\n      { min: UI.tileToPixels(17), max: UI.tileToPixels(28) },\n      { min: UI.tileToPixels(0), max: UI.tileToPixels(15) }\n    );\n    emitter.setQuantity(5);\n    emitter.setFrequency(20000);\n    emitter.setAngle({ min: 0, max: 360 });\n    emitter.setSpeed(5);\n    emitter.setGravityY(0.1);\n    emitter.setGravityX(0);\n    emitter.setLifespan({ min: 10000, max: 50000 });\n    emitter.alpha.onChange(0.5);\n  }\n\n  showDialog1() {\n    this.scene.events.emit('dialogue:show', {\n      participants: ['closeUp_Mary'],\n      participantNames: ['Mary'],\n      conversation: [\n        {\n          who: 'closeUp_Mary',\n          text: [\n            translate('level_2.dialog_1.mary_say_1')\n          ],\n          options: []\n        },\n      ]\n    })\n  }\n  showDialog2() {\n    this.scene.events.emit('dialogue:show', {\n      participants: ['closeUp_Mary'],\n      participantNames: ['Mary'],\n      conversation: [\n        {\n          who: 'closeUp_Mary',\n          text: [\n            translate('level_2.dialog_2.mary_say_1')\n          ],\n          options: []\n        },\n      ]\n    })\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el)\n    \n    if(el.isClass(Exit)) {\n      this.onComplete()\n    }\n  }\n  onJewelPick(el) {\n    super.onJewelPick(el)\n    if(el.isClass(Jewel) && this.collectedDiamonds === 1 && this.unfinished) {\n      this.showDialog2()\n    }\n  }\n}\n\nLevel2.key = 'level_2'\nexport default Level2\n","import LevelBase from \"./levelBase\";\nimport { Enemy, Exit } from \"../objects\";\nimport { Interactive } from \"../objects\";\nimport { translate } from \"../../utils/localization\";\nimport {\n  PIXEL_NAME,\n  PIXEL_TO_TILEMAP_POSITION,\n  SCALE,\n} from \"../../utils/constants\";\nimport UI from \"../UI\";\n\nclass Level3 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The tower\";\n    this.diamondsGoal = 0;\n  }\n\n  get id() {\n    return this.constructor.key;\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene)\n\n    let light_beam = this.scene.add.image(\n      this.scene.cameras.main.width / 2,\n      this.scene.cameras.main.height / 2,\n      \"light_beam\"\n    );\n    light_beam.x = UI.tileToScreen(20.5);\n    light_beam.y = UI.tileToScreen(10);\n    light_beam.setOrigin(0, 0);\n    light_beam.setScale(SCALE * 2);\n    light_beam.scaleX = SCALE;\n    light_beam.setScrollFactor(1);\n    light_beam.depth = 4.5;\n    light_beam.alpha = 0.5;\n\n    let particles = scene.add.particles(\"spark\").setScale(SCALE);\n    let emitter = particles.createEmitter();\n    emitter.setPosition(\n      { min: UI.tileToPixels(21), max: UI.tileToPixels(26) },\n      { min: UI.tileToPixels(9), max: UI.tileToPixels(24) }\n    );\n    emitter.setQuantity(5);\n    emitter.setFrequency(20000);\n    emitter.setAngle({ min: 0, max: 360 });\n    emitter.setSpeed(5);\n    emitter.setGravityY(0.1);\n    emitter.setGravityX(0);\n    emitter.setLifespan({ min: 10000, max: 50000 });\n    emitter.alpha.onChange(0.5);\n\n    // beam 2\n    light_beam = this.scene.add.image(\n      this.scene.cameras.main.width / 2,\n      this.scene.cameras.main.height / 2,\n      \"light_beam\"\n    );\n    light_beam.x = UI.tileToScreen(12.5);\n    light_beam.y = UI.tileToScreen(31);\n    light_beam.setOrigin(0, 0);\n    light_beam.setScale(SCALE * 2);\n    light_beam.scaleX = SCALE * 2.25;\n    light_beam.setScrollFactor(1);\n    light_beam.depth = 4.5;\n    light_beam.alpha = 0.5;\n\n    particles = scene.add.particles(\"spark\").setScale(SCALE);\n    emitter = particles.createEmitter();\n    emitter.setPosition(\n      { min: UI.tileToPixels(15), max: UI.tileToPixels(26) },\n      { min: UI.tileToPixels(29), max: UI.tileToPixels(44) }\n    );\n    emitter.setQuantity(5);\n    emitter.setFrequency(20000);\n    emitter.setAngle({ min: 0, max: 360 });\n    emitter.setSpeed(5);\n    emitter.setGravityY(0.1);\n    emitter.setGravityX(0);\n    emitter.setLifespan({ min: 10000, max: 50000 });\n    emitter.alpha.onChange(0.5);\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n    if (el.isClass(Interactive) && [1, 2].includes(el.order) && this.unfinished) {\n      this.showDialog1()\n      // ================================\n      // removes usless interactive spots\n      // ================================\n      Object.keys(this.interactiveElements).forEach((k) => {\n        // removes if is not the exit\n        const spot = this.interactiveElements[k]\n        if (spot && !spot.isClass(Exit) && spot.order <= 2) {\n          this.interactiveElements[k] = null;\n        }\n      });\n    }\n    if (el.isClass(Interactive) && el.order === 3) {\n      const layer = this.scene.children.getByName(\"layer_1\");\n      const { tilemap: map } = layer;\n      this.player.power = 1;\n      this.player.hasPickaxe = true;\n      map.putTileAt(\n        PIXEL_TO_TILEMAP_POSITION[PIXEL_NAME.EMPTY],\n        el.position.x,\n        el.position.y,\n        false,\n        \"layer_1\"\n      );\n      el.alien.destroy();\n\n      if(this.unfinished) {\n        this.showDialog4();\n      }\n    }\n  }\n\n  showDialog1() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\"],\n      participantNames: ['Mary'],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_3.dialog_1.mary_say_1\")],\n          options: [],\n        },\n      ],\n    });\n  }\n  \n  showDialog4() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\"],\n      participantNames: ['Mary'],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_3.dialog_4.mary_say_1\")],\n        },\n      ],\n    });\n  }\n\n  onAddElement(el) {\n\n    // add pickaxe\n    if (el.isClass(Interactive) && el.order === 3) {\n      const layer = this.scene.children.getByName(\"layer_1\");\n      const { tilemap: map } = layer;\n      const pickaxe = this.scene.add\n        .sprite(48, 16)\n        .setOrigin(0, 0.25)\n        .play(\"pickaxe_idle\");\n      pickaxe.setScale(layer.scaleX);\n      pickaxe.x = map.tileToWorldX(el.position.x);\n      pickaxe.y = map.tileToWorldY(el.position.y);\n\n      el.alien = pickaxe;\n    }\n\n\n    if (el.isClass(Enemy)) {\n      // make second enemy to run ACW so boulder can make it escape from blast\n      if (this.enemiesCount === 1) {\n        el.scanDirection = \"ACW\";\n      }\n    }\n\n  }\n  \n}\n\nLevel3.key = 'level_3'\nexport default Level3;\n","import LevelBase from './levelBase'\nimport { Enemy, Exit, Player } from '../objects'\nimport { Interactive } from \"../objects\";\nimport { translate } from '../../utils/localization';\n\nclass Level4 extends LevelBase {\n  constructor() {\n    super()\n    this.name = 'The round'\n    this.enemiesCount = 0\n    // countdown to trigger dialog after n moves after the quake\n    this.countDownAfterQuakeUntilMessage = null\n\n    // this.onPlayerMoves.bind(this)\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el)\n\n    // earthquake triggers\n    if ([0, 1, 2, 3, 4, 5, 6, 7].includes(el.order)) {\n      this.playEarthquake({ x1: el.position.x - 9,x2: el.position.x + 9, y1: el.position.y - 6, y2: el.position.y + 6 }, 1);\n\n      if(this.unfinished) {\n        this.countDownAfterQuakeUntilMessage = 4\n        this.scene.events.addListener('player_moves', this.onPlayerMoves, this )\n      }\n    }\n\n    if(el.isClass(Exit)) {\n      this.onComplete()\n    }\n  }\n  onPlayerMoves() {\n    if(this.countDownAfterQuakeUntilMessage !== null) {\n      this.countDownAfterQuakeUntilMessage--\n      if(this.countDownAfterQuakeUntilMessage === 0) {\n        this.showDialog1()\n\n        this.scene.events.removeListener('player_moves', this.onPlayerMove )\n      }\n    }\n  }\n\n  showDialog1() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\"],\n      participantNames: [\"Mary\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_4.dialog_1.mary_say_1\")],\n        },\n      ],\n    });\n  }\n  onAddElement(el) {\n    if(el.isClass(Player)) {\n      el.power = 1\n      el.hasPickaxe = true\n    }\n\n    if (el.isClass(Enemy)) {\n      this.enemiesCount++;\n      // make second enemy to run ACW so boulder can make it escape from blast\n      if (this.enemiesCount % 2 === 0) {\n        el.scanDirection = \"ACW\"\n      }\n    }\n  }\n\n}\n\nLevel4.key = 'level_4'\nexport default Level4\n","import Phaser from \"phaser\";\nimport LevelBase from \"./levelBase\";\nimport { Enemy, NPCharacter, Player } from \"../objects\";\nimport { Interactive } from \"../objects\";\nimport { translate } from \"../../utils/localization\";\n\nclass Level5 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The encounter\";\n    this.enemiesDeadCount = 0;\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n    \n    // removes dwarf if level was finished in the past\n    if (!this.unfinished) {\n      this.leader.alien.alpha = 0\n      this.replaceByEmpty(this.leader)\n    }\n  }\n  destroy() {\n    // this.scene.events.off('update', this.updateLight.bind(this))\n  }\n\n  updateLight() {\n    const layer = this.scene.children.getByName(\"layer_1\");\n    if (!layer) {\n      return true;\n    }\n    const map = layer.tilemap;\n    let origin = this.player.position;\n    this.moveables.forEach((el) => {\n      var dist = Phaser.Math.Distance.Snake(\n        origin.x,\n        origin.y,\n        el.position.x,\n        el.position.y\n      );\n\n      el.alien?.setAlpha(1 - 0.1 * dist);\n    });\n    map.forEachTile((tile) => {\n      var dist = Phaser.Math.Distance.Snake(origin.x, origin.y, tile.x, tile.y);\n\n      tile.setAlpha(1 - 0.1 * dist);\n    });\n  }\n\n  onInteractWith(el) {\n    if (el.order === 0) {\n      this.onComplete();\n    }\n  }\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n    if (el.isClass(NPCharacter)) {\n      el.leadingPath = [\n        { x: 8, y: 36 },\n        { x: 9, y: 36 },\n        { x: 10, y: 36 },\n        { x: 11, y: 36 },\n        { x: 11, y: 37 },\n        { x: 11, y: 38 },\n        { x: 11, y: 39 },\n        { x: 11, y: 40 },\n        { x: 12, y: 40 },\n        { x: 13, y: 40 },\n        { x: 14, y: 40 },\n        { x: 14, y: 39 },\n        { x: 14, y: 38 },\n        { x: 15, y: 38 },\n        { x: 16, y: 38 },\n        { x: 17, y: 38 },\n        { x: 18, y: 38 },\n        { x: 19, y: 38 },\n        { x: 20, y: 38 },\n        { x: 21, y: 38 },\n        { x: 22, y: 38 },\n        { x: 23, y: 38 },\n        { x: 24, y: 38 },\n        { x: 25, y: 38 },\n        { x: 26, y: 38 },\n        { x: 27, y: 38 },\n        { x: 28, y: 38 },\n        { x: 29, y: 38 },\n        { x: 30, y: 38 },\n      ];\n      el.isCloseEnough = () => this.dwarfRun;\n    }\n  }\n\n  onCharacterDie(el) {\n    super.onCharacterDie(el);\n    if (el.isClass(Enemy)) {\n      this.enemiesDeadCount++;\n\n      if (this.enemiesDeadCount === 1 && this.unfinished) {\n        // disconnect user\n        this.player.disconnect();\n      }\n      if (this.enemiesDeadCount === 2 && this.unfinished) {\n        // after killing the second enemy\n        this.encounter();\n      }\n    }\n  }\n\n  encounter() {\n    // move npc\n    this.dwarfRun = true;\n    this.onNextTick(this.moveDwarf.bind(this));\n    // show dialog\n  }\n\n  moveDwarf() {\n    // hack to auto move dwarf until pos x is 10\n    if (this.dwarfRun) {\n      if (this.leader.position.x < 11) {\n        this.leader.onPlayerMoves(this.player.position);\n        this.onNextTick(this.moveDwarf.bind(this));\n      } else {\n        if (!this.leader.alien.anims.currentAnim.key.includes(\"idle\")) {\n          this.leader?.animIdle();\n        }\n        this.player.reconnect();\n        this.showDialog1();\n      }\n    }\n  }\n\n  showDialog1() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"???\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_5.dialog_1.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_5.dialog_1.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_5.dialog_1.mary_say_2\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_5.dialog_1.dwarf_say_2\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_5.dialog_1.mary_say_3\")],\n        },\n      ],\n    });\n  }\n}\n\nLevel5.key = \"level_5\";\nexport default Level5;\n","import LevelBase from \"./levelBase\";\nimport { Exit, NPCharacter, Player } from \"../objects\";\nimport { translate } from \"../../utils/localization\";\nimport template from \"lodash.template\";\nimport UI from \"../UI\";\nimport { TICK_TIME } from \"../../utils/constants\";\n\nclass Level6 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The deal\";\n    this.diamondsGoal = 10;\n    this.dwarfRun = false;\n    this.preventDisplayDiamondsGoalAmount = true;\n    this.diamondIdTriggerDwarfMove = 4;\n    this.exit = null;\n    this.interactiveTileCloseToExit = null;\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n    if (this.unfinished) {\n      // erase method to animate exit destruction after talk to dwarf\n      this.destroyBlock = () => false;\n    } else {\n      // removes dwarf if level was finished in the past\n      this.leader.alien.alpha = 0;\n      this.replaceByEmpty(this.leader);\n    }\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n    // talk to Doc\n    if (el.order === 0 && this.unfinished) {\n      this.showDialog1();\n    }\n    // close to angel\n    if (el.order === 1 && this.unfinished) {\n      if (this.interactiveTileCloseToExit.ephemeral) {\n        // dwarf is not in front of the angel\n        this.showDialog2();\n      } else {\n        // talk to dwarf\n        // if(this.collectedDiamonds >= 2) {\n        if (this.collectedDiamonds >= this.diamondsGoal) {\n          this.showDialog3();\n        } else {\n          this.showDialog4();\n        }\n      }\n    }\n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n\n    if (el.isClass(Exit)) {\n      this.exit = el;\n    }\n\n    // close to angel\n    if (el.order === 1) {\n      this.interactiveTileCloseToExit = el;\n    }\n\n    if (el.isClass(NPCharacter)) {\n      el.leadingPath = [\n        // 10, 8\n        { x: 10, y: 9 },\n        { x: 11, y: 9 },\n        { x: 12, y: 9 },\n        { x: 12, y: 10 },\n        { x: 12, y: 10 },\n        { x: 12, y: 10 },\n        { x: 13, y: 11 },\n        { x: 13, y: 11 },\n        { x: 13, y: 11 },\n        { x: 14, y: 12 },\n        { x: 15, y: 12 },\n        { x: 16, y: 12 },\n        { x: 17, y: 12 },\n        { x: 18, y: 12 },\n        { x: 18, y: 11 },\n        { x: 19, y: 11 },\n        { x: 20, y: 11 },\n        { x: 21, y: 11 },\n        { x: 22, y: 11 },\n        { x: 23, y: 11 },\n        { x: 24, y: 11 },\n        { x: 25, y: 11 },\n        { x: 26, y: 11 },\n        { x: 27, y: 11 },\n        { x: 28, y: 11 },\n        { x: 29, y: 11 },\n        { x: 30, y: 11 },\n      ];\n      el.isCloseEnough = () => this.dwarfRun;\n    }\n  }\n  onJewelPick(el) {\n    super.onJewelPick(el);\n    if (el.order === this.diamondIdTriggerDwarfMove) {\n      const nextPos = { x: this.exit.position.x - 3, y: this.exit.position.y };\n\n      // teleport dwarf\n      this.teleportObject(this.leader, nextPos)\n      // -----\n\n      if (\n        !this.interactiveElements[\n          `${this.interactiveTileCloseToExit.position.x}-${this.interactiveTileCloseToExit.position.y}`\n        ]\n      ) {\n        // restore erased interactive tile\n        this.interactiveTileCloseToExit.ephemeral = false;\n        this.interactiveElements[\n          `${this.interactiveTileCloseToExit.position.x}-${this.interactiveTileCloseToExit.position.y}`\n        ] = this.interactiveTileCloseToExit;\n      } else {\n        // make it permanent\n        this.interactiveTileCloseToExit.ephemeral = false;\n      }\n      console.log(this.interactiveTileCloseToExit);\n    }\n  }\n\n  showDialog1() {\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      this.scene.events.emit(\"score:diamond_goal_set\", this.diamondsGoal);\n    });\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"???\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_6.dialog_1.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_6.dialog_1.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_6.dialog_1.mary_say_2\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_6.dialog_1.dwarf_say_2\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_6.dialog_1.mary_say_3\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_6.dialog_1.dwarf_say_3\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_6.dialog_1.mary_say_4\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_6.dialog_1.dwarf_say_4\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_6.dialog_1.dwarf_say_5\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_6.dialog_1.mary_say_5\")],\n        },\n      ],\n    });\n\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      this.player.disconnect();\n      this.dwarfRun = true;\n      this.moveDwarf();\n    });\n  }\n  showDialog2() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\"],\n      participantNames: [\"Mary\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_6.dialog_2.mary_say_1\")],\n        },\n      ],\n    });\n  }\n  showDialog3() {\n    this.scene.events.on(\"dialogue:message_shown\", (pageId) => {\n      if (pageId === 2) {\n        this.scene.events.emit(\"dialogue:updateCharacterName\", {\n          key: \"closeUp_Dwarf\",\n          name: \"Doc\",\n        });\n      }\n    });\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      // remove interactive tile\n      this.interactiveElements[\n        `${this.interactiveTileCloseToExit.position.x}-${this.interactiveTileCloseToExit.position.y}`\n      ] = null;\n\n      // anim dwarf and angel dismiss\n      this.scene.tweens.add({\n        targets: this.exit.block.alien,\n        x: UI.tileToScreen(this.exit.position.x),\n        duration: TICK_TIME * 2,\n        onComplete: () => this.exit.block.alien.destroy(),\n      });\n\n      this.player.disconnect();\n      this.dwarfRun = true;\n      this.leader.leadingPath = [\n        { x: this.leader.position.x + 1, y: this.leader.position.y },\n        { x: this.leader.position.x + 1, y: this.leader.position.y },\n        { x: this.leader.position.x + 2, y: this.leader.position.y },\n        { x: this.leader.position.x + 2, y: this.leader.position.y },\n        { x: this.leader.position.x + 3, y: this.leader.position.y },\n        { x: this.leader.position.x + 3, y: this.leader.position.y },\n      ];\n      this.moveDwarfToExit();\n    });\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"???\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_6.dialog_3.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_6.dialog_3.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_6.dialog_3.mary_say_2\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_6.dialog_3.dwarf_say_2\")],\n        },\n      ],\n    });\n  }\n\n  showDialog4() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"???\"],\n      conversation: [\n        {\n          who: \"closeUp_Dwarf\",\n          text: [\n            template(translate(\"level_6.dialog_4.dwarf_say_1\"))({\n              NUM: this.collectedDiamonds,\n            }),\n          ],\n        },\n      ],\n    });\n  }\n\n  moveDwarf() {\n    // hack to auto move dwarf until pos x is 10\n    if (this.dwarfRun) {\n      if (this.leader.position.x < 16) {\n        this.leader.onPlayerMoves(this.player.position);\n        this.onNextTick(() => {\n          this.leader.animIdle();\n          this.moveDwarf();\n        });\n      } else {\n        this.leader.animIdle();\n        // auto pilot off\n        this.player.reconnect();\n\n        // listen for player move until dwarf reach last position of path, then\n        // remove fix of dwarfRun and remove listener\n        const onPlayerMove = (() => {\n          if (this.leader.position.x >= 30) {\n            this.dwarfRun = false;\n            this.scene.events.removeListener(\"player_moves\", onPlayerMove);\n          }\n        }).bind(this);\n        this.scene.events.addListener(\"player_moves\", onPlayerMove);\n      }\n    }\n  }\n\n  moveDwarfToExit() {\n    // hack to auto move dwarf until pos x is 10\n    if (this.dwarfRun) {\n      if (this.leader.position.x < this.exit.position.x) {\n        this.onNextTick(() => {\n          this.leader.onPlayerMoves(this.player.position);\n          this.moveDwarfToExit();\n        });\n      } else {\n        this.leader.animIdle();\n        // auto pilot off\n        this.player.reconnect();\n      }\n    }\n  }\n}\n\nLevel6.key = \"level_6\";\nexport default Level6;\n","\nimport LevelBase from \"./levelBase\";\nimport { Exit, Interactive, NPCharacter, Player } from \"../objects\";\n\nclass Level7 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The dangerous chambers\";\n    this.diamondsGoal = 12;\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n    \n    // earthquake triggers\n    if (el.isClass(Interactive) && !el.isClass(Exit)) {\n      this.playEarthquake({ x1: el.position.x - 3,x2: el.position.x + 6, y1: el.position.y - 10, y2: el.position.y }, 2);\n    }\n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n\n    // if (el.isClass(NPCharacter)) {\n    //   el.leadingPath = [\n    //     // 10, 8\n    //     { x: 10, y: 9 },\n    //     { x: 11, y: 9 },\n    //     { x: 12, y: 9 },\n    //     { x: 12, y: 10 },\n    //     { x: 12, y: 10 },\n    //     { x: 12, y: 10 },\n    //     { x: 13, y: 11 },\n    //     { x: 13, y: 11 },\n    //     { x: 13, y: 11 },\n    //     { x: 14, y: 12 },\n    //     { x: 15, y: 12 },\n    //     { x: 16, y: 12 },\n    //     { x: 17, y: 12 },\n    //     { x: 18, y: 12 },\n    //     { x: 18, y: 11 },\n    //     { x: 19, y: 11 },\n    //     { x: 20, y: 11 },\n    //     { x: 21, y: 11 },\n    //     { x: 22, y: 11 },\n    //     { x: 23, y: 11 },\n    //     { x: 24, y: 11 },\n    //     { x: 25, y: 11 },\n    //     { x: 26, y: 11 },\n    //     { x: 27, y: 11 },\n    //     { x: 28, y: 11 },\n    //     { x: 29, y: 11 },\n    //     { x: 30, y: 11 },\n    //   ];\n    //   el.isCloseEnough = () => this.dwarfRun;\n    // }\n  }\n\n  // showDialog1() {\n  //   this.scene.events.emit('dialogue:show', {\n  //     participants: ['closeUp_Mary', 'closeUp_Dwarf'],\n  //     conversation: [\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_1.mary_say_1')],\n  //       },\n  //       {\n  //         who: 'closeUp_Dwarf',\n  //         text: [translate('level_6.dialog_1.dwarf_say_1')],\n  //       },\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_1.mary_say_2')],\n  //       },\n  //       {\n  //         who: 'closeUp_Dwarf',\n  //         text: [translate('level_6.dialog_1.dwarf_say_2')],\n  //       },\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_1.mary_say_3')],\n  //       },\n  //       {\n  //         who: 'closeUp_Dwarf',\n  //         text: [translate('level_6.dialog_1.dwarf_say_3')],\n  //       },\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_1.mary_say_4')],\n  //       },\n  //       {\n  //         who: 'closeUp_Dwarf',\n  //         text: [translate('level_6.dialog_1.dwarf_say_4')],\n  //       },\n  //       {\n  //         who: 'closeUp_Dwarf',\n  //         text: [translate('level_6.dialog_1.dwarf_say_5')],\n  //       },\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_1.mary_say_5')],\n  //       },\n  //     ]\n  //   })\n\n  //   this.scene.events.once('dialogue:hidden', () => {\n  //     this.player.disconnect()\n  //     this.dwarfRun = true\n  //     this.moveDwarf()\n  //   })\n  // }\n  // showDialog2() {\n  //   this.scene.events.emit('dialogue:show', {\n  //     participants: ['closeUp_Mary'],\n  //     conversation: [\n  //       {\n  //         who: 'closeUp_Mary',\n  //         text: [translate('level_6.dialog_2.mary_say_1')],\n  //       },\n  //     ],\n  //   })\n  // }\n\n  // moveDwarf() {\n  //   // hack to auto move dwarf until pos x is 10\n  //   if (this.dwarfRun) {\n  //     if (this.leader.position.x < 16) {\n  //       this.leader.onPlayerMoves(this.player.position);\n  //       this.onNextTick(() => {\n  //         this.leader.animIdle()\n  //         this.moveDwarf()\n  //       });\n  //     } else {\n  //       this.leader.animIdle()\n  //       // auto pilot off\n  //       this.player.reconnect()\n\n  //       // listen for player move until dwarf reach last position of path, then\n  //       // remove fix of dwarfRun and remove listener\n  //       const onPlayerMove = (() => {\n  //         if (this.leader.position.x >= 30) {\n  //           this.dwarfRun = false\n  //           this.scene.events.removeListener('player_moves', onPlayerMove)\n  //         }\n  //       }).bind(this)\n  //       this.scene.events.addListener('player_moves', onPlayerMove )\n  //     }\n  //   }\n  // }\n}\n\nLevel7.key = 'level_7'\nexport default Level7;\n","import LevelBase from \"./levelBase\";\nimport { Empty, Exit, Interactive, NPCharacter, Player } from \"../objects\";\nimport { translate } from \"../../utils/localization\";\nimport UI from \"../UI\";\nimport { PIXEL_NAME, SCALE, TICK_TIME } from \"../../utils/constants\";\nimport template from 'lodash.template'\nimport dbManager from \"../../utils/dbManager\";\n\nclass Level8 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The Sisyphean task\";\n    this.diamondsGoal = 40;\n    this.dwarf = null;\n    this.broSprite = null;\n    this.grayscalePipeline = null;\n    this.tripMusic = null\n    this.firstVisit = true\n    this.tookTheTrip = false\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n\n    this.focusElement = this.player;\n    this.tookTheTrip = dbManager.get('tripDone') || false\n\n    if(!this.tookTheTrip) {\n      this.broSprite = this.scene.add.sprite(48, 16).setOrigin(0, 0.25);\n      this.broSprite.setScale(SCALE);\n      this.broSprite.play(\"bro_idle\");\n      this.broSprite.x = this.dwarf.alien.x + UI.tileToScreen(12);\n      this.broSprite.y = this.dwarf.alien.y;\n  \n      this.grayscalePipeline = this.scene.renderer.pipelines.get(\"Gray\");\n      this.player.alien.setPipeline(this.grayscalePipeline);\n  \n      this.tripMusic = this.scene.sound.add('swarf_chat_music', { loop: true, valume: 0 })\n    } else {\n      // ===================\n      // removes NPC (dwarf)\n      // ===================\n      this.replaceByEmpty(this.leader);\n      this.leader.alien.destroy();\n      this.leader = null;\n      // ================================\n      // removes usless interactive spots\n      // ================================\n      Object.keys(this.interactiveElements).forEach(\n        (k) => {\n          // removes if is not the exit\n          if(!this.interactiveElements[k].isClass(Exit)) {\n            this.interactiveElements[k] = null\n          }\n        }\n      );\n    }\n  }\n\n  onComplete() {\n    dbManager.set('tripDone', this.tookTheTrip)\n    super.onComplete()\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n    // talk to Doc\n    if (el.order === 0) {\n      if(this.firstVisit) {\n        if(this.totalShroomsAmount > 0) {\n          this.showDialog1()\n        } else {\n          this.showDialog1NoShroom()\n        }\n      } else {\n        this.showDialog1Revisit()\n      }\n      this.firstVisit = false\n    }\n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n\n    if(el.isClass(Interactive)) {\n      el.ephemeral = false\n    }\n\n    if (el.isClass(NPCharacter)) {\n      el.isCloseEnough = () => false;\n      this.dwarf = el;\n    }\n  }\n\n  showDialog1NoShroom() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_8.dialog_1_no_shrooms.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_8.dialog_1_no_shrooms.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_8.dialog_1_no_shrooms.mary_say_2\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [template(translate(\"level_8.dialog_1_no_shrooms.dwarf_say_2\"))({NUM: 5})],\n        },\n      ]\n    })\n  }\n  showDialog1Revisit() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_8.dialog_1_repeat.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_8.dialog_1_repeat.mary_say_1\")],\n          options: {\n            slot0: {\n              label: translate(\"level_8.dialog_1_option.yes\"),\n              slot: 0,\n              onSelect: () => this.scene.events.emit(\"dialogue:nextPage\"),\n            },\n            slot1: {\n              label: translate(\"level_8.dialog_1_option.no\"),\n              slot: 1,\n              onSelect: () => this.scene.events.emit(\"dialogue:nextPage\", 1),\n            },\n            slot2: null,\n            slot3: null,\n          }\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_8.dialog_1_repeat.mary_say_2_yes\")],\n          options: {\n            slot2: null, // hide default NEXT option\n            slot3: {\n              label: translate(\"menu.dialog_options.close\"),\n              slot: 3,\n              onSelect: () => {\n                this.scene.events.emit(\"dialogue:hide\");\n                this.scene.events.once(\"dialogue:hidden\", () => {\n                  this.playTheTrip();\n                  this.scene.events.emit(\"score:mushroom_given\")\n                  this.collectedShrooms--\n                  // flag trip done in current level.\n                  // it will save in DB after level completes.\n                  this.tookTheTrip = true\n                });\n              },\n            },\n          },\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_8.dialog_1_repeat.mary_say_2_no\")],\n        },\n      ]\n    })\n  }\n  showDialog1() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_8.dialog_1.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_8.dialog_1.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_8.dialog_1.mary_say_2\")],\n          options: {\n            slot0: {\n              label: translate(\"level_8.dialog_1_option.yes\"),\n              slot: 0,\n              onSelect: () => this.scene.events.emit(\"dialogue:nextPage\"),\n            },\n            slot1: {\n              label: translate(\"level_8.dialog_1_option.no\"),\n              slot: 1,\n              onSelect: () => this.scene.events.emit(\"dialogue:nextPage\", 1),\n            },\n            slot2: null,\n            slot3: null,\n          },\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_8.dialog_1.mary_say_3_yes\")],\n          options: {\n            slot2: null, // hide default NEXT option\n            slot3: {\n              label: translate(\"menu.dialog_options.close\"),\n              slot: 3,\n              onSelect: () => {\n                this.scene.events.emit(\"dialogue:hide\");\n                this.scene.events.once(\"dialogue:hidden\", () => {\n                  this.playTheTrip();\n                  this.scene.events.emit(\"score:mushroom_given\")\n                  this.collectedShrooms--\n                  // flag trip done in current level.\n                  // it will save in DB after level completes.\n                  this.tookTheTrip = true\n                });\n              },\n            },\n          },\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_8.dialog_1.mary_say_3_no\")],\n        },\n      ],\n    });\n  }\n\n  showDialog2() {\n    return new Promise((res) => {\n      this.scene.events.emit(\"dialogue:show\", {\n        participants: [\"closeUp_Dwarf\", \"closeUp_Marduk\"],\n        participantNames: [\"Doc\", \"Marduk\"],\n        conversation: [\n          {\n            who: \"closeUp_Dwarf\",\n            text: [translate(\"level_8.dialog_2.dwarf_say_1\")],\n          },\n          {\n            who: \"closeUp_Marduk\",\n            text: [translate(\"level_8.dialog_2.marduk_say_1\")],\n          },\n          {\n            who: \"closeUp_Dwarf\",\n            text: [translate(\"level_8.dialog_2.dwarf_say_2\")],\n          },\n          {\n            who: \"closeUp_Marduk\",\n            text: [translate(\"level_8.dialog_2.marduk_say_2\")],\n          },\n          {\n            who: \"closeUp_Dwarf\",\n            text: [translate(\"level_8.dialog_2.dwarf_say_3\")],\n          },\n          {\n            who: \"closeUp_Marduk\",\n            text: [translate(\"level_8.dialog_2.marduk_say_3\")],\n          },\n          {\n            who: \"closeUp_Dwarf\",\n            text: [translate(\"level_8.dialog_2.dwarf_say_4\")],\n          },\n          {\n            who: \"closeUp_Dwarf\",\n            text: [translate(\"level_8.dialog_2.dwarf_say_5\")],\n          },\n          {\n            who: \"closeUp_Marduk\",\n            text: [translate(\"level_8.dialog_2.marduk_say_4\")],\n          },\n          {\n            who: \"closeUp_Dwarf\",\n            text: [translate(\"level_8.dialog_2.dwarf_say_6\")],\n          },\n          {\n            who: \"closeUp_Dwarf\",\n            text: [translate(\"level_8.dialog_2.dwarf_say_7\")],\n          },\n        ],\n      });\n\n      this.scene.events.once(\"dialogue:hidden\", () => {\n        setTimeout(res, 500);\n      });\n    });\n  }\n\n  showDialog3() {\n    return new Promise((res) => {\n      this.scene.events.emit(\"dialogue:show\", {\n        participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n        participantNames: [\"Mary\", \"Doc\"],\n        conversation: [\n          {\n            who: \"closeUp_Mary\",\n            text: [translate(\"level_8.dialog_3.mary_say_1\")],\n          },\n          {\n            who: \"closeUp_Dwarf\",\n            text: [translate(\"level_8.dialog_3.dwarf_say_1\")],\n          },\n          {\n            who: \"closeUp_Mary\",\n            text: [translate(\"level_8.dialog_3.mary_say_2\")],\n          },\n          {\n            who: \"closeUp_Dwarf\",\n            text: [translate(\"level_8.dialog_3.dwarf_say_2\")],\n          },\n        ],\n      });\n      this.scene.events.once(\"dialogue:hidden\", () => {\n        setTimeout(res, 500);\n      });\n    });\n  }\n\n  async playTheTrip() {\n    this.player.disconnect();\n    await this.animFadeOutLevel();\n    await this.moveCamera();\n    this.animPlayerAndDwarf();\n    await this.animBroEntrance();\n\n    await this.showDialog2();\n    await this.vanishBro();\n    await this.animDwarfMoveCloseToPlayer();\n    await this.showDialog3();\n\n    await this.vanishDwarf()\n\n    await this.animFadeInLevel()\n\n    this.restoreRegularGamePlay()\n  }\n  \n  restoreRegularGamePlay() {\n    // remove interactive element\n    this.interactiveElements[`${this.player.position.x}-${this.player.position.y}`] = null\n    // remove dwarf presence in map\n    this.setObjectAt(\n      this.dwarf.position.x,\n      this.dwarf.position.y,\n      new Empty(PIXEL_NAME.EMPTY, this)\n    )\n\n    this.player.reconnect()\n    this.focusElement = this.player\n  }\n\n  vanishDwarf() {\n    return new Promise((res) => {\n      // reposition player sprite\n      this.scene.tweens.add({\n        targets: this.player.alien,\n        x: this.player.alien.x + UI.tileToScreen(2),\n        duration: 3000,\n        ease: \"Linear\",\n        onComplete: () => {\n        },\n      });\n      // grayscale NPC\n      this.scene.tweens.add({\n        targets: [this.dwarf.alien],\n        duration: 3000,\n        alpha: 0,\n        x: this.dwarf.alien.x + UI.tileToScreen(2),\n        onComplete: res\n      })\n\n      // music transition\n      this.scene.tweens.add({\n        targets: this.scene.rules.music,\n        volume: 1,\n        delay: 1500,\n        ease: 'Linear',\n        duration: 1000,\n      });\n      \n      this.scene.tweens.add({\n        targets: this.tripMusic,\n        volume: 0,\n        ease: 'Linear',\n        duration: 1000,\n        onComplete: () => this.tripMusic.stop()\n      });\n    })\n  }\n\n  vanishBro() {\n    return new Promise((res) => {\n      this.scene.tweens.add({\n        targets: this.broSprite,\n        duration: 2000,\n        alpha: 0,\n        onComplete: res\n      });\n    });\n  }\n\n  async animBroEntrance() {\n    return new Promise((res) => {\n      // move bro\n      this.scene.tweens.add({\n        targets: this.broSprite,\n        x: this.broSprite.x - UI.tileToScreen(10),\n        duration: TICK_TIME * 10,\n        ease: \"Linear\",\n        delay: TICK_TIME * 10,\n        onComplete: () => {\n          this.player.animIdle();\n          this.dwarf.animIdle();\n          this.dwarf.animRunRight();\n          res();\n        },\n      });\n    });\n  }\n\n  animDwarfMoveCloseToPlayer() {\n    return new Promise((res) => {\n      this.dwarf.animRunLeft();\n      this.dwarf.animRun();\n\n      // move player left and play run right\n      this.scene.tweens.add({\n        targets: this.dwarf.alien,\n        x: this.dwarf.alien.x - UI.tileToScreen(1),\n        duration: TICK_TIME,\n        ease: \"Linear\",\n        onComplete: () => {\n          this.dwarf.animIdle();\n          this.dwarf.animRunRight();\n          // colorize player\n          this.scene.tweens.add({\n            targets: this.grayscalePipeline,\n            duration: 1000,\n            gray: 0,\n            completeDelay: 1000,\n            onComplete: res,\n          });\n        },\n      });\n    });\n  }\n\n  animPlayerAndDwarf() {\n    this.dwarf.animRunRight();\n    this.dwarf.animRun();\n\n    // move player left and play run right\n    this.scene.tweens.add({\n      targets: this.player.alien,\n      x: this.player.alien.x - UI.tileToScreen(2),\n      duration: TICK_TIME * 2,\n      ease: \"Linear\",\n      onComplete: () => {\n        this.player.animRun();\n      },\n    });\n  }\n\n  async moveCamera() {\n    // replace focus element (currently the player) for a position object with the same values\n    this.focusElement = {\n      position: { x: this.player.position.x, y: this.player.position.y },\n    };\n    return new Promise((res) => {\n      this.scene.tweens.add({\n        targets: this.focusElement.position,\n        x: this.dwarf.position.x + 5,\n        ease: \"Linear\",\n        duration: 1000,\n        onComplete: res\n      });\n    });\n  }\n\n  async animFadeInLevel() {\n    return new Promise((res) => {\n      this.scene.tweens.add({\n        targets: { alpha: 0 },\n        alpha: 1,\n        ease: \"Linear\",\n        duration: 2000,\n        onUpdate: (tween, target) => {\n          this.setLevelAlpha(target.alpha);\n        },\n        onComplete: res,\n      });\n    })\n  }\n  async animFadeOutLevel() {\n    return new Promise((res) => {\n      this.scene.tweens.add({\n        targets: this.grayscalePipeline,\n        delay: 1000,\n        duration: 1000,\n        gray: 1,\n      });\n      this.scene.tweens.add({\n        targets: { alpha: 1 },\n        alpha: 0,\n        ease: \"Linear\",\n        duration: 1000,\n        onUpdate: (tween, target) => {\n          this.setLevelAlpha(target.alpha);\n        },\n        onComplete: res,\n      });\n      // music transition\n      this.scene.tweens.add({\n        targets: this.scene.rules.music,\n        volume: 0,\n        ease: 'Linear',\n        duration: 1000,\n      });\n      this.tripMusic.volume = 0\n      this.tripMusic.play()\n      this.scene.tweens.add({\n        targets: this.tripMusic,\n        volume: 1,\n        delay: 500,\n        ease: 'Linear',\n        duration: 1000,\n      });\n    });\n  }\n\n  setLevelAlpha(value) {\n    const layer_1 = this.scene.children.getByName(\"layer_1\");\n    const layer_1z2 = this.scene.children.getByName(\"layer_1z2\");\n    const layer_2 = this.scene.children.getByName(\"layer_2\");\n    const layer_0 = this.scene.children.getByName(\"layer_0\");\n    const level_background_art = this.scene.children.getByName(\n      \"level_background_art\"\n    );\n    layer_1.setAlpha(value);\n    layer_1z2.setAlpha(value);\n    layer_2.setAlpha(value);\n    layer_0.setAlpha(value);\n    level_background_art.setAlpha(value / 4);\n    this.objects.forEach((row) =>\n      row.forEach((el) => {\n        if (el.alien && !el.isClass(Player) && !el.isClass(NPCharacter)) {\n          el.alien.setAlpha(value);\n        }\n      })\n    );\n    Object.values(this.decorationElements).forEach((el) =>\n      el.alien.setAlpha(value)\n    );\n  }\n\n}\n\nLevel8.key = \"level_8\";\nexport default Level8;\n","import LevelBase from \"./levelBase\";\nimport { Exit, Player } from \"../objects\";\n\nclass Level9 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The floodgates\";\n    this.diamondsGoal = 10;\n    // this.dwarfRun = false\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el)\n    \n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n\n  }\n\n}\n\nLevel9.key = 'level_9'\nexport default Level9;\n","import LevelBase from \"./levelBase\";\nimport { Empty, Exit, Interactive, NPCharacter, Player } from \"../objects\";\nimport EasyStar from \"easystarjs\";\nimport { translate } from \"../../utils/localization\";\nimport UI from \"../UI\";\nimport { TICK_TIME } from \"../../utils/constants\";\nimport template from \"lodash.template\";\n\nclass Level10 extends LevelBase {\n  constructor() {\n    super();\n    this.easystar = new EasyStar.js();\n    this.name = \"The castle\";\n    this.diamondsGoal = 10;\n    this.exit = null;\n    this.dwarf = null;\n    this.dwarfRun = false;\n  }\n\n  get id() {\n    return this.constructor.key;\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n\n    if (this.unfinished) {\n      // erase method to animate exit destruction after talk to dwarf\n      this.destroyBlock = () => false;\n\n      // Path finder to exit for Dwarf\n      const objectsAsKeys = this.objects.map((row) =>\n        row.map((el) => (el.isClass(NPCharacter) || el.isClass(Empty) ? 0 : 1))\n      );\n      this.easystar.setGrid(objectsAsKeys);\n      this.easystar.setAcceptableTiles([0]);\n\n      // console.log(this.leader.position, this.exit.position, objectsAsKeys);\n      this.easystar.findPath(\n        this.leader.position.x,\n        this.leader.position.y,\n        this.exit.position.x - 3,\n        this.exit.position.y,\n        (path) => {\n          this.leader.leadingPath = path.slice(1);\n        }\n      );\n      this.easystar.calculate();\n    } else {\n      // removes dwarf if level was finished in the past\n      this.leader.alien.alpha = 0;\n      this.replaceByEmpty(this.leader);\n    }\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n\n    // talk to Doc\n    if (el.order === 0 && this.unfinished) {\n      this.showDialog1();\n    }\n\n    // close to angel\n    if (el.order === 1 && this.unfinished) {\n      if(this.diamondsGoal <= this.collectedDiamonds) {\n        this.clearPath()\n      } else {\n        // fall short of diamonds\n        this.showDialog3()\n      }\n    }\n\n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n  }\n\n  showDialog1() {\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      this.player.disconnect();\n      // this.leader.isCloseEnough = () => this.dwarfRun;\n      this.dwarfRun = true;\n      this.moveDwarf();\n    });\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_10.dialog_1.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_10.dialog_1.dwarf_say_1\")],\n        },\n      ],\n    });\n  }\n\n  showDialog2() {\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      // remove listener since dwarf moves by himself\n      this.scene.events.off('player_moves')\n      // auto pilot off\n      this.player.reconnect();\n    });\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\"],\n      participantNames: [\"Mary\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_10.dialog_2.mary_say_1\")],\n        },\n      ],\n    });\n  }\n  \n  showDialog3() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Dwarf\",\n          text: [template(translate(\"level_10.dialog_3.dwarf_say_1\"))({ NUM: this.diamondsGoal })],\n        },\n      ],\n    });\n  }\n\n  moveDwarf() {\n    // hack to auto move dwarf\n    if (this.dwarfRun) {\n      if (!this.leader.leadingPath.length) {\n        this.dwarfRun = false;\n      }\n      \n      this.onNextTick(() => {\n        // hack: giving the leader position itself it will always return true for isCloseEnough calc since is closer than 3 blocks away.\n        this.leader.onPlayerMoves(this.leader.position);\n        // this.leader.animIdle();\n        this.moveDwarf();\n      });\n    } else {\n      this.leader.animIdle();\n    }\n    // shows dialog sonner to reduce player awaiting\n    if(this.leader.leadingPath.length === 10) {\n      this.leader.animIdle();\n      this.showDialog2();\n    }\n  }\n\n  clearPath() {\n    // anim dwarf and angel dismiss\n    this.scene.tweens.add({\n      targets: this.exit.block.alien,\n      x: UI.tileToScreen(this.exit.position.x),\n      duration: TICK_TIME * 2,\n      onComplete: () => this.exit.block.alien.destroy(),\n    });\n\n    this.leader.leadingPath = [\n      { x: this.leader.position.x + 1, y: this.leader.position.y },\n      { x: this.leader.position.x + 1, y: this.leader.position.y },\n      { x: this.leader.position.x + 2, y: this.leader.position.y },\n      { x: this.leader.position.x + 2, y: this.leader.position.y },\n      { x: this.leader.position.x + 3, y: this.leader.position.y },\n      { x: this.leader.position.x + 3, y: this.leader.position.y },\n    ];\n    this.player.disconnect();\n    this.dwarfRun = true;\n    this.moveDwarfToExit();\n  }\n\n  moveDwarfToExit() {\n    // hack to auto move dwarf\n    if (this.dwarfRun) {\n      if (this.leader.position.x < this.exit.position.x) {\n        this.onNextTick(() => {\n          this.leader.onPlayerMoves(this.leader.position);\n          // this.leader.animIdle();\n          this.moveDwarfToExit();\n        });\n      } else {\n        this.onNextTick(() => {\n          this.replaceByEmpty(this.leader)\n        });\n        // this.leader.animIdle();\n        // auto pilot off\n        this.player.reconnect();\n      }\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n      // // restore logic to allow overlap over exit interactive spot\n      // this.scene.events.once(\"score:diamond_goal\", () => el.canMove = el._canMove)\n    }\n\n    if (el.isClass(Exit)) {\n      this.exit = el;\n    }\n\n    if(el.isClass(Interactive) && el.order === 1) {\n      el.ephemeral = false\n      // once goal is reached, the interactive spot become ephemeral and it will be deleted after next interaction \n      this.scene.events.once(\"score:diamond_goal\", () => el.ephemeral = true)\n    }\n  }\n}\n\nLevel10.key = \"level_10\";\nexport default Level10;\n","import LevelBase from \"./levelBase\";\nimport { Empty, Exit, NPCharacter, Player } from \"../objects\";\nimport { translate } from \"../../utils/localization\";\nimport EasyStar from \"easystarjs\";\nimport UI from \"../UI\";\nimport { TICK_TIME } from \"../../utils/constants\";\nimport template from \"lodash.template\";\n\nclass Level11 extends LevelBase {\n  constructor() {\n    super();\n    this.easystar = new EasyStar.js();\n    this.name = \"The fallen city\";\n    this.diamondsGoal = 14;\n  }\n\n  get id() {\n    return this.constructor.key;\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n\n    if (this.unfinished) {\n      // erase method to animate exit destruction after talk to dwarf\n      this.destroyBlock = () => false;\n    }\n\n    // fisrt explosion\n    scene.events.once(\"barre:explode\", (el) => {\n      // TICK COUNTER TO DIALOG\n      this.setTickTimeout(lvl => lvl.showDialog2(), 5)\n    });\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n\n    if (el.order === 0 && this.unfinished) {\n      this.showDialog1();\n    }\n\n    if (el.order === 1 && this.unfinished) {\n      this.showDialog3()\n    }\n\n    if (el.order === 2 && this.unfinished) {\n      // move dwarf hidding it while travels\n      const nextPos = { x: this.exit.position.x - 3, y: this.exit.position.y };\n      this.leader.alien.alpha = 0;\n      this.moveObject(this.leader, nextPos);\n      setTimeout(() => {\n        this.leader.alien.alpha = 1;\n\n        // set up next trigger by proximity\n        this.scene.events.on(\"player_moves\", nextPos => {\n          if (this.leader.testProximity(nextPos, 1, true)) {\n            if(this.diamondsGoal <= this.collectedDiamonds) {\n              this.clearPath()\n              this.scene.events.off(\"player_moves\")\n            } else {\n              // fall short of diamonds\n              this.showDialog4()\n            }\n          }\n        })\n      }, 500);\n      // -----\n    }\n\n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n  }\n\n  showDialog1() {\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      // Path finder to exit for Dwarf\n      const objectsAsKeys = this.objects.map((row) =>\n        row.map((el) => (el.isClass(NPCharacter) || el.isClass(Empty) ? 0 : 1))\n      );\n      this.easystar.setGrid(objectsAsKeys);\n      this.easystar.setAcceptableTiles([0]);\n\n      // remove listener since dwarf moves by himself\n      this.scene.events.off(\"player_moves\");\n      this.player.disconnect();\n\n      this.easystar.enableDiagonals();\n      this.easystar.findPath(\n        this.leader.position.x,\n        this.leader.position.y,\n        1,\n        10,\n        (path) => {\n          this.leader.leadingPath = path.slice(1);\n          this.easystar.findPath(1, 10, 7, 18, (path) => {\n            // iterate leadingPath and duplicate when it moves in diagonal\n            const isDiagonal = (o, n) => o.x !== n.x && o.y !== n.y\n            this.leader.leadingPath = [\n              ...this.leader.leadingPath,\n              ...path.slice(1),\n            ].reduce((res, el, idx, src) => {\n              if(src[idx-1]) {\n                const prevEl = src[idx-1]\n                if(isDiagonal(el, prevEl)) {\n                  // repeats prev position\n                  res.push(prevEl)\n                }\n              }\n              res.push(el)\n              return res\n            },[])\n\n            this.dwarfRun = true;\n            this.moveDwarf();\n\n            // TICK COUNTER TO RECONNECT PLAYER\n            this.setTickTimeout(lvl => lvl.player.reconnect(), 4)\n          });\n          this.easystar.calculate();\n        }\n      );\n      this.easystar.calculate();\n\n      \n    });\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_11.dialog_1.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_11.dialog_1.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_11.dialog_1.mary_say_2\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_11.dialog_1.dwarf_say_2\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_11.dialog_1.dwarf_say_3\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_11.dialog_1.mary_say_3\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_11.dialog_1.dwarf_say_4\")],\n        },\n      ],\n    });\n  }\n\n  showDialog2() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\"],\n      participantNames: [\"Mary\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_11.dialog_2.mary_say_1\")],\n        },\n      ],\n    });\n  }\n  showDialog3() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_11.dialog_3.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_11.dialog_3.mary_say_1\")],\n        },\n      ],\n    });\n  }\n\n  showDialog4() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Dwarf\",\n          text: [template(translate(\"level_11.dialog_4.dwarf_say_1\"))({ NUM: this.diamondsGoal })],\n        },\n      ],\n    });\n  }\n\n  moveDwarf() {\n    // hack to auto move dwarf\n    if (this.dwarfRun) {\n      if (!this.leader.leadingPath.length) {\n        this.dwarfRun = false;\n      }\n\n      this.onNextTick(() => {\n        // hack: giving the leader position itself it will always return true for isCloseEnough calc since is closer than 3 blocks away.\n        this.leader.onPlayerMoves(this.leader.position);\n        // this.leader.animIdle();\n        this.moveDwarf();\n      });\n    } else {\n      this.leader.animIdle();\n    }\n  }\n\n  clearPath() {\n    // anim dwarf and angel dismiss\n    this.scene.tweens.add({\n      targets: this.exit.block.alien,\n      x: UI.tileToScreen(this.exit.position.x),\n      duration: TICK_TIME * 2,\n      onComplete: () => this.exit.block.alien.destroy(),\n    });\n\n    this.leader.leadingPath = [\n      { x: this.leader.position.x + 1, y: this.leader.position.y },\n      { x: this.leader.position.x + 1, y: this.leader.position.y },\n      { x: this.leader.position.x + 2, y: this.leader.position.y },\n      { x: this.leader.position.x + 2, y: this.leader.position.y },\n      { x: this.leader.position.x + 3, y: this.leader.position.y },\n      { x: this.leader.position.x + 3, y: this.leader.position.y },\n    ];\n    this.player.disconnect();\n    this.dwarfRun = true;\n    this.moveDwarfToExit();\n  }\n\n  moveDwarfToExit() {\n    // hack to auto move dwarf\n    if (this.dwarfRun) {\n      if (this.leader.position.x < this.exit.position.x) {\n        this.onNextTick(() => {\n          this.leader.onPlayerMoves(this.leader.position);\n          // this.leader.animIdle();\n          this.moveDwarfToExit();\n        });\n      } else {\n        this.onNextTick(() => {\n          this.replaceByEmpty(this.leader)\n        });\n        // this.leader.animIdle();\n        // auto pilot off\n        this.player.reconnect();\n      }\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n\n    if (el.isClass(NPCharacter)) {\n      el.leadingPath = [];\n    }\n\n    if(el.isClass(Exit)) {\n      this.exit = el\n    }\n  }\n}\n\nLevel11.key = \"level_11\";\nexport default Level11;\n","import LevelBase from \"./levelBase\";\nimport { Exit, Player } from \"../objects\";\n\nclass Level12 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"Time trial\";\n    this.diamondsGoal = 7;\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el)\n    \n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n\n  }\n\n}\n\nLevel12.key = 'level_12'\nexport default Level12;\n","import LevelBase from \"./levelBase\";\nimport { Exit, Interactive, Player } from \"../objects\";\nclass Level13 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"Risky business\";\n    this.diamondsGoal = 9;\n    this.interactiveCounts = 0\n    this.quakeTriggerIndex = Math.trunc(Math.random() * 100) % 4\n    this.playerOriginPosition = null\n  }\n\n  get id() {\n    return this.constructor.key;\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n    this.playerOriginPosition = {...this.player.position}\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el)\n    \n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n    if (el.isClass(Interactive)) {\n      if(this.interactiveCounts === this.quakeTriggerIndex) {\n        const areaWidth = 17\n        const areaHeight = 11\n        this.playEarthquake({\n          x1: this.playerOriginPosition.x - areaWidth - 1,\n          x2: this.playerOriginPosition.x - 1,\n          y1: el.position.y - areaHeight,\n          y2: this.playerOriginPosition.y\n        }, 3);\n      }\n      this.interactiveCounts++\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n\n  }\n\n}\nLevel13.key = 'level_13'\nexport default Level13;\n","import LevelBase from \"./levelBase\";\nimport { Exit, Player } from \"../objects\";\n\nclass Level14 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"Short fuse\";\n    this.diamondsGoal = 10;\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el)\n    \n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n\n  }\n\n}\n\nLevel14.key = 'level_14'\nexport default Level14;\n","import LevelBase from \"./levelBase\";\nimport { Exit, Player } from \"../objects\";\n\nclass Level15 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The catacomb\";\n    this.diamondsGoal = 15;\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el)\n    \n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n\n  }\n\n}\n\nLevel15.key = 'level_15'\nexport default Level15;\n","import LevelBase from \"./levelBase\";\nimport { Enemy, Exit, Interactive, Player } from \"../objects\";\nimport dbManager from \"../../utils/dbManager\";\nimport UI from \"../UI\";\nimport { SCALE, TICK_TIME } from \"../../utils/constants\";\nimport { translate } from \"../../utils/localization\";\nimport template from \"lodash.template\";\n\nclass Level16 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The sanctuary\";\n    this.diamondsGoal = 25;\n    // flag for alternative exit do not take effect until player go out and in again\n    this.wasInSanctuary = false;\n    // falg for dialogs\n    this.maryTalkedToDocAboutTheSactuary = false;\n    this.quakeTrigger = null;\n  }\n\n  get id() {\n    return this.constructor.key;\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n\n    // ====================\n    // sanctuary decoration\n    // ====================\n    // shadow text for SHAMASH\n    this.scene.add\n      .text(\n        UI.tileToScreen(this.follower.position.x - 0.3),\n        UI.tileToScreen(this.follower.position.y + 2.5),\n        \"𒀭𒌓\",\n        {\n          fontFamily: \"GameGirl\",\n          fill: \"#503F35\",\n          align: \"right\",\n        }\n      )\n      .setScale(SCALE);\n    // text for SHAMASH\n    this.scene.add\n      .text(\n        UI.tileToScreen(this.follower.position.x - 0.25),\n        UI.tileToScreen(this.follower.position.y + 2.55),\n        \"𒀭𒌓\",\n        {\n          fontFamily: \"GameGirl\",\n          fill: \"#947E6C\",\n          align: \"right\",\n        }\n      )\n      .setScale(SCALE);\n    if (this.unfinished) {\n      this.follower.isFollowing = false;\n      this.destroyBlock = () => false;\n      this.follower.animLayRight();\n    } else {\n      // ============================\n      // manually applys quake effect\n      // ============================\n\n      // removes debris\n      const removeDebris = (x, y) => {\n        let debris = this.getObjectAt(x, y);\n        debris.overrunBy();\n        this.replaceByEmpty(debris);\n      };\n      removeDebris(\n        this.quakeTrigger.position.x - 1,\n        this.quakeTrigger.position.y + 1\n      );\n      removeDebris(\n        this.quakeTrigger.position.x - 2,\n        this.quakeTrigger.position.y + 1\n      );\n      removeDebris(\n        this.quakeTrigger.position.x - 3,\n        this.quakeTrigger.position.y + 1\n      );\n\n      // removes ground\n      const removeGround = (x, y) => {\n        let ground = this.getObjectAt(x, y);\n        ground.overrunBy();\n        this.replaceByEmpty(ground);\n      };\n      removeGround(\n        this.quakeTrigger.position.x + 1,\n        this.quakeTrigger.position.y - 1\n      );\n      removeGround(\n        this.quakeTrigger.position.x + 2,\n        this.quakeTrigger.position.y - 1\n      );\n\n      // ============\n      // removes NPCs\n      // ============\n      this.follower.alien.destroy();\n      this.follower = null;\n      this.replaceByEmpty(this.leader);\n      this.leader.alien.destroy();\n      this.leader = null;\n\n      // ================================\n      // removes usless interactive spots\n      // ================================\n      Object.keys(this.interactiveElements).forEach(\n        (k) => {\n          // removes if is not the exit\n          if(!this.interactiveElements[k].isClass(Exit)) {\n            this.interactiveElements[k] = null\n          }\n        }\n      );\n      // this.interactiveElements[`${this.quakeTrigger.position.x}-${this.quakeTrigger.position.y}`] = null\n      // this.quakeTrigger.\n    }\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n\n    if (el.isClass(Exit)) {\n      if (this.unfinished) {\n        this.goToSanctuary();\n      } else {\n        this.onComplete();\n      }\n    }\n\n    // earthquake triggers\n    if (el.isClass(Interactive) && el.order === 0) {\n      this.playTheSighting(el);\n    }\n    // talk to dwarf\n    if (el.isClass(Interactive) && el.order === 2) {\n      const goalAchieved = this.collectedDiamonds >= this.diamondsGoal;\n      // removes interactive object since goal is achived\n      if (goalAchieved) {\n        this.interactiveElements[`${el.position.x}-${el.position.y}`] = null;\n      }\n\n      if (!this.maryTalkedToDocAboutTheSactuary) {\n        this.showDialog2();\n      } else {\n        this.showDialog2_repeat();\n      }\n    }\n    // sanctuary exit\n    if (el === this.sanctuaryEntrance && this.wasInSanctuary) {\n      this.onComplete();\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n    }\n\n    if (el.isClass(Enemy)) {\n      el.scanDirection = \"CCW\";\n    }\n\n    if (el.isClass(Interactive) && el.order === 2) {\n      el.ephemeral = false;\n    }\n\n    // quake trigger\n    if (el.isClass(Interactive) && el.order === 0) {\n      this.quakeTrigger = el;\n    }\n    // enter to the sanctuary\n    if (el.isClass(Interactive) && el.order === 1) {\n      el.ephemeral = false;\n      this.sanctuaryEntrance = el;\n    }\n\n    // add sanctuary entrance by clonning exit\n    if (el.isClass(Exit) && this.unfinished) {\n      const layer1z2 = this.scene.children.getByName(\"layer_1z2\");\n      const layer2 = this.scene.children.getByName(\"layer_2\");\n      layer2.copy(\n        el.position.x - 2,\n        el.position.y - 2,\n        5,\n        5,\n        this.sanctuaryEntrance.position.x - 2,\n        this.sanctuaryEntrance.position.y - 2\n      );\n      layer1z2.copy(\n        el.position.x - 2,\n        el.position.y - 2,\n        5,\n        5,\n        this.sanctuaryEntrance.position.x - 2,\n        this.sanctuaryEntrance.position.y - 2\n      );\n    }\n  }\n\n  async playTheSighting() {\n    await this.playEarthquake(\n      {\n        x1: this.player.position.x - 3,\n        x2: this.player.position.x + 3,\n        y1: this.player.position.y - 1,\n        y2: this.player.position.y + 2,\n      },\n      4\n    );\n    this.player.disconnect();\n    await this.awaitTicks(10);\n    this.player.animPushRight();\n    await this.awaitTicks(4);\n    this.player.animPushRight();\n    this.onNextTick(() => this.player.animPushRight());\n    await this.awaitTicks(4);\n    await this.showDialog1();\n    this.player.reconnect();\n  }\n\n  showDialog1() {\n    return new Promise((res) => {\n      this.scene.events.once(\"dialogue:hidden\", res);\n      this.scene.events.emit(\"dialogue:show\", {\n        participants: [\"closeUp_Mary\"],\n        participantNames: [\"Mary\"],\n        conversation: [\n          {\n            who: \"closeUp_Mary\",\n            text: [translate(\"level_16.dialog_1.mary_say_1\")],\n          },\n          {\n            who: \"closeUp_Mary\",\n            text: [translate(\"level_16.dialog_1.mary_say_2\")],\n          },\n          {\n            who: \"closeUp_Mary\",\n            text: [translate(\"level_16.dialog_1.mary_say_3\")],\n          },\n        ],\n      });\n    });\n  }\n\n  showDialog2() {\n    this.maryTalkedToDocAboutTheSactuary = true;\n    const goalAchieved = this.collectedDiamonds >= this.diamondsGoal;\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      if (goalAchieved) {\n        this.moveToExit();\n      }\n    });\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_16.dialog_2.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_16.dialog_2.dwarf_say_1\")],\n          options: {\n            slot2: {\n              label: translate(\"menu.dialog_options.next\"),\n              slot: 2,\n              onSelect: () => {\n                if (this.collectedDiamonds < this.diamondsGoal) {\n                  this.scene.events.emit(\"dialogue:nextPage\");\n                } else {\n                  this.scene.events.emit(\"dialogue:nextPage\", 1);\n                }\n              },\n            },\n          },\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [\n            template(translate(\"level_16.dialog_2.dwarf_say_2_diamonds\"))({\n              NUM: this.diamondsGoal,\n            }),\n          ],\n          options: {\n            slot2: null,\n          },\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_16.dialog_2.mary_say_2\")],\n        },\n      ],\n    });\n  }\n  showDialog2_repeat() {\n    const goalAchieved = this.collectedDiamonds >= this.diamondsGoal;\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      if (goalAchieved) {\n        this.moveToExit();\n      }\n    });\n    const goalAchievedConversation = {\n      who: \"closeUp_Mary\",\n      text: [translate(\"level_16.dialog_2_repeat.mary_say_1\")],\n    };\n    const goalMissingConversation = {\n      who: \"closeUp_Dwarf\",\n      text: [\n        template(translate(\"level_16.dialog_2_repeat_no_diamonds.dwarf_say_1\"))(\n          { NUM: this.diamondsGoal }\n        ),\n      ],\n    };\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        goalAchieved ? goalAchievedConversation : goalMissingConversation,\n      ],\n    });\n  }\n\n  async moveToExit() {\n    this.dwarfRun = true;\n    this.leader.leadingPath = [\n      { x: this.leader.position.x + 1, y: this.leader.position.y },\n      { x: this.leader.position.x + 1, y: this.leader.position.y },\n      { x: this.leader.position.x + 2, y: this.leader.position.y },\n      { x: this.leader.position.x + 2, y: this.leader.position.y },\n      { x: this.leader.position.x + 3, y: this.leader.position.y },\n      { x: this.leader.position.x + 3, y: this.leader.position.y },\n    ];\n\n    // anim angel dismiss\n    this.scene.tweens.add({\n      targets: this.exit.block.alien,\n      x: UI.tileToScreen(this.exit.position.x),\n      duration: TICK_TIME * 2,\n      onComplete: () => {\n        this.exit.block.alien.destroy();\n      },\n    });\n\n    // removes exit to avoid dwarf been destroyed on interact with it\n    this.interactiveElements[\n      `${this.exit.position.x}-${this.exit.position.y}`\n    ] = null;\n    this.exit.setPosition({\n      x: this.exit.position.x + 1,\n      y: this.exit.position.y,\n    });\n\n    this.moveDwarf();\n    await this.awaitTicks(this.leader.leadingPath.length);\n    await this.teleportObject(this.leader, this.sanctuaryEntrance.position);\n\n    // restores exit\n    this.exit.setPosition({\n      x: this.exit.position.x - 1,\n      y: this.exit.position.y,\n    });\n    this.interactiveElements[\n      `${this.exit.position.x}-${this.exit.position.y}`\n    ] = this.exit;\n  }\n\n  moveDwarf() {\n    // hack to auto move dwarf until pos x is 10\n    if (this.dwarfRun) {\n      // if (this.leader.position.x < this.exit.position.x) {\n      if (this.leader.leadingPath.length) {\n        this.onNextTick(() => {\n          this.leader.onPlayerMoves(this.leader.position);\n          // this.leader.animIdle();\n          this.moveDwarf();\n        });\n      } else {\n        this.dwarfRun = false;\n        this.leader.animIdle();\n      }\n    }\n  }\n  movePlayer() {\n    if (this.playerRun) {\n      this.onNextTick(() => {\n        if (this.player.moveToNextPosition()) {\n          this.movePlayer();\n        } else {\n          this.playerRun = false;\n        }\n      });\n    }\n  }\n\n  async goToSanctuary() {\n    this.player.disconnect();\n\n    this.focusElement = {\n      position: this.sanctuaryEntrance.position,\n    };\n    await this.awaitTicks(7);\n    this.follower.alien.alpha = 0;\n    await this.teleportObject(this.player, this.sanctuaryEntrance.position);\n\n    this.player.mandatoryPath = [\n      {\n        x: this.sanctuaryEntrance.position.x - 1,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 2,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 3,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 4,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 5,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 6,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 7,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 8,\n        y: this.sanctuaryEntrance.position.y,\n      },\n    ];\n\n    this.playerRun = true;\n    this.movePlayer();\n\n    // delay dwarf run so they keep 1 sapce bewteen\n    await this.awaitTicks(1);\n    this.leader.leadingPath = [\n      {\n        x: this.sanctuaryEntrance.position.x - 1,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 2,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 3,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 4,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 5,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 6,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 7,\n        y: this.sanctuaryEntrance.position.y,\n      },\n    ];\n    this.dwarfRun = true;\n    this.moveDwarf();\n\n    await this.awaitTicks(this.leader.leadingPath.length);\n    await this.awaitTicks(3);\n    this.showDialog3();\n  }\n\n  async moveDocToFinalExit() {\n    this.leader.leadingPath = [\n      {\n        x: this.sanctuaryEntrance.position.x,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 1,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 2,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 3,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 4,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 5,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 6,\n        y: this.sanctuaryEntrance.position.y,\n      },\n      {\n        x: this.sanctuaryEntrance.position.x - 7,\n        y: this.sanctuaryEntrance.position.y,\n      },\n    ].reverse();\n    this.dwarfRun = true;\n    this.moveDwarf();\n\n    await this.awaitTicks(this.leader.leadingPath.length + 2);\n    this.leader.alien.destroy();\n    this.leader.alien = null;\n    this.replaceByEmpty(this.leader);\n  }\n\n  showDialog3() {\n    this.scene.events.once(\"dialogue:hidden\", async () => {\n      this.wasInSanctuary = true;\n      await this.moveDocToFinalExit();\n      this.player.reconnect();\n    });\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_16.dialog_3.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_16.dialog_3.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_16.dialog_3.dwarf_say_2\")],\n        },\n      ],\n    });\n  }\n}\n\nLevel16.key = \"level_16\";\nexport default Level16;\n","import LevelBase from \"./levelBase\";\nimport { Exit, Interactive, Player, Torch } from \"../objects\";\nimport Phaser from \"phaser\";\nimport UI from \"../UI\";\nimport { translate } from \"../../utils/localization\";\nimport { TICK_TIME } from \"../../utils/constants\";\nimport template from \"lodash.template\";\n\nclass Level17 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"Into the dark\";\n    this.diamondsGoal = 10;\n    this.quakePlayed = false;\n  }\n\n  get id() {\n    return this.constructor.key;\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n    this.destroyBlock = () => null;\n    //  Enable lights and set a dark ambient color\n    scene.lights.enable().setAmbientColor(0x000000);\n\n    if(this.unfinished) {\n      // adds light on angel\n      this.staticlight = scene.lights\n        .addLight(\n          UI.tileToScreen(this.exit.position.x),\n          UI.tileToScreen(this.exit.position.y),\n          1000\n        )\n        .setColor(0xeaeaea)\n        .setIntensity(1.5);\n      scene.time.addEvent({\n        delay: 100,\n        callback: function () {\n          if (!this.exit.block.alien.active && this.staticlight.intensity > 0) {\n            this.staticlight.setIntensity(this.staticlight.intensity - 0.5);\n          }\n          Phaser.Geom.Ellipse.Random(this.exit.block.alien, this.staticlight);\n        },\n        callbackScope: this,\n        repeat: -1,\n      });\n    } else {\n      // ============\n      // removes NPCs\n      // ============\n      this.replaceByEmpty(this.leader);\n      this.leader.alien.destroy();\n      this.leader = null;\n      // ================================\n      // removes usless interactive spots\n      // ================================\n      Object.keys(this.interactiveElements).forEach((k) => {\n        // removes if is not the exit\n        if (!this.interactiveElements[k].isClass(Exit)) {\n          this.interactiveElements[k] = null;\n        }\n      });\n    }\n\n    scene.children.getByName(\"layer_0\").setPipeline(\"Light2D\");\n    scene.children.getByName(\"layer_1\").setPipeline(\"Light2D\");\n    scene.children.getByName(\"layer_2\").setPipeline(\"Light2D\");\n    scene.children.getByName(\"layer_1z2\").setPipeline(\"Light2D\");\n    this.moveables.forEach(\n      (m) => !m.isClass(Player) && m.alien.active && m.alien.setPipeline(\"Light2D\")\n    );\n    Object.values(this.decorationElements).forEach((m) =>\n      m.alien?.setPipeline(\"Light2D\")\n    );\n\n    this.scene.events.on(\"player_moves\", (nextPos) => {\n      this.updateLight(nextPos);\n      if(this.unfinished) {\n        this.detectDocTeleporting(nextPos);\n      }\n    });\n    // this.onNextTick(() => {\n    //   this.teleportObject(this.leader, {\n    //     x: this.exit.position.x - 3,\n    //     y: this.exit.position.y,\n    //   });\n    // });\n  }\n\n  detectDocTeleporting(nextPos) {\n    if (nextPos.y > 45 && this.leader.position.y < 10) {\n      this.teleportObject(this.leader, {\n        x: this.exit.position.x - 3,\n        y: this.exit.position.y,\n      });\n    }\n  }\n\n  updateLight(nextPos) {\n    if (!this.exit) return false;\n    if (\n      nextPos.x === this.exit.position.x - 3 &&\n      nextPos.y === this.exit.position.y\n    ) {\n      this.player.light?.setRadius(500);\n      this.player.light?.setIntensity(1.3);\n\n      // remove alpha tween\n      if (this.eyeAnimation) {\n        this.exitEye.alpha = 0;\n        this.eyeAnimation.remove();\n      }\n    } else if (\n      nextPos.x === this.exit.position.x - 2 &&\n      nextPos.y === this.exit.position.y\n    ) {\n      // this.player.light?.setIntensity(1.3)\n      this.player.light?.setRadius(250);\n      this.player.light?.setIntensity(0.8);\n\n      // alpha tween from 0 to 0.5\n      if (this.eyeAnimation) {\n        this.eyeAnimation.remove();\n      }\n      this.exitEye.alpha = 0.1;\n      this.eyeAnimation = this.scene.tweens.add({\n        targets: this.exitEye,\n        alpha: 0.2,\n        duration: 100,\n        yoyo: true,\n        repeat: -1,\n      });\n    } else if (\n      nextPos.x === this.exit.position.x - 1 &&\n      nextPos.y === this.exit.position.y\n    ) {\n      // this.player.light?.setIntensity(1.3)\n      this.player.light?.setIntensity(0.3);\n      this.player.light?.setRadius(125);\n\n      // alpha tween from 0.5 to 1\n      if (this.eyeAnimation) {\n        this.eyeAnimation.remove();\n      }\n      this.exitEye.alpha = 0.3;\n      this.eyeAnimation = this.scene.tweens.add({\n        targets: this.exitEye,\n        alpha: 0.5,\n        duration: 100,\n        yoyo: true,\n        repeat: -1,\n      });\n    } else if (\n      nextPos.x === this.exit.position.x &&\n      nextPos.y === this.exit.position.y\n    ) {\n      this.player.light?.setIntensity(0.1);\n    } else if (this.player.light?.intensity !== 1.5) {\n      this.player.light?.setIntensity(1.5);\n      this.player.light?.setRadius(1000);\n    }\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n\n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n\n    if (el.isClass(Interactive) && el.order === 0 && this.unfinished) {\n      this.showDialog1();\n    }\n\n    if (el.isClass(Interactive) && el.order === 1 && this.unfinished) {\n      if (this.collectedDiamonds < this.diamondsGoal) {\n        this.showDialogGoal();\n      } else {\n        this.moveToExit()\n        this.interactiveElements[`${el.position.x}-${el.position.y}`] = null\n      }\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = true;\n      // just a hack for presentation before torch is lit\n      el.alien.alpha = 0.5;\n\n      this.onNextTick(lvl => {\n        if(!lvl.unfinished) {\n          el.ligthTorch();\n        }\n      })\n    }\n\n    if (el.isClass(Exit)) {\n      const layer = this.scene.children.getByName(\"layer_2\");\n      const map = layer.tilemap;\n\n      this.exitEye = this.scene.add.sprite(48, 16, \"spark\").setOrigin(0.5, 0.5);\n      this.exitEye.setTintFill(0xd25400);\n      this.exitEye.setScale(layer.scaleX * 2, layer.scaleX * 4);\n      this.exitEye.x = map.tileToWorldX(el.position.x - 0.5);\n      this.exitEye.y = map.tileToWorldY(el.position.y - 0.4);\n      this.exitEye.depth = 100;\n      this.exitEye.alpha = 0;\n    }\n\n    if (el.isClass(Torch) && el.order === 0) {\n      el.ignite();\n    }\n\n    if (el.isClass(Interactive) && el.order === 1) {\n      el.ephemeral = false;\n    }\n  }\n\n  showDialog1() {\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      this.player.ligthTorch();\n      this.setTickTimeout(() => {\n        this.showDialog2();\n      }, 10);\n    });\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Dwarf\", \"closeUp_Mary\"],\n      participantNames: [\"Doc\", \"Mary\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_17.dialog_1.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_17.dialog_1.dwarf_say_1\")],\n        },\n      ],\n    });\n  }\n  showDialog2() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Dwarf\", \"closeUp_Mary\"],\n      participantNames: [\"Doc\", \"Mary\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_17.dialog_2.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"level_17.dialog_2.dwarf_say_1\")],\n        },\n      ],\n    });\n  }\n  showDialogGoal() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Dwarf\",\n          text: [\n            template(translate(\"levels.goal_dialog.dwarf_say_1\"))({\n              GOAL: this.diamondsGoal,\n              NUM: this.collectedDiamonds,\n            }),\n          ],\n        },\n      ],\n    });\n  }\n\n  async moveToExit() {\n    this.player.disconnect();\n    this.dwarfRun = true;\n    this.leader.leadingPath = [\n      { x: this.leader.position.x + 1, y: this.leader.position.y },\n      { x: this.leader.position.x + 1, y: this.leader.position.y },\n      { x: this.leader.position.x + 2, y: this.leader.position.y },\n      { x: this.leader.position.x + 2, y: this.leader.position.y },\n      { x: this.leader.position.x + 3, y: this.leader.position.y },\n      { x: this.leader.position.x + 3, y: this.leader.position.y },\n    ];\n    this.moveDwarf();\n\n    // anim angel dismiss\n    this.scene.tweens.add({\n      targets: this.exit.block.alien,\n      x: UI.tileToScreen(this.exit.position.x),\n      duration: TICK_TIME * 2,\n      onComplete: () => {\n        super.destroyBlock()\n        // auto pilot off\n        this.player.reconnect();\n      },\n    });\n  }\n  moveDwarf() {\n    // hack to auto move dwarf\n    if (this.dwarfRun) {\n      if (this.leader.leadingPath.length !== 0) {\n        this.onNextTick(() => {\n          this.leader.onPlayerMoves(this.leader.position);\n          this.moveDwarf();\n        });\n      } else {\n        this.dwarfRun = false;\n        this.replaceByEmpty(this.leader);\n        this.leader = null;\n      }\n    }\n  }\n}\n\nLevel17.key = \"level_17\";\nexport default Level17;\n","import LevelBase from './levelBase'\nimport { PIXEL_NAME, DIRS } from '../../utils/constants'\nimport { Player, Wall, Ground, Empty } from '../objects'\n\n\nclass LevelFinale extends LevelBase {\n  constructor() {\n    super()\n    this.name = 'The escape'\n\n    this.winningLoopRef = this.winningLoop.bind(this)\n  }\n\n  get id() {\n    return this.constructor.key\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene)\n    this.voidLevel = scene.children.getByName('layer_1').tilemap.height - 1\n    this.fx = this.scene.sound.add('earthquake')\n    // scene.events.once('levelstart', () => {\n    //   scene.events.emit('dialogue:show', {\n    //     participants: ['closeUp_Mary', 'closeUp_Tiamat'],\n    //     conversation: [\n    //       {\n    //         who: 'closeUp_Tiamat',\n    //         text: [\n    //           \"STOP!!\",\n    //           \"I will destroy everything\",\n    //           \"if i have to.\",\n    //           \"you belong to me!!\",\n    //         ]\n    //       }\n    //     ]\n    //   })\n    // })\n    scene.events.on('update', this.winningLoopRef)\n    this.startVoid(scene)\n    \n  }\n  startVoid(phaserScene) {\n    const camera = phaserScene.cameras.main\n    setTimeout(() => {\n      camera.shake(2000, 0.005)\n      this.fx.play()\n    }, 1500)\n    // destroy ground up to 1 tiles before player\n  }\n  playerLoop() {\n    super.playerLoop()\n    this.voidLoop()\n  }\n  resetAutoVoidTimer() {\n    clearTimeout(this.autoDestroyTID)\n    this.autoDestroyTID = setTimeout(this.destroyMap.bind(this), 5000)\n  }\n  destroyMap() {\n    this.resetAutoVoidTimer()\n    const layer = this.scene.children.getByName('layer_1')\n    if(!layer) {\n      return false\n    }\n    const { tilemap: map } = layer\n    const camera = this.scene.cameras.main\n    const y = this.voidLevel\n    layer.fill(100, 0, y, map.width, 1)\n    this.objects[y].forEach((el, x) => {\n      if (el.isClass(Wall) || el.isClass(Ground)) {\n        this.objects[y][x] = new Empty(PIXEL_NAME.EMPTY, this)\n      }\n    })\n    \n    this.moveables = this.moveables.filter(el => {\n      if (el.position.y > this.voidLevel) {\n        el.alien?.destroy()\n        return false\n      }\n      return true\n    })\n\n    camera.shake(1000, 0.001)\n    this.fx.play()\n    this.voidLevel--\n\n    // eval death.\n    if (this.player.position.y > this.voidLevel) {\n      this.player.die()\n      this.onCharacterDie(this.player)\n    }\n  }\n  voidLoop() {\n    // detect player move direction\n    if (this.player.isMoving && this.player.nextMoveDir === DIRS.UP) {\n      this.resetAutoVoidTimer()\n      // if moves up\n      if(this.voidLevel - this.player.position.y > 8) {\n        // only detroy ground when more than 3 tiles of space\n        this.destroyMap()\n      }\n    } else if(this.player.isMoving && this.player.nextMoveDir !== '') {\n      // if moves sides or down\n      // destroy ground\n      this.destroyMap()      \n    }\n\n  }\n  destroy() {\n    this.scene.events.off('update', this.winningLoopRef)\n    this.fx.stop()\n    clearTimeout(this.autoDestroyTID)\n    \n  }\n\n  winningLoop() {\n    if(this.player.position.y < 5) {\n      clearTimeout(this.autoDestroyTID)\n      this.scene.events.off('update', this.winningLoopRef)\n      this.onComplete()\n    }\n  }\n\n  onAddElement(el) {\n    if(el.isClass(Player)) {\n      el.power = 1\n      el.hasPickaxe = true\n    }\n  }\n}\n\nLevelFinale.key = 'level_finale'\nexport default LevelFinale\n","import Phaser from \"phaser\";\nimport LevelBase from \"./levelBase\";\nimport { Empty, Exit, Interactive, NPCharacter, Player } from \"../objects\";\nimport EasyStar from \"easystarjs\";\nimport Debris from \"../objects/Debris\";\nimport { PIXEL_NAME } from \"../../utils/constants\";\nimport { translate } from \"../../utils/localization\";\nimport template from 'lodash.template'\n\nclass LevelMaze1 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The Maze\";\n    this.easystar = new EasyStar.js();\n    this.solvingPath = [];\n    this.isMaze = true;\n    this.exitEye = null;\n    this.dwarfRun = false;\n    this.buyLeadingWithShrooms = false;\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n    //  Enable lights and set a dark ambient color\n    scene.lights.enable().setAmbientColor(0x000000);\n\n    this.exit = Object.values(this.interactiveElements).find((el) =>\n      el.isClass(Exit)\n    );\n\n    // Path finder to exit, runs alwas since is used to detect unreachable exit\n    const objectsAsKeys = this.objects.map((row) =>\n      row.map((el) => (el.isClass(NPCharacter) || el.isClass(Empty) ? 0 : 1))\n    );\n    this.easystar.setGrid(objectsAsKeys);\n    this.easystar.setAcceptableTiles([0]);\n\n    this.easystar.findPath(\n      this.leader.position.x,\n      this.leader.position.y,\n      this.exit.position.x,\n      this.exit.position.y,\n      (path) => {\n        if (path === null) {\n          // exit was placed into an unreachable tile.\n          // flag for patch\n          this.shouldRestart = true;\n        } else {\n          this.solvingPath = path.slice(1);\n          this.leader.personalSpace = 10;\n        }\n      }\n    );\n    this.easystar.calculate();\n    // =======================\n\n    scene.events.once(\"levelstart\", () => {\n      if (this.shouldRestart) {\n        // exit was placed into an unreachable tile.\n        // restart as patch\n        scene.levels.restart();\n      } else if (this.unfinished) {\n        if(this.totalShroomsAmount > 0) {\n          this.showDialog1();\n        } else {\n          this.showDialog1_no_shrooms();\n        }\n\n        // reduce personal space after half way to exit\n        const checkProgress = () => {\n          if (this.leader.leadingPath.length < this.solvingPath.length / 3) {\n            this.leader.personalSpace = 2;\n\n            // drops an interactive object 3 blocks away from doc\n            const threePositionsBackInPath = this.solvingPath.at(\n              -this.leader.leadingPath.length - 4\n            );\n            const intElement = new Interactive(PIXEL_NAME.INTERACTION, this);\n            intElement.order = 9;\n            const { x, y } = threePositionsBackInPath;\n            this.interactiveElements[`${x}-${y}`] = intElement;\n            intElement.setPosition({ x, y });\n          } else {\n            scene.events.once(\"player_moves\", checkProgress);\n          }\n        };\n        scene.events.once(\"player_moves\", checkProgress);\n      }\n    });\n\n    // fix scenario if it was finished once at least\n    if (!this.unfinished) {\n      // plaster the wall\n      const layer = this.scene.children.getByName(\"layer_1\");\n      const debris = new Debris(PIXEL_NAME.DEBRIS, this);\n      debris.setPosition({\n        x: this.leader.position.x - 1,\n        y: this.leader.position.y,\n      });\n      layer.copy(0, 4, 1, 1, 2, 5);\n      this.setObjectAt(\n        this.leader.position.x + 1,\n        this.leader.position.y,\n        debris\n      );\n\n      // remove dwarf\n      this.replaceByEmpty(this.leader);\n      this.leader.alien.destroy();\n      this.leader.alien = null;\n    }\n  }\n\n  get id() {\n    return this.constructor.key;\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n    if (el.order === 0) {\n      this.onComplete();\n    }\n\n    if(el.order === 9) {\n      // dwarf reduced personal space\n      this.showDialog2()\n    }\n  }\n\n  onAddElement(el) {\n    if (el.isClass(Player)) {\n      el.power = 1;\n      el.hasPickaxe = false;\n    }\n\n    if (el.isClass(Exit)) {\n      const layer = this.scene.children.getByName(\"layer_2\");\n      const map = layer.tilemap;\n\n      this.exitEye = this.scene.add.sprite(48, 16, \"spark\").setOrigin(0.5, 0.5);\n      this.exitEye.setTintFill(0xd25400);\n      this.exitEye.setScale(layer.scaleX * 2, layer.scaleX * 4);\n      this.exitEye.x = map.tileToWorldX(el.position.x - 0.5);\n      this.exitEye.y = map.tileToWorldY(el.position.y - 0.4);\n      this.exitEye.depth = 100;\n      this.exitEye.alpha = 0;\n    }\n  }\n\n  showDialog1_no_shrooms() {\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      this.leader.leadingPath = [\n        { x: this.leader.position.x + 1, y: this.leader.position.y },\n      ];\n      this.setUpLeader();\n    });\n\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"maze_1.dialog_1.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"maze_1.dialog_1.mary_say_2_empty\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [template(translate(\"maze_1.dialog_1.dwarf_say_2_empty\"))({ NUM: 9})],\n        },\n      ]\n    })\n  }\n  showDialog1() {\n    this.scene.events.once(\"dialogue:hidden\", () => {\n      if (this.buyLeadingWithShrooms) {\n        this.scene.events.emit(\"score:mushroom_given\");\n        this.collectedShrooms--;\n\n        this.leader.leadingPath = [...this.solvingPath];\n      } else {\n        this.leader.leadingPath = [\n          { x: this.leader.position.x + 1, y: this.leader.position.y },\n        ];\n      }\n      this.setUpLeader();\n    });\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"maze_1.dialog_1.dwarf_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"maze_1.dialog_1.mary_say_1\")],\n          options: {\n            slot0: {\n              label: translate(\"maze_1.dialog_1_option.yes\"),\n              slot: 0,\n              onSelect: () => {\n                this.buyLeadingWithShrooms = true;\n                this.scene.events.emit(\"dialogue:nextPage\");\n              },\n            },\n            slot1: {\n              label: translate(\"maze_1.dialog_1_option.no\"),\n              slot: 1,\n              onSelect: () => this.scene.events.emit(\"dialogue:nextPage\", 1),\n            },\n            slot2: null,\n            slot3: null,\n          },\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"maze_1.dialog_1.mary_say_2_yes\")],\n          options: {\n            slot2: null, // hide default NEXT option\n          },\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"maze_1.dialog_1.mary_say_2_no\")],\n        },\n      ],\n    });\n  }\n\n  setUpLeader() {\n    this.player.disconnect();\n    this.dwarfRun = true;\n    this.moveDwarf();\n  }\n\n  moveDwarf() {\n    // auto moves dwarf until gets personal space\n    if (this.dwarfRun) {\n      if (\n        !this.leader.isCloseEnough(this.player.position) ||\n        this.leader.leadingPath.length === 0\n      ) {\n        this.dwarfRun = false;\n      }\n\n      this.onNextTick(() => {\n        // hack: force player move action\n        this.leader.onPlayerMoves(this.player.position);\n        this.moveDwarf();\n      });\n    } else {\n      this.leader.animIdle();\n      this.player.reconnect();\n    }\n  }\n\n  showDialog2() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Dwarf\"],\n      participantNames: [\"Mary\", \"Doc\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"maze_1.dialog_2.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Dwarf\",\n          text: [translate(\"maze_1.dialog_2.dwarf_say_1\")],\n        },\n      ],\n    });\n  }\n}\n\nLevelMaze1.key = \"maze_1\";\nexport default LevelMaze1;\n","import { SCALE } from \"../../utils/constants\";\n\nclass Arrow {\n  constructor(scene) {\n    this.scene = scene;\n    // Creating a blank tilemap\n    this.map = this.scene.make.tilemap({ tileWidth: 20, tileHeight: 20, width: 3, height: 1 });\n  }\n\n  getArrow() {\n    const map = this.map\n    // addTilesetImage: function (tilesetName, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid)\n    let tileset = map.addTilesetImage('arrows', 'hud-tiles', 20, 20, 1, 2);\n    let layer = map.createBlankLayer('layer_arrow', tileset);\n    layer.name = 'layer_arrow'\n    layer.depth = 15\n    layer.setScrollFactor(0)\n    layer.setScale(SCALE)\n    \n    return map.putTileAt(30, 0, 0);\n  }\n  \n  getArrowDown() {\n    const tile = this.getArrow()\n    return tile\n  }\n  getArrowRight() {\n    const tile = this.getArrow()\n    tile.rotation = -Math.PI/2\n    return tile\n  }\n  getArrowUp() {\n    const tile = this.getArrow()\n    tile.rotation = Math.PI\n    return tile\n  }\n  getArrowLeft() {\n    const tile = this.getArrow()\n    tile.rotation = Math.PI/2\n    return tile\n  }\n}\n\nexport default Arrow","import { SCALE } from \"../utils/constants\";\nimport LevelTest from \"../components/levels/level_test\";\nimport Level1 from \"../components/levels/level_1\";\nimport Level2 from \"../components/levels/level_2\";\nimport Level3 from \"../components/levels/level_3\";\nimport Level4 from \"../components/levels/level_4\";\nimport Level5 from \"../components/levels/level_5\";\nimport Level6 from \"../components/levels/level_6\";\nimport Level7 from \"../components/levels/level_7\";\nimport Level8 from \"../components/levels/level_8\";\nimport Level9 from \"../components/levels/level_9\";\nimport Level10 from \"../components/levels/level_10\";\nimport Level11 from \"../components/levels/level_11\";\nimport Level12 from \"../components/levels/level_12\";\nimport Level13 from \"../components/levels/level_13\";\nimport Level14 from \"../components/levels/level_14\";\nimport Level15 from \"../components/levels/level_15\";\nimport Level16 from \"../components/levels/level_16\";\nimport Level17 from \"../components/levels/level_17\";\nimport LevelFinale from \"../components/levels/level_finale\";\nimport LevelMaze1 from \"../components/levels/Maze_1\";\nimport UI from \"./UI\";\nimport { translate } from \"../utils/localization\";\nimport Arrow from \"./DialogArrow\";\nimport DB from \"../utils/dbManager\";\nimport dbManager from \"../utils/dbManager\";\n\nexport default class UIMenus {\n  constructor(scene) {\n    this.scene = scene;\n    this.ROW_HEIGHT = 0;\n    this.MARGIN_LEFT = 0;\n    this.MARGIN_TOP = 0;\n    this.options = [];\n    this.optionsByPage = [];\n    this.scrollIndex = 0;\n    this.isVisible = true;\n\n    window.scene = this.scene;\n  }\n  showConfirmNewGameMenu() {\n    const menuOptions = [\n      {\n        label: translate(\"menu.main.yes\"),\n        disabled: false,\n        selectable: true,\n        onSelect: () => {\n          this.scene.navigateToScene(\"IntroScene\");\n        },\n      },\n      {\n        label: translate(\"menu.main.no\"),\n        disabled: false,\n        selectable: true,\n        onSelect: () => this.scene.navigateToScene(\"LandingScene\"),\n      },\n    ];\n    const header = {\n      label: \"Start a new game and lost\\n\\nyour current progress?\",\n      disabled: false,\n      selectable: false,\n    };\n    this.drawSelectableOptions(header, menuOptions, 0, 1, 2);\n  }\n  showInitialMenu() {\n    const menuOptions = [\n      {\n        label: translate(\"menu.main.option_new\"),\n        disabled: false,\n        selectable: true,\n        onSelect: () => {\n          const level_1 = dbManager.get(Level1.key);\n          if (level_1) {\n            this.scene.navigateToScene(\"ConfirmNewGameScene\");\n          } else {\n            this.scene.navigateToScene(\"IntroScene\");\n          }\n        },\n      },\n      {\n        label: translate(\"menu.main.option_continue\"),\n        disabled: false,\n        selectable: true,\n        // onSelect: () => this.scene.navigateToScene(\"LevelResumeScene\", { level: Level3.key}),\n        onSelect: () => this.scene.navigateToScene(\"MenuScene\"),\n      },\n    ];\n    this.drawSelectableOptions(null, menuOptions);\n  }\n  showMainMenu() {\n    // const levelData = DB.get(Level1.key);\n    // const maxProgress = DB.get(\"maxProgress\") || 1;\n    // shorthand formatter\n    const _ = (n) =>\n      n.toLocaleString(\"en-US\", {\n        minimumIntegerDigits: 2,\n      });\n    const _gems = (lKey) => {\n      const levelData = DB.get(lKey);\n      return levelData\n        ? `${_(levelData.collectedDiamonds)}/${_(levelData.countDiamonds)}`\n        : \"__/__\";\n    };\n    const _threats = (lKey) => {\n      const levelData = DB.get(lKey);\n      return levelData\n        ? `${_(levelData.killedEnemies)}/${_(levelData.countEnemies)}`\n        : \"__/__\";\n    };\n    const _shrooms = (lKey) => {\n      const levelData = DB.get(lKey);\n      return levelData\n        ? `${_(levelData.collectedShrooms)}/${_(levelData.countShrooms)}`\n        : \"__/__\";\n    };\n    const _comp = (lKey) => {\n      const levelData = DB.get(lKey);\n      const perc = (levelData?.comp * 100).toLocaleString(\"en-US\", {\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0,\n      });\n      return levelData\n        ? `${perc <= 9 ? \"  \" : perc <= 99 ? \" \" : \"\"}${perc}%`\n        : \"  0%\";\n    };\n    const menuOptions = [\n      {\n        label: `Ki     1     ${_gems(Level1.key)}     ${_threats(\n          Level1.key\n        )}     ${_shrooms(Level1.key)}   ${_comp(Level1.key)}`,\n        // label: \"Ki     1     __/__     __/__     __/__   100%\",\n        disabled: false && window.localStorage.getItem(\"level_1\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level1.key }),\n      },\n      {\n        label: `Ki     2     ${_gems(Level2.key)}     ${_threats(\n          Level2.key\n        )}     ${_shrooms(Level2.key)}   ${_comp(Level2.key)}`,\n        // label: \"Absu  2     __/__     __/__     __/__   100%\",\n        disabled: false && window.localStorage.getItem(\"level_2\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level2.key }),\n      },\n      {\n        label: `Ki     3     ${_gems(Level3.key)}     ${_threats(\n          Level3.key\n        )}     ${_shrooms(Level3.key)}   ${_comp(Level3.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_3\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level3.key }),\n      },\n      {\n        label: `Ki     4     ${_gems(Level4.key)}     ${_threats(\n          Level4.key\n        )}     ${_shrooms(Level4.key)}   ${_comp(Level4.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_4\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level4.key }),\n      },\n      {\n        label: `Ki     5     ${_gems(Level5.key)}     ${_threats(\n          Level5.key\n        )}     ${_shrooms(Level5.key)}   ${_comp(Level5.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_5\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level5.key }),\n      },\n      {\n        label: `Ki     6     ${_gems(Level6.key)}     ${_threats(\n          Level6.key\n        )}     ${_shrooms(Level6.key)}   ${_comp(Level6.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_6\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level6.key }),\n      },\n      {\n        label: `Ki     7     ${_gems(Level7.key)}     ${_threats(\n          Level7.key\n        )}     ${_shrooms(Level7.key)}   ${_comp(Level7.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_7\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level7.key }),\n      },\n      {\n        label: `Ki     8     ${_gems(Level8.key)}     ${_threats(\n          Level8.key\n        )}     ${_shrooms(Level8.key)}   ${_comp(Level8.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_8\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level8.key }),\n      },\n      {\n        label: `Ki     9     ${_gems(Level9.key)}     ${_threats(\n          Level9.key\n        )}     ${_shrooms(Level9.key)}   ${_comp(Level9.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_9\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level9.key }),\n      },\n      {\n        label: `Ki    10     ${_gems(Level10.key)}     ${_threats(\n          Level10.key\n        )}     ${_shrooms(Level10.key)}   ${_comp(Level10.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_10\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level10.key }),\n      },\n      {\n        label: `Ki    11     ${_gems(Level11.key)}     ${_threats(\n          Level11.key\n        )}     ${_shrooms(Level11.key)}   ${_comp(Level11.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_11\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level11.key }),\n      },\n      {\n        label: `Ki    12     ${_gems(Level12.key)}     ${_threats(\n          Level12.key\n        )}     ${_shrooms(Level12.key)}   ${_comp(Level12.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_12\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level12.key }),\n      },\n      {\n        label: `${translate('menu.main.ruins').padEnd(6, ' ')} 1`,\n        disabled:\n          false && window.localStorage.getItem(\"level_maze_1\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", {\n            levelName: LevelMaze1.key,\n          }),\n      },\n      {\n        label: `Ki    13     ${_gems(Level13.key)}     ${_threats(\n          Level13.key\n        )}     ${_shrooms(Level13.key)}   ${_comp(Level13.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_12\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level13.key }),\n      },\n      {\n        label: `Ki    14     ${_gems(Level14.key)}     ${_threats(\n          Level14.key\n        )}     ${_shrooms(Level14.key)}   ${_comp(Level14.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_12\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level14.key }),\n      },\n      {\n        label: `Ki    15     ${_gems(Level15.key)}     ${_threats(\n          Level15.key\n        )}     ${_shrooms(Level15.key)}   ${_comp(Level15.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_12\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level15.key }),\n      },\n      {\n        label: `Ki    16     ${_gems(Level16.key)}     ${_threats(\n          Level16.key\n        )}     ${_shrooms(Level16.key)}   ${_comp(Level16.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_12\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level16.key }),\n      },\n      {\n        label: `Ki    17     ${_gems(Level17.key)}     ${_threats(\n          Level17.key\n        )}     ${_shrooms(Level17.key)}   ${_comp(Level17.key)}`,\n        disabled: false && window.localStorage.getItem(\"level_12\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", { levelName: Level17.key }),\n      },\n      {\n        label: \"Test  x     __/__     __/__     __/__   100%\",\n        disabled: false && window.localStorage.getItem(\"level_test\") !== \"true\",\n        selectable: true,\n        onSelect: () =>\n          this.scene.navigateToScene(\"GameScene\", {\n            levelName: LevelTest.key,\n          }),\n      },\n      // , {\n      //   label: 'Cinematic final',\n      //   disabled: false,\n      //   selectable: true,\n      //   onSelect: () => this.scene.navigateToScene('ConnectorScene', { id: 8, name: 'cinematic_last' } )\n      // }\n      // , {\n      //   label: 'Cinematic final',\n      //   disabled: false,\n      //   selectable: true,\n      //   onSelect: () => this.scene.navigateToScene('ConnectorScene', { id: 7, name: 'cinematic_escape' } )\n      // }\n    ];\n\n    const header = {\n      label: translate(\"menu.main.heading_scrore\"),\n      disabled: false,\n      selectable: false,\n    };\n\n    // last option selected by default\n    this.drawSelectableOptions(\n      header,\n      menuOptions,\n      menuOptions.length - 1,\n      null,\n      null,\n      11\n    );\n  }\n  showInGameMenu() {\n    const menuOptions = [\n      {\n        label: \"Restart level\",\n        disabled: false,\n        selectable: true,\n        onSelect: () => this.scene.levels.restart(),\n      },\n      {\n        label: \"Exit to menu\",\n        disabled: false,\n        selectable: true,\n        onSelect: () => this.scene.scene.start(\"MenuScene\"),\n      },\n    ];\n\n    this.drawSelectableOptions(null, menuOptions, 0, 4, 1);\n  }\n\n  drawSelectableOptions(\n    header,\n    options,\n    initOption,\n    offsetX,\n    offsetY,\n    maxRows = 5\n  ) {\n    this.options = options;\n\n    const FIRST_SELECTABLE_OPTION = options.findIndex((o) => o.selectable);\n\n    let currentOption = FIRST_SELECTABLE_OPTION;\n    if (initOption >= maxRows - 1) {\n      // must scroll options\n      if (initOption < this.options.length) {\n        this.scrollIndex = initOption - maxRows + 1;\n        const haveMorePages = this.scrollIndex + maxRows < this.options.length;\n        if (haveMorePages) {\n          this.scrollIndex = initOption - maxRows + 2;\n          // arrow points one before the last\n          currentOption = maxRows - 2;\n        } else {\n          // arrow points the last option\n          currentOption = maxRows - 1;\n        }\n        // and list scrolls up to that option\n      } else {\n        // latest option, arrow should point to that\n        currentOption = maxRows;\n        this.scrollIndex = initOption - maxRows;\n      }\n    } else if (!isNaN(initOption)) {\n      currentOption = initOption;\n    }\n\n    const currentPage = Math.floor(currentOption / maxRows) + 1;\n    let currentIndex = currentOption - Math.floor((currentPage - 1) * maxRows);\n\n    const INIT_POS = currentOption;\n    this.ROW_HEIGHT = UI.pixelToScreen(15);\n    this.MARGIN_LEFT = UI.tileToScreen(offsetX || 1);\n    const ARROW_WIDTH = UI.pixelToScreen(20);\n    const OFFSET_X = this.MARGIN_LEFT - ARROW_WIDTH;\n    this.MARGIN_TOP = UI.tileToScreen(offsetY || 2);\n\n    const arrow = new Arrow(this.scene).getArrowRight();\n    arrow.tilemapLayer.setPosition(\n      OFFSET_X,\n      this.MARGIN_TOP + this.ROW_HEIGHT * INIT_POS - this.ROW_HEIGHT / 2\n    );\n\n    const arrowUp = new Arrow(this.scene).getArrowUp();\n    arrowUp.tilemapLayer.setPosition(\n      UI.tileToScreen(19),\n      this.MARGIN_TOP - this.ROW_HEIGHT\n    );\n    arrowUp.setAlpha(this.scrollIndex === 0 ? 0.5 : 1);\n    arrowUp.setVisible(maxRows < this.options.length);\n\n    const arrowDown = new Arrow(this.scene).getArrowDown();\n    arrowDown.tilemapLayer.setPosition(\n      UI.tileToScreen(19),\n      this.MARGIN_TOP + this.ROW_HEIGHT * maxRows - this.ROW_HEIGHT\n    );\n    arrowDown.setAlpha(\n      this.scrollIndex + maxRows < this.options.length ? 1 : 0.5\n    );\n    arrowDown.setVisible(maxRows < this.options.length);\n\n    if (header) {\n      const label = [\n        ...header.label.split(\"\"),\n        ...Array(Math.max(0, 20 - header.label.length)).fill(\"\"),\n      ].join(\"\")\n      const lines = Math.round(label.length / 20)\n      const txt = this.scene.add\n        .text(\n          this.MARGIN_LEFT,\n          this.ROW_HEIGHT * -lines + this.MARGIN_TOP,\n          label,\n          {\n            fontFamily: \"Emulogic\",\n            fontSize: \"8px\",\n            fill: \"#aee0c8\",\n            fontWeight: \"regular\",\n          }\n        )\n        .setVisible(!header.disabled);\n      txt.displayHeight = 10 * SCALE;\n      txt.alpha = 1;\n      txt.depth = 16;\n      txt.name = \"header_text\";\n      txt.setScale(SCALE);\n      txt.setScrollFactor(0);\n      txt.setShadow(-1, 1);\n    }\n\n    this.drawOptionsPage(this.scrollIndex, maxRows, currentIndex);\n\n    this.scene.input.keyboard.on(\"keydown\", (event) => {\n      // break control for in game pause menu\n      if (!this.isVisible) return false;\n\n      const reducedOptions = this.optionsByPage;\n      let newIndex = false;\n      if (event.key === \"ArrowUp\") {\n        const isNextToFirstOption = currentIndex === 1;\n        const scrollOptions = isNextToFirstOption && this.scrollIndex > 0;\n        if (scrollOptions) {\n          this.scrollIndex--;\n          this.drawOptionsPage(this.scrollIndex, maxRows, currentIndex);\n        } else {\n          // move arrow\n          if (currentIndex > 0) {\n            newIndex = currentIndex - 1;\n          }\n        }\n      }\n\n      if (event.key === \"ArrowDown\") {\n        const isNextToLastOption = currentIndex === maxRows - 2;\n        const scrollOptions =\n          isNextToLastOption &&\n          this.scrollIndex + maxRows < this.options.length;\n        if (scrollOptions) {\n          this.scrollIndex++;\n          this.drawOptionsPage(this.scrollIndex, maxRows, currentIndex);\n        } else {\n          // move arrow\n          if (currentIndex < reducedOptions.length - 1) {\n            newIndex = currentIndex + 1;\n          }\n        }\n      }\n\n      if (\n        (event.key === \"ArrowDown\" || event.key === \"ArrowUp\") &&\n        newIndex !== false\n      ) {\n        arrow.tilemapLayer.setPosition(\n          OFFSET_X,\n          this.MARGIN_TOP + this.ROW_HEIGHT * newIndex - this.ROW_HEIGHT / 2\n        );\n        const prevSelectedOpt = this.scene.children.getByName(\n          `menu_text_${currentIndex}`\n        );\n        prevSelectedOpt.alpha =\n          prevSelectedOpt.text.slice(-4) === \"100%\" ? 1 : 0.5;\n        prevSelectedOpt.setColor(\"#aee0c8\");\n        const nextSelectedOpt = this.scene.children.getByName(\n          `menu_text_${newIndex}`\n        );\n        nextSelectedOpt.alpha = 1;\n        nextSelectedOpt.setColor(\"#fff\");\n        currentIndex = newIndex;\n      }\n\n      // up down arrows maintenance\n      arrowUp.setAlpha(this.scrollIndex === 0 ? 0.5 : 1);\n      arrowDown.setAlpha(\n        this.scrollIndex + maxRows < this.options.length ? 1 : 0.5\n      );\n\n      if (event.key === \"Enter\") {\n        if (!reducedOptions[currentIndex].disabled) {\n          reducedOptions[currentIndex].onSelect();\n        }\n      }\n    });\n  }\n\n  drawOptionsPage(from, length, current) {\n    // clean up\n    this.scene.children.list\n      .filter((el) => el.name.includes(\"menu_text\"))\n      .forEach((el) => el.destroy());\n    this.optionsByPage = this.options.slice(from, from + length);\n\n    this.optionsByPage.forEach((o, idx) => {\n      const textToPrint = [\n        ...o.label.split(\"\"),\n        ...Array(Math.max(0, 20 - o.label.length)).fill(\"\"),\n      ].join(\"\");\n      const txt = this.scene.add\n        .text(\n          this.MARGIN_LEFT,\n          this.ROW_HEIGHT * idx + this.MARGIN_TOP,\n          textToPrint,\n          {\n            fontFamily: \"Emulogic\",\n            fontSize: \"8px\",\n            fill: \"#aee0c8\",\n            fontWeight: \"regular\",\n          }\n        )\n        .setVisible(!o.disabled);\n      txt.alpha = textToPrint.slice(-4) === \"100%\" || idx === current ? 1 : 0.5;\n      txt.setColor(idx === current ? \"#fff\" : \"#aee0c8\");\n      txt.displayHeight = 10 * SCALE;\n      txt.depth = 16;\n      txt.name = `menu_text_${idx}`;\n      txt.setScale(SCALE);\n      txt.setScrollFactor(0);\n      txt.setShadow(-1, 1);\n    });\n  }\n}\n","import { SCALE, TILE_SIZE } from '../../utils/constants'\nimport Arrow from '../DialogArrow'\nimport UI from '../UI'\n\nclass DialogOptions {\n  constructor(scene) {\n    this.scene = scene\n    this.options = []\n    this.menuOptionsContainer = null\n    this.keyDownHandler = this.keyDownHandler.bind(this)\n  }\n\n  mount() {\n    this.menuOptionsContainer = this.scene.add.container(0,0)\n    this.menuOptionsContainer.setScrollFactor(0)\n    this.currentSlot = 0\n    this.scene.input.keyboard.on(\"keydown\", this.keyDownHandler)\n  }\n  \n  unmount() {\n    this.scene.input.keyboard.off(\"keydown\", this.keyDownHandler)\n    this.menuOptionsContainer.destroy()\n    this.arrow?.setVisible(false)\n    this.arrow = null\n  }\n\n  get visible() {\n    return this.menuOptionsContainer.visible\n  }\n\n  show(options = {}) {\n    this.menuOptionsContainer.setVisible(true)\n    this.options = Object.keys(options).reduce((r, k) => {\n      if(options[k] !== null) {\n        r[k] = options[k]\n      }\n      return r\n    }, {})\n    const firstNonEmptySlotKey = Object.keys(this.options).sort()[0]\n    this.currentSlot = this.options[firstNonEmptySlotKey].slot\n    \n    this.menuOptionsContainer.depth = 20\n    this.menuOptionsContainer.setPosition(\n      UI.tileToScreen(4.5),\n      UI.tileToScreen(9),\n    )\n    const drawOption = (label = '', slot = 0) => {\n      const x = UI.tileToScreen(slot === 0 || slot === 1 ? 0 : 9)\n      const y = UI.tileToScreen(slot === 0 || slot === 2 ? 0.25 : 1)\n      const textObj = this.scene.add.text(\n        x,\n        y,\n        label,\n        {\n          fontFamily: 'GameGirl',\n          fontSize: \"8px\",\n          fill: \"#ffffff\",\n          lineSpacing: 2\n        }\n      )\n      textObj.setScale(SCALE)\n      textObj.displayHeight = UI.pixelToScreen(8)\n      textObj.displayWidth = UI.pixelToScreen(8 * label.length)\n      textObj.setShadow(-1,1)\n      this.menuOptionsContainer.add(textObj)\n    }\n    Object.values(this.options).forEach(o => drawOption(o.label, o.slot))\n    // drawOption(\"YES\", 0)\n    // drawOption(\"NO\", 1)\n    // drawOption(\"CLOSE\", 2)\n    // drawOption(\"STORY\", 3)\n    \n    if(!this.arrow) {\n      this.arrow = new Arrow(this.scene).getArrowRight();\n      this.arrow.name = 'menu_arrow'\n      this.arrow.setSize(UI.tileToPixels(0.66), UI.tileToPixels(0.66))\n    }\n    this.setArrowPositionBySlot(this.currentSlot)\n    // hide if no option\n    this.arrow.setVisible(this.options.length !== 0)\n\n  }\n  hide() {\n    while(this.menuOptionsContainer?.list.length) {\n      this.menuOptionsContainer?.list?.forEach(ch => ch.destroy())\n    }\n    // this.menuOptionsContainer?.list?.forEach((ch, idx) => ch.type !== 'Graphics' ? ch.destroy() : null)\n    this.menuOptionsContainer.setVisible(false)\n    this.arrow?.setVisible(false)\n  }\n\n  keyDownHandler(event) {\n    if(!this.menuOptionsContainer.visible) { return }\n    let slot = this.currentSlot\n    if (event.key === \"ArrowUp\" && (slot === 1 || slot === 3)) {\n      const newSlotIdx = slot - 1\n      if (this.options[`slot${newSlotIdx}`]) {\n        this.currentSlot = newSlotIdx\n      }\n    }\n    if (event.key === \"ArrowLeft\") {\n      const newSlotIdx = slot - 2\n      if (this.options[`slot${newSlotIdx}`]) {\n        this.currentSlot = newSlotIdx\n      } else if(this.options[`slot${newSlotIdx - 1}`]) {\n        this.currentSlot = newSlotIdx - 1\n      }\n    }\n    if (event.key === \"ArrowRight\") {\n      const newSlotIdx = slot + 2\n      if (this.options[`slot${newSlotIdx}`]) {\n        this.currentSlot = newSlotIdx\n      } else if(this.options[`slot${newSlotIdx + 1}`]) {\n        this.currentSlot = newSlotIdx + 1\n      }\n    }\n    if (event.key === \"ArrowDown\" && (slot === 0 || slot === 2)) {\n      const newSlotIdx = slot + 1\n      if (this.options[`slot${newSlotIdx}`]) {\n        this.currentSlot = newSlotIdx\n      }\n    }\n\n    if(event.key === 'Enter') {\n      const selectedOption = Object.values(this.options).find(o => o.slot === this.currentSlot)\n      selectedOption?.onSelect()\n    } else {\n      this.setArrowPositionBySlot(this.currentSlot)\n    }\n  }\n\n  setArrowPositionBySlot(slot) {\n    const ARROW_OFFSET_X = -UI.tileToScreen(0.5)\n    const ARROW_OFFSET_Y = -UI.tileToScreen(0.4)\n    const x = UI.tileToScreen(slot === 0 || slot === 1 ? 0 : 9)\n    const y = UI.tileToScreen(slot === 0 || slot === 2 ? 0.25 : 1)\n\n    this.arrow.tilemapLayer.setPosition(\n      x + ARROW_OFFSET_X + this.menuOptionsContainer.x,\n      y + ARROW_OFFSET_Y + this.menuOptionsContainer.y\n    )\n  }\n}\n\nexport default DialogOptions\n","import { TILE_SIZE, SCALE } from \"../../utils/constants\";\nimport { translate } from \"../../utils/localization\";\nimport DialogOptions from \"../DialogOptions\";\nimport UI from \"../UI\";\n\nconst TRANSITION_DURATION = 500;\nclass Dialogs {\n  constructor(scene) {\n    this.scene = scene;\n    this.tnContainer = null;\n    this.participantSprites = {};\n    this.conversation = {};\n    this.currentDialogIndex = 0;\n    this.isShowing = false;\n    this.isFullTextDisplayed = false;\n    this.dialogOptions = new DialogOptions(this.scene);\n    this.showDialog = this.showDialog.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.updateCharacterName = this.updateCharacterName.bind(this);\n    this.tIDs = []\n  }\n\n  mount() {\n    this.tIDs.push(\n      setTimeout(\n        () =>\n          this.scene.input.keyboard.addListener(\"keydown\", this.handleKeyDown),\n        TRANSITION_DURATION\n      )\n    )\n\n    // this.scene.events.on('dialogue:show', this.showDialog)\n    // this.scene.events.on('dialogue:hide', this.hideDialog)\n  }\n  unmount() {\n    this.tIDs.forEach(id => clearTimeout(id))\n    const l = this.scene.children.getByName(\"layer_hud\");\n    if (l) {\n      l.destroy();\n    }\n    const c = this.scene.children.getByName(\"dialog_tn_container\")\n    if (c) {\n      c.destroy();\n    }\n    const p = this.scene.children.getByName(\"placeholder_text\")\n    if (p) {\n      p.destroy();\n    }\n  }\n\n  handleKeyDown(event) {\n    // enter when full text displayed (otherwise is fast forward) as options are hidden (otherwise is option selection)\n    if (\n      event.key === \"Enter\" &&\n      this.isFullTextDisplayed &&\n      !this.dialogOptions.visible\n    ) {\n      if (this.currentDialogIndex < this.conversation.length - 1) {\n        // next page\n        // this.showMessage(this.conversation[++this.currentDialogIndex]);\n      } else {\n        this.scene.events.emit(\"dialogue:hide\");\n        // this.scene.input.keyboard.removeListener('keydown', onNextPage)\n      }\n    }\n  }\n\n  hideDialog() {\n    this.scene.input.keyboard.removeListener(\"keydown\", this.handleKeyDown);\n\n    const retVal = new Promise((res) => {\n      const map = this.scene.children.list.find(\n        (ch) => ch.name === \"layer_hud\"\n      ).tilemap;\n      this.clearText();\n      this.dialogOptions.unmount();\n      this.scene.tweens.add({\n        targets: [map.layers[0].tilemapLayer, this.tnContainer],\n        y: UI.tileToScreen(-7),\n        duration: 500,\n        ease: \"Back.In\",\n        onComplete: () => {\n          // this.scene.levels?.current?.resume()\n          this.isShowing = false;\n          res();\n        },\n      });\n    });\n\n    return retVal;\n  }\n\n  showDialog({ participants, participantNames = [], conversation }) {\n    this.isShowing = true;\n    this.conversation = conversation;\n    this.currentDialogIndex = 0;\n\n    // this.scene.levels?.current?.pause()\n    this.prepareHUD(participants, participantNames);\n    this.prepareText();\n\n    const map = this.scene.children.list.find(\n      (ch) => ch.name === \"layer_hud\"\n    ).tilemap;\n    map.layers[0].tilemapLayer.y = this.tnContainer.y = UI.tileToScreen(-8);\n\n    this.scene.tweens.add({\n      targets: [map.layers[0].tilemapLayer, this.tnContainer],\n      y: UI.tileToScreen(4),\n      duration: TRANSITION_DURATION,\n      ease: \"Cubic.Out\",\n      onComplete: () => {\n        this.dialogOptions.mount();\n        // let lastDialog = conversation.shift()\n\n        this.showMessage(this.conversation[this.currentDialogIndex]);\n      },\n    });\n  }\n\n  fullTextDisplayed() {\n    this.isFullTextDisplayed = true;\n    this.scene.events.emit('dialogue:message_shown', this.currentDialogIndex)\n    // show options\n    const onlyOnePageOption = {\n      slot1: {\n        label: translate(\"menu.dialog_options.close\"),\n        slot: 1,\n        onSelect: () => this.scene.events.emit(\"dialogue:hide\"),\n      },\n    }\n    const moreThanOnePageOption = {\n      slot1: {\n        label: translate(\"menu.dialog_options.story\"),\n        slot: 1,\n        // next page\n        onSelect: () =>\n          this.showMessage(this.conversation[++this.currentDialogIndex]),\n      },\n      slot3: {\n        label: translate(\"menu.dialog_options.close\"),\n        slot: 3,\n        onSelect: () => this.scene.events.emit(\"dialogue:hide\"),\n      },\n    };\n    const defaultPageOption = {\n      slot2: {\n        label: translate(\"menu.dialog_options.next\"),\n        slot: 2,\n        // next page\n        onSelect: () =>\n          this.showMessage(this.conversation[++this.currentDialogIndex]),\n      },\n      slot3: {\n        label: translate(\"menu.dialog_options.close\"),\n        slot: 3,\n        onSelect: () => this.scene.events.emit(\"dialogue:hide\"),\n      },\n    };\n    const lastPageOption = {\n      slot3: {\n        label: translate(\"menu.dialog_options.close\"),\n        slot: 3,\n        onSelect: () => this.scene.events.emit(\"dialogue:hide\"),\n      },\n    };\n    const options = {\n      ...(this.conversation.length === 1 ? onlyOnePageOption : {}),\n      ...(this.conversation.length > 1 && this.currentDialogIndex === 0 ? moreThanOnePageOption : {}),\n      ...(this.currentDialogIndex > 0 && \n      this.currentDialogIndex < this.conversation.length - 1\n        ? defaultPageOption\n        : {}),\n      ...(this.currentDialogIndex === this.conversation.length - 1 && this.conversation.length > 1\n        ? lastPageOption\n        : {}),\n      ...(this.conversation[this.currentDialogIndex].options || {}),\n    };\n    this.dialogOptions.show(options);\n  }\n\n  showMessage(message) {\n    this.clearText();\n    this.dialogOptions.hide();\n    this.writeText(message.text);\n    \n    const c = this.scene.children.getByName(\"dialog_tn_container\")\n    Object.keys(this.participantSprites).forEach((k) => {\n      if (k === message.who) {\n        // participantSprites[k].alpha = 1\n        this.participantSprites[k].clearTint();\n        c.list.find(el => el.name === `char_${k}_text_to_remove`).clearTint()\n      } else {\n        // participantSprites[k].alpha = 0.5\n        this.participantSprites[k].setTint(0x333333);\n        const txt = c.list.find(el => el.name === `char_${k}_text_to_remove`)\n        txt?.setTint(0x999999)\n      }\n    });\n  }\n\n  prepareHUD(participants, participantNames) {\n    // Creating a blank tilemap with dimensions matching the dungeon\n    const map = this.scene.make.tilemap({\n      tileWidth: 20,\n      tileHeight: 20,\n      width: 20,\n      height: 20,\n    });\n\n    // addTilesetImage: function (tilesetName, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid)\n    let tileset = map.addTilesetImage(\"hud-tiles\", \"hud-tiles\", 20, 20, 1, 2);\n\n    let layer = map.createBlankLayer(\"layer_hud\", tileset);\n    layer.name = \"layer_hud\";\n    layer.depth = 5;\n    layer.setScrollFactor(0);\n    layer.setScale(SCALE);\n\n    // Fill with black tiles\n    // layer.fill(1)\n    let p, tn, charName;\n    this.tnContainer = this.scene.add.container(0, 0);\n    this.tnContainer.depth = 10;\n    this.tnContainer.name = 'dialog_tn_container'\n    // this.tnContainer.setScale(SCALE)\n    // this.tnContainer.y = -this.scene.renderer.height/2\n    switch (participants.length) {\n      case 2:\n        if (participants[1]) {\n          p = participants[1];\n          tn = this.scene.add\n            .sprite(0, 0)\n            .play(p)\n            .setOrigin(0, 0.25)\n            .setScale(SCALE);\n          tn.name = `${p}_tn_to_remove`;\n          tn.x = UI.tileToScreen(17) + UI.pixelToScreen(10);\n          tn.y = UI.tileToScreen(3) + UI.pixelToScreen(2);\n          tn.setScrollFactor(0);\n          tn.setFlipX(true);\n          this.tnContainer.add(tn);\n          this.participantSprites[p] = tn;\n        }\n\n        /// TN MIDDLE RIGHT\n        Dialogs.drawWindow(map, { w: 3, h: 2, x: 17, y: 3 });\n        // NAME\n        charName = this.scene.add.text(\n          tn.x - UI.tileToScreen(2) * 0.25,\n          tn.y + UI.tileToScreen(2) * 0.8,\n          participantNames[1] || '???',\n          {\n            fontFamily: 'GameGirl',\n            fill: \"#ffffff\",\n            align: 'right'\n          }\n        ).setScale(SCALE/2).setScrollFactor(0);\n        charName.name = `char_${p}_text_to_remove`;\n        this.tnContainer.add(charName)\n      // eslint-disable-next-line no-fallthrough\n      case 1:\n        if (participants[0]) {\n          p = participants[0];\n          tn = this.scene.add\n            .sprite(0, 0)\n            .play(p)\n            .setOrigin(0, 0.25)\n            .setScale(SCALE);\n          tn.name = `${p}_tn_to_remove`;\n          tn.x = UI.tileToScreen(0) + UI.pixelToScreen(12);\n          tn.y = UI.tileToScreen(3) + UI.pixelToScreen(2);\n          tn.setScrollFactor(0);\n          this.tnContainer.add(tn);\n          this.participantSprites[p] = tn;\n        }\n        /// TN MIDDLE LEFT\n        Dialogs.drawWindow(map, { w: 3, h: 2, x: 0, y: 3 });\n        // NAME\n        charName = this.scene.add.text(\n          tn.x - UI.tileToScreen(2) * 0.25,\n          tn.y + UI.tileToScreen(2) * 0.8,\n          participantNames[0] || '???',\n          {\n            fontFamily: 'GameGirl',\n            fill: \"#ffffff\",\n            align: 'right'\n          }\n        ).setScale(SCALE/2).setScrollFactor(0);\n        charName.name = `char_${p}_text_to_remove`;\n        this.tnContainer.add(charName)\n        break;\n      case 4:\n        /// TN LOWER RIGHT\n        if (participants[3]) {\n          p = participants[3];\n          tn = this.scene.add\n            .sprite(0, 0)\n            .play(p)\n            .setOrigin(0, 0.25)\n            .setScale(SCALE);\n          tn.name = `${p}_tn_to_remove`;\n          tn.x = UI.tileToScreen(17) + UI.pixelToScreen(10);\n          tn.y = UI.tileToScreen(4) + UI.pixelToScreen(2);\n          tn.setScrollFactor(0);\n          tn.setFlipX(true);\n          this.tnContainer.add(tn);\n          this.participantSprites[p] = tn;\n        }\n        Dialogs.drawWindow(map, { w: 3, h: 2, x: 17, y: 4 });\n        // NAME\n        charName = this.scene.add.text(\n          tn.x - UI.tileToScreen(2) * 0.25,\n          tn.y + UI.tileToScreen(2) * 0.8,\n          participantNames[3] || '???',\n          {\n            fontFamily: 'GameGirl',\n            fill: \"#ffffff\",\n            align: 'right'\n          }\n        ).setScale(SCALE/2).setScrollFactor(0);\n        charName.name = `char_${p}_text_to_remove`;\n        this.tnContainer.add(charName)\n      // eslint-disable-next-line no-fallthrough\n      case 3:\n        /// TN UPPER LEFT\n        if (participants[0]) {\n          p = participants[0];\n          tn = this.scene.add\n            .sprite(0, 0)\n            .play(p)\n            .setOrigin(0, 0.25)\n            .setScale(SCALE);\n          tn.name = `${p}_tn_to_remove`;\n          tn.x = UI.tileToScreen(0) + UI.pixelToScreen(12);\n          tn.y = UI.tileToScreen(0) + UI.pixelToScreen(2);\n          tn.setScrollFactor(0);\n          this.tnContainer.add(tn);\n          this.participantSprites[p] = tn;\n        }\n        Dialogs.drawWindow(map, { w: 3, h: 2, x: 0, y: 0 });\n        // NAME\n        charName = this.scene.add.text(\n          tn.x - UI.tileToScreen(2) * 0.25,\n          tn.y + UI.tileToScreen(2) * 0.8,\n          participantNames[0] || '???',\n          {\n            fontFamily: 'GameGirl',\n            fill: \"#ffffff\",\n            align: 'right'\n          }\n        ).setScale(SCALE/2).setScrollFactor(0);\n        charName.name = `char_${p}_text_to_remove`;\n        this.tnContainer.add(charName)\n\n        /// TN BOTTOM LEFT\n        if (participants[2]) {\n          p = participants[2];\n          tn = this.scene.add\n            .sprite(0, 0)\n            .play(p)\n            .setOrigin(0, 0.25)\n            .setScale(SCALE);\n          tn.name = `${p}_tn_to_remove`;\n          tn.x = UI.tileToScreen(0) + UI.pixelToScreen(12);\n          tn.y = UI.tileToScreen(4) + UI.pixelToScreen(2);\n          tn.setScrollFactor(0);\n          this.tnContainer.add(tn);\n          this.participantSprites[p] = tn;\n        }\n\n        Dialogs.drawWindow(map, { w: 3, h: 2, x: 0, y: 4 });\n        // NAME\n        charName = this.scene.add.text(\n          tn.x - UI.tileToScreen(2) * 0.25,\n          tn.y + UI.tileToScreen(2) * 0.8,\n          participantNames[2] || '???',\n          {\n            fontFamily: 'GameGirl',\n            fill: \"#ffffff\",\n            align: 'right'\n          }\n        ).setScale(SCALE/2).setScrollFactor(0);\n        charName.name = `char_${p}_text_to_remove`;\n        this.tnContainer.add(charName)\n\n        /// TN UPPER RIGHT\n        if (participants[1]) {\n          p = participants[1];\n          tn = this.scene.add\n            .sprite(0, 0)\n            .play(p)\n            .setOrigin(0, 0.25)\n            .setScale(SCALE);\n          tn.name = `${p}_tn_to_remove`;\n          tn.x = UI.tileToScreen(17) + UI.pixelToScreen(10);\n          tn.y = UI.tileToScreen(0) + UI.pixelToScreen(2);\n          tn.setScrollFactor(0);\n          tn.setFlipX(true);\n          this.tnContainer.add(tn);\n          this.participantSprites[p] = tn;\n        }\n        Dialogs.drawWindow(map, { w: 3, h: 2, x: 17, y: 0 });\n        // NAME\n        charName = this.scene.add.text(\n          tn.x - UI.tileToScreen(2) * 0.25,\n          tn.y + UI.tileToScreen(2) * 0.8,\n          participantNames[1] || '???',\n          {\n            fontFamily: 'GameGirl',\n            fill: \"#ffffff\",\n            align: 'right'\n          }\n        ).setScale(SCALE/2).setScrollFactor(0);\n        charName.name = `char_${p}_text_to_remove`;\n        this.tnContainer.add(charName)\n        break;\n      default:\n    }\n\n    Dialogs.drawWindow(map, { w: 14, h: 7, x: 3, y: 0 });\n  }\n\n  updateCharacterName(key='closeUp_Mary', name='???') {\n    const c = this.scene.children.getByName(\"dialog_tn_container\")\n    const charName = c.list.find(el => el.name === `char_${key}_text_to_remove`);\n    charName.setText(name)\n  }\n\n  prepareText() {\n    const textObj = this.scene.add.text(\n      UI.tileToScreen(3.5),\n      UI.tileToScreen(4.5),\n      \" \",\n      {\n        fontFamily: \"GameGirl\",\n        //  fontSize: \"8px\",\n        fill: \"#ffffff\",\n        lineSpacing: 2,\n        // wordWrap: { width: MAX_CHARS_BY_LINE * 8 }\n      }\n    );\n    textObj.setScrollFactor(0);\n    textObj.displayHeight = 10 * SCALE;\n    textObj.displayWidth = 10 * SCALE;\n    textObj.name = \"placeholder_text\";\n    textObj.depth = 10;\n    textObj.setShadow(-1, 1);\n  }\n\n  writeText(text) {\n    const charPlaceholder = this.scene.children.getByName(\"placeholder_text\");\n    this.isFullTextDisplayed = false;\n    // ===========\n    // prepare one big text with \\n by line of 26 char length\n    const MAX_CHARS_BY_LINE = 26;\n    const fullText = text.join(\"\"); // legacy for texts as array\n    const paragraphs = fullText.split(\"\\n\"); // respect \\n into text\n    const lines = [];\n    while (paragraphs.length) {\n      let line = \"\"; // new line\n      const paragraphWords = paragraphs.shift().split(\" \");\n      while (paragraphWords.length) {\n        const prevLine = line; // save current line\n        const nextWord = paragraphWords.shift();\n        line += nextWord + \" \"; // build new line\n        if (line.trim().length > MAX_CHARS_BY_LINE) {\n          // new line is bigger than mx char by line\n          lines.push(prevLine); // store prev line\n          paragraphWords.unshift(nextWord); // restore last word for next line\n          line = \"\";\n        }\n      }\n      lines.push(line);\n    }\n    let letters = lines.join(\"\\n\");\n    // ===========\n\n    let timerId;\n    const fastForward = () => {\n      clearTimeout(timerId);\n      if(letters.length) {\n        putLetter(letters.length);\n      }\n    };\n    const putLetter = (len = 1) => {\n      const char = letters.substring(0, len);\n      letters = letters.substring(len);\n      charPlaceholder.setText(charPlaceholder.text + char);\n      if (letters.length) {\n        timerId = setTimeout(\n          () => putLetter(1),\n          [\".\", \"!\", \"?\"].includes(char) ? 500 : 50\n        );\n        this.tIDs.push(timerId)\n      } else {\n        this.scene.input.keyboard.off(\"keyup\", fastForward);\n        this.fullTextDisplayed();\n      }\n    };\n    putLetter();\n    this.tIDs.push(\n      setTimeout(() => this.scene.input.keyboard.once(\"keyup\", event => {\n        if(['Enter', 'Escape', 'Spacebar'].includes(event.key)){\n          fastForward()\n        }\n      }), 500)\n    )\n  }\n\n  clearText() {\n    this.scene.children.getByName(\"placeholder_text\").setText(\"\");\n    // this.scene.children.list.filter(el => el.name === 'placeholder_text').forEach(el => el.setText(\"\"))\n  }\n\n  static drawWindow(map, { w, h, x, y }) {\n    const THEME = 6;\n    const TILES = {\n      TOP_LEFT: 0 + THEME,\n      TOP_MIDDLE: 1 + THEME,\n      TOP_RIGHT: 2 + THEME,\n      LEFT: 10 + THEME,\n      MIDDLE: 11 + THEME,\n      RIGHT: 12 + THEME,\n      BOTTOM_LEFT: 20 + THEME,\n      BOTTOM_MIDDLE: 21 + THEME,\n      BOTTOM_RIGHT: 22 + THEME,\n    };\n    for (let j = 0; j < h; j++) {\n      for (let i = 0; i < w; i++) {\n        let tile;\n        if (i === 0 && j === 0) {\n          tile = TILES.TOP_LEFT;\n        }\n        if (i > 0 && i < w - 1 && j === 0) {\n          tile = TILES.TOP_MIDDLE;\n        }\n        if (i === w - 1 && j === 0) {\n          tile = TILES.TOP_RIGHT;\n        }\n\n        if (i === 0 && j > 0 && j < h - 1) {\n          tile = TILES.LEFT;\n        }\n        if (i > 0 && i < w - 1 && j > 0 && j < h - 1) {\n          tile = TILES.MIDDLE;\n        }\n        if (i === w - 1 && j > 0 && j < h - 1) {\n          tile = TILES.RIGHT;\n        }\n\n        if (i === 0 && j === h - 1) {\n          tile = TILES.BOTTOM_LEFT;\n        }\n        if (i > 0 && i < w - 1 && j === h - 1) {\n          tile = TILES.BOTTOM_MIDDLE;\n        }\n        if (i === w - 1 && j === h - 1) {\n          tile = TILES.BOTTOM_RIGHT;\n        }\n\n        map.putTileAt(tile, i + x, j + y);\n      }\n    }\n  }\n}\n\nexport default Dialogs;\n","import { SCALE, TILE_SIZE } from \"../utils/constants\";\nimport UIMenus from \"./UIMenus\";\nimport Dialogs from \"./Dialogs\";\nimport dbManager from \"../utils/dbManager\";\n\nexport default class UI {\n  constructor(scene, noScores) {\n    this.scene = scene;\n    this.inGameMenu = null;\n    this.setUpPuseResumeGame();\n    this.mushroomsIcon = null;\n    this.diamondsIcon = null;\n\n    this.scene.events.off(\"game_paused\");\n    this.scene.events.on(\"game_paused\", () => this.showPauseMenu());\n    this.scene.events.off(\"game_resumed\");\n    this.scene.events.on(\"game_resumed\", () => this.hidePauseMenu());\n\n    const rockHit1 = this.scene.sound.add(\"rock_hit\");\n    const rockHit2 = this.scene.sound.add(\"rock_hit2\");\n    const rockHit3 = this.scene.sound.add(\"rock_hit3\");\n    const rockHit = [rockHit1, rockHit2, rockHit3];\n    this.scene.events.off(\"sounds:rock_hit_hard\");\n    this.scene.events.on(\"sounds:rock_hit_hard\", () =>\n      rockHit[Math.trunc(Math.random() * 10) % 3].play()\n    );\n\n    const rockSlideHard1 = this.scene.sound.add(\"rock_slide_hard1\");\n    const rockSlideHard2 = this.scene.sound.add(\"rock_slide_hard2\");\n    const rockSlideHard3 = this.scene.sound.add(\"rock_slide_hard3\");\n    const rockSlideHard = [rockSlideHard1, rockSlideHard2, rockSlideHard3];\n    this.scene.events.off(\"sounds:rock_slide_hard\");\n    this.scene.events.on(\"sounds:rock_slide_hard\", () =>\n      rockSlideHard[Math.trunc(Math.random() * 10) % 3].play()\n    );\n\n    const rockSlideSoft1 = this.scene.sound.add(\"rock_slide_soft1\");\n    const rockSlideSoft2 = this.scene.sound.add(\"rock_slide_soft2\");\n    const rockSlideSoft3 = this.scene.sound.add(\"rock_slide_soft3\");\n    const rockSlideSoft = [rockSlideSoft1, rockSlideSoft2, rockSlideSoft3];\n    this.scene.events.off(\"sounds:rock_slide_soft\");\n    this.scene.events.on(\"sounds:rock_slide_soft\", () =>\n      rockSlideSoft[Math.trunc(Math.random() * 10) % 3].play()\n    );\n\n    const rockHitSoft = this.scene.sound.add(\"rock_hit_soft\");\n    this.scene.events.off(\"sounds:rock_hit_soft\");\n    this.scene.events.on(\"sounds:rock_hit_soft\", () => rockHitSoft.play());\n\n    const gemHit = this.scene.sound.add(\"gem_hit\");\n    this.scene.events.off(\"sounds:gem_hit\");\n    this.scene.events.on(\"sounds:gem_hit\", () => gemHit.play());\n\n    const explosion = this.scene.sound.add(\"explosion\");\n    this.scene.events.off(\"sounds:explosion\");\n    this.scene.events.on(\"sounds:explosion\", () => explosion.play());\n\n    const shroomPick = this.scene.sound.add(\"shroom_pick\");\n    this.scene.events.off(\"sounds:shroom_pick\");\n    this.scene.events.on(\"sounds:shroom_pick\", () => shroomPick.play());\n\n    const gemPick = this.scene.sound.add(\"gem_pick\");\n    this.scene.events.off(\"sounds:gem_pick\");\n    this.scene.events.on(\"sounds:gem_pick\", () => gemPick.play());\n\n    const coinPick = this.scene.sound.add(\"coin\");\n    this.scene.events.off(\"sounds:coin\");\n    this.scene.events.once(\"sounds:coin\", () => coinPick.play());\n\n    const clearHit1 = this.scene.sound.add(\"clear_hit1\");\n    const clearHit2 = this.scene.sound.add(\"clear_hit2\");\n    const clearHit3 = this.scene.sound.add(\"clear_hit3\");\n    const clearHit = [clearHit1, clearHit2, clearHit3];\n    this.scene.events.off(\"sounds:clear_hit\");\n    this.scene.events.on(\"sounds:clear_hit\", () =>\n      clearHit[Math.trunc(Math.random() * 10) % 3].play()\n    );\n\n    const deathByRockHit = this.scene.sound.add(\"death_by_rock\");\n    this.scene.events.off(\"sounds:death_by_rock_hit\");\n    this.scene.events.on(\"sounds:death_by_rock_hit\", () =>\n      deathByRockHit.play()\n    );\n\n    const levelComplete = this.scene.sound.add(\"level_complete\");\n    this.scene.events.off(\"sounds:level_complete\");\n    this.scene.events.on(\"sounds:level_complete\", () => levelComplete.play());\n    if (!noScores) {\n      this.drawScores();\n    }\n\n    this.dialogs = new Dialogs(this.scene);\n    this.scene.events.off(\"dialogue:show\");\n    this.scene.events.on(\"dialogue:show\", (props) => {\n      this.scene.levels?.current?.pause();\n      this.dialogs.mount();\n      this.dialogs.showDialog(props);\n    });\n    this.scene.events.off(\"dialogue:updateCharacterName\");\n    this.scene.events.on(\"dialogue:updateCharacterName\", async ({key, name}) => {\n      this.dialogs.updateCharacterName(key, name);\n    });\n    this.scene.events.off(\"dialogue:nextPage\");\n    this.scene.events.on(\"dialogue:nextPage\", async (skipAmount = 0) => {\n      console.log(this.dialogs.currentDialogIndex, this.dialogs.conversation);\n      this.dialogs.currentDialogIndex += skipAmount\n      console.log(this.dialogs.currentDialogIndex);\n      this.dialogs.showMessage(this.dialogs.conversation[++this.dialogs.currentDialogIndex])\n    });\n    this.scene.events.off(\"dialogue:hide\");\n    this.scene.events.on(\"dialogue:hide\", async () => {\n      await this.dialogs.hideDialog();\n      this.scene.events.emit(\"dialogue:hidden\");\n      this.dialogs.unmount();\n      this.scene.levels?.current?.resume();\n    });\n  }\n\n  destroy() {\n    this.mushroomsIcon.destroy();\n    this.diamondsIcon.destroy();\n    this.mushroomsScore.destroy();\n    this.diamondsScore.destroy();\n    this.diamondsScoreGoal.destroy();\n    this.scene.events.off(\"score:diamond_goal\");\n    this.scene.events.off(\"score:diamond_set\");\n    this.scene.events.off(\"score:diamond_goal_set\");\n    this.scene.events.off(\"score:mushroom_collected\");\n    this.scene.events.off(\"score:mushroom_given\");\n  }\n  onResize() {\n    const layer = this.scene.children.getByName(\"layer_scores\");\n    if(!layer) return false\n\n    this.mushroomsIcon.setPosition(\n      UI.tileToScreen(18),\n      UI.tileToScreen(1)\n    ).setScale(SCALE * 1.5)\n\n    const shroomsAmount = window.localStorage.getItem(\"shrooms\") || \"0\";\n    this.mushroomsScore.setPosition(\n      UI.tileToScreen(20) - this.MT_MARGIN_RIGHT,\n      // map.tileToWorldY(1)\n      UI.tileToScreen(1)\n    )\n    this.mushroomsScore.setScrollFactor(0);\n    this.mushroomsScore.displayHeight = 10 * SCALE;\n    this.mushroomsScore.displayWidth = shroomsAmount.length * 10 * SCALE;\n\n    this.diamondsIcon.setPosition(\n      UI.tileToScreen(1) + this.D_MARGIN_LEFT,\n      UI.tileToScreen(1)\n    ).setScale(SCALE * 1.5);\n\n\n    this.diamondsScoreGoal.setPosition(\n      UI.tileToScreen(3) - this.DT_MARGIN_RIGHT,\n      UI.tileToScreen(1)\n    )\n    this.diamondsScoreGoal.displayHeight = 8 * SCALE;\n    this.diamondsScoreGoal.displayWidth = 2 * 8 * SCALE;\n\n    this.diamondsScore.setPosition(\n      UI.tileToScreen(3) - this.DT_MARGIN_RIGHT,\n      UI.tileToScreen(1) - this.diamondsScoreGoal.test !== \"00\" ? UI.tileToScreen(0.5) : 0\n    )\n    this.diamondsScore.displayHeight = 10 * SCALE;\n    this.diamondsScore.displayWidth = this.diamondsAmount.length * 10 * SCALE;\n\n  }\n\n  hidePauseMenu() {\n    const layer = this.scene.children.list.find(\n      (el) => el.name === \"layer_pause_nenu\"\n    );\n    if (layer) {\n      layer.setVisible(false);\n      // flag to avoid options to work after menu is hidden\n      this.inGameMenu.isVisible = false;\n    }\n    this.scene.children.list\n      .filter((el) => el.name.includes(\"menu_text\"))\n      .forEach((el) => el.destroy());\n    this.scene.children.list\n      .filter((el) => el.name.includes(\"_tn_to_remove\"))\n      .forEach((el) => el.destroy());\n\n    // console.log(this.scene.children.list.filter(el => el.name.includes('layer_pause_nenu')));\n    this.scene.children.list\n      .filter((el) => el.name.includes(\"layer_arrow\"))\n      .forEach((el) => el.destroy());\n    // this.scene.children.list.filter(el => el.name.includes('layer_pause_nenu')).forEach(el => el.destroy())\n  }\n\n  drawScores() {\n    // Creating a blank tilemap with dimensions matching the dungeon\n    const map = this.scene.make.tilemap({\n      tileWidth: 20,\n      tileHeight: 20,\n      width: 20,\n      height: 20,\n    });\n    // addTilesetImage: function (tilesetName, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid)\n    map.addTilesetImage(\"hud-tiles\", \"hud-tiles\", 20, 20, 1, 2);\n\n    let scoreTileset = map.addTilesetImage(\n      \"hud-tiles\",\n      \"hud-tiles\",\n      20,\n      20,\n      1,\n      2\n    );\n\n    let scoresLayer = map.createBlankLayer(\"layer_scores\", scoreTileset);\n    scoresLayer.name = \"layer_scores\";\n    scoresLayer.depth = 5;\n    scoresLayer.setScrollFactor(0);\n\n    scoresLayer.setScale(SCALE);\n    // LEFT\n\n    Dialogs.drawWindow(map, { w: 3, h: 2, x: 0, y: 0 });\n\n    // RIGHT\n    Dialogs.drawWindow(map, { w: 3, h: 2, x: 17, y: 0 });\n\n    // this.pickaxeScore = window.localStorage.getItem('pickaxe')\n    // const s = this.scene.add.sprite(\n    //   map.tileToWorldX(9) + 10 * SCALE,\n    //   map.tileToWorldY(0) + 10 * SCALE,\n    // ).play('closeUp_Pickaxe').setOrigin(0.1, 0.15).setScale(SCALE)\n    // s.depth = 6\n    // s.setScrollFactor(0)\n    // s.setVisible(this.pickaxeScore === 'true')\n\n    const msh = this.scene.add\n      .sprite(map.tileToWorldX(18), map.tileToWorldY(1))\n      .play(\"closeUp_Mushroom\")\n      .setOrigin(0.5, 0.5)\n      .setScale(SCALE * 1.5);\n    msh.depth = 6;\n    msh.name = \"score_img\";\n    msh.setScrollFactor(0);\n    this.mushroomsIcon = msh;\n\n    const MT_MARGIN_RIGHT_PX = 9;\n    this.MT_MARGIN_RIGHT = MT_MARGIN_RIGHT_PX * SCALE;\n    // const shroomsAmount = window.localStorage.getItem(\"shrooms\") || \"0\";\n    // console.log(dbManager.getLevels())\n    // const shroomsAmount = dbManager.getLevels().reduce((r, l) => r + l.collectedShrooms, 0);\n    const shroomsAmount = Math.max(dbManager.get('totalShroomsAmount'), 0);\n    this.mushroomsScore = this.scene.add.text(\n      map.tileToWorldX(20) - this.MT_MARGIN_RIGHT,\n      map.tileToWorldY(1),\n      String(shroomsAmount),\n      {\n        fontFamily: \"GameGirl\",\n        fill: \"#ffffff\",\n        align: \"right\",\n      }\n    );\n    this.mushroomsScore.setData('amount', shroomsAmount)\n    this.mushroomsScore.setOrigin(1, 0);\n    this.mushroomsScore.displayHeight = 10 * SCALE;\n    this.mushroomsScore.displayWidth = String(shroomsAmount).length * 10 * SCALE;\n    this.mushroomsScore.name = \"score_text_to_remove\";\n    this.mushroomsScore.depth = 6;\n    this.mushroomsScore.setScrollFactor(0);\n    this.mushroomsScore.setShadow(-1, 1);\n\n    const D_MARGIN_LEFT_PX = 0.5; //px\n    this.D_MARGIN_LEFT = D_MARGIN_LEFT_PX * SCALE;\n    const diamond = this.scene.add\n      .sprite(map.tileToWorldX(1) + this.D_MARGIN_LEFT, map.tileToWorldY(1))\n      .play(\"closeUp_Diamond\")\n      .setOrigin(0.5, 0.5)\n      .setScale(SCALE * 1.5);\n    diamond.depth = 6;\n    diamond.name = \"score_img\";\n    diamond.setScrollFactor(0);\n    this.diamondsIcon = diamond;\n\n    this.scene.events.once(\"score:diamond_goal\", () => {\n      this.scene.tweens.add({\n        targets: diamond,\n        scale: SCALE * 2,\n        ease: \"Linear\",\n        duration: 250,\n        yoyo: true,\n        // onComplete: () => {\n        //   this.music.stop()\n        // },\n      });\n    });\n\n    const DT_MARGIN_RIGHT_PX = 9;\n    this.DT_MARGIN_RIGHT = DT_MARGIN_RIGHT_PX * SCALE;\n    this.diamondsAmount = \"0\";\n    this.diamondsScore = this.scene.add.text(\n      map.tileToWorldX(3) - this.DT_MARGIN_RIGHT,\n      map.tileToWorldY(1),\n      // map.tileToWorldY(0.5),\n      this.diamondsAmount,\n      {\n        fontFamily: \"GameGirl\",\n        fill: \"#ffffff\",\n        align: \"right\",\n      }\n    );\n    this.diamondsScore.setOrigin(1, 0);\n    this.diamondsScore.displayHeight = 10 * SCALE;\n    this.diamondsScore.displayWidth = this.diamondsAmount.length * 10 * SCALE;\n    this.diamondsScore.name = \"score_text_to_remove\";\n    this.diamondsScore.depth = 6;\n    this.diamondsScore.setScrollFactor(0);\n    this.diamondsScore.setShadow(-1, 1);\n\n    this.diamondsScoreGoal = this.scene.add.text(\n      map.tileToWorldX(3) - this.DT_MARGIN_RIGHT,\n      map.tileToWorldY(1),\n      \"00\", // goal\n      {\n        fontFamily: \"GameGirl\",\n        fill: \"gold\",\n        align: \"right\",\n      }\n    );\n    this.diamondsScoreGoal.alpha = 0;\n    this.diamondsScoreGoal.setOrigin(1, 0);\n    this.diamondsScoreGoal.displayHeight = 8 * SCALE;\n    this.diamondsScoreGoal.displayWidth = 2 * 8 * SCALE;\n    this.diamondsScoreGoal.name = \"score_text_to_remove\";\n    this.diamondsScoreGoal.depth = 6;\n    this.diamondsScoreGoal.setScrollFactor(0);\n    this.diamondsScoreGoal.setShadow(-1, 1);\n\n    this.scene.events.on(\"score:mushroom_collected\", (howMany = 1) => {\n      const amount = this.mushroomsScore.getData('amount') + howMany\n      this.mushroomsScore.setText(amount);\n    });\n    this.scene.events.on(\"score:mushroom_given\", (howMany = 1) => {\n      const amount = Number(this.mushroomsScore.getData('amount')) - howMany\n      this.mushroomsScore.setText(String(amount));\n    });\n    window.scene = this.scene;\n\n    this.scene.events.on(\"score:diamond_set\", (amount) => {\n      this.diamondsAmount = amount\n      this.diamondsScore.setText(amount);\n    });\n\n    this.scene.events.once(\"score:diamond_goal_set\", (amount) => {\n      this.scene.tweens.add({\n        targets: this.diamondsScore,\n        y: UI.tileToScreen(0.5),\n        ease: \"Linear\",\n        duration: 250,\n        onComplete: () => {},\n      });\n      const targetPosX = this.diamondsScoreGoal.x;\n      this.diamondsScoreGoal.x += UI.tileToScreen(0.5);\n      this.diamondsScoreGoal.alpha = 0;\n      this.diamondsScoreGoal.setText(amount);\n      this.scene.tweens.add({\n        targets: this.diamondsScoreGoal,\n        x: targetPosX,\n        alpha: 1,\n        ease: \"Linear\",\n        duration: 250,\n        delay: 200,\n      });\n    });\n  }\n\n  drawMenuOptions(map) {\n    this.inGameMenu = new UIMenus(this.scene);\n    this.inGameMenu.showInGameMenu();\n  }\n\n  showPauseMenu() {\n    const existingLayer = this.scene.children.list.find(\n      (el) => el.name === \"layer_pause_nenu\"\n    );\n    // flag to avoid options to work after menu is hidden\n    if (existingLayer) {\n      existingLayer.setVisible(true);\n      this.drawMenuOptions();\n      this.inGameMenu.isVisible = true;\n      return true;\n    }\n\n    // Creating a blank tilemap with dimensions matching the dungeon\n    const map = this.scene.make.tilemap({\n      tileWidth: 20,\n      tileHeight: 20,\n      width: 20,\n      height: 20,\n    });\n    // addTilesetImage: function (tilesetName, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid)\n    let tileset = map.addTilesetImage(\"hud-tiles\", \"hud-tiles\", 20, 20, 1, 2);\n\n    let layer = map.createBlankLayer(\"layer_pause_nenu\", tileset);\n    layer.name = \"layer_pause_nenu\";\n    layer.depth = 15;\n    layer.setScrollFactor(0);\n\n    layer.setScale(SCALE);\n\n    Dialogs.drawWindow(map, { w: 14, h: 3, x: 3, y: 0 });\n    this.drawMenuOptions(map);\n    this.inGameMenu.isVisible = true;\n  }\n\n  setUpPuseResumeGame() {\n    this.scene.input.keyboard.removeListener(\n      \"keydown\",\n      this.onKeyDown.bind(this)\n    );\n    this.scene.input.keyboard.addListener(\"keydown\", this.onKeyDown.bind(this));\n  }\n\n  onKeyDown(event) {\n    const pauseGame = () => {\n      this.scene.levels.current.pause();\n      this.scene.events.emit(\"game_paused\");\n    };\n    const resumeGame = () => {\n      this.scene.levels.current.resume();\n      this.scene.events.emit(\"game_resumed\");\n    };\n    if (event.key === \"Escape\" && !this.dialogs.isShowing && this.scene.levels.current.player.connected) {\n      const action = this.scene.levels.current.isPaused\n        ? resumeGame\n        : pauseGame;\n      action();\n    }\n  }\n\n  // HELPER\n  static tileToScreen(val = 0) {\n    return UI.pixelToScreen(val * TILE_SIZE);\n  }\n  static tileToPixels(val = 0) {\n    return val * TILE_SIZE;\n  }\n  static pixelToScreen(val = 0) {\n    return val * SCALE;\n  }\n}\n","import Phaser from 'phaser'\nimport { PIXEL_TO_TILEMAP_POSITION, PIXEL_NAME, SCALE } from '../../utils/constants'\nimport UI from '../UI'\nimport Destroyable from './Destroyable'\nimport Player from './Player'\n\nexport default class Ground extends Destroyable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: true,\n      isBreakable: true,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: false,\n      level\n    })\n    this.strength = 1\n  }\n\n  overrunBy(el) {\n    // assume is player who overruns ground\n    const layer = this.level.scene.children.getByName('layer_1')\n    // when player dies and level is restarting but explosions still occuring, layer is null\n    if(!layer) return false\n    const { tilemap: map } = layer\n    \n    map.putTileAt(-1, this.position.x, this.position.y, false, 'layer_1')\n\n    if(el && el.isClass(Player)) {\n      this.level.scene.events.emit('sounds:clear_hit')\n  \n      \n    } else {\n      // destroyed by explosion or earthquake\n      this.break_effect = this.level.scene.add.sprite(48, 16).setOrigin(0, 0.25);\n      this.break_effect.setScale(SCALE);\n      this.break_effect.depth = 4;\n      this.break_effect.x = UI.tileToScreen(this.position.x)\n      this.break_effect.y = UI.tileToScreen(this.position.y)\n      this.break_effect.play('ground_disolves')\n      this.break_effect.setFlipY(true)\n      this.break_effect.on(Phaser.Animations.Events.ANIMATION_COMPLETE, () => {\n        this.break_effect.destroy()\n      })\n      // this.level.scene.plugins.get('rexFade').fadeOutDestroy(this.alien, 2000);\n    }\n\n    // we need to run this after level.objects updates from level.moveObject.\n      // so we queue it for the next tick\n      this.level.onNextTick(level => {\n        // ** calcultate tile shape for each neighbour of removed tile **\n    \n        // cross neighbours coords offset (up, right, down, left)\n        const neighboursCoords = [[0, -1], [1, 0], [0, 1], [-1, 0]]\n        neighboursCoords.forEach(coords => {\n          // create a 3x3 matrix to pass to calculateGroundTileWithNeighbours\n          const data = Array(3).fill(0).map(() => Array(3).fill(0))\n    \n          // gets object from neighbour coordinate\n          const x = this.position.x + coords[0]\n          const y = this.position.y + coords[1]\n          const neighbour = level.getObjectAt(x, y)\n          \n          // check if neighbour and it is a ground\n          if (neighbour && neighbour.constructor.className === this.constructor.className) {\n            // build data based on current neighbour, setting ground pixel or 0 accordingly.\n            data[0][1] = level.getObjectAt(x, y-1)?.constructor.className === this.constructor.className ? PIXEL_NAME.GROUND : 0\n            data[1][0] = level.getObjectAt(x-1, y)?.constructor.className === this.constructor.className ? PIXEL_NAME.GROUND : 0\n            data[2][1] = level.getObjectAt(x, y+1)?.constructor.className === this.constructor.className ? PIXEL_NAME.GROUND : 0\n            data[1][2] = level.getObjectAt(x+1, y)?.constructor.className === this.constructor.className ? PIXEL_NAME.GROUND : 0\n    \n            // gets and updates tile\n            const tile = PIXEL_TO_TILEMAP_POSITION.calculateGroundTileWithNeighbours(1, 1, data)\n            map.putTileAt(tile, x, y, false, 'layer_1')\n          }\n        })\n      })\n  }\n}\n\nGround.className = 'Ground'\n","import Moveable from './Moveable'\nimport { DIRS } from '../../utils/constants'\nimport Ground from './Ground'\n\nexport default class Character extends Moveable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: true,\n      level\n    })\n    this.pushingDirection = null\n  }\n\n  animRun() {}\n  \n  canMove(x, y) {\n    const neighbour = this.level.getObjectAt(x, y)\n    const emptyPlace = this.level.objectIsEmpty(neighbour)\n    const canBrakeNeighbour = neighbour?.isBreakable && this.power >= neighbour.strength && !neighbour.isClass(Character)\n    const canWalkThrough = neighbour.isClass && neighbour.isClass(Character) && neighbour.name !== 'dwarf'\n    \n    this.isBrakingGround = canBrakeNeighbour && neighbour.isClass(Ground)\n\n    return emptyPlace || canWalkThrough || canBrakeNeighbour || neighbour.isPickable ? neighbour : false\n  }\n\n  canMoveDir(DIR) {\n    switch(DIR) {\n      case DIRS.UP: return this.canMoveUp()\n      case DIRS.DOWN: return this.canMoveDown()\n      case DIRS.LEFT: return this.canMoveLeft()\n      case DIRS.RIGHT: return this.canMoveRight()\n      default: return false\n    }\n  }\n\n  canMoveUp() {\n    return this.canMove(this.position.x, this.position.y - 1)\n  }\n  canMoveDown() {\n    return this.canMove(this.position.x, this.position.y + 1)\n  }\n  animPushRight() {\n  }\n  animPushLeft() {\n  }\n  canMoveLeft() {\n    return this.canMove(this.position.x - 1, this.position.y)\n  }\n  canPushLeft() {\n    const neighbour = this.level.getObjectAt(this.position.x - 1, this.position.y)\n    const nothingBesides = this.level.isPositionClear(this.position.x - 2, this.position.y)\n    const isAboutToFall = this.level.isPositionClear(this.position.x - 1, this.position.y + 1)\n    const canPush = neighbour?.isMoveable && nothingBesides && !isAboutToFall\n    return canPush\n  }\n  pushLeft() {\n    const neighbour = this.level.getObjectAt(this.position.x - 1, this.position.y)\n    const canMove = this.canMoveLeft()\n    const canPush = this.canPushLeft()\n    let pushed = false\n    if(!canMove && canPush) {\n      if(this.pushingDirection === DIRS.LEFT) {\n        this.animPushLeft()\n        pushed = true\n        this.level.moveObject(neighbour, { x: this.position.x - 2, y: this.position.y })\n        this.level.jumpIntoParallelGravity(neighbour)\n        // clears pushing dir to let a new loop to push again\n        this.pushingDirection = null\n      } else {\n        this.pushingDirection = DIRS.LEFT\n        this.animPushLeft()\n      }\n    }\n    return pushed\n  }\n\n  canMoveRight() {\n    return this.canMove(this.position.x + 1, this.position.y)\n  }\n  \n  canPushRight() {\n    const neighbour = this.level.getObjectAt(this.position.x + 1, this.position.y)\n    const nothingBesides = this.level.isPositionClear(this.position.x + 2, this.position.y)\n    const isAboutToFall = this.level.isPositionClear(this.position.x + 1, this.position.y + 1)\n    const canPush = neighbour?.isMoveable && nothingBesides && !isAboutToFall\n    return canPush\n  }\n  \n  pushRight() {\n    const neighbour = this.level.getObjectAt(this.position.x + 1, this.position.y)\n    const canMove = this.canMoveRight()\n    const canPush = this.canPushRight()\n    let pushed = false\n    if(!canMove && canPush) {\n      if(this.pushingDirection === DIRS.RIGHT) {\n        this.animPushRight()\n        this.level.moveObject(neighbour, { x: this.position.x + 2, y: this.position.y })\n        this.level.jumpIntoParallelGravity(neighbour)\n        // clears pushing dir to let a new loop to push again\n        this.pushingDirection = null\n        pushed = true\n      } else {\n        this.pushingDirection = DIRS.RIGHT\n        this.animPushRight()\n      }\n    }\n    return pushed\n  }\n\n  testProximity(targetPos, proximity = 1, onlyRightAngles) {\n    const topLimit = this.position.y - proximity\n    const bottomLimit = this.position.y + proximity\n    const leftLimit = this.position.x - proximity\n    const rightLimit = this.position.x + proximity\n    let retVal = false\n    const isInArea = targetPos.x >= leftLimit && targetPos.x <= rightLimit && targetPos.y >= topLimit && targetPos.y <= bottomLimit\n    const isInRightAngle = targetPos.x === this.position.x || targetPos.y === this.position.y\n    if(isInArea && (!onlyRightAngles || (onlyRightAngles && isInRightAngle))) {\n      retVal = true\n    }\n\n    return retVal\n  }\n}\n\nCharacter.className = 'Character'\n","import { SCALE } from \"../../utils/constants\";\nimport UI from \"../UI\";\nimport Explosion from \"./Explosion\";\nimport Fallable from \"./Fallable\";\nimport Player from \"./Player\";\n\nexport default class Jewel extends Fallable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: false,\n      isPickable: true,\n      isCrushable: false,\n      level,\n    });\n    this.strength = 4;\n  }\n  overrunBy(el) {\n    if (el.isClass(Player)) {\n      this.alien.destroy()\n      this.shine.destroy()\n      // this.alien.visible = false;\n      // this.shine.visible = false;\n      this.level.onJewelPick(this);\n      this.level.scene.events.emit(\"sounds:gem_pick\");\n    }\n\n    if (el.isClass(Explosion)) {\n      this.alien.destroy()\n      this.shine.destroy()\n      // this.alien.visible = false;\n      // this.shine.visible = false;\n      this.alien.destroy();\n    }\n  }\n  move(coords) {\n    super.move(coords);\n    if (!this.shine) {\n      this.shine = this.level.scene.add\n        .sprite(48, 16)\n        .setOrigin(0.05, 0.2)\n        .play(\"diamond_shine\");\n      this.shine.setScale(SCALE());\n      this.shine.depth = 4.5\n    }\n    this.shine.x = UI.tileToScreen(coords.x);\n    this.shine.y = UI.tileToScreen(coords.y);\n    if(this.isFalling) {\n      this.shine.stop()\n    } else {\n      this.shine.play(\"diamond_shine\")\n    }\n  }\n}\n\nJewel.className = \"Jewel\";\n","import Phaser from \"phaser\";\nimport Character from \"./Character\";\nimport Player from \"./Player\";\nimport Boulder from \"./Boulder\";\nimport { DIRS, SCALE, TILE_SIZE } from \"../../utils/constants\";\nimport UI from \"../UI\";\nimport Jewel from \"./Jewel\";\n\nexport default class Enemy extends Character {\n  constructor(id, level) {\n    super(id, level);\n    this.moveIntentDir = DIRS.UP;\n    this.scanDirection = \"CW\";\n    this.anchorPosition = null;\n    this.line1 = null;\n    this.debug = false;\n  }\n  \n  addedToScene() {\n    if (this.debug) {\n      this.directionLine = this.level.scene.add.line(\n        // obj position = tile with 0.5 offset\n        UI.tileToScreen(this.position.x) + UI.tileToScreen(1) / 2,\n        UI.tileToScreen(this.position.y) + UI.tileToScreen(1) / 2,\n        // start point of line\n        0,\n        0,\n        // end point of line\n        0,\n        -UI.tileToScreen(1),\n        0x0000ff\n      );\n      this.directionLine.setRotation(Math.PI / 2);\n      this.directionLine.width = 1; // keep it this size for rotation to properly apply\n      this.directionLine.height = 1; // keep it this size for rotation to properly apply\n      this.directionLine.setOrigin(0.5, 0.5);\n\n      this.anchorLine = this.level.scene.add.line(\n        // obj position = tile with 0.5 offset\n        UI.tileToScreen(this.position.x) + UI.tileToScreen(1) / 2,\n        UI.tileToScreen(this.position.y) + UI.tileToScreen(1) / 2,\n        // start point of line\n        0,\n        0,\n        // end point of line\n        0,\n        -UI.tileToScreen(1),\n        0x00ff00\n      );\n      this.anchorLine.setRotation(Math.PI / 2);\n      this.anchorLine.width = 1; // keep it this size for rotation to properly apply\n      this.anchorLine.height = 1; // keep it this size for rotation to properly apply\n      this.anchorLine.setOrigin(0.5, 0.5);\n    }\n  }\n  overrunBy(el) {\n    if (el.constructor.className !== Player.className) {\n      // this.alien.visible = false\n      // this.alien.alpha = 0.5\n      this.alien?.destroy();\n      this.line1?.destroy();\n      this.level.onCharacterDie(this);\n      this.level.onEnemyKill(this)\n    }\n    if (el.isClass(Boulder) || el.isClass(Jewel)) {\n      this.level.scene.events.emit(\"sounds:death_by_rock_hit\");\n    }\n\n    this.level.enemy_die_effect.x = this.alien.x;\n    this.level.enemy_die_effect.y = this.alien.y;\n    this.level.enemy_die_effect.play(\"enemy_dies\");\n  }\n  loop() {\n    if (this.moveIntentDir === DIRS.RIGHT && this.alien.flipX) {\n      this.alien.setFlipX(false);\n    }\n    if (this.moveIntentDir === DIRS.LEFT && !this.alien.flipX) {\n      this.alien.setFlipX(true);\n    }\n\n    if (this.debug) {\n      this.directionLine.setPosition(\n        UI.tileToScreen(this.position.x) + UI.tileToScreen(1) / 2,\n        UI.tileToScreen(this.position.y) + UI.tileToScreen(1) / 2\n      );\n      this.directionLine.setRotation(\n        this.moveIntentDir === DIRS.UP\n          ? 0\n          : this.moveIntentDir === DIRS.RIGHT\n          ? Math.PI / 2\n          : this.moveIntentDir === DIRS.DOWN\n          ? Math.PI\n          : (3 * Math.PI) / 2\n      );\n      if (this.anchorPosition) {\n        // console.log(this.anchorPosition);\n        this.anchorLine.setPosition(\n          UI.tileToScreen(this.position.x) + UI.tileToScreen(1) / 2,\n          UI.tileToScreen(this.position.y) + UI.tileToScreen(1) / 2\n        );\n\n        this.anchorLine.setRotation(\n          this.anchorPosition.y < this.position.y\n            ? 0\n            : this.anchorPosition.x > this.position.x\n            ? Math.PI / 2\n            : this.anchorPosition.y > this.position.y\n            ? Math.PI\n            : (3 * Math.PI) / 2\n        );\n      }\n    }\n  }\n}\n\nEnemy.className = \"Enemy\";\n","import Character from \"./Character\"\nimport Enemy from \"./Enemy\"\nimport Boulder from \"./Boulder\"\nimport { DIRS } from \"../../utils/constants\"\nimport Player from \"./Player\"\n\nexport default class NPCharacter extends Character {\n  constructor(id, level, name) {\n    super(id, level)\n    this.name = name\n    this.moveIntentDir = \"\"\n    this.isFollowing = false\n    this.isLeading = false\n    this.leadingPath = []\n    level.scene.events.on('player_moves',  this.onPlayerMoves.bind(this))\n    this.personalSpace = 3\n  }\n  \n  onPlayerMoves(nextPos) {\n    if(this.isCloseEnough(nextPos) && this.isLeading) {\n      if(this.leadingPath.length) {\n        const nextPos = this.leadingPath.shift()\n        this.calcMoveIntentForLeader(nextPos)\n        this.level.moveObject(this, nextPos)\n      }\n    }\n  }\n\n  isCloseEnough(pos) {\n    const xDist = Math.abs(this.position.x - pos.x)\n    const yDist = Math.abs(this.position.y - pos.y)\n    return xDist < this.personalSpace && yDist < this.personalSpace\n    // return (\n    //   // NORTH\n    //   (this.position.x === pos.x && this.position.y - 1 === pos.y) ||\n    //   // EAST\n    //   (this.position.x + 1 === pos.x && this.position.y === pos.y) ||\n    //   // SOUTH\n    //   (this.position.x === pos.x && this.position.y + 1 === pos.y) ||\n    //   // WEST\n    //   (this.position.x - 1 === pos.x && this.position.y === pos.y)\n    // )\n  }\n  calcMoveIntentForLeader(nextPos) {\n    this.moveIntentDir = this.position.y < nextPos.y ? DIRS.DOWN : this.moveIntentDir\n    this.moveIntentDir = this.position.y > nextPos.y ? DIRS.UP : this.moveIntentDir\n    if (this.position.x < nextPos.x) {\n      this.moveIntentDir = DIRS.LEFT\n      this.animRunRight()\n    }\n    if (this.position.x > nextPos.x) {\n      this.moveIntentDir = DIRS.RIGHT\n      this.animRunLeft()\n    }\n\n    // this.moveObject(follower, followerNextPos)\n\n    // if(this.moveIntentDir === DIRS.UP) {\n    //   this.alien.depth = 20\n    //   player.alien.depth = 0\n    // } else {\n    //   player.alien.depth = 20\n    //   this.alien.depth = 0\n    // }\n  }\n\n  destroy() {\n    // animate die\n\n  }\n  animIdle() {\n    this.alien?.play(`${this.name}_idle`)\n  }\n\n  animRun() {\n    let animRunVariant = \"\"\n    if (this.moveIntentDir === DIRS.UP) {\n      animRunVariant = \"_up\"\n    }\n    if (this.moveIntentDir === DIRS.DOWN) {\n      animRunVariant = \"_down\"\n    }\n    const animName = `${this.name}_run${animRunVariant}`\n    if (this.alien.anims.currentAnim.key !== animName) {\n      this.alien.play(animName)\n    }\n  }\n  animRunLeft(){\n    this.alien.setFlipX(true)\n    this.alien.setOrigin(0.25, 0.25)\n  }\n  animRunRight(){\n    this.alien.setFlipX(false)\n    this.alien.setOrigin(0, 0.25)\n  }\n  animLayRight() {\n    this.alien?.setFlipX(false)\n    this.alien?.play(`${this.name}_laying`)\n  }\n  animLayLeft() {\n    this.alien?.setFlipX(true)\n    this.alien?.play(`${this.name}_laying`)\n  }\n\n  die() {\n    this.inactive = true\n    this.alien.alpha = 0\n    this.level.scene.events.off('player_moves',  this.onPlayerMoves)\n    this.destroy()\n    // this.level.onCharacterDie(this)\n  }\n\n  overrunBy(el) {\n    if (el.constructor.className === Boulder.className) {\n      this.level.scene.events.emit(\"sounds:death_by_rock_hit\")\n    }\n    if (el.constructor.className !== Player.className) {\n      this.die()\n    }\n  }\n  runningOver(el) {\n    if (el.constructor.className === Enemy.className) {\n      this.die()\n    }\n    // this.isBrakingGround = el.constructor.className === Ground.className\n  }\n}\n\nNPCharacter.className = \"NPCharacter\"\n","import Phaser from 'phaser'\nimport Character from './Character'\nimport Enemy from './Enemy'\nimport Boulder from './Boulder'\nimport { DIRS } from '../../utils/constants'\nimport NPCharacter from './NPCharacter'\nimport Ground from './Ground'\nimport Jewel from './Jewel'\n\nexport default class Player extends Character {\n  constructor(id, level) {\n    super(id, level)\n    this.power = 0.5\n    this.moveIntentDir = ''\n    this.connected = true\n    this.torch = null\n    this.mandatoryPath = []\n    this.ligth = null\n\n    const scene = level.scene\n    scene.input.keyboard.removeListener('keydown', this.onKeyDown)\n    scene.input.keyboard.addListener('keydown', this.onKeyDown.bind(this))\n\n    scene.input.keyboard.removeListener('keyup', this.onKeyUp)\n    scene.input.keyboard.addListener('keyup', this.onKeyUp.bind(this))\n  }\n  disconnect() {\n    this.connected = false\n    this.moveIntentDir = ''\n    if(!this.inactive) {\n      this.animIdle()\n    }\n  }\n  reconnect() {\n    this.connected = true\n  }\n  onKeyUp(event) {\n    if (this.moveIntentDir === event.key && this.connected) {\n      this.moveIntentDir = ''\n      this.pushingDirection = null\n    }\n  }\n  onKeyDown(event) {\n    if(!event.repeat && [DIRS.UP, DIRS.DOWN, DIRS.LEFT, DIRS.RIGHT].includes(event.key) && this.connected) {\n      this.moveIntentDir = event.key;\n      // calls loop to avoid delay between key press and visual movement at the begining of next loop\n      if(!this.isMoving) {\n        this.level.playerLoop()\n      }\n    }\n  }\n  destroy() {\n    \n  }\n  moveToNextPosition() {\n    if(!this.mandatoryPath.length) {\n      this.moveIntentDir = ''\n      this.animIdle()\n      return false\n    }\n    const nextPos = this.mandatoryPath.shift()\n    this.calcMoveIntent(nextPos)\n    this.level.moveObject(this, nextPos)\n    return true\n  }\n  calcMoveIntent(nextPos) {\n    this.moveIntentDir = this.position.y < nextPos.y ? DIRS.DOWN : this.moveIntentDir\n    this.moveIntentDir = this.position.y > nextPos.y ? DIRS.UP : this.moveIntentDir\n    if (this.position.x < nextPos.x) {\n      this.moveIntentDir = DIRS.LEFT\n      this.animRunRight()\n    }\n    if (this.position.x > nextPos.x) {\n      this.moveIntentDir = DIRS.RIGHT\n      this.animRunLeft()\n    }\n  }\n  animIdle() {\n    const animName = this.hasPickaxe ? 'brave_idle_pickaxe' : 'brave_idle'\n    if((this.moveIntentDir === '' || !this.canMoveDir(this.moveIntentDir)) && !this.inactive) {\n      this.alien?.play(animName)\n      this.alien?.setFlipX(false)\n      this.alien?.setOrigin(0, 0.25)\n\n      this.torch?.play('torch_idle')\n      this.torch?.setFlipX(false)\n      this.torch?.setOrigin(0, 0.25)\n    }\n  }\n  animPushRight() {\n    this.alien?.play('brave_push')\n    this.alien.setFlipX(false)\n    this.alien.setOrigin(0, 0.25)\n\n    this.torch?.play('torch_push')\n    this.torch?.setFlipX(false)\n    this.torch?.setOrigin(0, 0.25)\n  }\n  animPushLeft() {\n    this.alien?.play('brave_push')\n    this.alien.setFlipX(true)\n    this.alien.setOrigin(0.25, 0.25)\n\n    this.torch?.play('torch_push')\n    this.torch?.setFlipX(true)\n    this.torch?.setOrigin(0.25, 0.25)\n  }\n  animRun() {\n    let dirVariant = ''\n    let pickaxeVariant = ''\n    let actionVariant = '_run'\n    let character = 'brave'\n    if(this.moveIntentDir === DIRS.UP) {\n      dirVariant = '_up'\n    }\n    if(this.moveIntentDir === DIRS.DOWN) {\n      dirVariant = '_down'\n    }\n    if(this.isBrakingGround) {\n      actionVariant = '_break'\n    }\n    if(this.hasPickaxe) {\n      pickaxeVariant = '_pickaxe'\n      if(dirVariant === '' && this.isBrakingGround && Math.random() > 0.5) {\n        pickaxeVariant = pickaxeVariant + '_alt'\n      }\n    }\n\n    const animName = character + actionVariant + pickaxeVariant + dirVariant\n\n\n    if(this.alien.anims.currentAnim.key !== animName && !this.inactive) {\n      this.alien.play(animName)\n\n      // if(actionVariant.includes('run')) {\n        this.torch?.play('torch_run' + dirVariant)\n      // }\n      // if(actionVariant.includes('break')) {\n      //   this.torch?.play('torch_break' + dirVariant)\n      // }\n    }\n\n  }\n  // these 2 method are probably switched.\n  // animRunRight is called when player runs left and viceversa\n  animRunRight(){\n    this.alien.setFlipX(false)\n    this.alien.setOrigin(0, 0.25)\n    // this.alien.setFlipX(true)\n    this.torch?.setFlipX(false)\n    this.torch?.setOrigin(0, 0.25)\n    // this.torch?.setFlipX(true)\n  }\n  animRunLeft(){\n    this.alien.setFlipX(true)\n    this.alien.setOrigin(0.25, 0.25)\n    // this.alien.setFlipX(false)\n    this.torch?.setFlipX(true)\n    this.torch?.setOrigin(0.25, 0.25)\n    // this.torch?.setFlipX(false)\n  }\n\n  die() {\n    this.inactive = true\n    // this.disconnect()\n    const scene = this.level.scene\n    scene.input.keyboard.off('keydown')\n    scene.input.keyboard.off('keyup')\n    // animate die\n    this.level.onCharacterDie(this)\n    this.alien.play('brave_dies')\n    this.alien.on(Phaser.Animations.Events.ANIMATION_COMPLETE, () => {\n      this.destroy()\n      this.alien.alpha = 0\n    })\n  }\n\n  overrunBy(el) {\n    if (el.constructor.className === Boulder.className) {\n      this.level.scene.events.emit('sounds:death_by_rock_hit')\n    }\n    \n    if (el.constructor.className !== NPCharacter.className) {\n      this.die()\n    }\n  }\n  runningOver(el) {\n    if(el.isClass(Enemy)) {\n      this.die()\n    }\n    \n    if(el.isClass(Ground)) {\n      const layer = this.level.scene.children.getByName('layer_1')\n      const { tilemap: map } = layer\n      this.level.break_effect.x = map.tileToWorldX(el.position.x)\n      this.level.break_effect.y = map.tileToWorldY(el.position.y)\n      this.level.break_effect.play('ground_breaks')\n    }\n    if(el.isClass(Jewel)) {\n      const layer = this.level.scene.children.getByName('layer_1')\n      const { tilemap: map } = layer\n      this.level.pick_effect.x = map.tileToWorldX(el.position.x)\n      this.level.pick_effect.y = map.tileToWorldY(el.position.y)\n      this.level.pick_effect.play('jewel_pick')\n    }\n  }\n\n  setupLight() {\n    this.light = this.level.scene.lights\n    .addLight(this.alien.x, this.alien.y, 1000)\n    .setColor(0xeaeaea)\n    .setIntensity(1.5);\n  }\n\n  ligthTorch() {\n    if(!this.light) {\n      this.setupLight()\n    }\n    this.alien.alpha = 1\n    this.torch = this.level.scene.add.sprite(48, 16).setOrigin(0, 0.25)\n    this.torch.setScale(this.alien.scaleX)\n    this.torch.depth = 4.5 // .5 higher than player when has follower\n    this.torch.play('torch_idle')\n    this.level.scene.time.addEvent({\n      delay: 10,\n      callback: function ()\n      {\n        this.torch.x = this.alien?.x\n        this.torch.y = this.alien?.y\n      },\n      callbackScope: this,\n      repeat: -1\n    })\n\n    this.level.scene.time.addEvent({\n      delay: 100,\n      callback: function () {\n        this.light.x = this.alien.x;\n        this.light.y = this.alien.y;\n        Phaser.Geom.Ellipse.Random(this.alien, this.light);\n      },\n      callbackScope: this,\n      repeat: -1,\n    });\n  }\n}\n\nPlayer.className = 'Player'\n","import GameObject from './GameObject'\n\nexport default class Wall extends GameObject {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: true,\n      isBreakable: false,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: false,\n      level\n    })\n    this.strength = 20\n  }\n}\n\nWall.className = 'Wall'\n","import Empty from './Empty'\nimport Player from './Player'\n\nexport default class Interactive extends Empty {\n  constructor(id, level) {\n    super(id, level)\n    this.ephemeral = true\n  }\n  overrunBy(el) {\n    if (el.isClass(Player)) {\n      this.level.onInteractWith(this)\n    }\n  }\n}\n\nInteractive.className = 'Interactive'\n","import Interactive from \"./Interactive\"\n\nexport default class Exit extends Interactive {\n}\n\nExit.className = 'Exit'\n","import { PIXEL_NAME, SCALE, TICK_TIME, TILE_SIZE } from '../../utils/constants'\nimport UI from '../UI'\nimport Empty from './Empty'\nimport Explosion from './Explosion'\nimport Fallable from './Fallable'\n\nexport default class Barrel extends Fallable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: true,\n      level\n    })\n    this.reach = 1\n    this.strength = 5\n    this.objectsToDestroyByExplostion = []\n  }\n  addedToScene() {\n    let particles = this.level.scene.add.particles(\"spark\").setScale(SCALE);\n    this.emitter = particles.createEmitter();\n    this.emitter.setQuantity(15);\n    this.emitter.setFrequency(1000);\n    this.emitter.setAngle({ min: -180, max: 90 });\n    this.emitter.setSpeed({min: 5, max: 7 });\n    this.emitter.setGravityY(1);\n    this.emitter.setGravityX(0.01);\n    this.emitter.setLifespan({ min: 1000, max: 5000 });\n    this.emitter.alpha.onChange(0.5);\n    this.emitter.tint.onChange(0xD25400);\n    this.emitter.stop()\n  }\n  explode() {\n    this.alien?.destroy()\n\n    // remove barrel\n    this.level.moveables = this.level.moveables.filter((e) => e !== this);\n    this.level.parallelMovables = this.level.parallelMovables.filter((e) => e !== this);\n    this.level.replaceByEmpty(this);\n\n    // freeze explosion places so objects can not move before the explosion triggers\n    for (let x = this.position.x - this.reach; x <= this.position.x + this.reach; x++) {\n      for (\n        let y = this.position.y - this.reach;\n        y <= this.position.y + this.reach;\n        y++\n      ) {\n        const burntEl = this.level.getObjectAt(x, y);\n        const burntWillBreak =\n          burntEl.isBreakable && (burntEl.strength || 0) < 10 // explosion.power\n        if (burntWillBreak && !this.level.objectIsEmpty(burntEl)) {\n          this.objectsToDestroyByExplostion.push(burntEl)\n          if(burntEl.isClass(Fallable)) {\n            // prevent to keep moving by removing it from movables\n            this.level.moveables = this.level.moveables.filter((e) => e !== burntEl);\n            this.level.parallelMovables = this.level.parallelMovables.filter((e) => e !== burntEl);\n          }\n        }\n        if (burntWillBreak || this.level.objectIsEmpty(burntEl)) {\n          // complete explosion matrix with empty elements to replace them later with explosion objects\n          const explosionPlaceholder = new Explosion(PIXEL_NAME.EXPLOSION, this.level)\n          // const explosionPlaceholder = new Empty(PIXEL_NAME.EMPTY, this.level)\n          // explosionPlaceholder.isEmpty = false\n          explosionPlaceholder.setPosition({ x, y })\n          this.level.setObjectAt(x, y, explosionPlaceholder);\n          this.objectsToDestroyByExplostion.push(explosionPlaceholder)\n        }\n      }\n    }\n    // setTimeout(() => this.level.onExplode(this), TICK_TIME/2)\n    setTimeout(() => this.onExplode(), TICK_TIME/2)\n    \n    this.level.scene.events.emit('sounds:explosion')\n    this.level.scene.events.emit('barre:explode', this)\n    this.level.scene.cameras.main.shake(500, 0.003)\n  }\n\n  onExplode() {\n    const lvl = this.level\n    this.objectsToDestroyByExplostion.forEach(burntEl => {\n        \n      const explosion = new Explosion(PIXEL_NAME.EXPLOSION, lvl);\n      if(!burntEl.isClass(Explosion)) {\n        burntEl.overrunBy(explosion);\n        lvl.onDestroyElement(burntEl);\n      }\n    })\n    \n    this.emitter.setPosition(\n      { min: UI.tileToPixels(this.position.x), max: UI.tileToPixels(this.position.x + 1) },\n        { min: UI.tileToPixels(this.position.y), max: UI.tileToPixels(this.position.y + 1) }\n    );\n    // this.emitter.start()\n    this.level.onNextTick(lvl => {\n      this.emitter.stop()\n    })\n  }\n  overrunBy() {\n    this.explode()\n    // setTimeout(() => this.explode(), TICK_TIME/2)\n  }\n}\nBarrel.className = 'Barrel'\n\n","import Explosion from './Explosion'\nimport Fallable from './Fallable'\nimport Player from './Player'\n\nexport default class Mushroom extends Fallable {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: false,\n      isBreakable: true,\n      isFlat: false,\n      isPickable: true,\n      isCrushable: false,\n      level\n    })\n    this.strength = 4\n  }\n  overrunBy(el) {\n    if(el.isClass(Player)) {\n      this.alien.visible = false\n      this.level.onMushroomPick(this)\n      this.level.scene.events.emit('sounds:shroom_pick')\n      this.level.scene.events.emit('score:mushroom_collected')\n    }\n\n    if(el.isClass(Explosion)) {\n      this.alien.visible = false\n      this.alien.destroy()\n    }\n  }\n}\n\nMushroom.className = 'Mushroom'\n","import UI from '../UI'\nimport GameObject from './GameObject'\nimport Phaser from 'phaser'\nimport { PIXEL_NAME, SCALE, TILE_SIZE } from '../../utils/constants'\nimport Interactive from './Interactive'\nimport Player from './Player'\n\nexport default class Torch extends GameObject {\n  constructor(id, level) {\n    super({\n      id,\n      isRigid: true,\n      isBreakable: false,\n      isFlat: true,\n      isPickable: false,\n      isCrushable: false,\n      level\n    })\n    this.isLit = false\n    this.light = null\n    this.alien = level.scene.add\n      .sprite(48, 16)\n      .setOrigin(0, 0.5)\n      .play(\"wall_torch_idle\");\n    this.alien.on(Phaser.Animations.Events.ANIMATION_COMPLETE, () => {\n      if(this.isLit) {\n        if(this.alien.flipX) {\n          this.alien.setOrigin(0, 0.5)\n        } else {\n          this.alien.setOrigin(0.15, 0.5)\n        }\n        this.alien.setFlipX(!this.alien.flipX)\n        this.alien.play(\"wall_torch_lit\")\n      }\n    });\n    this.alien.setScale(SCALE());\n    this.strength = 20\n    this.leftTrigger = null\n    this.rightTrigger = null\n  }\n\n  ignite() {\n    this.alien.play(\"wall_torch_lighting\")\n    this.isLit = true\n    this.setUpLights()\n  }\n  \n  async setPosition(coords) {\n    super.setPosition(coords)\n\n    this.alien.x = UI.tileToScreen(coords.x);\n    this.alien.y = UI.tileToScreen(coords.y);\n    \n    this.level.onNextTick(() => {\n      this.setIgniteTriggers()\n    })\n  }\n\n  setUpLights() {\n    this.light = this.level.scene.lights\n      .addLight(UI.tileToScreen(this.position.x), UI.tileToScreen(this.position.y), 1000)\n      .setColor(0xeaeaea)\n      .setIntensity(0);\n    \n    this.level.scene.time.addEvent({\n      delay: 100,\n      callback: function () {\n        if(this.light.intensity < 1.5) {\n          this.light.setIntensity(this.light.intensity + 0.3)\n        }\n        Phaser.Geom.Ellipse.Random(\n          {x: this.alien.x + UI.tileToPixels(1), y: this.alien.y, width: this.alien.width, height: this.alien.height },\n          this.light\n        );\n      },\n      callbackScope: this,\n      repeat: -1,\n    });\n  }\n\n  setIgniteTriggers() {\n    const leftNeighbour = this.level.getObjectAt(this.position.x - 1, this.position.y)\n    const rightNeighbour = this.level.getObjectAt(this.position.x + 1, this.position.y)\n    const onInteract = el => {\n      if (el.isClass(Player) && el.torch && !this.isLit) {\n        this.ignite()\n      }\n    }\n    if(leftNeighbour) {\n      const element = new Interactive(PIXEL_NAME.INTERACTION, this)\n      element.setPosition(leftNeighbour.position)\n      element.overrunBy = onInteract\n      this.level.interactiveElements[`${element.position.x}-${element.position.y}`] = element\n      this.leftTrigger = element\n    }\n    if(rightNeighbour) {\n      const element = new Interactive(PIXEL_NAME.INTERACTION, this)\n      element.setPosition(rightNeighbour.position)\n      element.overrunBy = onInteract\n      this.level.interactiveElements[`${element.position.x}-${element.position.y}`] = element\n      this.rightTrigger = element\n    }\n  }\n\n}\n\nTorch.className = 'Torch'\n","import { SCALE } from \"../../utils/constants\";\nimport dbManager from \"../../utils/dbManager\";\nimport { translate } from \"../../utils/localization\";\nimport { Exit, Interactive } from \"../objects\";\nimport UI from \"../UI\";\nimport LevelBase from \"./levelBase\";\n\nclass Level1 extends LevelBase {\n  constructor() {\n    super();\n    this.name = \"The beginning\";\n  }\n\n  get id() {\n    return this.constructor.key;\n  }\n\n  connectToScene(scene) {\n    super.connectToScene(scene);\n\n    if(this.unfinished) {\n      scene.events.once(\"levelstart\", () => this.showDialog1());\n    }\n\n    let light_beam = this.scene.add.image(\n      this.scene.cameras.main.width / 2,\n      this.scene.cameras.main.height / 2,\n      \"light_beam\"\n    );\n    light_beam.x = UI.tileToScreen(14);\n    light_beam.y = UI.tileToScreen(1);\n    light_beam.setOrigin(0, 0);\n    light_beam.setScale(SCALE * 2);\n    light_beam.scaleX = SCALE * 2.4;\n    light_beam.setScrollFactor(1);\n    light_beam.depth = 4.5;\n    light_beam.alpha = 0.5;\n\n    var particles = scene.add.particles(\"spark\").setScale(SCALE);\n    var emitter = particles.createEmitter();\n    emitter.setPosition(\n      { min: UI.tileToPixels(17), max: UI.tileToPixels(28) },\n      { min: UI.tileToPixels(0), max: UI.tileToPixels(10) }\n    );\n    emitter.setQuantity(5);\n    emitter.setFrequency(20000);\n    emitter.setAngle({ min: 0, max: 360 });\n    emitter.setSpeed(5);\n    emitter.setGravityY(0.1);\n    emitter.setGravityX(0);\n    emitter.setLifespan({ min: 10000, max: 50000 });\n    emitter.alpha.onChange(0.5);\n  }\n\n  showDialog1() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\"],\n      participantNames: [\"Mary\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_1.dialog_1.mary_say_1\")],\n          options: [],\n        },\n      ],\n    });\n  }\n  showDialog2() {\n    this.scene.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\"],\n      participantNames: [\"Mary\"],\n      conversation: [\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"level_1.dialog_2.mary_say_1\")],\n          options: [],\n        },\n      ],\n    });\n  }\n\n  onInteractWith(el) {\n    super.onInteractWith(el);\n    if (el.isClass(Exit)) {\n      this.onComplete();\n    }\n    if (el.isClass(Interactive) && el.order === 0 && this.unfinished) {\n      this.showDialog2();\n    }\n  }\n}\nLevel1.key = \"level_1\";\nexport default Level1;\n","import Phaser from 'phaser'\nimport Level1 from '../components/levels/level_1';\nimport Level2 from '../components/levels/level_2';\nimport Level3 from '../components/levels/level_3';\nimport Level4 from '../components/levels/level_4';\nimport Level5 from '../components/levels/level_5';\nimport Level6 from '../components/levels/level_6';\nimport Level7 from '../components/levels/level_7';\nimport Level8 from '../components/levels/level_8';\nimport Level9 from '../components/levels/level_9';\nimport Level10 from '../components/levels/level_10';\nimport Level11 from '../components/levels/level_11';\nimport Level12 from '../components/levels/level_12';\nimport Level13 from '../components/levels/level_13';\nimport Level14 from '../components/levels/level_14';\nimport Level15 from '../components/levels/level_15';\nimport Level16 from '../components/levels/level_16';\nimport Level17 from '../components/levels/level_17';\nimport LevelFinale from '../components/levels/level_finale';\nimport LevelTest from '../components/levels/level_test';\nimport LevelMaze1 from '../components/levels/Maze_1';\nimport UIMenus from '../components/UIMenus';\nimport { SCALE } from '../utils/constants'\nimport CRTFilter from '../utils/CRTShaderFX'\nimport { translate } from '../utils/localization';\n\nlet titlesMusic\nexport default class LandingScene extends Phaser.Scene {\n  constructor () {\n    super('LandingScene');\n  }\n\n  preload () {\n    const txt = this.add.text(80 * SCALE(), (121) * SCALE() + 20 * SCALE(),\n    translate('menu.main.loading_message'),\n    // https://en.wikipedia.org/wiki/Sumerian_language\n\n    // 𒉆  𒅗𒈠    𒋛𒀀𒋛𒀀𒂠       𒂊𒀝\n    // nam  inim-ma  diri-diri-še3  e-ak\n    // acted unspeakably\n\n    // 𒄑𒆵𒆠𒁕   𒁮𒄩𒊏    𒂊𒁕𒀝\n    // ummaki-da  dam-ḫa-ra  e-da-ak\n\n\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"40px\",\n        fill: \"#ffffff\",\n      }\n    ).setShadow(-1,1)\n  \n    txt.setScale(SCALE() / 5)\n    this.load.script('webfont', 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js');\n    // this.load.image('main-tiles', process.env.PUBLIC_URL + '/assets/tilemaps/tilemap_20x20.png');\n    this.load.image('main-tiles', process.env.PUBLIC_URL + '/assets/tilemaps/world1_tiles_20x20.png');\n    this.load.image('gates-tiles', process.env.PUBLIC_URL + '/assets/tilemaps/gates_tilemap_20x20.png');\n    this.load.image('hud-tiles', process.env.PUBLIC_URL + '/assets/tilemaps/hud_tilemap_20x20.png');\n    this.load.image('_level_2', process.env.PUBLIC_URL + '/assets/maps/test.png');\n    this.load.image(LevelTest.key, process.env.PUBLIC_URL + '/assets/maps/level_test.png');\n    this.load.image(`${LevelTest.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_test_bg.png');\n    this.load.image(Level1.key, process.env.PUBLIC_URL + '/assets/maps/level_1.png');\n    this.load.image(`${Level1.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_1_bg.png');\n    this.load.image(Level2.key, process.env.PUBLIC_URL + '/assets/maps/level_2.png');\n    this.load.image(`${Level2.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_2_bg.png');\n    this.load.image(Level3.key, process.env.PUBLIC_URL + '/assets/maps/level_3.png');\n    this.load.image(`${Level3.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_3_bg.png');\n    this.load.image(Level4.key, process.env.PUBLIC_URL + '/assets/maps/level_4.png');\n    this.load.image(`${Level4.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level5.key, process.env.PUBLIC_URL + '/assets/maps/level_5.png');\n    this.load.image(`${Level5.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level6.key, process.env.PUBLIC_URL + '/assets/maps/level_6.png');\n    this.load.image(`${Level6.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level7.key, process.env.PUBLIC_URL + '/assets/maps/level_7.png');\n    this.load.image(`${Level7.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level8.key, process.env.PUBLIC_URL + '/assets/maps/level_8.png');\n    this.load.image(`${Level8.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level9.key, process.env.PUBLIC_URL + '/assets/maps/level_9.png');\n    this.load.image(`${Level9.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level10.key, process.env.PUBLIC_URL + '/assets/maps/level_10.png');\n    this.load.image(`${Level10.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level11.key, process.env.PUBLIC_URL + '/assets/maps/level_11.png');\n    this.load.image(`${Level11.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level12.key, process.env.PUBLIC_URL + '/assets/maps/level_12.png');\n    this.load.image(`${Level12.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level13.key, process.env.PUBLIC_URL + '/assets/maps/level_13.png');\n    this.load.image(`${Level13.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level14.key, process.env.PUBLIC_URL + '/assets/maps/level_14.png');\n    this.load.image(`${Level14.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level15.key, process.env.PUBLIC_URL + '/assets/maps/level_15.png');\n    this.load.image(`${Level15.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level16.key, process.env.PUBLIC_URL + '/assets/maps/level_16.png');\n    this.load.image(`${Level16.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(Level17.key, process.env.PUBLIC_URL + '/assets/maps/level_17.png');\n    this.load.image(`${Level17.key}_bg`, process.env.PUBLIC_URL + '/assets/maps/level_default_bg.png');\n    this.load.image(LevelFinale.key, process.env.PUBLIC_URL + '/assets/maps/level_finale.png');\n    this.load.image('Stage1_bg', process.env.PUBLIC_URL + '/assets/images/stage_1_bg_art.png');\n    this.load.image('IntroTiamat', process.env.PUBLIC_URL + '/assets/images/intro_tiamat.png');\n    this.load.image('IntroSky', process.env.PUBLIC_URL + '/assets/images/intro_sky.png');\n    this.load.image('IntroClouds', process.env.PUBLIC_URL + '/assets/images/intro_clouds.png');\n    this.load.image('IntroGround', process.env.PUBLIC_URL + '/assets/images/intro_ground.png');\n    this.load.image('IntroGroundHigh', process.env.PUBLIC_URL + '/assets/images/intro_ground_high.png');\n    this.load.image('IntroGroundBreak', process.env.PUBLIC_URL + '/assets/images/intro_ground_break.png');\n    this.load.image('IntroComet', process.env.PUBLIC_URL + '/assets/images/intro_comet.png');\n    this.load.image('IntroPeopleClimbing', process.env.PUBLIC_URL + '/assets/images/intro_people_climbing.png');\n    this.load.image('IntroPeoplePraying', process.env.PUBLIC_URL + '/assets/images/intro_people_praying.png');\n    this.load.image('IntroPeoplePrayingHigh', process.env.PUBLIC_URL + '/assets/images/intro_people_praying_high.png');\n    this.load.image('IntroPeopleDescending', process.env.PUBLIC_URL + '/assets/images/intro_people_descending.png');\n    this.load.image('IntroPeopleFalling', process.env.PUBLIC_URL + '/assets/images/intro_people_falling.png');\n    this.load.image('IntroPeopleJumping', process.env.PUBLIC_URL + '/assets/images/intro_people_jumping.png');\n    this.load.image('IntroStorm', process.env.PUBLIC_URL + '/assets/images/intro_storm.png');\n    this.load.image('Prologue', process.env.PUBLIC_URL + '/assets/images/Prologue.png');\n    this.load.image('thechild', process.env.PUBLIC_URL + '/assets/images/thechild.png');\n    this.load.image('theworld', process.env.PUBLIC_URL + '/assets/images/theworld.png');\n    this.load.image('Tiamat', process.env.PUBLIC_URL + '/assets/images/Tiamat.png');\n    this.load.image('Cover', process.env.PUBLIC_URL + '/assets/images/cover.png');\n    this.load.image('Bossfight', process.env.PUBLIC_URL + '/assets/images/Bossfight.png');\n    this.load.image('Bossfighthands', process.env.PUBLIC_URL + '/assets/images/Bossfighthands.png');\n    this.load.image('spark', process.env.PUBLIC_URL + '/assets/sprites/flare_blue.png');\n    this.load.image('light_beam', process.env.PUBLIC_URL + '/assets/sprites/light_beam.png');\n    this.load.spritesheet('boulder', process.env.PUBLIC_URL + '/assets/sprites/boulder_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('explosion', process.env.PUBLIC_URL + '/assets/sprites/explosion_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('torch', process.env.PUBLIC_URL + '/assets/sprites/torch_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('brave', process.env.PUBLIC_URL + '/assets/sprites/brave_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('bro', process.env.PUBLIC_URL + '/assets/sprites/bro_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('dwarf', process.env.PUBLIC_URL + '/assets/sprites/dwarf_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('gate', process.env.PUBLIC_URL + '/assets/sprites/gate_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('bat', process.env.PUBLIC_URL + '/assets/sprites/bat_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('pickables', process.env.PUBLIC_URL + '/assets/sprites/pickables_sprite.png', { frameWidth: 26, frameHeight: 26 });\n    this.load.spritesheet('closeUp', process.env.PUBLIC_URL + '/assets/sprites/close_up_sprite.png', { frameWidth: 40, frameHeight: 40 });\n    this.load.spritesheet('closeUpItems', process.env.PUBLIC_URL + '/assets/sprites/close_up_sprite.png', { frameWidth: 20, frameHeight: 20 });\n    this.load.audio('credits', process.env.PUBLIC_URL + '/assets/audio/Score/Opening Credits_.mp3');\n    this.load.audio('opening_peace', process.env.PUBLIC_URL + '/assets/audio/Score/NormalDay.mp3');\n    this.load.audio('opening_quakes', process.env.PUBLIC_URL + '/assets/audio/Score/Earthquakes+Tiamat.mp3');\n    this.load.audio('credits', process.env.PUBLIC_URL + '/assets/audio/Score/NormalDay.mp3');\n    this.load.audio('levels_surface', process.env.PUBLIC_URL + '/assets/audio/Score/1st 7 Levels.mp3');\n    this.load.audio('swarf_chat_music', process.env.PUBLIC_URL + '/assets/audio/Score/MushroomDwarfDialogue(loop).mp3');\n    this.load.audio('generic_chat_music', process.env.PUBLIC_URL + '/assets/audio/Score/GenericDialogue(loop).mp3');\n    this.load.audio('escape_music', process.env.PUBLIC_URL + '/assets/audio/Score/BossBattle_EscapeTheVoid!(loop).mp3');\n    this.load.audio('rock_hit', process.env.PUBLIC_URL + '/assets/audio/SFX/RockHit.mp3');\n    this.load.audio('rock_hit2', process.env.PUBLIC_URL + '/assets/audio/SFX/RockHit2.mp3');\n    this.load.audio('rock_hit3', process.env.PUBLIC_URL + '/assets/audio/SFX/RockHit3.wav');\n    this.load.audio('rock_hit_soft', process.env.PUBLIC_URL + '/assets/audio/SFX/RockHitSoft.mp3');\n    this.load.audio('explosion', process.env.PUBLIC_URL + '/assets/audio/SFX/MidSizeExplosion.mp3');\n    this.load.audio('clear_hit1', process.env.PUBLIC_URL + '/assets/audio/SFX/PickaxeClearingGround1.mp3');\n    this.load.audio('clear_hit2', process.env.PUBLIC_URL + '/assets/audio/SFX/PickaxeClearingGround2.mp3');\n    this.load.audio('clear_hit3', process.env.PUBLIC_URL + '/assets/audio/SFX/PickaxeClearingGround3.mp3');\n    this.load.audio('rock_slide_hard1', process.env.PUBLIC_URL + '/assets/audio/SFX/RockSlideHard1.mp3');\n    this.load.audio('rock_slide_hard2', process.env.PUBLIC_URL + '/assets/audio/SFX/RockSlideHard2.mp3');\n    this.load.audio('rock_slide_hard3', process.env.PUBLIC_URL + '/assets/audio/SFX/RockSlideHard3.mp3');\n    this.load.audio('rock_slide_soft1', process.env.PUBLIC_URL + '/assets/audio/SFX/RockSlideSoft1.mp3');\n    this.load.audio('rock_slide_soft2', process.env.PUBLIC_URL + '/assets/audio/SFX/RockSlideSoft2.mp3');\n    this.load.audio('rock_slide_soft3', process.env.PUBLIC_URL + '/assets/audio/SFX/RockSlideSoft3.mp3');\n    this.load.audio('coin', process.env.PUBLIC_URL + '/assets/audio/SFX/CoinSound.mp3');\n    this.load.audio('gem_hit', process.env.PUBLIC_URL + '/assets/audio/SFX/GemHitRock.mp3');\n    this.load.audio('shroom_pick', process.env.PUBLIC_URL + '/assets/audio/SFX/MushroomPickUp.mp3');\n    this.load.audio('gem_pick', process.env.PUBLIC_URL + '/assets/audio/SFX/DiamondPickUp.mp3');\n    this.load.audio('death_by_rock', process.env.PUBLIC_URL + '/assets/audio/SFX/DeathByRock.mp3')\n    this.load.audio('level_complete', process.env.PUBLIC_URL + '/assets/audio/SFX/Level Finish.mp3')\n    this.load.audio('earthquake', process.env.PUBLIC_URL + '/assets/audio/SFX/Earthquake.mp3')\n    // this.load.on(Phaser.Loader.Events.PROGRESS, console.log)\n  }\n\n  navigateToScene(sceneId, props = {}) {\n    this.cameras.main.fade(500, 0, 0, 0)\n    this.tweens.add({  \n      targets: titlesMusic,\n      volume: 0,\n      ease: 'Linear',\n      duration: 500,\n      onComplete: () => {\n        titlesMusic.pause()\n        console.log(sceneId);\n        this.scene.start(sceneId, props)\n      },\n    });\n  }\n\n  create() {\n    this.cameras.main.setPostPipeline(CRTFilter);\n    // this.cameras.main.setBackgroundColor(\"#486859\")\n    this.cameras.main.setBackgroundColor(\"#000\")\n\n    let image = this.add.image(this.cameras.main.width / 2, this.cameras.main.height / 2, 'Cover')\n    // let image = this.add.image(this.cameras.main.width / 2, this.cameras.main.height / 3, 'Cover')\n    let scaleX = this.cameras.main.width / image.width\n    let scaleY = this.cameras.main.height / image.height\n    let scale = Math.min(scaleX, scaleY)\n    image.setOrigin(0.5, 0.5)\n    image.setScale(scale).setScrollFactor(0)\n    // image.setScale(scale * 1.5).setScrollFactor(0)\n    image.name = 'background_art'\n\n    \n\n\n    // off-line version\n    // this.cameras.main.fadeIn(500, 0, 0, 0)\n    // this.events.emit('scene_ready', this.sys.config)\n    // const menu = new UIMenus(this)\n    // menu.showInitialMenu()\n    // titlesMusic = this.sound.add('credits', { loop: true });\n    // return false\n\n    titlesMusic = this.sound.add('credits', { loop: true });\n    window.WebFont.load({\n      custom: {\n          families: [ 'GameGirl', 'Emulogic' ]\n      },\n      active: () => {\n        this.cameras.main.fadeIn(500, 0, 0, 0)\n        this.events.emit('scene_ready', this.sys.config)\n\n        titlesMusic = this.sound.add('credits', { loop: true });\n        // titlesMusic.play()\n        \n        // this.events.once(Phaser.Scenes.Events.WAKE, () => console.log(Phaser.Scenes.Events.WAKE))\n        // this.events.once(Phaser.Scenes.Events.UPDATE, () => console.log(Phaser.Scenes.Events.UPDATE))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_WAKE, () => console.log(Phaser.Scenes.Events.TRANSITION_WAKE))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_START, () => console.log(Phaser.Scenes.Events.TRANSITION_START))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_OUT, () => console.log(Phaser.Scenes.Events.TRANSITION_OUT))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_INIT, () => console.log(Phaser.Scenes.Events.TRANSITION_INIT))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_COMPLETE, () => console.log(Phaser.Scenes.Events.TRANSITION_COMPLETE))\n        // this.events.once(Phaser.Scenes.Events.START, () => console.log(Phaser.Scenes.Events.START))\n        // this.events.once(Phaser.Scenes.Events.SLEEP, () => console.log(Phaser.Scenes.Events.SLEEP))\n        // this.events.once(Phaser.Scenes.Events.SHUTDOWN, () => console.log(Phaser.Scenes.Events.SHUTDOWN))\n        // this.events.once(Phaser.Scenes.Events.RESUME, () => console.log(Phaser.Scenes.Events.RESUME))\n        // this.events.once(Phaser.Scenes.Events.RENDER, () => console.log(Phaser.Scenes.Events.RENDER))\n        // this.events.once(Phaser.Scenes.Events.READY, () => console.log(Phaser.Scenes.Events.READY))\n        // this.events.once(Phaser.Scenes.Events.PRE_RENDER, () => console.log(Phaser.Scenes.Events.PRE_RENDER))\n        // this.events.once(Phaser.Scenes.Events.PAUSE, () => console.log(Phaser.Scenes.Events.PAUSE))\n        // this.events.once(Phaser.Scenes.Events.CREATE, () => console.log(Phaser.Scenes.Events.CREATE))\n        // this.events.once(Phaser.Scenes.Events.BOOT, () => console.log(Phaser.Scenes.Events.BOOT))\n\n        // let currentOption = 0\n\n        // const arrow = this.add.graphics({ fillStyle: { color: 0xffffff, alpha: 1 } })\n        // arrow.fillTriangle(0, 0, 5, 5, 0, 10).setPosition(70 * SCALE, 27 * SCALE)\n        // // arrow.setPosition(70 * SCALE, ((12 * newOption) + 2) * SCALE)\n        // arrow.setScale(SCALE)\n        \n        const menu = new UIMenus(this)\n        menu.showInitialMenu()\n        \n\n        // menuOptions.forEach((o, idx) => {\n        //   const txt = this.add.text(80 * SCALE, (14 * idx + 1) * SCALE + 20 * SCALE,\n        //     o.label,\n        //     {\n        //       fontFamily: 'GameGirl',\n        //       // fontSize: \"14px\",\n        //       fill: \"#ffffff\",\n        //     }\n        //   ).setVisible(!o.disabled)\n        //   txt.displayHeight = 10 * SCALE\n        //   txt.setScale(SCALE)\n        //   // txt.displayWidth = idx * 10 * SCALE\n\n        // })\n\n        // this.input.keyboard.on('keydown', event => {\n        //   let newOption = false\n        //   if (event.key === 'ArrowUp') {\n        //     newOption = currentOption > 0 ? currentOption - 1 : menuOptions.length - 1\n        //   }\n        //   if (event.key === 'ArrowDown') {\n        //     newOption = currentOption < menuOptions.length - 1 ? currentOption + 1 : 0\n        //   }\n        //   if(newOption !== false && !menuOptions[newOption].disabled) {\n        //     const INIT_OFFSET = 27 * SCALE\n        //     arrow.setPosition(70 * SCALE, (14 * newOption) * SCALE + INIT_OFFSET)\n        //     currentOption = newOption\n        //   }\n        //   if (event.key === 'Enter') {\n        //     if(!menuOptions[currentOption].disabled) {\n        //       menuOptions[currentOption].onSelect()\n        //     }\n        //   }\n        // })\n      }\n    })\n  }\n}\n","import Phaser from \"phaser\";\nimport UIMenus from \"../components/UIMenus\";\nimport { SCALE } from \"../utils/constants\";\nimport CRTFilter from \"../utils/CRTShaderFX\";\nimport dbManager from \"../utils/dbManager\";\n\nlet titlesMusic;\nexport default class MenuScene extends Phaser.Scene {\n  constructor() {\n    super(\"MenuScene\");\n  }\n\n  preload() {}\n\n  navigateToScene(sceneId, props = {}) {\n    this.cameras.main.fade(500, 0, 0, 0);\n    this.tweens.add({\n      targets: titlesMusic,\n      volume: 0,\n      ease: \"Linear\",\n      duration: 500,\n      onComplete: () => {\n        titlesMusic.pause();\n        this.scene.start(sceneId, props);\n      },\n    });\n  }\n\n  create() {\n    this.cameras.main.setPostPipeline(CRTFilter);\n    this.cameras.main.setBackgroundColor(\"#486859\");\n\n    let image = this.add.image(\n      this.cameras.main.width / 2,\n      // this.cameras.main.width / 2,\n      this.cameras.main.height / 2,\n      // this.cameras.main.height / 3,\n      \"Stage1_bg\"\n    );\n    let scaleX = this.cameras.main.width / image.width;\n    let scaleY = this.cameras.main.height / image.height;\n    let scale = Math.max(scaleX, scaleY);\n    image.setScale(scale * 1.5).setScrollFactor(0);\n    image.name = \"background_art\";\n\n    // //  Enable lights and set a dark ambient color\n    // this.lights.enable().setAmbientColor(0x333333);\n    // image.setPipeline(\"Light2D\");\n    // //  Our spotlight. 100px radius and white in color.\n    // var light = this.lights\n    //   .addLight(180, 80, 200)\n    //   .setColor(0xffffff)\n    //   .setIntensity(2);\n    // //  Track the pointer\n    // this.input.on(\"pointermove\", function (pointer) {\n    //   light.x = pointer.x;\n    //   light.y = pointer.y;\n    // });\n\n    // var flash = this.plugins.get('rexFlash').add(part);\n    // flash.flash()\n\n    // var particles = this.add.particles('spark').setScale(SCALE);\n\n    // var emitter = particles.createEmitter();\n\n    // emitter.setPosition(10*SCALE, 10*SCALE);\n    // emitter.setSpeed(20);\n    // // emitter.setBlendMode(Phaser.BlendModes.ADD);\n\n    // off-line version\n    // this.cameras.main.fadeIn(500, 0, 0, 0);\n    // this.events.emit(\"scene_ready\", this.sys.config);\n    // const mainMenu = new UIMenus(this);\n    // mainMenu.showMainMenu();\n    // titlesMusic = this.sound.add(\"credits\", { loop: true });\n    // return false\n\n    titlesMusic = this.sound.add(\"credits\", { loop: true });\n\n    window.WebFont.load({\n      custom: {\n        families: [\"GameGirl\"],\n      },\n      active: () => {\n        this.cameras.main.fadeIn(500, 0, 0, 0);\n        this.events.emit(\"scene_ready\", this.sys.config);\n\n        titlesMusic = this.sound.add(\"credits\", { loop: true });\n\n        // titlesMusic.play();\n\n        // this.events.once(Phaser.Scenes.Events.WAKE, () => console.log(Phaser.Scenes.Events.WAKE))\n        // this.events.once(Phaser.Scenes.Events.UPDATE, () => console.log(Phaser.Scenes.Events.UPDATE))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_WAKE, () => console.log(Phaser.Scenes.Events.TRANSITION_WAKE))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_START, () => console.log(Phaser.Scenes.Events.TRANSITION_START))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_OUT, () => console.log(Phaser.Scenes.Events.TRANSITION_OUT))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_INIT, () => console.log(Phaser.Scenes.Events.TRANSITION_INIT))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_COMPLETE, () => console.log(Phaser.Scenes.Events.TRANSITION_COMPLETE))\n        // this.events.once(Phaser.Scenes.Events.START, () => console.log(Phaser.Scenes.Events.START))\n        // this.events.once(Phaser.Scenes.Events.SLEEP, () => console.log(Phaser.Scenes.Events.SLEEP))\n        // this.events.once(Phaser.Scenes.Events.SHUTDOWN, () => console.log(Phaser.Scenes.Events.SHUTDOWN))\n        // this.events.once(Phaser.Scenes.Events.RESUME, () => console.log(Phaser.Scenes.Events.RESUME))\n        // this.events.once(Phaser.Scenes.Events.RENDER, () => console.log(Phaser.Scenes.Events.RENDER))\n        // this.events.once(Phaser.Scenes.Events.READY, () => console.log(Phaser.Scenes.Events.READY))\n        // this.events.once(Phaser.Scenes.Events.PRE_RENDER, () => console.log(Phaser.Scenes.Events.PRE_RENDER))\n        // this.events.once(Phaser.Scenes.Events.PAUSE, () => console.log(Phaser.Scenes.Events.PAUSE))\n        // this.events.once(Phaser.Scenes.Events.CREATE, () => console.log(Phaser.Scenes.Events.CREATE))\n        // this.events.once(Phaser.Scenes.Events.BOOT, () => console.log(Phaser.Scenes.Events.BOOT))\n\n        this.input.keyboard.off(\"keydown\");\n        this.input.keyboard.on(\"keydown\", (event) => {\n          if (event.key === \"Escape\") {\n            this.navigateToScene(\"LandingScene\");\n          }\n        });\n\n        const mainMenu = new UIMenus(this);\n        mainMenu.showMainMenu();\n      },\n    });\n  }\n}\n","import Phaser from \"phaser\";\nimport UIMenus from \"../components/UIMenus\";\nimport { SCALE } from \"../utils/constants\";\nimport CRTFilter from \"../utils/CRTShaderFX\";\nimport dbManager from \"../utils/dbManager\";\n\nlet titlesMusic;\nexport default class ConfirmNewGameScene extends Phaser.Scene {\n  constructor() {\n    super(\"ConfirmNewGameScene\");\n  }\n\n  preload() {}\n\n  navigateToScene(sceneId, props = {}) {\n    this.cameras.main.fade(500, 0, 0, 0);\n    this.tweens.add({\n      targets: titlesMusic,\n      volume: 0,\n      ease: \"Linear\",\n      duration: 500,\n      onComplete: () => {\n        titlesMusic.pause();\n        this.scene.start(sceneId, props);\n      },\n    });\n  }\n\n  create() {\n    this.cameras.main.setPostPipeline(CRTFilter);\n    this.cameras.main.setBackgroundColor(\"#486859\");\n\n    let image = this.add.image(\n      this.cameras.main.width / 2,\n      this.cameras.main.height / 3,\n      \"Bossfight\"\n    );\n    let scaleX = this.cameras.main.width / image.width;\n    let scaleY = this.cameras.main.height / image.height;\n    let scale = Math.max(scaleX, scaleY);\n    image.setScale(scale * 1.5).setScrollFactor(0);\n    image.name = \"background_art\";\n\n    // //  Enable lights and set a dark ambient color\n    // this.lights.enable().setAmbientColor(0x333333);\n    // image.setPipeline(\"Light2D\");\n    // //  Our spotlight. 100px radius and white in color.\n    // var light = this.lights\n    //   .addLight(180, 80, 200)\n    //   .setColor(0xffffff)\n    //   .setIntensity(2);\n    // //  Track the pointer\n    // this.input.on(\"pointermove\", function (pointer) {\n    //   light.x = pointer.x;\n    //   light.y = pointer.y;\n    // });\n\n    // var flash = this.plugins.get('rexFlash').add(part);\n    // flash.flash()\n\n    // var particles = this.add.particles('spark').setScale(SCALE);\n\n    // var emitter = particles.createEmitter();\n\n    // emitter.setPosition(10*SCALE, 10*SCALE);\n    // emitter.setSpeed(20);\n    // // emitter.setBlendMode(Phaser.BlendModes.ADD);\n\n    // off-line version\n    // this.cameras.main.fadeIn(500, 0, 0, 0);\n    // this.events.emit(\"scene_ready\", this.sys.config);\n    // const mainMenu = new UIMenus(this);\n    // mainMenu.showMainMenu();\n    // titlesMusic = this.sound.add(\"credits\", { loop: true });\n    // return false\n\n    titlesMusic = this.sound.add(\"credits\", { loop: true });\n\n    window.WebFont.load({\n      custom: {\n        families: [\"GameGirl\"],\n      },\n      active: () => {\n        this.cameras.main.fadeIn(500, 0, 0, 0);\n        this.events.emit(\"scene_ready\", this.sys.config);\n\n        titlesMusic = this.sound.add(\"credits\", { loop: true });\n\n        // titlesMusic.play();\n\n        // this.events.once(Phaser.Scenes.Events.WAKE, () => console.log(Phaser.Scenes.Events.WAKE))\n        // this.events.once(Phaser.Scenes.Events.UPDATE, () => console.log(Phaser.Scenes.Events.UPDATE))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_WAKE, () => console.log(Phaser.Scenes.Events.TRANSITION_WAKE))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_START, () => console.log(Phaser.Scenes.Events.TRANSITION_START))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_OUT, () => console.log(Phaser.Scenes.Events.TRANSITION_OUT))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_INIT, () => console.log(Phaser.Scenes.Events.TRANSITION_INIT))\n        // this.events.once(Phaser.Scenes.Events.TRANSITION_COMPLETE, () => console.log(Phaser.Scenes.Events.TRANSITION_COMPLETE))\n        // this.events.once(Phaser.Scenes.Events.START, () => console.log(Phaser.Scenes.Events.START))\n        // this.events.once(Phaser.Scenes.Events.SLEEP, () => console.log(Phaser.Scenes.Events.SLEEP))\n        // this.events.once(Phaser.Scenes.Events.SHUTDOWN, () => console.log(Phaser.Scenes.Events.SHUTDOWN))\n        // this.events.once(Phaser.Scenes.Events.RESUME, () => console.log(Phaser.Scenes.Events.RESUME))\n        // this.events.once(Phaser.Scenes.Events.RENDER, () => console.log(Phaser.Scenes.Events.RENDER))\n        // this.events.once(Phaser.Scenes.Events.READY, () => console.log(Phaser.Scenes.Events.READY))\n        // this.events.once(Phaser.Scenes.Events.PRE_RENDER, () => console.log(Phaser.Scenes.Events.PRE_RENDER))\n        // this.events.once(Phaser.Scenes.Events.PAUSE, () => console.log(Phaser.Scenes.Events.PAUSE))\n        // this.events.once(Phaser.Scenes.Events.CREATE, () => console.log(Phaser.Scenes.Events.CREATE))\n        // this.events.once(Phaser.Scenes.Events.BOOT, () => console.log(Phaser.Scenes.Events.BOOT))\n\n        this.input.keyboard.off(\"keydown\");\n        this.input.keyboard.on(\"keydown\", (event) => {\n          if (event.key === \"Escape\") {\n            this.navigateToScene(\"LandingScene\");\n          }\n        });\n\n        const mainMenu = new UIMenus(this);\n        mainMenu.showConfirmNewGameMenu();\n        // mainMenu.showMainMenu();\n      },\n    });\n  }\n}\n","import Phaser from \"phaser\";\nimport { SCALE, SCALE_RATIO, SCALE_V } from \"./constants\";\nconst fragShader = `\n#define SHADER_NAME BLUR_FS\n\nprecision mediump float;\n\n//\"in\" attributes from our vertex shader\nvarying vec2 outTexCoord;\n\n//declare uniforms\nuniform sampler2D uMainSampler;\nuniform float uResolution;\nuniform float radius;\nuniform vec2 dir;\n\nvoid main()\n{\n    //this will be our RGBA sum\n    vec4 sum = vec4(0.0);\n\n    //our original texcoord for this fragment\n    vec2 tc = outTexCoord;\n\n    //the amount to blur, i.e. how far off center to sample from\n    //1.0 -> blur by one pixel\n    //2.0 -> blur by two pixels, etc.\n    float blur = radius/uResolution;\n\n    //the direction of our blur\n    //(1.0, 0.0) -> x-axis blur\n    //(0.0, 1.0) -> y-axis blur\n    float hstep = dir.x;\n    float vstep = dir.y;\n\n    //apply blurring, using a 9-tap filter with predefined gaussian weights\",\n\n    sum += texture2D(uMainSampler, vec2(tc.x - 4.0*blur*hstep, tc.y - 4.0*blur*vstep)) * 0.0162162162;\n    sum += texture2D(uMainSampler, vec2(tc.x - 3.0*blur*hstep, tc.y - 3.0*blur*vstep)) * 0.0540540541;\n    sum += texture2D(uMainSampler, vec2(tc.x - 2.0*blur*hstep, tc.y - 2.0*blur*vstep)) * 0.1216216216;\n    sum += texture2D(uMainSampler, vec2(tc.x - 1.0*blur*hstep, tc.y - 1.0*blur*vstep)) * 0.1945945946;\n\n    sum += texture2D(uMainSampler, vec2(tc.x, tc.y)) * 0.2270270270;\n\n    sum += texture2D(uMainSampler, vec2(tc.x + 1.0*blur*hstep, tc.y + 1.0*blur*vstep)) * 0.1945945946;\n    sum += texture2D(uMainSampler, vec2(tc.x + 2.0*blur*hstep, tc.y + 2.0*blur*vstep)) * 0.1216216216;\n    sum += texture2D(uMainSampler, vec2(tc.x + 3.0*blur*hstep, tc.y + 3.0*blur*vstep)) * 0.0540540541;\n    sum += texture2D(uMainSampler, vec2(tc.x + 4.0*blur*hstep, tc.y + 4.0*blur*vstep)) * 0.0162162162;\n\n    //discard alpha for our simple demo,return\n    gl_FragColor =  vec4(sum.rgb, 1.0);\n}\n`;\n\nconst fragCRTShader = `\n  #ifdef GL_ES\n      precision highp float;\n  #endif\n\n  #define PI 3.1415926538\n\n  // Samplers\n  varying vec2 outTexCoord;\n  uniform sampler2D uMainSampler;\n\n  // Parameters\n  uniform vec2 curvature;\n  uniform vec2 screenResolution;\n  uniform vec2 scanLineOpacity;\n  uniform float vignetteOpacity;\n  uniform float brightness;\n  uniform float vignetteRoundness;\n\n\n  vec2 curveRemapUV(vec2 uv)\n  {\n      // as we near the edge of our screen apply greater distortion using a sinusoid.\n\n      uv = uv * 2.0 - 1.0;\n  vec2 offset = abs(uv.yx) / vec2(curvature.x, curvature.y);\n  uv = uv + uv * offset * offset;\n  uv = uv * 0.5 + 0.5;\n      return uv;\n  }\n\n  vec4 scanLineIntensity(float uv, float resolution, float opacity)\n  {\n      float intensity = sin(uv * resolution * PI * 2.0);\n      intensity = ((0.5 * intensity) + 0.5) * 0.9 + 0.1;\n      return vec4(vec3(pow(intensity, opacity)), 1.0);\n  }\n\n  vec4 vignetteIntensity(vec2 uv, vec2 resolution, float opacity, float roundness)\n  {\n      float intensity = uv.x * uv.y * (1.0 - uv.x) * (1.0 - uv.y);\n      return vec4(vec3(clamp(pow((resolution.x / roundness) * intensity, opacity), 0.0, 1.0)), 1.0);\n  }\n\n  void main(void) \n  {\n      vec2 remappedUV = curveRemapUV(vec2(outTexCoord.x, outTexCoord.y));\n      vec4 baseColor = texture2D(uMainSampler, remappedUV);\n\n      baseColor *= vignetteIntensity(remappedUV, screenResolution, vignetteOpacity, vignetteRoundness);\n\n      baseColor *= scanLineIntensity(remappedUV.x, screenResolution.y, scanLineOpacity.x);\n      baseColor *= scanLineIntensity(remappedUV.y, screenResolution.x, scanLineOpacity.y);\n\n      baseColor *= vec4(vec3(brightness), 1.0);\n\n      if (remappedUV.x < 0.0 || remappedUV.y < 0.0 || remappedUV.x > 1.0 || remappedUV.y > 1.0){\n          gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n      } else {\n          gl_FragColor = baseColor;\n      }\n  }\n`;\n\nexport default class BlurPostFX extends Phaser.Renderer.WebGL.Pipelines.PostFXPipeline\n{\n    constructor (game)\n    {\n        // super({game})\n        super({\n            game,\n            renderTarget: true,\n            fragShader: fragCRTShader,\n            // uniforms: [\n            //     'uProjectionMatrix',\n            //     'uMainSampler',\n            //     'uResolution',\n            //     'radius',\n            //     'dir'\n            // ]\n            uniforms: [\n                // 'uProjectionMatrix',\n                'uMainSampler',\n                'curvature',\n                'screenResolution',\n                'scanLineOpacity',\n                'vignetteOpacity',\n                'brightness',\n                'vignetteRoundness',\n            ]\n        });\n        this.set2f(\"curvature\", 6.0, 100.0);\n        // this.set2f(\"curvature\", 6.0, 6.0);\n        // this.set2f(\"screenResolution\", 320, 240);\n        \n        // const ratio = document.querySelector('canvas').width / document.querySelector('canvas').height\n        // this.set2f(\"screenResolution\", 1024 / ratio, 760 / ratio);\n        // this.set2f(\"screenResolution\", 640 / ratio, 480 / ratio);\n        // this.set2f(\"screenResolution\", 640 / SCALE_RATIO, 480 / SCALE_RATIO);\n        this.set2f(\"scanLineOpacity\", 0.25, 0.25);\n        this.set1f(\"vignetteOpacity\", 0.5);\n        this.set1f(\"vignetteRoundness\", 1.0)\n        this.set1f(\"brightness\", 1.25);\n    }\n\n    onPreRender () \n    {\n        const ratio = document.querySelector('canvas').width / document.querySelector('canvas').height\n        this.set2f(\"screenResolution\", 640, 480);\n\n    }\n}","import Phaser from \"phaser\";\nimport { SCALE, TILES_BY_SCREEN, TILE_SIZE } from \"../utils/constants\";\nimport CRTFilter from \"../utils/CRTShaderFX\";\nimport UI from \"../components/UI\";\nimport { translate } from \"../utils/localization\";\nimport Level1 from \"../components/levels/level_1\";\nimport dbManager from \"../utils/dbManager\";\n\nexport default class IntroScene extends Phaser.Scene {\n  constructor() {\n    super(\"IntroScene\");\n\n    // intro images\n    this.images = {\n      tiamat: null,\n      sky: null,\n      clouds: null,\n      storm: null,\n      ground: null,\n      ground_high: null,\n      ground_break: null,\n      comet: null,\n      people_climbing: null,\n      people_paying: null,\n      people_paying_high: null,\n      people_descending: null,\n      people_falling: null,\n      people_jumping: null,\n    };\n    this.texts = {\n      line1: null,\n      line2: null,\n      line3: null,\n      level_title: null,\n    };\n    this.sounds = {\n      background_music: null,\n      dramatic_music: null,\n      earthquake: null,\n    };\n  }\n\n  preload() {\n    dbManager.reset()\n  }\n\n  createAnimations() {\n    this.anims.create({\n      key: \"closeUp_Mary\",\n      frames: this.anims.generateFrameNumbers(\"closeUp\", { frames: [0] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"closeUp_Marduk\",\n      frames: this.anims.generateFrameNumbers(\"closeUp\", { frames: [1] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"closeUp_Dwarf\",\n      frames: this.anims.generateFrameNumbers(\"closeUp\", { frames: [2] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"closeUp_Tiamat\",\n      frames: this.anims.generateFrameNumbers(\"closeUp\", { frames: [5] }),\n      repeat: 0,\n    });\n    // this.anims.create({\n    //   key: 'closeUp_Pickaxe',\n    //   frames:this.anims.generateFrameNumbers('closeUpItems', { frames: [ 6 ] }),\n    //   repeat: 0,\n    // })\n    // this.anims.create({\n    //   key: 'closeUp_Mushroom',\n    //   frames:this.anims.generateFrameNumbers('closeUpItems', { frames: [ 7 ] }),\n    //   repeat: 0,\n    // })\n  }\n  createSounds() {\n    this.sounds.background_music = this.sound.add(\"opening_peace\", {\n      loop: true,\n    });\n    this.sounds.dramatic_music = this.sound.add(\"opening_quakes\", {\n      loop: true,\n    });\n    this.sounds.earthquake = this.sound.add(\"earthquake\");\n  }\n  createTextPlaceholders() {\n    this.texts.line1 = this.createTextLine(-4);\n    this.texts.line2 = this.createTextLine(-3);\n    this.texts.line3 = this.createTextLine(-2);\n\n    this.texts.level_title = this.createTextLine(0);\n    this.texts.level_title.setPosition(this.cameras.main.width / 2, this.cameras.main.height / 2)\n    this.texts.level_title._shadow.setPosition(this.cameras.main.width / 2, this.cameras.main.height / 2)\n    this.texts.level_title.setOrigin(0.5, 0.5)\n    this.texts.level_title._shadow.setOrigin(0.5, 0.5)\n    this.texts.level_title.alpha = 0\n    this.texts.level_title._shadow.alpha = 0\n    this.texts.level_title.setText(translate('stage_1.title'))\n  }\n  createTextLine(lineNumber) {\n    const LINE_HEIGHT = 10 * SCALE;\n    const LINE_REF = lineNumber < 0 ? this.cameras.main.height : 0;\n    const LINE_REF_FACTOR = lineNumber < 0 ? -1 : 1;\n    const XPOS = 2 * SCALE;\n    const YPOS =\n      LINE_REF + Math.abs(LINE_HEIGHT * lineNumber) * LINE_REF_FACTOR;\n    const lineShadow = this.add\n      .text(80, 10, \"\", {\n        fontFamily: \"GameGirl\",\n        fontSize: \"10px\",\n        fill: \"#ffffff\",\n      })\n      .setScale(SCALE)\n      .setPosition(XPOS, YPOS);\n\n    lineShadow.displayHeight = LINE_HEIGHT;\n    const line = this.add\n      .text(lineShadow.x + 5, lineShadow.y - 5, \"\", lineShadow.style)\n      .setScale(SCALE);\n    line.displayHeight = lineShadow.displayHeight\n    lineShadow.setTint(0x333333);\n\n    // line.setData('shadow', lineShadow)\n    line._setText = line.setText;\n    line._shadow = lineShadow;\n    line.setText = (txt) => {\n      line._shadow.setText(txt);\n      line._setText(txt);\n    };\n\n    return line;\n  }\n  createImages() {\n    this.images.sky = this.createFullscreenImage(\"IntroSky\");\n    this.images.clouds = this.createFullscreenImage(\"IntroClouds\");\n    this.images.tiamat = this.createFullscreenImage(\"IntroTiamat\");\n    this.images.ground = this.createFullscreenImage(\"IntroGround\");\n    this.images.comet = this.createFullscreenImage(\"IntroComet\");\n    this.images.storm = this.createFullscreenImage(\"IntroStorm\");\n    this.images.ground_high = this.createFullscreenImage(\"IntroGroundHigh\");\n    this.images.ground_break = this.createFullscreenImage(\"IntroGroundBreak\");\n    this.images.people_climbing = this.createFullscreenImage(\n      \"IntroPeopleClimbing\"\n    );\n    this.images.people_falling =\n      this.createFullscreenImage(\"IntroPeopleFalling\");\n    this.images.people_paying =\n      this.createFullscreenImage(\"IntroPeoplePraying\");\n    this.images.people_paying_high = this.createFullscreenImage(\n      \"IntroPeoplePrayingHigh\"\n    );\n    this.images.people_descending = this.createFullscreenImage(\n      \"IntroPeopleDescending\"\n    );\n    this.images.people_jumping =\n      this.createFullscreenImage(\"IntroPeopleJumping\");\n  }\n  createFullscreenImage(name) {\n    let image = this.add.image(\n      this.cameras.main.width / 2,\n      this.cameras.main.height / 2,\n      name\n    );\n    image.setScale(SCALE).setScrollFactor(0);\n    image.alpha = 0;\n    return image;\n  }\n\n  async animEnterTiamat(duration) {\n    return new Promise((res) => {\n      this.tweens.add({\n        targets: this.images.tiamat,\n        alpha: 1,\n        // scale: scale,\n        duration,\n        ease: \"Linear\",\n        onComplete: res,\n      });\n    });\n  }\n  async animExitTiamat(duration) {\n    return new Promise((res) => {\n      this.tweens.add({\n        targets: this.images.tiamat,\n        alpha: 0,\n        duration,\n        ease: \"Linear\",\n        onComplete: res,\n      });\n    });\n  }\n  async animEnterWorld() {\n    return new Promise((res) => {\n      this.tweens.add({\n        targets: this.images.sky,\n        // scale: scale,\n        alpha: 1,\n        duration: 2500,\n        ease: \"Linear\",\n        // onComplete: res\n      });\n      this.tweens.add({\n        targets: this.images.clouds,\n        // scale: scale,\n        alpha: 1,\n        delay: 3000,\n        duration: 2500,\n        ease: \"Linear\",\n        // onComplete: res\n      });\n      this.tweens.add({\n        targets: this.images.comet,\n        // scale: scale,\n        alpha: 1,\n        delay: 6000,\n        duration: 2500,\n        ease: \"Linear\",\n        // onComplete: res\n      });\n      this.tweens.add({\n        targets: this.images.ground,\n        // scale: scale,\n        alpha: 1,\n        delay: 9000,\n        duration: 2500,\n        ease: \"Linear\",\n        onComplete: res,\n      });\n    });\n  }\n  async animEnterPeople() {\n    const DELAY_TO_START = 3000;\n    return new Promise((res) => {\n      this.tweens.add({\n        targets: this.images.people_climbing,\n        delay: DELAY_TO_START,\n        alpha: 1,\n        duration: 1000,\n        yoyo: true,\n        hold: 1000,\n        ease: \"Linear\",\n        // onComplete: res\n      });\n      this.tweens.add({\n        targets: this.images.people_paying,\n        // scale: scale,\n        alpha: 1,\n        delay: DELAY_TO_START + 2000,\n        duration: 1000,\n        ease: \"Linear\",\n        onComplete: res,\n      });\n    });\n  }\n  async animGroundTransition() {\n    return new Promise((res) => {\n      this.tweens.add({\n        targets: [this.images.people_paying, this.images.ground],\n        alpha: 0,\n        duration: 1000,\n        ease: \"Linear\",\n      });\n      this.tweens.add({\n        targets: [this.images.people_paying_high, this.images.ground_high],\n        alpha: 1,\n        // delay: 1000,\n        duration: 1000,\n        ease: \"Linear\",\n      });\n      // anim people\n      this.tweens.add({\n        targets: [this.images.people_paying_high],\n        alpha: 0,\n        delay: 2000,\n        duration: 1000,\n        ease: \"Linear\",\n      });\n      this.tweens.add({\n        targets: [this.images.people_descending],\n        alpha: 1,\n        delay: 2000,\n        duration: 1000,\n        ease: \"Linear\",\n        completeDelay: 2000,\n        onComplete: res,\n      });\n    });\n  }\n  async animPage(duration) {\n    return new Promise((res) => {\n      this.texts.line1.alpha =\n        this.texts.line2.alpha =\n        this.texts.line3.alpha =\n          0;\n\n      this.tweens.add({\n        targets: [\n          this.texts.line1,\n          this.texts.line1._shadow,\n          this.texts.line2,\n          this.texts.line2._shadow,\n          this.texts.line3,\n          this.texts.line3._shadow,\n        ],\n        alpha: 1,\n        duration: 1000,\n        completeDelay: duration, // delay before onComplete\n        onComplete: () => {\n          this.tweens.add({\n            targets: [\n              this.texts.line1,\n              this.texts.line1._shadow,\n              this.texts.line2,\n              this.texts.line2._shadow,\n              this.texts.line3,\n              this.texts.line3._shadow,\n            ],\n            alpha: 0,\n            duration: 1000,\n            onComplete: res,\n          });\n        },\n      });\n    });\n  }\n  async animPage1(duration) {\n    this.texts.line1.setText(translate(\"intro.story_page_1.line_1\"));\n    this.texts.line2.setText(translate(\"intro.story_page_1.line_2\"));\n\n    return this.animPage(duration);\n  }\n  async animPage2(duration) {\n    this.texts.line1.setText(translate(\"intro.story_page_2.line_1\"));\n    this.texts.line2.setText(translate(\"intro.story_page_2.line_2\"));\n    this.texts.line3.setText(translate(\"intro.story_page_2.line_3\"));\n\n    return this.animPage(duration);\n  }\n  async animPage3(duration) {\n    this.texts.line1.setText(translate(\"intro.story_page_3.line_1\"));\n    this.texts.line2.setText(translate(\"intro.story_page_3.line_2\"));\n    this.texts.line3.setText(translate(\"intro.story_page_3.line_3\"));\n\n    return this.animPage(duration);\n  }\n  async animPage4(duration) {\n    // this.texts.line1.setPosition(0, 0)\n    this.texts.line1.setText(translate(\"intro.story_page_4.line_1\"));\n    this.texts.line2.setText(translate(\"intro.story_page_4.line_2\"));\n    this.texts.line3.setText(\"\");\n    return this.animPage(duration);\n  }\n  async animPage5(duration) {\n    this.texts.line1.setText(translate(\"intro.story_page_5.line_1\"));\n    this.texts.line2.setText(translate(\"intro.story_page_5.line_2\"));\n    this.texts.line3.setText(\"\");\n    return this.animPage(duration);\n  }\n  async animEarthquake() {\n    this.cameras.main.shake(2000, 0.005);\n    this.sounds.earthquake.play();\n  }\n  async animStormEnter() {\n    return new Promise((res) => {\n      this.tweens.add({\n        targets: [this.images.storm],\n        alpha: 1,\n        // delay: 2000,\n        duration: 2000,\n        ease: \"Linear\",\n        completeDelay: 2000,\n        onComplete: () => {\n          // hide underlay elements so later we can anim storm fade out to black\n          this.images.clouds.alpha = 0\n          this.images.comet.alpha = 0\n          this.images.ground.alpha = 0\n          this.images.sky.alpha = 0\n          res()\n        },\n      });\n    });\n  }\n  async animEnterFalling() {\n    return new Promise((res) => {\n      this.tweens.add({\n        targets: [this.images.ground_high, this.images.people_descending],\n        alpha: 0,\n        delay: 1000,\n        duration: 1000,\n        ease: \"Linear\",\n      });\n      this.tweens.add({\n        targets: [this.images.ground_break, this.images.people_falling],\n        alpha: 1,\n        delay: 1000,\n        duration: 1000,\n        ease: \"Linear\",\n        completeDelay: 2000,\n        onComplete: res,\n      });\n    });\n  }\n\n  async animEnterJumping() {\n    return new Promise((res) => {\n      this.tweens.add({\n        targets: [this.images.people_falling],\n        alpha: 0,\n        delay: 1000,\n        duration: 1000,\n        ease: \"Linear\",\n      });\n      this.tweens.add({\n        targets: [this.images.people_jumping],\n        alpha: 1,\n        delay: 1000,\n        duration: 1000,\n        ease: \"Linear\",\n        completeDelay: 5000,\n        onComplete: res,\n      });\n    });\n  }\n  async animLevelTitle() {\n    return new Promise((res) => {\n      this.tweens.add({\n        targets: [\n          this.images.people_jumping,\n          this.images.ground_break,\n          this.images.storm,\n        ],\n        alpha: 0,\n        delay: 1000,\n        duration: 1000,\n        ease: \"Linear\",\n      });\n      this.tweens.add({\n        targets: [this.texts.level_title, this.texts.level_title._shoadow],\n        alpha: 1,\n        delay: 1000,\n        duration: 1000,\n        ease: \"Linear\",\n        completeDelay: 5000,\n        onComplete: res,\n      });\n    });\n  }\n  playMusic() {\n    this.sounds.background_music.play();\n  }\n  playDramaticMusic() {\n    this.tweens.add({\n      targets: this.sounds.background_music,\n      volume: 0,\n      duration: 500,\n      completeDelay: 1000, // delay before onComplete\n      onComplete: () => {\n        this.sounds.background_music.stop();\n        this.sounds.dramatic_music.play();\n        // this.showThirdDialogs()\n      },\n    });\n  }\n  exitMusic() {\n    this.tweens.add({\n      targets: this.sounds.dramatic_music,\n      volume: 0,\n      duration: 1500,\n      onComplete: () => {\n        this.sounds.dramatic_music.stop();\n      },\n    });\n  }\n  async create() {\n    this.cameras.main.setPostPipeline(CRTFilter);\n    new UI(this, true);\n\n    this.createAnimations();\n    this.createSounds();\n    this.createImages();\n    this.createTextPlaceholders();\n\n    // animations\n\n    this.playMusic();\n    this.animEnterTiamat(5000);\n    await this.animPage1(8000)\n\n    this.animEnterWorld();\n    await this.animPage2(8000)\n    this.animEnterPeople();\n    await this.animPage3(8000)\n\n    await this.showFirstDialogs()\n\n    await this.animExitTiamat(5000);\n    await this.animGroundTransition();\n    await this.showSecondDialogs();\n\n    this.playDramaticMusic();\n    await this.animStormEnter();\n\n    this.animEarthquake();\n    this.animEnterFalling();\n    await this.animPage4(4000);\n\n    this.animPage5(6000);\n    await this.animEnterJumping();\n\n    this.exitMusic();\n    await this.animLevelTitle();\n\n    this.cameras.main.fade(1000, 0, 0, 0);\n    this.cameras.main.once(\n      \"camerafadeoutcomplete\",\n      () => this.scene.start(\"GameScene\", { levelName: Level1.key })\n    );\n  }\n\n  showFirstDialogs() {\n    this.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Tiamat\", \"closeUp_Marduk\"],\n      participantNames: ['Mary', 'Tiamat', 'Marduk'],\n      conversation: [\n        {\n          who: \"closeUp_Tiamat\",\n          text: [translate(\"intro.dialog_1.tiamat_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"intro.dialog_1.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Tiamat\",\n          text: [translate(\"intro.dialog_1.tiamat_say_2\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"intro.dialog_1.mary_say_2\")],\n        },\n        {\n          who: \"closeUp_Tiamat\",\n          text: [translate(\"intro.dialog_1.tiamat_say_3\")],\n        },\n        {\n          who: \"closeUp_Marduk\",\n          text: [translate(\"intro.dialog_1.marduk_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"intro.dialog_1.mary_say_3\")],\n        },\n        {\n          who: \"closeUp_Tiamat\",\n          text: [translate(\"intro.dialog_1.tiamat_say_4\")],\n        },\n        {\n          who: \"closeUp_Tiamat\",\n          text: [translate(\"intro.dialog_1.tiamat_say_5\")],\n        },\n        {\n          who: \"closeUp_Tiamat\",\n          text: [translate(\"intro.dialog_1.tiamat_say_6\")],\n        },\n      ],\n    });\n\n    // hack to get control after dialogue close\n    return new Promise((res) => {\n      this.levels = {\n        current: {\n          pause: () => false,\n          resume: () => {\n            setTimeout(res, 1000);\n          },\n        },\n      };\n    });\n  }\n\n  showSecondDialogs() {\n    this.events.emit(\"dialogue:show\", {\n      participants: [\"closeUp_Mary\", \"closeUp_Marduk\"],\n      participantNames: ['Mary', 'Marduk'],\n      conversation: [\n        {\n          who: \"closeUp_Marduk\",\n          text: [translate(\"intro.dialog_2.marduk_say_1\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"intro.dialog_2.mary_say_1\")],\n        },\n        {\n          who: \"closeUp_Marduk\",\n          text: [translate(\"intro.dialog_2.marduk_say_2\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"intro.dialog_2.mary_say_2\")],\n        },\n        {\n          who: \"closeUp_Marduk\",\n          text: [translate(\"intro.dialog_2.marduk_say_3\")],\n        },\n        {\n          who: \"closeUp_Mary\",\n          text: [translate(\"intro.dialog_2.mary_say_3\")],\n        },\n        {\n          who: \"closeUp_Marduk\",\n          text: [translate(\"intro.dialog_2.marduk_say_4\")],\n        },\n      ],\n    });\n    // hack to get control after dialogue close\n    return new Promise((res) => {\n      this.levels = {\n        current: {\n          pause: () => false,\n          resume: () => {\n            setTimeout(res, 1000);\n          },\n        },\n      };\n    });\n  }\n\n  showThirdDialogs() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => false,\n        resume: () => {\n          this.tweens.add({\n            targets: this.quakesMusic,\n            volume: 0,\n            duration: 500,\n            completeDelay: 500,\n            onComplete: () => {\n              this.scene.start(\"GameScene\", { level: 1 });\n            },\n          });\n        },\n      },\n    };\n\n    this.events.emit(\"dialogue:show\", {\n      participants: [],\n      conversation: [\n        {\n          who: \"\",\n          text: [\"- A fissure opens up\", \"beneath Marduk and he\", \"falls into\"],\n        },\n        {\n          who: \"\",\n          text: [\"- Mary rolls her eyes\", \"and jumps in after\"],\n        },\n      ],\n    });\n  }\n  animateIntro() {\n    this.cameras.main.pan(\n      this.renderer.width,\n      this.renderer.height / 2,\n      2000,\n      \"Sine.easeInOut\"\n    );\n    this.cameras.main.once(Phaser.Cameras.Scene2D.Events.PAN_COMPLETE, () => {\n      this.cameras.main.shake(2000, 0.02);\n      this.tweens.add({\n        targets: this.children.getByName(\"dark\"),\n        y: -this.renderer.height * 0.3,\n        duration: 2000,\n      });\n      this.tweens.add({\n        targets: this.children.getByName(\"partner\"),\n        y: this.renderer.height,\n        delay: 2000,\n        duration: 2000,\n        ease: \"Sine.in\",\n      });\n      this.tweens.add({\n        targets: this.children.getByName(\"player\"),\n        y: this.renderer.height,\n        x: {\n          value: this.children.getByName(\"player\").x + 150,\n          duration: 1000,\n          ease: \"Cubic.easeOut\",\n        },\n        delay: 4000,\n        duration: 2000,\n        ease: \"Back.easeInOut\",\n        onComplete: () => {\n          this.cameras.main.fade(1000, 0, 0, 0);\n          this.cameras.main.once(\n            \"camerafadeoutcomplete\",\n            () => void this.scene.start(\"GameScene\", { level: 1 })\n          );\n        },\n      });\n    });\n  }\n}\n","import Phaser from \"phaser\";\nimport dbManager from \"./dbManager\";\n\nexport const textureToMapConfig = (textures, id) => {\n  const texture = textures.get(id);\n  const image = texture.getSourceImage();\n  const levelConfig = Array(image.height)\n    .fill(\"000000\")\n    .map(() => Array(image.width).fill(\"000000\"));\n  for (let j = 0; j < image.width; j++) {\n    for (let i = 0; i < image.height; i++) {\n      const pixColor = textures.getPixel(j, i, id);\n      const key = `${Phaser.Display.Color.ComponentToHex(\n        pixColor.r\n      )}${Phaser.Display.Color.ComponentToHex(\n        pixColor.g\n      )}${Phaser.Display.Color.ComponentToHex(pixColor.b)}`;\n      levelConfig[i][j] = key;\n    }\n  }\n  return levelConfig;\n};\n\nconst _ = (n) =>\n  n.toLocaleString(\"en-US\", {\n    minimumIntegerDigits: 2,\n  });\n\nexport const formatScore = (value, total) =>\n  typeof total == 'number' ? `${_(value)}/${_(total)}` : \"__/__\";\n\nexport const formatComp = (value) => {\n  const perc = (value * 100).toLocaleString(\"en-US\", {\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 0,\n  });\n  return value\n    ? ` ${perc <= 9 ? \"  \" : perc <= 99 ? \" \" : \"\"}${perc}%`\n    : \"   -\";\n};\n\nexport const drawGemsScore = (lKey) => {\n  const levelData = dbManager.get(lKey);\n  return formatScore(levelData?.collectedDiamonds, levelData?.countDiamonds);\n};\nexport const drawThreatsScore = (lKey) => {\n  const levelData = dbManager.get(lKey);\n  return formatScore(levelData?.killedEnemies, levelData?.countEnemies);\n};\nexport const drawShroomsScore = (lKey) => {\n  const levelData = dbManager.get(lKey);\n  return formatScore(levelData?.collectedShrooms, levelData?.countShrooms);\n};\nexport const drawCompScore = (lKey) => {\n  const levelData = dbManager.get(lKey);\n  return formatComp(levelData?.comp);\n};\n","import Destroyable from \"./Destroyable\"\n\nexport default class Deco extends Destroyable {\n  \n}","import { BG_PIXEL_TO_TILEMAP_POSITION, PIXEL_NAME, PIXEL_TO_TILEMAP_POSITION } from '../utils/constants'\nimport LevelTest from './levels/level_test'\nimport Level1 from './levels/level_1'\nimport Level2 from './levels/level_2'\nimport Level3 from './levels/level_3'\nimport Level4 from './levels/level_4'\nimport Level5 from './levels/level_5'\nimport Level6 from './levels/level_6'\nimport Level7 from './levels/level_7'\nimport Level8 from './levels/level_8'\nimport Level9 from './levels/level_9'\nimport Level10 from './levels/level_10'\nimport Level11 from './levels/level_11'\nimport Level12 from './levels/level_12'\nimport Level13 from './levels/level_13'\nimport Level14 from './levels/level_14'\nimport Level15 from './levels/level_15'\nimport Level16 from './levels/level_16'\nimport Level17 from './levels/level_17'\nimport Maze1 from './levels/Maze_1'\nimport LevelFinale from './levels/level_finale'\nimport mazegenerator from 'generate-maze'\nimport { textureToMapConfig } from '../utils/helpers'\nimport Deco from './objects/Deco'\n\nexport const LEVELS = [\n  '',\n  LevelTest,\n  Level1,\n  'cinematic_1',\n  Level2,\n  Level3,\n  Level4,\n  Level5,\n  'cinematic_escape',\n  Level6,\n  Level7,\n  Level8,\n  Level9,\n  Level10,\n  Level11,\n  Level12,\n  Maze1,\n  Level13,\n  Level14,\n  Level15,\n  Level16,\n  Level17,\n  LevelFinale,\n  'cinematic_last',\n]\n\nexport const getNextLevel = levelKey => {\n  let currentIndex = LEVELS.findIndex(l => l.key === levelKey)\n  let nextLevel\n  do {\n    currentIndex++\n    nextLevel = LEVELS[currentIndex]\n  } while(typeof nextLevel === 'string' || currentIndex > LEVELS.length)\n\n  return nextLevel.key\n}\n\nexport default class LevelManager {\n  constructor(scene, currentLevelName = '') {\n    this.currentName = currentLevelName\n    this.currentIndex = LEVELS.findIndex(l => l.id === this.currentName)\n    this.scene = scene\n    this.start()\n  }\n  \n  start() {\n    console.log('START');\n    const Level = LEVELS.find(l => l.key === this.currentName)\n    this.current = new Level()\n    const [mapConfig, bgConfig] = this.generateConfig()\n    this.current.config = mapConfig\n    this.current.bgConfig = bgConfig\n    this.map = this.createMap()\n    this.createBackground()\n    this.current.connectToScene(this.scene)\n    this.current.pause()\n    this.scene.cameras.main.once('camerafadeincomplete', () => {\n      this.current.resume()\n      this.scene.events.emit('levelstart')\n    })\n  }\n  restart() {\n    this.scene.cameras.main.fade(500, 0, 0, 0)\n    this.scene.cameras.main.once('camerafadeoutcomplete', () => {\n      this.scene.events.off('player_moves')\n      this.current.destroy()\n      this.scene.children.list.forEach(ch => {\n        ch.destroy()\n      })\n      this.scene.rules.destroy()\n      this.scene.ui.destroy()\n      this.scene.scene.restart({ levelName: this.currentName })\n      \n    })\n  }\n\n  next() {\n    // destroy and unload\n    this.currentIndex += 1\n    if(typeof LEVELS[this.currentIndex] === 'string' && LEVELS[this.currentIndex].includes('cinematic')) {\n      this.scene.scene.start('ConnectorScene', { id: this.currentIndex, name: LEVELS[this.currentIndex]})\n    } else if (LEVELS[this.currentIndex]) {\n      this.start()\n    } else {\n      this.scene.scene.start('MenuScene')\n    }\n\n  }\n\n  generateConfig() {\n    const scene = this.scene\n    const levelId = this.current.constructor.key\n    \n    let levelConfig\n    let bgConfig\n    if(this.current.isMaze) {\n      // Generate a maze\n      // Width == 8, height == 4, maze edges are closed, using random seed \n      const MAZE_WIDTH = 40\n      const MAZE_HEIGHT = 10\n      const STARTING_ROW = 3 // move 3 blocks down to avoid hud overlap\n      levelConfig = Array(2*MAZE_HEIGHT + STARTING_ROW +1 ).fill('000000').map(r => Array(2*MAZE_WIDTH+1).fill('000000'))\n      const maze = mazegenerator(MAZE_WIDTH, MAZE_HEIGHT, true, Math.round(Math.random() * Math.pow(10, 8)))\n      maze.forEach(row => {\n        row.forEach(cell => {\n          const j = 2 * cell.x + 1\n          const i = 2 * cell.y + 1 + STARTING_ROW\n          // top\n          levelConfig[i-1][j] = cell.top ? PIXEL_NAME.WALL : PIXEL_NAME.EMPTY\n          if(cell.top) {\n            levelConfig[i-1][j+1] = PIXEL_NAME.WALL\n            levelConfig[i-1][j-1] = PIXEL_NAME.WALL\n          }\n          // right\n          levelConfig[i][j+1] = cell.right ? PIXEL_NAME.WALL : PIXEL_NAME.EMPTY\n          if(cell.right) {\n            levelConfig[i+1][j+1] = PIXEL_NAME.WALL\n            levelConfig[i-1][j+1] = PIXEL_NAME.WALL\n          }\n          // bottom\n          levelConfig[i+1][j] = cell.bottom ? PIXEL_NAME.WALL : PIXEL_NAME.EMPTY\n          if(cell.bottom) {\n            levelConfig[i+1][j+1] = PIXEL_NAME.WALL\n            levelConfig[i+1][j-1] = PIXEL_NAME.WALL\n          }\n          // left\n          levelConfig[i][j-1] = cell.left ? PIXEL_NAME.WALL : PIXEL_NAME.EMPTY\n          if(cell.left) {\n            levelConfig[i+1][j-1] = PIXEL_NAME.WALL\n            levelConfig[i-1][j-1] = PIXEL_NAME.WALL\n          }\n          // center\n          levelConfig[i][j] = PIXEL_NAME.EMPTY\n        })\n      })\n      levelConfig[STARTING_ROW + 1][1] = PIXEL_NAME.PLAYER\n      // levelConfig[STARTING_ROW-1][levelConfig[0].length - 2] = PIXEL_NAME.PLAYER\n      // levelConfig[STARTING_ROW+1][1] = PIXEL_NAME.BRO\n      levelConfig[STARTING_ROW + 2][1] = PIXEL_NAME.DWARF\n      levelConfig[STARTING_ROW + 2][2] = PIXEL_NAME.EMPTY // dwarf position to move away the path\n\n      // try to set an exit\n      const rowIdx = levelConfig.findIndex((r) => {\n          // ignores 3 top spaces saved for HUD\n          const lastColTile = r.slice(-1).pop()\n          \n          const isNotTopBufferSpace = lastColTile !== PIXEL_NAME.EMPTY\n          // gets last 2 position skiping last one (column) that is always a wall\n          const lastThreeBeforLastTile = r.slice(-4, -1)\n          // const tileIsEmpty = lastThreeBeforLastTile[2] === PIXEL_NAME.EMPTY\n          // const emptyPrecededByEmpty = tileIsEmpty && lastThreeBeforLastTile[0] === PIXEL_NAME.EMPTY\n          const threeEmptyInARow = lastThreeBeforLastTile.every(t => t === PIXEL_NAME.EMPTY)\n          // finds first row with 2 consecutive empty spaces into the maze\n          return isNotTopBufferSpace && threeEmptyInARow\n        })\n      \n      levelConfig[rowIdx][levelConfig[0].length - 1] = PIXEL_NAME.EXIT\n      this.buildWallsAroundGate(levelConfig)\n    } else {\n      levelConfig = textureToMapConfig(scene.textures, levelId)\n      // decorates gate\n      bgConfig = textureToMapConfig(scene.textures, `${levelId}_bg`)\n    }\n    return [levelConfig, bgConfig]\n  }\n  buildWallsAroundGate(config) {\n    config.forEach((row, y) => {\n      row.forEach((el, x) => {\n        if(el === PIXEL_NAME.EXIT) {\n          config[y-1][x] = PIXEL_NAME.DEBRIS\n          config[y-1][x-1] = PIXEL_NAME.DEBRIS\n          config[y-1][x-2] = PIXEL_NAME.DEBRIS\n\n          config[y+1][x] = PIXEL_NAME.DEBRIS\n          config[y+1][x-1] = PIXEL_NAME.DEBRIS\n          config[y+1][x-2] = PIXEL_NAME.DEBRIS\n\n        }\n      })\n    })\n\n  }\n  createBackground() {\n    let image = this.scene.add.image(0, 0, 'Stage1_bg')\n    let scaleX = this.scene.cameras.main.width / image.width\n    let scaleY = this.scene.cameras.main.height / image.height\n    let scale = Math.max(scaleX, scaleY)\n    image.setOrigin(0, 0)\n    image.setScale(scale * 1.5).setScrollFactor(0.1)\n    image.name = 'level_background_art'\n    image.depth = -2\n  }\n\n  createMap() {\n    const scene = this.scene\n    const levelData = this.current\n    const SCALE = scene.data.get('custom_scale')\n    const camera = this.scene.cameras.main\n\n    let map = this.map\n    let mapZ2 = this.mapZ2\n    let underlayMap = this.underlayMap\n    if(map && map.scene) {\n      map.destroy()\n      mapZ2.destroy()\n      underlayMap.destroy()\n    }\n\n    // Creating a blank tilemap with dimensions matching the dungeon\n    map = scene.make.tilemap({ tileWidth: 20, tileHeight: 20, width: levelData.config[0].length, height: levelData.config.length });\n    mapZ2 = scene.make.tilemap({ tileWidth: 20, tileHeight: 20, width: levelData.config[0].length, height: levelData.config.length });\n    underlayMap = scene.make.tilemap({ tileWidth: 20, tileHeight: 20, width: levelData.config[0].length, height: levelData.config.length });\n\n    window.map = map\n    // addTilesetImage: function (tilesetName, key, tileWidth, tileHeight, tileMargin, tileSpacing, gid)\n    let tileset = map.addTilesetImage('tiles', 'main-tiles', 20, 20, 1, 2);\n    let tilesetGates = map.addTilesetImage('tiles-gates', 'gates-tiles', 20, 20, 1, 2);\n    let tilesetZ2 = mapZ2.addTilesetImage('tiles-z2', 'gates-tiles', 20, 20, 1, 2);\n    let underlaytileset = underlayMap.addTilesetImage('under-tiles', 'main-tiles', 20, 20, 1, 2);\n\n    let layer = map.createBlankLayer('layer_1', tileset);\n    layer.name = 'layer_1'\n    layer.depth = 0\n    let layer2 = map.createBlankLayer('layer_2', tilesetGates);\n    layer2.name = 'layer_2'\n    layer2.depth = 0\n\n    let layerZ2 = mapZ2.createBlankLayer('layer_1z2', tilesetZ2);\n    layerZ2.name = 'layer_1z2'\n    layerZ2.depth = 5\n\n    let underlayer = underlayMap.createBlankLayer('layer_0', underlaytileset);\n    underlayer.name = 'layer_0'\n    underlayer.depth = -1\n    \n    layer.setScale(SCALE)\n    layer2.setScale(SCALE)\n    layerZ2.setScale(SCALE)\n    underlayer.setScale(SCALE * 1.01)// fix glitch of empty line between tiles for specific camera positions\n    underlayer.setScrollFactor(0.95)\n\n    levelData.config.forEach((row, x) => {\n      row.forEach((el, y) => {\n        let tile = el\n        if(levelData.bgConfig) {\n          let bgTile = levelData.bgConfig[x][y]\n          underlayMap.putTileAt(BG_PIXEL_TO_TILEMAP_POSITION[bgTile], y, x)\n        }\n\n        if (\n          [\n            PIXEL_NAME.WALL,\n            PIXEL_NAME.DEBRIS,\n            PIXEL_NAME.GROUND,\n            PIXEL_NAME.ART,\n            PIXEL_NAME.ART2,\n            PIXEL_NAME.EXIT,\n            PIXEL_NAME.TORCH,\n          ].includes(tile)\n        ) {\n          if (tile === PIXEL_NAME.WALL || tile === PIXEL_NAME.TORCH) {\n            if(this.current.isMaze) {\n              tile = 1\n            } else {\n              tile = PIXEL_TO_TILEMAP_POSITION.calculateWallTileWithNeighbours(x, y, levelData.config)\n            }\n            map.putTileAt(tile, y, x, false, 'layer_1')\n          } else if (tile === PIXEL_NAME.DEBRIS) {\n            map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile], y, x, false, 'layer_1')\n            // map.putTileAt(1, y, x, false, 'layer_1')\n          } else if (tile === PIXEL_NAME.GROUND) {\n            tile = PIXEL_TO_TILEMAP_POSITION.calculateGroundTileWithNeighbours(x, y, levelData.config)\n            map.putTileAt(tile, y, x, false, 'layer_1')\n          } else if ([PIXEL_NAME.ART, PIXEL_NAME.ART2].includes(tile)) {\n            map.putTileAt(21, y, x, false, 'layer_1')\n            // two consecutives art tiles means flix horizontal\n            const isFlipX = [PIXEL_NAME.ART, PIXEL_NAME.ART2].includes(levelData.config[x][y+1])\n            const isFlipFlag = [PIXEL_NAME.ART, PIXEL_NAME.ART2].includes(levelData.config[x][y-1])\n            if(isFlipFlag) return false\n            if(isFlipX) {\n              map.putTileAt(21, y + 1, x, false, 'layer_1')\n\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 3, y-1, x, false, 'layer_2').setFlipX(true)\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 2, y, x, false, 'layer_2').setFlipX(true)\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 1, y+1, x, false, 'layer_2').setFlipX(true)\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile], y+2, x, false, 'layer_2').setFlipX(true)\n              \n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 10 + 3, y-1, x + 1, false, 'layer_2').setFlipX(true)\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 10 + 2, y, x + 1, false, 'layer_2').setFlipX(true)\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 10 + 1, y+1, x + 1, false, 'layer_2').setFlipX(true)\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 10, y+2, x + 1, false, 'layer_2').setFlipX(true)\n            } else {\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile], y, x, false, 'layer_2')\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 1, y + 1, x, false, 'layer_2')\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 2, y + 2, x, false, 'layer_2')\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 3, y + 3, x, false, 'layer_2')\n              \n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 10, y, x + 1, false, 'layer_2')\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 10 + 1, y + 1, x + 1, false, 'layer_2')\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 10 + 2, y + 2, x + 1, false, 'layer_2')\n              map.putTileAt(PIXEL_TO_TILEMAP_POSITION[tile] + 10 + 3, y + 3, x + 1, false, 'layer_2')\n            }\n          } else if (tile === PIXEL_NAME.EXIT) {\n            const POSITION_EXIT = PIXEL_TO_TILEMAP_POSITION[tile + '_1']\n            // entrance behind user\n            map.putTileAt(POSITION_EXIT - 3, y - 1, x, false, 'layer_2')\n            // entrance behind and above user\n            // remove original tile\n            // map.putTileAt(PIXEL_TO_TILEMAP_POSITION[PIXEL_NAME.EMPTY] - 10 - 4, y - 2, x - 1, false, 'layer_1')\n            map.putTileAt(POSITION_EXIT - 10 - 4, y - 2, x - 1, false, 'layer_2')\n            // entrance behind and below user\n            map.putTileAt(POSITION_EXIT - 4, y - 2, x, false, 'layer_2')\n            /**\n             * 1 2 3\n             * 4 5 6\n             * 7 8 9\n             */\n            // 1\n            // let tileKind = PIXEL_TO_TILEMAP_POSITION.calculateWallTileWithNeighbours(x, y, levelData.config)\n            // map.putTileAt(PIXEL_TO_TILEMAP_POSITION[PIXEL_NAME.WALL], y - 2, x - 1, false, 'layer_1')\n            mapZ2.putTileAt(POSITION_EXIT - 10 - 2, y - 2, x - 1)\n            // 2\n            // map.putTileAt(PIXEL_TO_TILEMAP_POSITION[PIXEL_NAME.WALL], y - 1, x - 1, false, 'layer_1')\n            mapZ2.putTileAt(POSITION_EXIT - 10 - 1, y - 1, x - 1)\n            // 3\n            mapZ2.putTileAt(POSITION_EXIT - 10, y, x - 1)\n            // 4\n            mapZ2.putTileAt(POSITION_EXIT - 2, y - 2, x)\n            // 5\n            mapZ2.putTileAt(POSITION_EXIT - 1, y - 1, x)\n            // 6\n            mapZ2.putTileAt(POSITION_EXIT, y, x)\n            // 7\n            mapZ2.putTileAt(POSITION_EXIT + 10 - 2 , y - 2, x + 1)\n            // 8\n            mapZ2.putTileAt(POSITION_EXIT + 10 - 1, y - 1, x + 1)\n            // 9\n            mapZ2.putTileAt(POSITION_EXIT + 10, y, x + 1)\n          }\n        } else if ([PIXEL_NAME.HANGING_2, PIXEL_NAME.HANGING_3, PIXEL_NAME.HANGING_4, PIXEL_NAME.HANGING_5].includes(tile)) {\n          // place a wall in layer_1\n          const tileKind = PIXEL_TO_TILEMAP_POSITION.calculateWallTileWithNeighbours(x, y, levelData.config)\n          map.putTileAt(tileKind, y, x, false, 'layer_1')\n          levelData.config[x][y] = PIXEL_NAME.WALL\n\n          \n          // place 1st hanging sprite in depth = 5\n          let pos = { x: y, y: x } // inverse pos due to config loop: cols by row\n          let nextSprite = 'liana_start'\n          let hanging = this.scene.add.sprite(48, 16)\n          .setOrigin(0, 0.2)\n          .play(nextSprite)\n          hanging.setScale(layer.scaleX)\n          hanging.x = map.tileToWorldX(pos.x)\n          hanging.y = map.tileToWorldY(pos.y)\n          hanging.depth = 5\n\n          let element = new Deco(tile, this.current)\n          element.position = {...pos}\n          element.alien = hanging\n          levelData.decorationElements[`${pos.x}-${pos.y}`] = element\n          \n\n          // place hanging 2nd sprite\n          pos.y++\n          if([PIXEL_NAME.HANGING_3, PIXEL_NAME.HANGING_4, PIXEL_NAME.HANGING_5].includes(tile)) {\n            nextSprite = 'liana_middle'\n          } else {\n            nextSprite = 'liana_end'\n          }\n          hanging = this.scene.add.sprite(48, 16)\n          .setOrigin(0, 0.2)\n          .play(nextSprite)\n          hanging.setScale(layer.scaleX)\n          hanging.x = map.tileToWorldX(pos.x)\n          hanging.y = map.tileToWorldY(pos.y)\n          hanging.depth = 5\n\n          element = new Deco(tile, this.current)\n          element.position = {...pos}\n          element.alien = hanging\n          levelData.decorationElements[`${pos.x}-${pos.y}`] = element\n\n          // place hanging 3rd sprite?\n          if([PIXEL_NAME.HANGING_3, PIXEL_NAME.HANGING_4, PIXEL_NAME.HANGING_5].includes(tile)) {\n            pos.y++\n            nextSprite = PIXEL_NAME.HANGING_3 === tile ? 'liana_end' : 'liana_middle'\n\n            hanging = this.scene.add.sprite(48, 16)\n            .setOrigin(0, 0.2)\n            .play(nextSprite)\n            hanging.setScale(layer.scaleX)\n            hanging.x = map.tileToWorldX(pos.x)\n            hanging.y = map.tileToWorldY(pos.y)\n            hanging.depth = 5\n\n            element = new Deco(tile, this.current)\n            element.position = {...pos}\n            element.alien = hanging\n            levelData.decorationElements[`${pos.x}-${pos.y}`] = element\n          }\n          \n\n          // place hanging 4th sprite\n          if([PIXEL_NAME.HANGING_4, PIXEL_NAME.HANGING_5].includes(tile)) {\n            pos.y++\n            nextSprite = PIXEL_NAME.HANGING_4 === tile ? 'liana_end' : 'liana_middle'\n            hanging = this.scene.add.sprite(48, 16)\n            .setOrigin(0, 0.2)\n            .play(nextSprite)\n            hanging.setScale(layer.scaleX)\n            hanging.x = map.tileToWorldX(pos.x)\n            hanging.y = map.tileToWorldY(pos.y)\n            hanging.depth = 5\n\n            element = new Deco(tile, this.current)\n            element.position = {...pos}\n            element.alien = hanging\n            levelData.decorationElements[`${pos.x}-${pos.y}`] = element\n          }\n\n          // place hanging 5th sprite\n          if([PIXEL_NAME.HANGING_5].includes(tile)) {\n            pos.y++\n            nextSprite = 'liana_end'\n            hanging = this.scene.add.sprite(48, 16)\n            .setOrigin(0, 0.2)\n            .play(nextSprite)\n            hanging.setScale(layer.scaleX)\n            hanging.x = map.tileToWorldX(pos.x)\n            hanging.y = map.tileToWorldY(pos.y)\n            hanging.depth = 5\n\n            element = new Deco(tile, this.current)\n            element.position = {...pos}\n            element.alien = hanging\n            levelData.decorationElements[`${pos.x}-${pos.y}`] = element\n          }\n\n        } else {\n          if(!levelData.bgConfig) {\n            map.putTileAt(PIXEL_TO_TILEMAP_POSITION[PIXEL_NAME.EMPTY], y, x, false, 'layer_1')\n          }\n        }\n      })\n    })\n\n    // set up camera\n    camera.setBounds(0, 0, layer.width * layer.scaleX, layer.height * layer.scaleY);\n    camera.zoom = 1\n\n    this.underlayMap = underlayMap\n    this.mapZ2 = mapZ2\n    return map\n  }\n}","import Phaser from 'phaser'\nimport { TICK_TIME } from '../utils/constants'\nimport LevelFinale from './levels/level_finale'\n\nexport default class Rules {\n  constructor(scene) {\n    this.scene = scene\n    // gravity loop\n    this.timer = 0\n    this.worldTickFreq = TICK_TIME\n    // scene.events.removeListener(Phaser.Scenes.Events.UPDATE, this.onSceneUpdate)\n    scene.events.on(Phaser.Scenes.Events.UPDATE, this.onSceneUpdate.bind(this))\n\n    // this.setUpPuseResumeGame()\n    this.setUpCameraFollowPlayer()\n    scene.events.off('levelcompleted')\n    scene.events.on('levelcompleted', result => {\n      scene.events.emit('sounds:level_complete')\n      scene.tweens.add({\n        targets: this.music,\n        volume: 1,\n        ease: 'Linear',\n        duration: 500,\n        onComplete: () => {\n          this.music.stop()\n        },\n      });\n      scene.cameras.main.fade(3000, 0, 0)\n      scene.cameras.main.once('camerafadeoutcomplete', () => {\n        scene.scene.start('LevelResumeScene', { level: scene.levels.current.constructor.key, ...result  })\n        // scene.levels.current.cleanLevel()\n        // scene.levels.next()\n        // scene.cameras.main.fadeIn(1000, 0, 0)\n      })\n    })\n    scene.events.removeListener('levelstart', this.onLevelStart.bind(this))\n    scene.events.addListener('levelstart', this.onLevelStart.bind(this))\n  }\n  destroy() {\n    this.music?.stop()\n    // this.music.destroy()\n    this.scene.events.off(Phaser.Scenes.Events.UPDATE)\n    this.scene.events.off('levelstart')\n  }\n  onLevelStart() {\n    if(this.scene.levels.current.id === LevelFinale.key) {\n      this.music = this.scene.sound.add('escape_music', { loop: true, valume: 0 })\n      \n    }else {\n      this.music = this.scene.sound.add('levels_surface', { loop: true, valume: 0 })\n      // const lvlKey = this.scene.levels.current.id\n      // if(lvlKey.includes('level_') || lvlKey.includes('maze_')) {\n      // }\n    }\n    this.music.play()\n    // music.volume = 0\n    this.scene.tweens.add({  \n      targets: this.music,\n      volume: 1,\n      ease: 'Linear',\n      duration: 500,\n      onComplete: () => {\n      //   titlesMusic.pause()\n      //   scene.start(sceneId, props)\n      },\n    });\n  }\n\n  setUpCameraFollowPlayer() {\n    this.scene.events.addListener(Phaser.Scenes.Events.UPDATE, () => {\n      const cam = this.scene.cameras.main\n      const layer = this.scene.children.getByName('layer_1')\n      if (!layer) {\n        return false\n      }\n      const { tilemap: map } = layer\n      const {x, y} = this.scene.levels.current.getPlayerPos()\n      if (cam && map) {\n        var smoothFactor = 0.99;\n  \n        const scrollX = smoothFactor * cam.scrollX + (1 - smoothFactor) * (map.tileToWorldX(x) - cam.width * 0.5);\n        const scrollY = smoothFactor * cam.scrollY + (1 - smoothFactor) * (map.tileToWorldY(y) - cam.height * 0.5);\n\n        cam.scrollX = Math.round(scrollX)\n        cam.scrollY = Math.round(scrollY)\n      }\n    })\n  }\n\n  onSceneUpdate(time, delta) {\n    this.timer += delta\n    if (this.timer >= this.worldTickFreq) {\n      while (this.timer > this.worldTickFreq) {\n          this.timer -= this.worldTickFreq\n      }\n      this.scene.levels.current.gravityLoop()\n    }\n  }\n\n  calcCompletion(gems, collectedGems, enemies, killedEnemies, shrooms, colectedShrooms) {\n    const levelCompleted = 1\n    const comp = (collectedGems + killedEnemies + colectedShrooms + levelCompleted) / (gems + enemies + shrooms + levelCompleted)\n    return Math.round(comp * 100) / 100\n  }\n}\n","import Phaser from \"phaser\";\nimport {\n  TILES_BY_SCREEN,\n  TILE_SIZE,\n  TICK_TIME,\n  SCALE,\n  SCALE_V,\n} from \"../utils/constants\";\nimport LevelManager from \"../components/LevelManager\";\nimport Rules from \"../components/Rules\";\nimport UI from \"../components/UI\";\nimport CRTFilter from \"../utils/CRTShaderFX\"\n\nexport default class GameScene extends Phaser.Scene {\n  constructor() {\n    super(\"GameScene\");\n  }\n\n  create(data = {}) {\nconsole.log('CREATES GAME SCENE', data);\n    this.cameras.main.setPostPipeline(CRTFilter);\n    this.data.set(\"custom_scale\", SCALE);\n\n    this.game.scale.scaleMode = Phaser.Scale.RESIZE;\n    this.handleScales();\n    this.createAnimations();\n    if (this.levels?.current) {\n      this.levels.current.cleanLevel();\n    }\n    this.levels = new LevelManager(this, data.levelName, data.levelIndex);\n\n    this.cameras.main.fadeIn(1000, 0, 0, 0);\n    this.rules = new Rules(this);\n    this.ui = new UI(this);\n    this.events.on(Phaser.Scenes.Events.SHUTDOWN, () => {\n      this.rules.destroy();\n      this.ui.destroy();\n    });\n  }\n\n  handleScales() {\n    // const SCALE = this.data.get(\"custom_scale\");\n    // const scalables = new Map();\n    // this.clearScalables = () => scalables.clear();\n    // this.removeFromScalables = (el) => scalables.delete(el);\n    // this.addToScalables = (el, coords) => {\n    //   el.setScale(SCALE);\n    //   scalables.set(el, coords);\n    // };\n    // this.updateScale = (scale) => {\n    //   scalables.forEach((coords, el) => el?.setScale(scale));\n    // };\n\n    window.addEventListener(\"resize\", () => {\n      // const scale =\n      //   Math.round(\n      //     (((window.innerWidth / TILES_BY_SCREEN) * 100) / TILE_SIZE / 100) *\n      //       100\n      //   ) / 100;\n      // const canvas = document.querySelector('canvas')\n      // if(window.innerHeight > window.innerWidth) {\n      //   canvas.height = 3 * window.innerWidth / 4\n      // } else {\n      //   canvas.width = 4 * window.innerHeight / 3\n      // }\n      this.children.list.forEach((ch) => {\n        ch.setScale(SCALE, SCALE_V());\n      });\n\n      this.ui.onResize()\n\n      const layer = this.children.getByName(\"layer_1\");\n      if (!layer) {\n        return false;\n      }\n      this.levels?.current.updatePositionsOnScale();\n      \n      const camera = this.cameras.main;\n      camera.setBounds(\n        0,\n        0,\n        layer.width * layer.scaleX,\n        layer.height * layer.scaleY\n      );\n    });\n  }\n\n  createAnimations() {\n    this.anims.create({\n      key: \"boulder_roll_right\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [7, 10, 8, 7],\n      }),\n      frameRate: (1000 / TICK_TIME) * 4,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"boulder_roll_left\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [7, 8, 10, 7],\n      }),\n      frameRate: (1000 / TICK_TIME) * 4,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"diamond_roll_right\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [55, 56, 57, 60, 61, 62, 63, 54],\n      }),\n      frameRate: (1000 / TICK_TIME) * 8,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"diamond_roll_left\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [63, 62, 61, 60, 57, 56, 55, 54],\n      }),\n      frameRate: (1000 / TICK_TIME) * 8,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"boulder_idle\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", { frames: [7] }),\n      frameRate: 1,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"wall_torch_lit\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", { frames: [12, 13, 14, 15, 16, 17] }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"wall_torch_lighting\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", { frames: [26, 27, 28, 29] }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"wall_torch_idle\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", { frames: [25] }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"barrel_idle\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", { frames: [70] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"barrel_roll_right\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [71, 76, 77, 70],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"barrel_roll_left\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [77, 76, 71, 70],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"pillar_idle\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", { frames: [66] }),\n      frameRate: 1,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"pillar_roll_right\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [67, 68, 69, 66],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"pillar_roll_left\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [69, 68, 67, 66],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"liana_start\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", { frames: [72] }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"liana_middle\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", { frames: [78] }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"liana_end\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", { frames: [84] }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"explosion_explode\",\n      frames: this.anims.generateFrameNumbers(\"explosion\", {\n        frames: [0, 1, 2, 3, 4, 5, 6, 7],\n      }),\n      frameRate: (1000 / TICK_TIME) * 4,\n      repeat: 0,\n    });\n\n    this.anims.create({\n      key: \"diamond_idle\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [\n          54,\n        ],\n      }),\n      frameRate: (1000 / TICK_TIME) * 4,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"diamond_shine\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [\n          53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53,\n          53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53,\n          53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53,\n          53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 58, 59, 64, 65,\n          53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53,\n          53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53,\n          53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53,\n          53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53,\n        ],\n      }),\n      frameRate: (1000 / TICK_TIME) * 4,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"mushroom_idle\",\n      frames: this.anims.generateFrameNumbers(\"pickables\", { frames: [3] }),\n      frameRate: 1,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"pickaxe_idle\",\n      frames: this.anims.generateFrameNumbers(\"pickables\", { frames: [6] }),\n      frameRate: 1,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"brave_idle\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [\n          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 2, 2, 2, 2, 2, 2, 2, 0,\n        ],\n      }),\n      frameRate: 4,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_idle_pickaxe\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [\n          32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 33, 33, 33, 32, 34, 34, 34,\n          34, 34, 34, 34, 32,\n        ],\n      }),\n      frameRate: 4,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_run\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [8, 9, 10, 11, 12, 13, 14, 15],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5, // magic number that make smooth run and full frames in about 2 cycles\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_run_up\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [56, 57, 58, 59, 60, 61, 62, 63],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_run_pickaxe_up\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [56, 57, 58, 59, 60, 61, 62, 63],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_run_down\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [64, 65, 66, 67, 68, 69, 70, 71],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_run_pickaxe_down\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [72, 73, 74, 75, 76, 77, 78, 79],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_run_pickaxe\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [16, 17, 18, 19, 20, 21, 22, 23],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_break_pickaxe\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [40, 41, 41, 42, 43],\n      }),\n      frameRate: (1000 / TICK_TIME) * 5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_break_pickaxe_up\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [44, 45, 45, 46, 47],\n      }),\n      frameRate: (1000 / TICK_TIME) * 5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_break_pickaxe_down\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [52, 53, 53, 54, 55],\n      }),\n      frameRate: (1000 / TICK_TIME) * 5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_break_pickaxe_alt\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [48, 49, 49, 50, 51],\n      }),\n      frameRate: (1000 / TICK_TIME) * 5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"brave_push\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [24, 24, 24, 24, 25, 26, 27],\n      }),\n      frameRate: (1000 / TICK_TIME) * 4,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"brave_dies\",\n      frames: this.anims.generateFrameNumbers(\"brave\", {\n        frames: [28, 29, 30, 31, 30, 31],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3.5,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"torch_idle\",\n      frames: this.anims.generateFrameNumbers(\"torch\", {\n        frames: [0, 1, 2, 3],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"torch_run\",\n      frames: this.anims.generateFrameNumbers(\"torch\", {\n        frames: [8, 9, 10, 11, 12, 13, 14, 15],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"torch_run_up\",\n      frames: this.anims.generateFrameNumbers(\"torch\", {\n        frames: [56, 57, 58, 59, 60, 61, 62, 63],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"torch_run_down\",\n      frames: this.anims.generateFrameNumbers(\"torch\", {\n        frames: [64, 65, 66, 67, 68, 69, 70, 71],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"torch_push\",\n      frames: this.anims.generateFrameNumbers(\"torch\", {\n        frames: [24, 25, 26, 27, 24, 25, 26],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"torch_break_pickaxe\",\n      frames: this.anims.generateFrameNumbers(\"torch\", {\n        frames: [40, 41, 41, 42, 43],\n      }),\n      frameRate: (1000 / TICK_TIME) * 5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"bat_move\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [18, 19, 20, 21, 22, 23, 24],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"ground_breaks\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"ground_disolves\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [32, 33, 34, 35, 36, 37, 38, 39, 40],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"jewel_pick\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [42, 43, 44, 45, 46, 40],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"enemy_dies\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [47, 48, 49, 50, 51, 52, 40],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3,\n      repeat: 0,\n    });\n\n    this.anims.create({\n      key: \"closeUp_Mary\",\n      frames: this.anims.generateFrameNumbers(\"closeUp\", { frames: [0] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"closeUp_Marduk\",\n      frames: this.anims.generateFrameNumbers(\"closeUp\", { frames: [1] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"closeUp_Dwarf\",\n      frames: this.anims.generateFrameNumbers(\"closeUp\", { frames: [2] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"closeUp_Tiamat\",\n      frames: this.anims.generateFrameNumbers(\"closeUp\", { frames: [5] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"closeUp_Pickaxe\",\n      frames: this.anims.generateFrameNumbers(\"closeUpItems\", { frames: [6] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"closeUp_Mushroom\",\n      frames: this.anims.generateFrameNumbers(\"closeUpItems\", { frames: [8] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"closeUp_Diamond\",\n      frames: this.anims.generateFrameNumbers(\"closeUpItems\", { frames: [7] }),\n      repeat: 0,\n    });\n    // Bro\n    this.anims.create({\n      key: \"bro_idle\",\n      frames: this.anims.generateFrameNumbers(\"bro\", {\n        frames: [\n          0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 1, 1,\n          1, 1, 1, 1, 0, 0, 0, 2, 2, 2, 0, 0, 1, 1, 1, 0,\n        ],\n      }),\n      frameRate: 4,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"bro_run\",\n      frames: this.anims.generateFrameNumbers(\"bro\", {\n        frames: [8, 9, 10, 11, 12, 13, 14, 15],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5, // magic number that make smooth run and full frames in about 2 cycles\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"bro_run_up\",\n      frames: this.anims.generateFrameNumbers(\"bro\", {\n        frames: [56, 57, 58, 59, 60, 61, 62, 63],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"bro_run_down\",\n      frames: this.anims.generateFrameNumbers(\"bro\", {\n        frames: [64, 65, 66, 67],\n      }),\n      frameRate: (1000 / TICK_TIME) * 4,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"bro_laying\",\n      frames: this.anims.generateFrameNumbers(\"bro\", {\n        frames: [31],\n      }),\n      frameRate: (1000 / TICK_TIME) * 3.5,\n      repeat: 0,\n    });\n    // Shmebulock\n    this.anims.create({\n      key: \"dwarf_idle\",\n      frames: this.anims.generateFrameNumbers(\"dwarf\", {\n        frames: [\n          0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 2, 2, 2, 2, 2, 2, 2, 0,\n        ],\n      }),\n      frameRate: 4,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"dwarf_run\",\n      frames: this.anims.generateFrameNumbers(\"dwarf\", {\n        frames: [8, 9, 10, 11, 12, 13, 14, 15],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5, // magic number that make smooth run and full frames in about 2 cycles\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"dwarf_run_up\",\n      frames: this.anims.generateFrameNumbers(\"dwarf\", {\n        frames: [56, 57, 58, 59, 60, 61, 62, 63],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"dwarf_run_down\",\n      frames: this.anims.generateFrameNumbers(\"dwarf\", {\n        frames: [64, 65, 66, 67],\n      }),\n      frameRate: (1000 / TICK_TIME) * 4,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"exit_block\",\n      frames: this.anims.generateFrameNumbers(\"boulder\", {\n        frames: [0, 1, 2, 3, 4, 5],\n      }),\n      frameRate: (1000 / TICK_TIME) * 2.5,\n      repeat: -1,\n    });\n    this.anims.create({\n      key: \"moonAltarTop\",\n      frames: this.anims.generateFrameNumbers(\"closeUpItems\", { frames: [26] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"moonAltarBottom\",\n      frames: this.anims.generateFrameNumbers(\"closeUpItems\", { frames: [37] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"sunAltarTop\",\n      frames: this.anims.generateFrameNumbers(\"closeUpItems\", { frames: [27] }),\n      repeat: 0,\n    });\n    this.anims.create({\n      key: \"sunAltarBottom\",\n      frames: this.anims.generateFrameNumbers(\"closeUpItems\", { frames: [38] }),\n      repeat: 0,\n    });\n    \n  }\n}\n","import Phaser from 'phaser'\nimport { SCALE, TILES_BY_SCREEN, TILE_SIZE } from '../utils/constants'\nimport CRTFilter from '../utils/CRTShaderFX'\nimport UI from '../components/UI'\n\nexport default class ConnectorScene extends Phaser.Scene {\n  constructor () {\n    super('ConnectorScene');\n  }\n  \n  preload () {\n    \n  }\n\n  createAnimations() {\n    this.anims.create({\n      key: 'closeUp_Mary',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 0 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Marduk',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 1 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Dwarf',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 2 ] }),\n      repeat: 0,\n    })\n    this.anims.create({\n      key: 'closeUp_Tiamat',\n      frames:this.anims.generateFrameNumbers('closeUp', { frames: [ 3 ] }),\n      repeat: 0,\n    })\n  }\n  getMusicFromName(name) {\n    switch(name) {\n      case 'cinematic_1':\n        return 'swarf_chat_music'\n      default:\n        return 'generic_chat_music'\n    }\n  }\n  \n  getImageByName(name) {\n    let image, scaleX, scaleY, scale\n    switch(name) {\n      default:\n      case 'cinematic_1':\n        image = this.add.image(this.cameras.main.width / 2, this.cameras.main.height / 1.5, 'Tiamat')\n        scaleX = this.cameras.main.width / image.width\n        scaleY = this.cameras.main.height / image.height\n        scale = Math.max(scaleX, scaleY)\n        image.setScale(scale * 4).setScrollFactor(0)\n        break\n      case 'cinematic_last':\n        image = this.add.image(this.cameras.main.width /2, this.cameras.main.height/2, 'Tiamat')\n        scaleX = this.cameras.main.width / image.width\n        scaleY = this.cameras.main.height / image.height\n        scale = Math.max(scaleX, scaleY)\n        image.setScale(scale).setScrollFactor(0)\n        break\n      case 'cinematic_last_2':\n        image = this.add.image(this.cameras.main.width /2, this.cameras.main.height/2, 'thechild')\n        scaleX = this.cameras.main.width / image.width\n        scaleY = this.cameras.main.height / image.height\n        scale = Math.max(scaleX, scaleY)\n        image.setScale(scale).setScrollFactor(0)\n        break\n    }\n    return image\n  }\n  create({id, name}) {\n    this.currentLevel = id\n    this.createAnimations()\n    const musicName = this.getMusicFromName(name)\n    this.environmentMusic = this.sound.add(musicName, { loop: true });\n    this.environmentMusic.play();\n\n    new UI(this, true)\n\n    this.cameras.main.setPostPipeline(CRTFilter);\n    let image = this.getImageByName(name)\n    image.name = 'background_art'\n\n    this[`showDialogLevel_${name}`]()\n    \n  }\n  showDialogLevel_cinematic_escape() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => false,\n        resume: () => {\n          setTimeout(() => {\n            this.environmentMusic.stop()\n            // this.environmentMusic.destroy()\n            this.cameras.main.fade(1000, 0, 0, 0)\n            this.cameras.main.once('camerafadeoutcomplete', () => void this.scene.start('GameScene', { level: this.currentLevel + 1 }))\n          }, 1000);\n        }\n      }\n    }\n\n    this.events.emit('dialogue:show', {\n      participants: ['closeUp_Marduk', 'closeUp_Mary'],\n      conversation: [\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"Do you feel it Mary?\",\n            \"Do you feel her presence\",\n            \"below?\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n             \"I do... But what\",\n             \"does it mean?\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n             \"That I do not know... But\",\n             \"it does not portend well.\",\n             \"I have learned so much in\",\n             \"so little time. Mary...I\",\n             \"can’t recognize the man\",\n             \"I once was. I felt\",\n             \"bound by obligation,\",\n             \"I was trapped, Mary.\"\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n             \"It is time, Marduk\",\n             \"we have to escape\",\n             \"from here before\",\n             \"Tiamat stops us\",\n             \" \",\n             \"go!!!\"\n          ]\n        },\n      ]\n    })\n\n  }\n\n  showDialogLevel_cinematic_last_2() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => {\n          this.tweens.add({\n            targets: this.children.getByName('background_art'),\n            alpha: 0,\n            duration: 500,\n            onComplete: () => {\n              const img = this.getImageByName('cinematic_last_2')\n              img.alpha = 0\n              this.tweens.add({\n                targets: img,\n                alpha: 1,\n                duration: 500,\n              })\n            }\n          })\n        },\n        resume: () => {\n          setTimeout(() => {\n            this.tweens.add({\n              targets:this.environmentMusic,\n              valume: 0,\n              duration: 500,\n            })\n            \n            this.cameras.main.fade(1000, 0, 0, 0)\n            this.cameras.main.once('camerafadeoutcomplete', () => void this.scene.start('CreditsScene'))\n          }, 1000);\n        }\n      }\n    }\n    this.events.emit('dialogue:show', {\n      participants: ['closeUp_Marduk', 'closeUp_Dwarf'],\n      conversation: [\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n             \"That's not how things work\",\n             \"where I come from. Marduk,\",\n             \"You have been preparing\",\n             \"for this moment since\",\n             \"your life began. Do you\",\n             \"have the courage to\",\n             \"forge your own destiny?\",\n          ]\n        },\n      ]\n    })\n    \n  }\n  showDialogLevel_cinematic_last() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => false,\n        resume: () => {\n          setTimeout(() => {\n            this.showDialogLevel_cinematic_last_2()\n            // this.cameras.main.fade(1000, 0, 0, 0)\n            // this.cameras.main.once('camerafadeoutcomplete', () => void this.scene.start('GameScene', { level: this.currentLevel + 1 }))\n          }, 1000);\n        }\n      }\n    }\n\n    this.events.emit('dialogue:show', {\n      participants: ['closeUp_Marduk', 'closeUp_Tiamat'],\n      conversation: [\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"How could you do this? We\",\n            \"are your creations. This\",\n            \"is your land. How could\",\n            \"you lie to us!?\",\n            \"Why have you forsaken us?\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n            \"Life is a cycle. The\",\n            \"catalyst comet is a part\",\n            \"of this cycle: I did not\",\n            \"lie when I said the Comet\",\n            \"was the source of the\",\n            \"earthquakes.\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n             \"However: I am a force of\",\n             \"this world. It is through\",\n             \"my actions that things\",\n             \"occur. I am bound to the\",\n             \"will of the comet: for\",\n             \"truly we are one. I am\",\n             \"nature: and this...is\",\n             \"within my nature.\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n             \"I may have created\",\n             \"everything, yet still:\",\n             \"there was a natural order\",\n             \"to life that preceded me.\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n             \"You are finite in your\",\n             \"perspective Marduk.\",\n             \"Death signifies new\",\n             \"beginnings.\",\n             \" \",\n             \"This is Destiny.\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n             \"Who would accept a fate\",\n             \"such as this? We have done\",\n             \"no wrong. We worship and\",\n             \"revere you. We are your\",\n             \"children! Would you\",\n             \"really destroy us?\",\n          ]\n        },\n        {\n          who: 'closeUp_Tiamat',\n          text: [\n            \"The end was written\",\n            \"in the beginning.\",\n            \"Fate cannot be rewritten.\"\n          ]\n        },\n      ]\n    })\n  }\n  showDialogLevel_cinematic_1() {\n    // hack to get control after dialogue close\n    this.levels = {\n      current: {\n        pause: () => false,\n        resume: () => {\n          setTimeout(() => {\n            this.tweens.add({\n              targets: this.environmentMusic,\n              volume: 0,\n              duration: 500,\n            })\n            this.cameras.main.fade(1000, 0, 0, 0)\n            this.cameras.main.once('camerafadeoutcomplete', () => void this.scene.start('GameScene', { level: this.currentLevel + 1 }))\n          }, 1000);\n        }\n      }\n    }\n    this.events.emit('dialogue:show', {\n      participants: ['closeUp_Mary', 'closeUp_Marduk', 'closeUp_Dwarf'],\n      conversation: [\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"There you are! I was\",\n            \"worried about you!\",\n            \"Are you okay?\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"- marduk has been crying -\",\n            \"Thank Tiamat You’re here!\",\n            \"I made a mistake. I ate\",\n            \"one of the mushrooms. I\",\n            \"don’t feel well…I think I\",\n            \"broke my leg falling from\",\n            \"the surface.\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"Are you going to\",\n            \"throw up!?\",\n            \"Can you stand?\",\n          ]\n        },{\n          who: 'closeUp_Marduk',\n          text: [\n            \"No….I don’t think so.\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"What are we going to do\",\n            \"with you.\",\n          ]\n        },\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n            \"You know…..there's\",\n            \"nothing wrong with being\",\n            \"sad or afraid. It’s\",\n            \"nature's way of guiding\",\n            \"us towards a brighter\",\n            \"future.\",\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"WHAT ON EARTH IS THAT!?\",\n            \"Don’t patronize me foul\",\n            \"beast.\",\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"You really need to learn\",\n            \"when to shut your mouth.\",\n            \"Marduk. You have become\",\n            \"rude & foul tempered.\",\n          ]\n        },\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n            \"I mean he’s right.\",\n            \"I am a monster.\",\n            \"I'm... different.\"\n          ]\n        },\n        {\n          who: 'closeUp_Mary',\n          text: [\n            \"You don’t seem like\",\n            \"a monster to me.\",\n          ]\n        },\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n            \"That’s because we're\",\n            \"going to make a deal\"\n          ]\n        },\n        {\n          who: 'closeUp_Marduk',\n          text: [\n            \"I don’t make deals with...\",\n            \"your kind...\",\n          ]\n        },\n        {\n          who: 'closeUp_Dwarf',\n          text: [\n            \"But You Will...in time...\",\n            \"things change. People grow.\",\n            \"Even you Marduk. I think\",\n            \"we could be great friends.\",\n            \"In Fact. It Is Prophecy\",\n          ]\n        }\n      ]\n    }) \n  }\n}\n","import Phaser from 'phaser'\nimport { SCALE, TILES_BY_SCREEN, TILE_SIZE } from '../utils/constants'\nimport CRTFilter from '../utils/CRTShaderFX'\nimport UI from '../components/UI'\n\nexport default class IntroScene extends Phaser.Scene {\n  constructor () {\n    super('CreditsScene');\n  }\n\n  create() {\n    this.normalDayMusic = this.sound.add('opening_peace', { loop: true })\n    this.normalDayMusic.play();\n\n    this.cameras.main.setPostPipeline(CRTFilter);\n    let image = this.add.image(this.cameras.main.width / 2, this.cameras.main.height / 2, 'theworld')\n    let scaleX = this.cameras.main.width / image.width\n    let scaleY = this.cameras.main.height / image.height\n    let scale = Math.max(scaleX, scaleY)\n    image.setScale(scale).setScrollFactor(0)\n    image.name = 'background_art'\n    image.alpha = 0\n    this.tweens.add({\n      targets: image,\n      alpha: 1,\n      duration: 5000,\n    })\n    const line1 = this.add.text(80, 10, \"THE END\",\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"10px\",\n        fill: \"#ffffff\",\n      }\n    ).setScale(scaleX * 2).setPosition(2 * scaleX, this.cameras.main.height - 20 * 4 * scaleY).setShadow(-1,1)\n    line1.displayHeight = 10 * scaleY\n    const line2 = this.add.text(80, 10, \"Thanks for playing\",\n      {\n        fontFamily: 'GameGirl',\n        fontSize: \"10px\",\n        fill: \"#ffffff\",\n      }\n    ).setScale(scaleX * 0.9).setPosition(2 * scaleX, this.cameras.main.height - 10 * 3 * scaleY).setShadow(-1,1)\n    line2.displayHeight = 10 * scaleY\n  }\n}","import { useLayoutEffect, useState, useContext } from \"react\";\nimport Phaser from \"phaser\";\nimport { context } from \"../PhaserProvider\";\n\nconst usePhaser = () => {\n  const { game, scene, sceneProps } = useContext(context);\n  const getState = (game, scene) => {\n    game.scene.scenes.forEach((s) => {\n      s.events.off(Phaser.Scenes.Events.READY);\n      s.events.once(Phaser.Scenes.Events.READY, () => {\n        s.events.off(Phaser.Scenes.Events.RENDER);\n        s.events.once(Phaser.Scenes.Events.RENDER, () => {\n          setState({\n            ...s,\n            camera: s.cameras.main,\n            cameras: s.cameras,\n            scene: s,\n          });\n        });\n      });\n    });\n    return {\n      game,\n      scene, // current scene based on last scene that called RPFScene.create\n      sceneProps, // current scene data recieved into scene.create method\n      camera: scene.cameras.main,\n      cameras: scene.cameras,\n      scenes: game.scene.scenes,\n      scenesManager: game.scene,\n    };\n  };\n  const [state, setState] = useState({});\n  useLayoutEffect(() => {\n     if (scene) {\n       setState(getState(game, scene))\n     }\n  }, [game, scene])\n\n  return state;\n};\nexport default usePhaser;\n","import React, { useEffect, forwardRef, useRef, useCallback, useLayoutEffect } from 'react'\nimport Phaser from 'phaser'\nimport usePhaser from '../hooks/usePhaser'\n\nconst GameObject = forwardRef(({\n  args,\n  type = 'Shape',\n  addedToScene = () => {},\n  addedToSceneForParent = () => {},\n  children,\n  dataParentRef,\n  ...props\n}, externalRef) => {\n  const { scene } = usePhaser()\n  const localRef = useRef()\n  const tId = useRef()\n  const ref = externalRef || localRef\n  \n  const applyProps = useCallback((_this, p) => {\n    Object.keys(p).forEach(k => {\n      if(_this?.hasOwnProperty(k) || _this?.__proto__.hasOwnProperty(k)) {\n        if(typeof _this[k] === 'function') {\n          _this[k](p[k])\n        } else {\n          _this[k] = p[k]\n        }\n      }\n    })\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [props])\n  \n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useLayoutEffect(() => applyProps(ref.current, props), [props])\n  \n  // IMPORTANT: keep this as useEffect so this code runs after render\n  // that way we have all Phaser listeners settled once the objects are created\n  useEffect(() => {\n    if (scene) {\n      // new object\n      const obj = new Phaser.GameObjects[type](scene, ...args)\n      \n      // makes Rect aware of the new object\n      ref.current = obj\n      \n      // listen to added-to-scne event\n      obj.once(Phaser.GameObjects.Events.ADDED_TO_SCENE, () => {\n        // convenient callback for event as object property\n        addedToScene(obj)\n        \n        // calls parent container callback (if present)\n        addedToSceneForParent(obj)\n\n        // update Phaser with React props\n        applyProps(obj, props)\n      })\n\n      // offset execution to let object creation propagate on refs before being added to de scene\n      tId.current = setTimeout(() => {\n        // adds object to scene\n        scene.add.existing(obj)\n      })\n      \n    }\n\n    return () => {\n      ref?.current?.destroy()\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [scene])\n\n  useEffect(() =>{\n    return () => {\n      clearTimeout(tId.current)\n  }}, [])\n\n  return <>{children}</>\n})\nGameObject.displayName = `GameObject`;\nexport default GameObject\n","import { useEffect, forwardRef, useRef } from 'react'\nimport GameObject from './GameObject'\n\nconst Text = forwardRef(({\n  args,\n  children,\n  ...props\n}, externalRef) => {\n\n  const localRef = useRef()\n  const ref = externalRef || localRef\n\n  useEffect(() => {\n    if (typeof children === 'string') {\n      ref.current?.setText(children)\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [children])\n\n  return (\n    <GameObject\n      ref={ref}\n      type=\"Text\"\n      args={[\n        args?.[0] ?? props.x,\n        args?.[1] ?? props.y,\n        typeof children === 'string' ? children : args?.[2] ?? \"\",\n        args?.[3] ?? props.style\n      ]}\n      {...props}\n    />\n  )\n})\nText.displayName = 'Text'\nexport default Text\n","import React, {\n  Children,\n  useLayoutEffect,\n  useEffect,\n  cloneElement,\n  createRef,\n} from \"react\";\nimport { forwardRef, useRef } from \"react\";\nimport Phaser from \"phaser\";\nimport usePhaser from \"../hooks/usePhaser\";\nimport GameObject from \"./GameObject\";\n\nconst Container = forwardRef(\n  (\n    { args = [0, 0], addedToScene = () => {}, children, ...props },\n    externalRef\n  ) => {\n    const localRef = useRef();\n    const ref = externalRef || localRef;\n\n    const onObjectAddedToScene = (obj) => {\n      ref.current.add(obj);\n    };\n    const extractPhaserChildren = (_children) => {\n      return Children.toArray(_children).map((ch) => {\n        if (String(ch.type).includes(\"react.fragment\")) {\n          return cloneElement(ch, {\n            children: extractPhaserChildren(ch.props.children),\n          });\n        }\n        return cloneElement(ch, {\n          addedToSceneForParent: onObjectAddedToScene,\n        });\n      })\n    };\n    // console.log(Children.toArray(children));\n    return (\n      <GameObject ref={ref} type=\"Container\" args={args} {...props}>\n        {/* Inject dataParentRef to children */}\n        {extractPhaserChildren(children)}\n      </GameObject>\n    );\n  }\n);\n\nContainer.displayName = \"Container\";\nexport default Container;\n","import { forwardRef, useRef } from 'react'\nimport GameObject from './GameObject'\n\nconst Sprite = forwardRef(({\n  args,\n  children,\n  ...props\n}, externalRef) => {\n\n  const localRef = useRef()\n  const ref = externalRef || localRef\n\n  return (\n    <GameObject\n      ref={ref}\n      type=\"Sprite\"\n      args={args}\n      {...props}\n    />\n  )\n})\n\nSprite.displayName = 'Sprite'\nexport default Sprite\n","import { useRef, Fragment, useState, useCallback, useEffect } from \"react\";\nimport UI from \"../../components/UI\";\nimport Text from \"../../libs/react-phaser-fiber/components/Text\";\nimport Container from \"../../libs/react-phaser-fiber/components/Container\";\nimport usePhaser from \"../../libs/react-phaser-fiber/hooks/usePhaser\";\nimport { SCALE } from \"../../utils/constants\";\nimport Sprite from \"../../libs/react-phaser-fiber/components/Sprite\";\nimport dbManager from \"../../utils/dbManager\";\nimport {\n  drawCompScore,\n  drawGemsScore,\n  drawShroomsScore,\n  drawThreatsScore,\n  formatComp,\n  formatScore,\n} from \"../../utils/helpers\";\nimport { translate } from \"../../utils/localization\";\nimport { getNextLevel } from \"../../components/LevelManager\";\n\nconst OptionsScene = () => {\n  const { game, scene, sceneProps } = usePhaser();\n  const [selIndex, setSelIndex] = useState(0);\n  const [showRowScore, setShowRowScore] = useState(0);\n  // const [results, setResults] = useState(null);\n  const [options] = useState([\n    translate('menu.main.score_op_next'),\n    translate('menu.main.score_op_repeat'),\n    translate('menu.main.score_op_exit')\n  ]);\n  const tId = useRef();\n  const refScene = useRef();\n\n  const keyDownHandler = useCallback(\n    (event) => {\n      if (event.key === \"Escape\") {\n        game.scene.start(\"LandingScene\");\n      }\n      if (event.key === \"ArrowDown\" && selIndex < options.length - 1) {\n        setSelIndex((idx) => idx + 1);\n      }\n      if (event.key === \"ArrowUp\" && selIndex > 0) {\n        setSelIndex((idx) => idx - 1);\n      }\n      if (event.key === \"Enter\") {\n        switch(selIndex) {\n          default:\n          case 0:\n            scene.scene.start('GameScene', { levelName: getNextLevel(sceneProps?.level) })\n            break\n          case 1:\n            scene.scene.start('GameScene', { levelName: sceneProps?.level })\n            break\n          case 2:\n            scene.scene.start('MenuScene')\n            break\n        }\n      }\n    },\n    [game, scene, selIndex, options, sceneProps]\n  );\n\n  useEffect(() => {\n    scene?.input.keyboard.addListener(\"keydown\", keyDownHandler);\n\n    return () =>\n      scene?.input.keyboard.removeListener(\"keydown\", keyDownHandler);\n  }, [scene, keyDownHandler]);\n\n  useEffect(() => {\n    refScene.current = scene\n    scene?.anims.create({\n      key: \"arrow_menu\",\n      frames: scene.anims.generateFrameNumbers(\"hud\", { frames: [30] }),\n      repeat: 0,\n    });\n  }, [scene]);\n\n  // useEffect(() => {\n  //   if (sceneProps) {\n  //     const data = dbManager.get(sceneProps.level);\n  //     // console.log(sceneProps);\n  //     setResults({\n  //       ...data,\n  //     });\n  //   }\n  // }, [sceneProps]);\n\n  useEffect(() => {\n    if (showRowScore < 5) {\n      tId.current = setTimeout(() => setShowRowScore((v) => v + 1), 800);\n    }\n    return () => clearTimeout(tId.current);\n  }, [showRowScore]);\n\n  useEffect(() =>{\n    return () => {\n      clearTimeout(tId.current)\n      refScene.current.input.keyboard.off(\"keydown\");\n  }}, [])\n\n  const formatFont = (txt) => {\n    txt.displayHeight = 10 * SCALE;\n    txt.depth = 16;\n    txt.name = \"header_text\";\n    txt.setScale(SCALE);\n    txt.setScrollFactor(0);\n    txt.setShadow(-1, 1);\n  };\n  const fontStyle = {\n    fontFamily: \"Emulogic\",\n    fontSize: \"8px\",\n    fill: \"#aee0c8\",\n    fontWeight: \"regular\",\n  };\n\n  const CONTAINER_TOP = UI.tileToScreen(1);\n  const CONTAINER_LEFT = UI.tileToScreen(5);\n\n  const MARGIN_LEFT = UI.tileToScreen(1);\n  const LINE_HEIGHT = UI.tileToScreen(0.75);\n  const MENU_OPTIONS_TOP = UI.tileToScreen(7);\n\n  return (\n    <Container x={CONTAINER_LEFT} y={CONTAINER_TOP}>\n      <Text\n        x={MARGIN_LEFT}\n        y={0}\n        setStyle={fontStyle}\n        addedToScene={formatFont}\n      >\n        {`KI - ${translate('menu.main.chamber')} ${sceneProps?.level.replace('level_', '')} -`}\n      </Text>\n      {showRowScore > 0 && (\n        <Fragment key=\"gems_score\">\n          <Text\n            x={MARGIN_LEFT}\n            y={LINE_HEIGHT * 2}\n            setStyle={fontStyle}\n            alpha={\n              sceneProps?.collectedDiamonds < sceneProps?.countDiamonds ? 0.8 : 1\n            }\n            addedToScene={formatFont}\n          >\n            {translate('menu.main.score_gems')}\n          </Text>\n          <Text\n            x={MARGIN_LEFT + UI.tileToScreen(6)}\n            y={LINE_HEIGHT * 2}\n            setStyle={fontStyle}\n            alpha={\n              sceneProps?.collectedDiamonds < sceneProps?.countDiamonds ? 0.8 : 1\n            }\n            addedToScene={formatFont}\n          >\n            {formatScore(sceneProps?.collectedDiamonds, sceneProps?.countDiamonds)}\n          </Text>\n        </Fragment>\n      )}\n      {showRowScore > 1 && (\n        <Fragment key=\"enemies_score\">\n          <Text\n            x={MARGIN_LEFT}\n            y={LINE_HEIGHT * 3}\n            setStyle={fontStyle}\n            alpha={sceneProps?.killedEnemies < sceneProps?.countEnemies ? 0.8 : 1}\n            addedToScene={formatFont}\n          >\n            {translate('menu.main.score_enemies')}\n          </Text>\n          <Text\n            x={MARGIN_LEFT + UI.tileToScreen(6)}\n            y={LINE_HEIGHT * 3}\n            setStyle={fontStyle}\n            alpha={sceneProps?.killedEnemies < sceneProps?.countEnemies ? 0.8 : 1}\n            addedToScene={formatFont}\n          >\n            {formatScore(sceneProps?.killedEnemies, sceneProps?.countEnemies)}\n          </Text>\n        </Fragment>\n      )}\n      {showRowScore > 2 && (\n        <Fragment key=\"shrooms_score\">\n          <Text\n            x={MARGIN_LEFT}\n            y={LINE_HEIGHT * 4}\n            setStyle={fontStyle}\n            alpha={sceneProps?.collectedShrooms < sceneProps?.countShrooms ? 0.8 : 1}\n            addedToScene={formatFont}\n          >\n            {translate('menu.main.score_shrooms')}\n          </Text>\n          <Text\n            x={MARGIN_LEFT + UI.tileToScreen(6)}\n            y={LINE_HEIGHT * 4}\n            setStyle={fontStyle}\n            alpha={sceneProps?.collectedShrooms < sceneProps?.countShrooms ? 0.8 : 1}\n            addedToScene={formatFont}\n          >\n            {formatScore(sceneProps?.collectedShrooms, sceneProps?.countShrooms)}\n          </Text>\n        </Fragment>\n      )}\n\n      <Text\n        x={MARGIN_LEFT}\n        y={LINE_HEIGHT * 4.75}\n        setStyle={fontStyle}\n        addedToScene={formatFont}\n      >\n        --------------------\n      </Text>\n      {showRowScore > 3 && (\n        <Fragment key=\"total_score\">\n          <Text\n            x={MARGIN_LEFT}\n            y={LINE_HEIGHT * 5.5}\n            setStyle={fontStyle}\n            alpha={sceneProps?.comp <= sceneProps?.prevBest ? 0.8 : 1}\n            addedToScene={formatFont}\n          >\n            {translate('menu.main.score_comp')}\n          </Text>\n          <Text\n            x={MARGIN_LEFT + UI.tileToScreen(6)}\n            y={LINE_HEIGHT * 5.5}\n            setStyle={fontStyle}\n            alpha={sceneProps?.comp <= sceneProps?.prevBest ? 0.8 : 1}\n            addedToScene={formatFont}\n          >\n            {formatComp(sceneProps?.comp)}\n          </Text>\n        </Fragment>\n      )}\n      {showRowScore > 4 && (\n        <Fragment key=\"best_score\">\n          <Text\n            x={MARGIN_LEFT}\n            y={LINE_HEIGHT * 6.5}\n            setStyle={{\n              ...fontStyle,\n              fill: sceneProps?.prevBest >= sceneProps?.comp ? \"#aee0c8\" : \"#ffd700\",\n            }}\n            addedToScene={formatFont}\n          >\n            {translate('menu.main.score_best')}\n          </Text>\n          <Text\n            x={MARGIN_LEFT + UI.tileToScreen(6)}\n            y={LINE_HEIGHT * 6.5}\n            setStyle={{\n              ...fontStyle,\n              fill: sceneProps?.prevBest >= sceneProps?.comp ? \"#aee0c8\" : \"#ffd700\",\n            }}\n            addedToScene={formatFont}\n          >\n            {formatComp(Math.max(sceneProps?.prevBest, sceneProps?.comp))}\n          </Text>\n        </Fragment>\n      )}\n      {options.map((label, idx) => (\n        <Fragment key={`row_${idx}`}>\n          {selIndex === idx && (\n            <Sprite\n              args={[100, 100, \"arrow\"]}\n              x={MARGIN_LEFT - UI.tileToScreen(1.3)}\n              y={MENU_OPTIONS_TOP + LINE_HEIGHT * idx + UI.tileToScreen(0.15)}\n              addedToScene={(el) =>\n                el\n                  .play(\"arrow_menu\")\n                  .setRotation(-Math.PI / 2)\n                  .setScale(SCALE)\n                  .setOrigin(0.5, 0)\n              }\n            />\n          )}\n          <Text\n            alpha={selIndex === idx ? 1 : 0.5}\n            args={[\n              MARGIN_LEFT,\n              MENU_OPTIONS_TOP + LINE_HEIGHT * idx,\n              label,\n              {\n                fontFamily: \"Emulogic\",\n                fontSize: \"8px\",\n                fill: \"#aee0c8\",\n                fontWeight: \"regular\",\n              },\n            ]}\n            addedToScene={formatFont}\n          />\n        </Fragment>\n      ))}\n    </Container>\n  );\n};\n\nexport default OptionsScene;\n","import CRTFilter from '../../utils/CRTShaderFX'\n\nconst config = {\n  preload() {\n    // this is scene binded by RPF\n    this.load.spritesheet(\n      \"hud\",\n      process.env.PUBLIC_URL + \"/assets/tilemaps/hud_tilemap_20x20.png\",\n      { frameWidth: 20, frameHeight: 20, margin: 1, sapcing: 2 }\n    );\n  },\n  create() {\n    this.cameras.main.setPostPipeline(CRTFilter);\n  }\n};\n\nexport default config\n","import Phaser from \"phaser\";\n\nconst fragShader = `\nprecision mediump float;\n\nuniform sampler2D uMainSampler[%count%];\nuniform float gray;\n\nvarying vec2 outTexCoord;\nvarying float outTexId;\nvarying vec4 outTint;\nvarying vec2 fragCoord;\n\nvoid main()\n{\n    vec4 texture;\n\n    %forloop%\n\n    gl_FragColor = texture;\n    gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126 * gl_FragColor.r + 0.7152 * gl_FragColor.g + 0.0722 * gl_FragColor.b), gray);\n}\n`;\n\nexport default class GrayScalePipeline extends Phaser.Renderer.WebGL.Pipelines.MultiPipeline {\n  constructor(game) {\n    super({\n      game,\n      fragShader,\n      uniforms: [\"uProjectionMatrix\", \"uMainSampler\", \"gray\"],\n    });\n\n    this._gray = 0;\n  }\n\n  onPreRender() {\n    this.set1f(\"gray\", this._gray);\n  }\n\n  get gray() {\n    return this._gray;\n  }\n\n  set gray(value) {\n    this._gray = value;\n  }\n}\n","import { useEffect, useState } from \"react\";\nimport usePhaser from \"../hooks/usePhaser\";\n\nconst Scene = ({ name, children }) => {\n  const [isActive, setActive] = useState(false);\n  const { game, scene } = usePhaser();\n  \n  useEffect(() => {\n    if (game?.scene.isActive(name) && scene) {\n      setActive(true);\n    }\n  }, [game, name, scene]);\n\n  return isActive ? children : null;\n};\n\nexport default Scene;\n","import Phaser from \"phaser\";\nimport Canvas from \"./libs/react-phaser-fiber/components/Canvas\";\nimport LandingScene from \"./scenes/LandingScene\";\nimport MenuScene from \"./scenes/MenuScene\";\nimport IntroScene from \"./scenes/IntroScene\";\nimport GameScene from \"./scenes/GameScene\";\nimport ConnectorScene from \"./scenes/ConnectorScene\";\nimport CreditsScene from \"./scenes/CreditsScene\";\nimport ConfirmNewGameScene from \"./scenes/ConfirmNewGameScene\";\nimport LevelResumeMenu from \"./scenes/LevelResumeScene/LevelResumeMenu\";\nimport LevelResumeSceneConfig from \"./scenes/LevelResumeScene/config\";\nimport CRTFilter from \"./utils/CRTShaderFX\";\nimport GrayScalePipeline from \"./utils/GrayScalePipeline\";\nimport { setI18nConfig } from \"./utils/localization\";\nimport { useEffect, useState } from \"react\";\nimport FadePlugin from \"phaser3-rex-plugins/plugins/fade-plugin.js\";\nimport FlashPlugin from \"phaser3-rex-plugins/plugins/flash-plugin.js\";\nimport Scene from \"./libs/react-phaser-fiber/components/Scene\";\n\nconst gameConfig = {\n  width: \"100%\",\n  height: \"100%\",\n  // width: window.innerWidth * window.devicePixelRatio,\n  // height: window.innerHeight * window.devicePixelRatio,\n  type: Phaser.WEBGL,\n  scale: {\n    mode: Phaser.Scale.RESIZE,\n    // mode: Phaser.Scale.ENVELOP,\n    // max: {\n    //   width: 800,\n    //   height: 600,\n    // },\n    autoCenter: Phaser.Scale.CENTER_BOTH,\n  },\n\n  backgroundColor: \"#000000\",\n  disableContextMenu: true,\n  pixelArt: true,\n  roundPixels: false,\n  scene: [\n    LandingScene,\n    MenuScene,\n    IntroScene,\n    GameScene,\n    ConnectorScene,\n    CreditsScene,\n    ConfirmNewGameScene,\n  ],\n  pipeline: { CRTFilter, Gray: GrayScalePipeline, GrayAlt: GrayScalePipeline },\n  plugins: {\n    global: [\n      {\n        key: \"rexFade\",\n        plugin: FadePlugin,\n        start: true,\n      },\n      {\n        key: \"rexFlash\",\n        plugin: FlashPlugin,\n        start: true,\n      },\n    ],\n  },\n};\n\nfunction Game() {\n  const [ready, setReady] = useState();\n  useEffect(() => {\n    setI18nConfig(() => setReady(true));\n  }, []);\n  return ready ? (\n    <Canvas args={gameConfig}>\n      <Scene name=\"LevelResumeScene\" args={LevelResumeSceneConfig}>\n        <LevelResumeMenu />\n      </Scene>\n    </Canvas>\n  ) : null;\n}\n\nexport default Game;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Game from './Game';\nimport reportWebVitals from './reportWebVitals';\nimport config from '../package.json'\nReactDOM.render(\n  <React.StrictMode>\n    <Game />\n    <div style={{\n      position: 'absolute',\n      bottom: 0,\n      right: 0,\n      fontSize: 10,\n      color: 'gray'\n    }}>v{config.version}</div>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}